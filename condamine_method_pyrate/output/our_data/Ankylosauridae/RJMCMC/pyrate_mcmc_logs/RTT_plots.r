

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.45384597013263, -67.21067288642327,-67.9674998027139,-68.72432671900454,-69.48115363529516,-70.23798055158579,-70.99480746787643,-71.75163438416706,-72.5084613004577,-73.26528821674833,-74.02211513303897,-74.7789420493296,-75.53576896562022,-76.29259588191086,-77.04942279820149,-77.80624971449213,-78.56307663078276,-79.3199035470734,-80.07673046336403,-80.83355737965466,-81.5903842959453,-82.34721121223593,-83.10403812852655,-83.86086504481719,-84.61769196110782,-85.37451887739846,-86.13134579368909,-86.88817270997973,-87.64499962627035,-88.40182654256098,-89.15865345885162,-89.91548037514225,-90.67230729143289,-91.42913420772352,-92.18596112401416,-92.94278804030479,-93.69961495659543,-94.45644187288606,-95.2132687891767,-95.97009570546732,-96.72692262175795,-97.48374953804858,-98.24057645433922,-98.99740337062985,-99.75423028692047,-100.51105720321111,-101.26788411950174,-102.02471103579238,-102.78153795208301,-103.53836486837365,-104.29519178466428,-105.05201870095492,-105.80884561724555,-106.56567253353619,-107.32249944982682,-108.07932636611746,-108.83615328240809,-109.59298019869871,-110.34980711498935,-111.10663403127998,-111.86346094757062,-112.62028786386124,-113.37711478015187,-114.1339416964425,-114.89076861273314,-115.64759552902377,-116.40442244531441,-117.16124936160504,-117.91807627789568,-118.67490319418631,-119.43173011047695,-120.18855702676758,-120.94538394305822,-121.70221085934885,-122.45903777563947,-123.21586469193011,-123.97269160822074,-124.72951852451138,-125.486345440802,-126.24317235709263,-126.99999927338327,-127.7568261896739,-128.51365310596452,-129.27048002225519,-130.0273069385458,-130.78413385483645,-131.54096077112706,-132.29778768741772,-133.05461460370833,-133.811441519999,-134.5682684362896,-135.32509535258026,-136.08192226887087,-136.83874918516153,-137.59557610145214,-138.3524030177428,-139.1092299340334,-139.86605685032407,-140.62288376661468,-141.37971068290528)
rate=c(0.102794013977703, 0.10273934721073538,0.1027029410762631,0.10273934721073538,0.102794013977703,0.102794013977703,0.102794013977703,0.102794013977703,0.102794013977703,0.102794013977703,0.10283897870943502,0.10283897870943502,0.10273934721073538,0.10273934721073538,0.10273934721073538,0.10273934721073538,0.10273934721073538,0.1027029410762631,0.1027029410762631,0.10244440681237806,0.10244440681237806,0.10244440681237806,0.10244440681237806,0.10244440681237806,0.10244346523608089,0.10244346523608089,0.10244346523608089,0.10243369320073023,0.10243369320073023,0.10243369320073023,0.10221522356738892,0.10214746390123508,0.1021221102297081,0.1021221102297081,0.10209001457802311,0.10209001457802311,0.10209001457802311,0.10209001457802311,0.10209001457802311,0.10202642452361652,0.10202642452361652,0.1019596833464424,0.1019596833464424,0.1019596833464424,0.1019596833464424,0.10202642452361652,0.10202642452361652,0.10202642452361652,0.10194231991702266,0.10192921353114892,0.10192921353114892,0.10194231991702266,0.10192921353114892,0.10192921353114892,0.10192921353114892,0.10192921353114892,0.10192921353114892,0.10194231991702266,0.1019596833464424,0.1019596833464424,0.10202642452361652,0.1019596833464424,0.1019596833464424,0.1019596833464424,0.1019596833464424,0.1019596833464424,0.1019596833464424,0.10202642452361652,0.10202642452361652,0.10202642452361652,0.10209001457802311,0.1021708259307509,0.10221522356738892,0.10234442221328341,0.10234442221328341,0.10241083902291595,0.10243369320073023,0.10244440681237806,0.1027029410762631,0.10295677555428183,0.10310485436404479,0.10310485436404479,0.10310485436404479,0.10310485436404479,0.10316145430188844,0.10315503108194629,0.1031807077121682,0.10321843232071973,0.10326305712330153,0.1033178330787498,0.1033178330787498,0.10334038702622898,0.1035367701366603,0.10386061007012248,0.10386061007012248,0.10401917544830037,0.10415995318486895,0.10430393139685684,0.10430393139685684,0.10433292040190692)
minHPD=c(0.06807765785454, 0.07000921962751044,0.07000921962751044,0.07271809280593387,0.07271809280593387,0.07271809280593387,0.07271809280593387,0.07271809280593387,0.07271809280593387,0.07271809280593387,0.07271809280593387,0.07271809280593387,0.07357523018937642,0.07357523018937642,0.07370018500028841,0.07444874816077089,0.07444874816077089,0.07444874816077089,0.07444874816077089,0.07444874816077089,0.07444874816077089,0.07444874816077089,0.07444874816077089,0.07444874816077089,0.07444874816077089,0.07444874816077089,0.07444874816077089,0.07257354254943849,0.07257354254943849,0.07257354254943849,0.07457129927231373,0.07483204490543144,0.06776040063074078,0.06776040063074078,0.06739828075044962,0.06739828075044962,0.06739828075044962,0.06739828075044962,0.06739828075044962,0.06776040063074078,0.06776040063074078,0.06739828075044962,0.06776040063074078,0.06776040063074078,0.06776040063074078,0.06721646652757633,0.06721646652757633,0.06721646652757633,0.06634122340002774,0.06634122340002774,0.06634122340002774,0.06634122340002774,0.06721646652757633,0.06634122340002774,0.06634122340002774,0.06634122340002774,0.06634122340002774,0.06634122340002774,0.06634122340002774,0.06634122340002774,0.07357523018937642,0.07357523018937642,0.07357523018937642,0.07357523018937642,0.07357523018937642,0.07357523018937642,0.07444874816077089,0.07357523018937642,0.07357523018937642,0.07357523018937642,0.07257354254943849,0.07257354254943849,0.07257354254943849,0.07257354254943849,0.07026099038777896,0.07026099038777896,0.06906051231263187,0.06845483355354536,0.06721646652757633,0.06634122340002774,0.06515195034346064,0.06515195034346064,0.06515195034346064,0.06515195034346064,0.06380768235885328,0.06634122340002774,0.06515195034346064,0.06515195034346064,0.06380768235885328,0.06012008023095117,0.06012008023095117,0.06380768235885328,0.06380768235885328,0.06292925018870771,0.06292925018870771,0.06292925018870771,0.06435730160335051,0.06292925018870771,0.06012008023095117,0.06012008023095117)
maxHPD=c(0.143095432467863, 0.143095432467863,0.14302665248455512,0.14521718226103897,0.14521718226103897,0.14521718226103897,0.14521718226103897,0.14521718226103897,0.14521718226103897,0.14521718226103897,0.14390221334005726,0.14354023977867614,0.14354023977867614,0.143095432467863,0.143095432467863,0.14354023977867614,0.14354023977867614,0.143095432467863,0.143095432467863,0.14390221334005726,0.14390221334005726,0.14390221334005726,0.14390221334005726,0.14354023977867614,0.14354023977867614,0.14354023977867614,0.14354023977867614,0.14165208775318341,0.14165208775318341,0.14165208775318341,0.143095432467863,0.143095432467863,0.13579659693064508,0.13579659693064508,0.13579659693064508,0.13579659693064508,0.13579659693064508,0.13579659693064508,0.13579659693064508,0.13579659693064508,0.13579659693064508,0.13579659693064508,0.13579659693064508,0.13579659693064508,0.13579659693064508,0.13579659693064508,0.13579659693064508,0.13579659693064508,0.13539143966283657,0.13539143966283657,0.13539143966283657,0.13539143966283657,0.13579659693064508,0.1357187261367299,0.1357187261367299,0.1357187261367299,0.1357187261367299,0.13579659693064508,0.13579659693064508,0.13579659693064508,0.14354023977867614,0.14354023977867614,0.14354023977867614,0.14354023977867614,0.14354023977867614,0.14354023977867614,0.14390221334005726,0.14354023977867614,0.14354023977867614,0.14354023977867614,0.143095432467863,0.14354023977867614,0.14354023977867614,0.14479462957316347,0.143095432467863,0.14354023977867614,0.14354023977867614,0.14354023977867614,0.14354023977867614,0.14390221334005726,0.14354023977867614,0.14390221334005726,0.14390221334005726,0.14390221334005726,0.14390221334005726,0.14721878133524804,0.14721878133524804,0.14721878133524804,0.14721878133524804,0.14721878133524804,0.14721878133524804,0.1551239043904195,0.1558793644766353,0.15900389957103078,0.15900389957103078,0.166505247707208,0.17303612329016552,0.1743881437031508,0.1743881437031508,0.20376287531189705)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.22413916284308677), xlim = c(-141.75812414105062,-66.07543251198732), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.45766832829571, -67.22213996091253,-67.98661159352932,-68.75108322614611,-69.51555485876293,-70.28002649137972,-71.04449812399653,-71.80896975661332,-72.57344138923011,-73.33791302184693,-74.10238465446372,-74.86685628708054,-75.63132791969733,-76.39579955231412,-77.16027118493093,-77.92474281754772,-78.68921445016454,-79.45368608278133,-80.21815771539812,-80.98262934801494,-81.74710098063173,-82.51157261324855,-83.27604424586534,-84.04051587848213,-84.80498751109894,-85.56945914371573,-86.33393077633255,-87.09840240894934,-87.86287404156613,-88.62734567418295,-89.39181730679974,-90.15628893941656,-90.92076057203334,-91.68523220465013,-92.44970383726695,-93.21417546988374,-93.97864710250056,-94.74311873511735,-95.50759036773417,-96.27206200035096,-97.03653363296775,-97.80100526558456,-98.56547689820135,-99.32994853081817,-100.09442016343496,-100.85889179605175,-101.62336342866857,-102.38783506128536,-103.15230669390218,-103.91677832651897,-104.68124995913576,-105.44572159175257,-106.21019322436936,-106.97466485698618,-107.73913648960297,-108.50360812221976,-109.26807975483658,-110.03255138745337,-110.79702302007018,-111.56149465268697,-112.32596628530376,-113.09043791792058,-113.85490955053737,-114.61938118315419,-115.38385281577098,-116.14832444838777,-116.91279608100459,-117.67726771362138,-118.4417393462382,-119.20621097885498,-119.97068261147177,-120.73515424408859,-121.49962587670538,-122.2640975093222,-123.02856914193899,-123.79304077455578,-124.5575124071726,-125.32198403978938,-126.0864556724062,-126.85092730502299,-127.61539893763978,-128.3798705702566,-129.1443422028734,-129.9088138354902,-130.673285468107,-131.43775710072381,-132.2022287333406,-132.9667003659574,-133.7311719985742,-134.495643631191,-135.26011526380782,-136.0245868964246,-136.7890585290414,-137.55353016165822,-138.318001794275,-139.08247342689182,-139.8469450595086,-140.6114166921254,-141.37588832474222)
counts=c(0.005, 0.003,0.003,0.001,0.0,0.0,0.001,0.002,0.001,0.002,0.001,0.002,0.001,0.002,0.003,0.001,0.003,0.001,0.003,0.0,0.0,0.0,0.001,0.002,0.0,0.001,0.0,0.0,0.001,0.004,0.002,0.001,0.001,0.001,0.0,0.0,0.0,0.001,0.001,0.0,0.001,0.001,0.0,0.0,0.002,0.001,0.0,0.002,0.001,0.0,0.001,0.002,0.002,0.0,0.002,0.002,0.001,0.0,0.001,0.001,0.0,0.0,0.001,0.0,0.0,0.002,0.001,0.002,0.003,0.004,0.002,0.002,0.002,0.001,0.004,0.005,0.004,0.007,0.002,0.001,0.0,0.0,0.002,0.003,0.002,0.001,0.002,0.002,0.0,0.004,0.002,0.006,0.0,0.007,0.007,0.005,0.001,0.007,0.006)
plot(mids,counts,type = 'h', xlim = c(-141.75812414105062,-66.07543251198732), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.033291776536687634
bf6 = 0.20284834687298803
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.45384597013263, -67.21067288642327,-67.9674998027139,-68.72432671900454,-69.48115363529516,-70.23798055158579,-70.99480746787643,-71.75163438416706,-72.5084613004577,-73.26528821674833,-74.02211513303897,-74.7789420493296,-75.53576896562022,-76.29259588191086,-77.04942279820149,-77.80624971449213,-78.56307663078276,-79.3199035470734,-80.07673046336403,-80.83355737965466,-81.5903842959453,-82.34721121223593,-83.10403812852655,-83.86086504481719,-84.61769196110782,-85.37451887739846,-86.13134579368909,-86.88817270997973,-87.64499962627035,-88.40182654256098,-89.15865345885162,-89.91548037514225,-90.67230729143289,-91.42913420772352,-92.18596112401416,-92.94278804030479,-93.69961495659543,-94.45644187288606,-95.2132687891767,-95.97009570546732,-96.72692262175795,-97.48374953804858,-98.24057645433922,-98.99740337062985,-99.75423028692047,-100.51105720321111,-101.26788411950174,-102.02471103579238,-102.78153795208301,-103.53836486837365,-104.29519178466428,-105.05201870095492,-105.80884561724555,-106.56567253353619,-107.32249944982682,-108.07932636611746,-108.83615328240809,-109.59298019869871,-110.34980711498935,-111.10663403127998,-111.86346094757062,-112.62028786386124,-113.37711478015187,-114.1339416964425,-114.89076861273314,-115.64759552902377,-116.40442244531441,-117.16124936160504,-117.91807627789568,-118.67490319418631,-119.43173011047695,-120.18855702676758,-120.94538394305822,-121.70221085934885,-122.45903777563947,-123.21586469193011,-123.97269160822074,-124.72951852451138,-125.486345440802,-126.24317235709263,-126.99999927338327,-127.7568261896739,-128.51365310596452,-129.27048002225519,-130.0273069385458,-130.78413385483645,-131.54096077112706,-132.29778768741772,-133.05461460370833,-133.811441519999,-134.5682684362896,-135.32509535258026,-136.08192226887087,-136.83874918516153,-137.59557610145214,-138.3524030177428,-139.1092299340334,-139.86605685032407,-140.62288376661468,-141.37971068290528)
rate=c(0.3461532306277979, 0.24941213052465394,0.24347253631745464,0.2414089895930221,0.24206874278843454,0.2414089895930221,0.24079762183538575,0.24046276635693362,0.24034506837886338,0.23951292879697458,0.23732746195503632,0.23586662426276508,0.22456954268680696,0.21747296554591122,0.19678685980029287,0.17016821091524842,0.10192104940221644,0.07965112533709212,0.07033160482951012,0.06690836970853926,0.06552714667029097,0.06451629659807787,0.06432893032584268,0.06368824678605425,0.06356302384890397,0.06336630178956493,0.06314510716402016,0.06291053569083732,0.06250975544827247,0.06225995250574799,0.06209901069442553,0.06206863333662435,0.06206863333662435,0.0620206297830461,0.06183169127965296,0.061753540544205385,0.06173559470522729,0.0616648360048683,0.0616648360048683,0.061485920293641014,0.06119796949085804,0.06116227289605142,0.061088404246163,0.06107397080897864,0.06105617004442735,0.06101583249196541,0.060971653471494414,0.060971653471494414,0.060971653471494414,0.06090570419091315,0.06090570419091315,0.06090570419091315,0.06081929561736424,0.06081929561736424,0.06076457553514218,0.06076457553514218,0.06076457553514218,0.06068736312147279,0.06063393128362263,0.06063393128362263,0.06063393128362263,0.060630758101042875,0.06063393128362263,0.06063393128362263,0.06063393128362263,0.06063393128362263,0.06063393128362263,0.06063393128362263,0.06063393128362263,0.06063393128362263,0.06063393128362263,0.06068736312147279,0.06076457553514218,0.06068736312147279,0.06063393128362263,0.06063393128362263,0.06063393128362263,0.06063393128362263,0.060630758101042875,0.060630758101042875,0.060630758101042875,0.060630758101042875,0.060630758101042875,0.060630758101042875,0.060630758101042875,0.060630758101042875,0.060630758101042875,0.06068736312147279,0.06068736312147279,0.06068736312147279,0.06068736312147279,0.06068736312147279,0.06076457553514218,0.06076457553514218,0.06076457553514218,0.06081929561736424,0.06081929561736424,0.06091318128687441,0.06091318128687441,0.06091318128687441)
minHPD=c(0.09228322507432456, 0.06055993019238908,0.0644229278258173,0.0759059905410292,0.07659929675363256,0.07869697826841623,0.07869697826841623,0.0759059905410292,0.0759059905410292,0.07659929675363256,0.0759059905410292,0.0759059905410292,0.0547954476748309,0.04741147060539764,0.04396180659651529,0.04072856988589753,0.03555589391434355,0.036741922065602124,0.033501862532349824,0.035541684350410184,0.035541684350410184,0.028467892008342943,0.028467892008342943,0.035541684350410184,0.026252013425218858,0.03241947912281974,0.035541684350410184,0.035541684350410184,0.029492810502538266,0.027574226861708687,0.028858801176025486,0.029492810502538266,0.029492810502538266,0.030719629245737467,0.03150722596221724,0.027574226861708687,0.029492810502538266,0.028467892008342943,0.028858801176025486,0.029492810502538266,0.03033445085862647,0.03033445085862647,0.03150722596221724,0.03033445085862647,0.03241947912281974,0.03241947912281974,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033793592943440975,0.033793592943440975,0.033793592943440975,0.033793592943440975,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.033501862532349824,0.03241947912281974,0.03241947912281974,0.03241947912281974,0.03241947912281974,0.03241947912281974,0.03241947912281974,0.03241947912281974,0.03241947912281974,0.03241947912281974,0.03241947912281974,0.03241947912281974,0.03241947912281974,0.03241947912281974,0.03241947912281974,0.03241947912281974,0.03241947912281974,0.03241947912281974,0.032021045165095116,0.032021045165095116,0.032021045165095116,0.032021045165095116,0.033793592943440975,0.033793592943440975,0.033793592943440975,0.03033445085862647,0.03033445085862647,0.03033445085862647)
maxHPD=c(3.3810099944598164, 0.5012534369465342,0.4050342736245405,0.4050342736245405,0.4050342736245405,0.40603174714206364,0.40603174714206364,0.4006534639949044,0.3991150673893125,0.3991150673893125,0.397710882513058,0.3991150673893125,0.36730192480605495,0.35596616556231964,0.34820745476077025,0.32665170939905297,0.3005174583772565,0.27172029046075674,0.2355071644456843,0.20019753572938312,0.1784334456691582,0.14819030016733728,0.1447718888041777,0.14411312814968155,0.1305023776713644,0.1289393628583794,0.12746595477864175,0.12679875457067113,0.11600631817628247,0.10797230629964838,0.1070836345547299,0.1070836345547299,0.1070836345547299,0.10797230629964838,0.10797230629964838,0.10283307796812292,0.10283307796812292,0.09989190966359306,0.09989190966359306,0.09923875318007293,0.09989190966359306,0.09923875318007293,0.09964740365753831,0.09819193555736784,0.09964740365753831,0.09923875318007293,0.09964740365753831,0.09964740365753831,0.09964740365753831,0.09964740365753831,0.09964740365753831,0.09964740365753831,0.09964740365753831,0.09964740365753831,0.09964740365753831,0.09964740365753831,0.09964740365753831,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09964740365753831,0.09964740365753831,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.09923875318007293,0.10136568025568471,0.10136568025568471,0.10136568025568471,0.09818307670006064,0.09818307670006064,0.09818307670006064)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 3.7191109939057982), xlim = c(-141.75812414105062,-66.07543251198732), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.45766832829571, -67.22213996091253,-67.98661159352932,-68.75108322614611,-69.51555485876293,-70.28002649137972,-71.04449812399653,-71.80896975661332,-72.57344138923011,-73.33791302184693,-74.10238465446372,-74.86685628708054,-75.63132791969733,-76.39579955231412,-77.16027118493093,-77.92474281754772,-78.68921445016454,-79.45368608278133,-80.21815771539812,-80.98262934801494,-81.74710098063173,-82.51157261324855,-83.27604424586534,-84.04051587848213,-84.80498751109894,-85.56945914371573,-86.33393077633255,-87.09840240894934,-87.86287404156613,-88.62734567418295,-89.39181730679974,-90.15628893941656,-90.92076057203334,-91.68523220465013,-92.44970383726695,-93.21417546988374,-93.97864710250056,-94.74311873511735,-95.50759036773417,-96.27206200035096,-97.03653363296775,-97.80100526558456,-98.56547689820135,-99.32994853081817,-100.09442016343496,-100.85889179605175,-101.62336342866857,-102.38783506128536,-103.15230669390218,-103.91677832651897,-104.68124995913576,-105.44572159175257,-106.21019322436936,-106.97466485698618,-107.73913648960297,-108.50360812221976,-109.26807975483658,-110.03255138745337,-110.79702302007018,-111.56149465268697,-112.32596628530376,-113.09043791792058,-113.85490955053737,-114.61938118315419,-115.38385281577098,-116.14832444838777,-116.91279608100459,-117.67726771362138,-118.4417393462382,-119.20621097885498,-119.97068261147177,-120.73515424408859,-121.49962587670538,-122.2640975093222,-123.02856914193899,-123.79304077455578,-124.5575124071726,-125.32198403978938,-126.0864556724062,-126.85092730502299,-127.61539893763978,-128.3798705702566,-129.1443422028734,-129.9088138354902,-130.673285468107,-131.43775710072381,-132.2022287333406,-132.9667003659574,-133.7311719985742,-134.495643631191,-135.26011526380782,-136.0245868964246,-136.7890585290414,-137.55353016165822,-138.318001794275,-139.08247342689182,-139.8469450595086,-140.6114166921254,-141.37588832474222)
counts=c(0.353, 0.033,0.01,0.003,0.002,0.004,0.006,0.005,0.008,0.014,0.013,0.04,0.042,0.092,0.113,0.152,0.123,0.128,0.054,0.032,0.023,0.003,0.015,0.004,0.01,0.005,0.005,0.009,0.006,0.004,0.001,0.001,0.001,0.001,0.004,0.002,0.002,0.001,0.004,0.002,0.004,0.002,0.001,0.002,0.003,0.002,0.0,0.0,0.001,0.0,0.001,0.0,0.001,0.0,0.0,0.0,0.001,0.001,0.001,0.001,0.0,0.001,0.0,0.002,0.0,0.001,0.0,0.0,0.0,0.001,0.002,0.001,0.001,0.001,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.002,0.002,0.0,0.0,0.001,0.002,0.002,0.0,0.0,0.002,0.001,0.002,0.0,0.0,0.0)
plot(mids,counts,type = 'h', xlim = c(-141.75812414105062,-66.07543251198732), ylim=c(0,0.353), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.45384597013263, -67.21067288642327,-67.9674998027139,-68.72432671900454,-69.48115363529516,-70.23798055158579,-70.99480746787643,-71.75163438416706,-72.5084613004577,-73.26528821674833,-74.02211513303897,-74.7789420493296,-75.53576896562022,-76.29259588191086,-77.04942279820149,-77.80624971449213,-78.56307663078276,-79.3199035470734,-80.07673046336403,-80.83355737965466,-81.5903842959453,-82.34721121223593,-83.10403812852655,-83.86086504481719,-84.61769196110782,-85.37451887739846,-86.13134579368909,-86.88817270997973,-87.64499962627035,-88.40182654256098,-89.15865345885162,-89.91548037514225,-90.67230729143289,-91.42913420772352,-92.18596112401416,-92.94278804030479,-93.69961495659543,-94.45644187288606,-95.2132687891767,-95.97009570546732,-96.72692262175795,-97.48374953804858,-98.24057645433922,-98.99740337062985,-99.75423028692047,-100.51105720321111,-101.26788411950174,-102.02471103579238,-102.78153795208301,-103.53836486837365,-104.29519178466428,-105.05201870095492,-105.80884561724555,-106.56567253353619,-107.32249944982682,-108.07932636611746,-108.83615328240809,-109.59298019869871,-110.34980711498935,-111.10663403127998,-111.86346094757062,-112.62028786386124,-113.37711478015187,-114.1339416964425,-114.89076861273314,-115.64759552902377,-116.40442244531441,-117.16124936160504,-117.91807627789568,-118.67490319418631,-119.43173011047695,-120.18855702676758,-120.94538394305822,-121.70221085934885,-122.45903777563947,-123.21586469193011,-123.97269160822074,-124.72951852451138,-125.486345440802,-126.24317235709263,-126.99999927338327,-127.7568261896739,-128.51365310596452,-129.27048002225519,-130.0273069385458,-130.78413385483645,-131.54096077112706,-132.29778768741772,-133.05461460370833,-133.811441519999,-134.5682684362896,-135.32509535258026,-136.08192226887087,-136.83874918516153,-137.59557610145214,-138.3524030177428,-139.1092299340334,-139.86605685032407,-140.62288376661468,-141.37971068290528)
net_rate=c(-0.8793032483501949, -0.17429944036760028,-0.14532274799459166,-0.138834070029418,-0.13869645470233924,-0.13854990917276375,-0.13824172631594933,-0.13772072985662998,-0.13649742033335643,-0.13429931237439727,-0.1302774174077643,-0.12761893814294425,-0.1160562411855821,-0.10796545811148738,-0.08762694084043707,-0.06526180052653961,-0.035989348125724,-0.012303180795351277,0.010701278562495463,0.02248895888285841,0.02809259547368949,0.03173109627161598,0.03214917417266279,0.03362005539448247,0.03419284131885648,0.03543095786801933,0.03622323511629117,0.03650119764371097,0.03710774238789302,0.03806124527407064,0.038159840153272145,0.03799574390306184,0.03793539870227971,0.0379961733046138,0.03815750828271924,0.03836706216531557,0.03862742490810964,0.038897011818127346,0.038951941848745585,0.03930135916049454,0.03951387869957006,0.0397373487119042,0.039941169791816195,0.04002764603651722,0.040096253776809934,0.04030771991047329,0.04052788551187388,0.04052723404351998,0.040448296682958476,0.04038287133262988,0.04038287133262988,0.040399370432627084,0.040381560429571604,0.040414874582202207,0.040457676886922096,0.04045615934076808,0.04045707548299224,0.040585953501150185,0.04062768182155813,0.04061831710520107,0.04066126321523314,0.04070293201913266,0.04067629872197433,0.04067629872197433,0.040679872710563295,0.04065317480765473,0.04063518039183657,0.04089698435989608,0.04089698435989608,0.04109909911243487,0.041420971864129796,0.041789472475235165,0.04185069037058273,0.04213051872020877,0.04232069714575102,0.04278069025615461,0.04313557567410012,0.04433414879717788,0.044746859378917515,0.04544667863329791,0.04579423209716043,0.04602840015036156,0.04602840015036156,0.04602840015036156,0.046264850433839995,0.04536647281126253,0.045692041255829506,0.04563179631726128,0.0458925449981965,0.04616329880168824,0.04614906937031088,0.04743275361679331,0.04719281927156739,0.04816547732860872,0.04810478284741281,0.049752831931538566,0.0507336540999053,0.05273701916091677,0.05302206462297561,0.05442206334242565)
net_minHPD=c(-3.3161634473207275, -0.4004107339278835,-0.31152647534664374,-0.30752774780217484,-0.30596865935480866,-0.30596865935480866,-0.30596865935480866,-0.29287548422920073,-0.28888269379585096,-0.2883331826442079,-0.2883331826442079,-0.2910758078632355,-0.2704486848935064,-0.2616542374885068,-0.25777551783478103,-0.2363090115341252,-0.22485766958996617,-0.1864825298549604,-0.14481307905406693,-0.10727798796087545,-0.08241033721046268,-0.06342674517288675,-0.051858141303516445,-0.042975155171296436,-0.04152709980282933,-0.028545728699857942,-0.026716464546036794,-0.022201640452689658,-0.022201640452689658,-0.01932208647519705,-0.01804248766159404,-0.012184078166789306,-0.012184078166789306,-0.011704500747090549,-0.011283047157551476,-0.011283047157551476,-0.012184078166789306,-0.011283047157551476,-0.0075276472388050575,-0.004947118284644669,-0.00525562112566938,-0.003897325793851658,-0.005964690404379566,-0.00525562112566938,-0.00525562112566938,-0.004947118284644669,-0.003897325793851658,-0.003897325793851658,-0.003897325793851658,-0.003897325793851658,-0.003897325793851658,-0.003897325793851658,-0.003897325793851658,-0.004947118284644669,-0.004947118284644669,-0.004947118284644669,-0.004947118284644669,-0.003419372564403625,-0.003897325793851658,-0.003897325793851658,-0.003897325793851658,-0.003419372564403625,-0.003419372564403625,-0.003419372564403625,-0.003419372564403625,-0.004947118284644669,-0.004947118284644669,-0.00525562112566938,-0.00525562112566938,-0.00525562112566938,-0.003897325793851658,-0.003897325793851658,-0.003897325793851658,-0.004556593229730038,-0.004947118284644669,-0.012184078166789306,-0.012184078166789306,-0.011067870669760116,-0.012002046416644804,-0.01733982802930767,-0.01804248766159404,-0.01932208647519705,-0.01932208647519705,-0.01932208647519705,-0.02061132461456651,-0.022294740851505734,-0.022294740851505734,-0.022294740851505734,-0.02541562862437762,-0.025999778062499868,-0.025999778062499868,-0.022294740851505734,-0.025999778062499868,-0.022294740851505734,-0.022294740851505734,-0.02541562862437762,-0.026716464546036794,-0.026716464546036794,-0.026716464546036794,-0.026716464546036794)
net_maxHPD=c(0.02365594284632902, 0.08913313333168689,0.04259696503366538,0.034743483551075274,0.034743483551075274,0.03387561398311345,0.03387561398311345,0.043878474010944565,0.043878474010944565,0.043878474010944565,0.043878474010944565,0.043878474010944565,0.0581069518364238,0.06270129877544417,0.06505195575217441,0.07950042552007705,0.07862254924150763,0.0900787661191157,0.09179851281807702,0.09274684075270417,0.09106333544686393,0.0900787661191157,0.09556046448551238,0.09556046448551238,0.09179851281807702,0.09808885532766352,0.09274684075270417,0.09179851281807702,0.08874150927660646,0.08874150927660646,0.08593647605236616,0.09179851281807702,0.09179851281807702,0.09179851281807702,0.0913866619454341,0.0913866619454341,0.08868920274851047,0.08868920274851047,0.09179851281807702,0.09106333544686393,0.08868920274851047,0.08868920274851047,0.08654444197567264,0.08654444197567264,0.08593647605236616,0.08593647605236616,0.08593647605236616,0.08593647605236616,0.08654444197567264,0.08593647605236616,0.08593647605236616,0.08593647605236616,0.08654444197567264,0.08593647605236616,0.08593647605236616,0.08593647605236616,0.08593647605236616,0.08774773652623666,0.08774773652623666,0.08774773652623666,0.08774773652623666,0.08729845800153056,0.08729845800153056,0.08729845800153056,0.08729845800153056,0.08593647605236616,0.08593647605236616,0.08593647605236616,0.08593647605236616,0.08593647605236616,0.08827712610096128,0.09124829558289886,0.09124829558289886,0.09181197760731132,0.09181197760731132,0.08729845800153056,0.08887799111064518,0.09181197760731132,0.09181197760731132,0.09181197760731132,0.09181197760731132,0.09181197760731132,0.09181197760731132,0.09181197760731132,0.09181197760731132,0.0913532405068187,0.09181197760731132,0.09179851281807702,0.09179851281807702,0.09179851281807702,0.09179851281807702,0.10026183570615836,0.09921762553726907,0.10710036178518394,0.10710036178518394,0.10753996618729944,0.1108083494198672,0.11746408728796558,0.11915168588110675,0.1447304286499488)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-3.6477797920528006, 0.1592034715149437), xlim = c(-141.75812414105062,-66.07543251198732), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.45384597013263, -67.21067288642327,-67.9674998027139,-68.72432671900454,-69.48115363529516,-70.23798055158579,-70.99480746787643,-71.75163438416706,-72.5084613004577,-73.26528821674833,-74.02211513303897,-74.7789420493296,-75.53576896562022,-76.29259588191086,-77.04942279820149,-77.80624971449213,-78.56307663078276,-79.3199035470734,-80.07673046336403,-80.83355737965466,-81.5903842959453,-82.34721121223593,-83.10403812852655,-83.86086504481719,-84.61769196110782,-85.37451887739846,-86.13134579368909,-86.88817270997973,-87.64499962627035,-88.40182654256098,-89.15865345885162,-89.91548037514225,-90.67230729143289,-91.42913420772352,-92.18596112401416,-92.94278804030479,-93.69961495659543,-94.45644187288606,-95.2132687891767,-95.97009570546732,-96.72692262175795,-97.48374953804858,-98.24057645433922,-98.99740337062985,-99.75423028692047,-100.51105720321111,-101.26788411950174,-102.02471103579238,-102.78153795208301,-103.53836486837365,-104.29519178466428,-105.05201870095492,-105.80884561724555,-106.56567253353619,-107.32249944982682,-108.07932636611746,-108.83615328240809,-109.59298019869871,-110.34980711498935,-111.10663403127998,-111.86346094757062,-112.62028786386124,-113.37711478015187,-114.1339416964425,-114.89076861273314,-115.64759552902377,-116.40442244531441,-117.16124936160504,-117.91807627789568,-118.67490319418631,-119.43173011047695,-120.18855702676758,-120.94538394305822,-121.70221085934885,-122.45903777563947,-123.21586469193011,-123.97269160822074,-124.72951852451138,-125.486345440802,-126.24317235709263,-126.99999927338327,-127.7568261896739,-128.51365310596452,-129.27048002225519,-130.0273069385458,-130.78413385483645,-131.54096077112706,-132.29778768741772,-133.05461460370833,-133.811441519999,-134.5682684362896,-135.32509535258026,-136.08192226887087,-136.83874918516153,-137.59557610145214,-138.3524030177428,-139.1092299340334,-139.86605685032407,-140.62288376661468,-141.37971068290528)
rate=c(1.0140187914493108, 3.5676037240240954,3.9875101368065,4.092677896053808,4.094507545238698,4.096965854939175,4.102145283635632,4.110867573359078,4.131948935119639,4.169744039095534,4.2408381219529945,4.290655192769141,4.518015646547516,4.690911959271208,5.1875208618227004,5.869634446360794,7.087377729695169,8.52914807935076,10.609714807113143,12.155280015705289,13.043738225500379,13.693633295519264,13.772480823512812,14.077711283666506,14.221127477989567,14.476012614718107,14.64396446932455,14.72036380184672,14.852979510132009,15.066354630690686,15.21913576241268,15.242302088082514,15.242302088082514,15.257515817429862,15.308112341072858,15.357376876843153,15.41902969385321,15.483390565121201,15.496570446601496,15.596995380474178,15.648866149250662,15.715205746297439,15.770797066059158,15.792334641086187,15.809463821933852,15.83836308073337,15.893785708561927,15.893785708561927,15.893785708561927,15.895682628013457,15.895682628013457,15.895682628013457,15.90519085980646,15.90519085980646,15.916026153402727,15.916026153402727,15.916026153402727,15.931663716797289,15.935680825387541,15.93330304868822,15.93330304868822,15.956129507659213,15.949351602003382,15.949351602003382,15.951064197147975,15.944274169136676,15.940905620091213,15.940905620091213,15.940905620091213,15.940905620091213,15.940905620091213,15.92743330628995,15.917635033481984,15.913521179361766,15.925186908616734,15.925186908616734,15.925186908616734,15.925186908616734,15.929136690609612,15.929136690609612,15.929136690609612,15.929136690609612,15.929136690609612,15.929136690609612,15.929136690609612,15.929136690609612,15.926255883120934,15.903670418312213,15.903670418312213,15.903670418312213,15.900072228995617,15.895033372292446,15.76043121235871,15.76043121235871,15.74536964528789,15.733087135030223,15.737500357781485,15.720356152954357,15.720356152954357,15.720356152954357)
minHPD=c(1.0140187914493108, 3.5676037240240954,3.9875101368065,4.092677896053808,4.094507545238698,4.096965854939175,4.102145283635632,4.110867573359078,4.131948935119639,4.169744039095534,4.2408381219529945,4.290655192769141,4.518015646547516,4.690911959271208,5.1875208618227004,5.869634446360794,7.087377729695169,8.52914807935076,10.609714807113143,12.155280015705289,13.043738225500379,13.693633295519264,13.772480823512812,14.077711283666506,14.221127477989567,14.476012614718107,14.64396446932455,14.72036380184672,14.852979510132009,15.066354630690686,15.21913576241268,15.242302088082514,15.242302088082514,15.257515817429862,15.308112341072858,15.357376876843153,15.41902969385321,15.483390565121201,15.496570446601496,15.596995380474178,15.648866149250662,15.715205746297439,15.770797066059158,15.792334641086187,15.809463821933852,15.83836308073337,15.893785708561927,15.893785708561927,15.893785708561927,15.895682628013457,15.895682628013457,15.895682628013457,15.90519085980646,15.90519085980646,15.916026153402727,15.916026153402727,15.916026153402727,15.931663716797289,15.935680825387541,15.93330304868822,15.93330304868822,15.956129507659213,15.949351602003382,15.949351602003382,15.951064197147975,15.944274169136676,15.940905620091213,15.940905620091213,15.940905620091213,15.940905620091213,15.940905620091213,15.92743330628995,15.917635033481984,15.913521179361766,15.925186908616734,15.925186908616734,15.925186908616734,15.925186908616734,15.929136690609612,15.929136690609612,15.929136690609612,15.929136690609612,15.929136690609612,15.929136690609612,15.929136690609612,15.929136690609612,15.926255883120934,15.903670418312213,15.903670418312213,15.903670418312213,15.900072228995617,15.895033372292446,15.76043121235871,15.76043121235871,15.74536964528789,15.733087135030223,15.737500357781485,15.720356152954357,15.720356152954357,15.720356152954357)
maxHPD=c(1.0140187914493108, 3.5676037240240954,3.9875101368065,4.092677896053808,4.094507545238698,4.096965854939175,4.102145283635632,4.110867573359078,4.131948935119639,4.169744039095534,4.2408381219529945,4.290655192769141,4.518015646547516,4.690911959271208,5.1875208618227004,5.869634446360794,7.087377729695169,8.52914807935076,10.609714807113143,12.155280015705289,13.043738225500379,13.693633295519264,13.772480823512812,14.077711283666506,14.221127477989567,14.476012614718107,14.64396446932455,14.72036380184672,14.852979510132009,15.066354630690686,15.21913576241268,15.242302088082514,15.242302088082514,15.257515817429862,15.308112341072858,15.357376876843153,15.41902969385321,15.483390565121201,15.496570446601496,15.596995380474178,15.648866149250662,15.715205746297439,15.770797066059158,15.792334641086187,15.809463821933852,15.83836308073337,15.893785708561927,15.893785708561927,15.893785708561927,15.895682628013457,15.895682628013457,15.895682628013457,15.90519085980646,15.90519085980646,15.916026153402727,15.916026153402727,15.916026153402727,15.931663716797289,15.935680825387541,15.93330304868822,15.93330304868822,15.956129507659213,15.949351602003382,15.949351602003382,15.951064197147975,15.944274169136676,15.940905620091213,15.940905620091213,15.940905620091213,15.940905620091213,15.940905620091213,15.92743330628995,15.917635033481984,15.913521179361766,15.925186908616734,15.925186908616734,15.925186908616734,15.925186908616734,15.929136690609612,15.929136690609612,15.929136690609612,15.929136690609612,15.929136690609612,15.929136690609612,15.929136690609612,15.929136690609612,15.926255883120934,15.903670418312213,15.903670418312213,15.903670418312213,15.900072228995617,15.895033372292446,15.76043121235871,15.76043121235871,15.74536964528789,15.733087135030223,15.737500357781485,15.720356152954357,15.720356152954357,15.720356152954357)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 17.551742458425135), xlim = c(-141.75812414105062,-66.07543251198732), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()