

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.37298609711507, -67.12966006234996,-67.88633402758481,-68.64300799281969,-69.39968195805457,-70.15635592328942,-70.9130298885243,-71.66970385375919,-72.42637781899404,-73.18305178422892,-73.9397257494638,-74.69639971469869,-75.45307367993354,-76.20974764516842,-76.9664216104033,-77.72309557563815,-78.47976954087304,-79.23644350610792,-79.99311747134277,-80.74979143657765,-81.50646540181253,-82.26313936704739,-83.01981333228227,-83.77648729751715,-84.533161262752,-85.28983522798688,-86.04650919322177,-86.80318315845665,-87.5598571236915,-88.31653108892638,-89.07320505416126,-89.82987901939612,-90.586552984631,-91.34322694986588,-92.09990091510073,-92.85657488033561,-93.6132488455705,-94.36992281080535,-95.12659677604023,-95.88327074127511,-96.63994470651,-97.39661867174485,-98.15329263697973,-98.90996660221461,-99.66664056744946,-100.42331453268434,-101.17998849791923,-101.93666246315408,-102.69333642838896,-103.45001039362384,-104.2066843588587,-104.96335832409358,-105.72003228932846,-106.47670625456331,-107.23338021979819,-107.99005418503307,-108.74672815026796,-109.50340211550281,-110.26007608073769,-111.01675004597257,-111.77342401120742,-112.5300979764423,-113.28677194167719,-114.04344590691204,-114.80011987214692,-115.5567938373818,-116.31346780261666,-117.07014176785154,-117.82681573308642,-118.5834896983213,-119.34016366355615,-120.09683762879104,-120.85351159402592,-121.61018555926077,-122.36685952449565,-123.12353348973053,-123.88020745496539,-124.63688142020027,-125.39355538543515,-126.15022935067,-126.90690331590488,-127.66357728113977,-128.42025124637462,-129.1769252116095,-129.93359917684438,-130.69027314207926,-131.44694710731412,-132.203621072549,-132.96029503778385,-133.71696900301873,-134.4736429682536,-135.2303169334885,-135.98699089872338,-136.74366486395823,-137.50033882919308,-138.25701279442796,-139.01368675966285,-139.77036072489773,-140.5270346901326,-141.28370865536746)
rate=c(0.13036692450799076, 0.13034130441191158,0.13024720273049653,0.13006009453256595,0.1297880568977952,0.12960336814230689,0.12948900923441026,0.12937161003752023,0.12934479694492512,0.12802413051092387,0.12730865693487242,0.12697012378617853,0.12672786809372705,0.12669980686673668,0.12669980686673668,0.1266054738971307,0.1266054738971307,0.12669980686673668,0.1267511111127575,0.12676965739943866,0.12725950809889036,0.1294827952563106,0.39153682434186754,0.479295492573572,0.46409486617530404,0.42348186175692004,0.41184862326450666,0.4023809933079223,0.39898326128344164,0.39637612314754667,0.3949975030507564,0.3929051620749622,0.38786809023427127,0.37236890887252116,0.3488790784562361,0.26894473385518247,0.13344797691132726,0.09288915863358317,0.07771087168041874,0.06780079614794503,0.06250387212975632,0.0590225160753977,0.056524619959088945,0.05438011572978275,0.05374894081242744,0.05306492908267067,0.05257597962959272,0.05242637733447163,0.0518922468103579,0.05146375109697747,0.05146375109697747,0.051406598972511194,0.051375358521372844,0.05138672024931974,0.05138672024931974,0.05138672024931974,0.05138672024931974,0.05138672024931974,0.05138672024931974,0.05138672024931974,0.05138672024931974,0.05138672024931974,0.05138672024931974,0.05138672024931974,0.05138672024931974,0.051375358521372844,0.051375358521372844,0.051375358521372844,0.051375358521372844,0.051375358521372844,0.051375358521372844,0.051375358521372844,0.051375358521372844,0.051375358521372844,0.051406598972511194,0.051406598972511194,0.051406598972511194,0.051406598972511194,0.05146375109697747,0.05146375109697747,0.051517218867573586,0.051517218867573586,0.051517218867573586,0.051517218867573586,0.051517218867573586,0.051517218867573586,0.051517218867573586,0.05235576943803152,0.05235576943803152,0.052533370290024216,0.05255462915431058,0.052533370290024216,0.05255462915431058,0.05269195943702343,0.052860366573897574,0.05374894081242744,0.05438011572978275,0.05554546131603447,0.05687702460774516,0.0589280677793948)
minHPD=c(0.08116842062319284, 0.08116842062319284,0.08491271011333812,0.09242211339215958,0.09242211339215958,0.09242211339215958,0.09264163477407175,0.09213522781109924,0.09213522781109924,0.09213522781109924,0.09091860427535724,0.09159263127464413,0.09091860427535724,0.09091860427535724,0.09091860427535724,0.09091860427535724,0.09091860427535724,0.09091860427535724,0.08619410968213573,0.08519518593399582,0.08491271011333812,0.06560896870047297,0.08619410968213573,0.1175279953525098,0.1249752505828824,0.060945434821296815,0.06628633255260466,0.05888123420205433,0.06055015591389762,0.06292737050986989,0.04682534552987966,0.05274052009455503,0.052438041343131084,0.03884633080437827,0.018632099849674906,0.008679327705860357,0.008312296759905722,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0022310634863011883,0.005435824104029299,0.0032088754986770635,0.0032088754986770635,0.004826929185236577,0.004826929185236577,0.004826929185236577,0.004826929185236577,0.0013082544564071597,0.0014134183839005039,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0022310634863011883,0.0022310634863011883,0.0022310634863011883,0.0022310634863011883,0.0022310634863011883,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.0013082544564071597,0.005435824104029299,0.0013082544564071597,0.0013082544564071597,0.004826929185236577,0.004826929185236577,0.0032088754986770635,0.004903516411256446,0.004903516411256446,0.006553112087234363,0.005435824104029299,0.005435824104029299,0.006553112087234363,0.0032088754986770635,0.0013082544564071597,0.007957859403252946,0.0013082544564071597,0.0013082544564071597,0.0014134183839005039,0.0014134183839005039)
maxHPD=c(0.19765007276098462, 0.19338473359219066,0.190348940748844,0.19197363461236025,0.1879461991710028,0.1879461991710028,0.1879461991710028,0.18551334010113904,0.18551334010113904,0.181185382740949,0.1781916434536914,0.1783262749542399,0.1781916434536914,0.1783262749542399,0.1783262749542399,0.17912781841918443,0.17960548834703907,0.17996610423786452,0.17645435688571437,0.17645435688571437,0.18135940879712562,0.3484362688071512,0.8313593321158282,1.0706565147246248,1.0403425563111197,0.7342093946566687,0.6592794825271934,0.6426046429698307,0.6414288622126084,0.6414288622126084,0.6205202933305431,0.6196264724413181,0.6205202933305431,0.6166200187982479,0.5888138193587239,0.5660759416917808,0.5376821568362609,0.5197507135180618,0.4902031807515531,0.44996673955417876,0.435143765605084,0.3986448743101411,0.3809160841113947,0.2687773670328046,0.21418666703304798,0.1783262749542399,0.17625329368884732,0.16797817716636443,0.1639840916488679,0.16371985910293904,0.16371985910293904,0.16371985910293904,0.16153026445272986,0.15648041899629264,0.15657298771722628,0.1536889697748703,0.1536889697748703,0.15313085108529512,0.15313085108529512,0.15313085108529512,0.1536889697748703,0.1536889697748703,0.1536889697748703,0.1536889697748703,0.1536889697748703,0.1514295936503448,0.1514295936503448,0.1514295936503448,0.1514295936503448,0.1514295936503448,0.1514295936503448,0.1514295936503448,0.1514295936503448,0.1514295936503448,0.15313085108529512,0.15313085108529512,0.15313085108529512,0.15313085108529512,0.15313085108529512,0.15313085108529512,0.15313085108529512,0.16042830766248292,0.15657298771722628,0.15657298771722628,0.16042830766248292,0.16153026445272986,0.16042830766248292,0.1639840916488679,0.1639840916488679,0.16649399258881423,0.16649399258881423,0.16649399258881423,0.16869414900751759,0.16869414900751759,0.16797817716636443,0.1783262749542399,0.17801736050710978,0.1978896230506619,0.2839681662304355,0.4395014169411384)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.1777221661970874), xlim = c(-141.6620456379849,-65.99464911449763), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.37680768279807, -67.14112481939895,-67.90544195599983,-68.66975909260071,-69.4340762292016,-70.19839336580249,-70.96271050240337,-71.72702763900425,-72.49134477560513,-73.25566191220601,-74.01997904880689,-74.78429618540777,-75.54861332200865,-76.31293045860953,-77.07724759521042,-77.8415647318113,-78.60588186841218,-79.37019900501306,-80.13451614161394,-80.89883327821482,-81.6631504148157,-82.42746755141658,-83.19178468801746,-83.95610182461834,-84.72041896121922,-85.48473609782012,-86.249053234421,-87.01337037102188,-87.77768750762276,-88.54200464422364,-89.30632178082452,-90.0706389174254,-90.83495605402628,-91.59927319062717,-92.36359032722805,-93.12790746382893,-93.89222460042981,-94.6565417370307,-95.42085887363157,-96.18517601023245,-96.94949314683333,-97.71381028343421,-98.4781274200351,-99.24244455663597,-100.00676169323685,-100.77107882983773,-101.53539596643863,-102.29971310303951,-103.06403023964039,-103.82834737624127,-104.59266451284215,-105.35698164944304,-106.12129878604392,-106.8856159226448,-107.64993305924568,-108.41425019584656,-109.17856733244744,-109.94288446904832,-110.7072016056492,-111.47151874225008,-112.23583587885096,-113.00015301545184,-113.76447015205272,-114.5287872886536,-115.29310442525448,-116.05742156185536,-116.82173869845626,-117.58605583505714,-118.35037297165802,-119.1146901082589,-119.87900724485978,-120.64332438146067,-121.40764151806155,-122.17195865466243,-122.93627579126331,-123.7005929278642,-124.46491006446507,-125.22922720106595,-125.99354433766683,-126.75786147426771,-127.5221786108686,-128.28649574746947,-129.05081288407035,-129.81513002067123,-130.5794471572721,-131.343764293873,-132.10808143047387,-132.87239856707475,-133.63671570367563,-134.4010328402765,-135.1653499768774,-135.92966711347827,-136.69398425007915,-137.45830138668006,-138.22261852328094,-138.98693565988182,-139.7512527964827,-140.51556993308358,-141.27988706968446)
counts=c(0.004, 0.008,0.006,0.005,0.004,0.002,0.003,0.002,0.026,0.016,0.012,0.003,0.001,0.0,0.001,0.001,0.001,0.003,0.006,0.026,0.106,0.782,0.022,0.085,0.095,0.025,0.019,0.019,0.003,0.007,0.011,0.028,0.048,0.099,0.133,0.128,0.079,0.075,0.061,0.037,0.038,0.021,0.022,0.011,0.014,0.011,0.005,0.004,0.004,0.002,0.002,0.005,0.002,0.0,0.001,0.001,0.002,0.001,0.001,0.0,0.0,0.0,0.0,0.001,0.0,0.001,0.0,0.001,0.001,0.001,0.0,0.0,0.003,0.001,0.0,0.0,0.0,0.001,0.002,0.003,0.001,0.002,0.001,0.002,0.0,0.006,0.001,0.004,0.001,0.004,0.004,0.008,0.002,0.008,0.009,0.012,0.018,0.032,0.011)
plot(mids,counts,type = 'h', xlim = c(-141.6620456379849,-65.99464911449763), ylim=c(0,0.782), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03332448696358552
bf6 = 0.20301266724715702
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.37298609711507, -67.12966006234996,-67.88633402758481,-68.64300799281969,-69.39968195805457,-70.15635592328942,-70.9130298885243,-71.66970385375919,-72.42637781899404,-73.18305178422892,-73.9397257494638,-74.69639971469869,-75.45307367993354,-76.20974764516842,-76.9664216104033,-77.72309557563815,-78.47976954087304,-79.23644350610792,-79.99311747134277,-80.74979143657765,-81.50646540181253,-82.26313936704739,-83.01981333228227,-83.77648729751715,-84.533161262752,-85.28983522798688,-86.04650919322177,-86.80318315845665,-87.5598571236915,-88.31653108892638,-89.07320505416126,-89.82987901939612,-90.586552984631,-91.34322694986588,-92.09990091510073,-92.85657488033561,-93.6132488455705,-94.36992281080535,-95.12659677604023,-95.88327074127511,-96.63994470651,-97.39661867174485,-98.15329263697973,-98.90996660221461,-99.66664056744946,-100.42331453268434,-101.17998849791923,-101.93666246315408,-102.69333642838896,-103.45001039362384,-104.2066843588587,-104.96335832409358,-105.72003228932846,-106.47670625456331,-107.23338021979819,-107.99005418503307,-108.74672815026796,-109.50340211550281,-110.26007608073769,-111.01675004597257,-111.77342401120742,-112.5300979764423,-113.28677194167719,-114.04344590691204,-114.80011987214692,-115.5567938373818,-116.31346780261666,-117.07014176785154,-117.82681573308642,-118.5834896983213,-119.34016366355615,-120.09683762879104,-120.85351159402592,-121.61018555926077,-122.36685952449565,-123.12353348973053,-123.88020745496539,-124.63688142020027,-125.39355538543515,-126.15022935067,-126.90690331590488,-127.66357728113977,-128.42025124637462,-129.1769252116095,-129.93359917684438,-130.69027314207926,-131.44694710731412,-132.203621072549,-132.96029503778385,-133.71696900301873,-134.4736429682536,-135.2303169334885,-135.98699089872338,-136.74366486395823,-137.50033882919308,-138.25701279442796,-139.01368675966285,-139.77036072489773,-140.5270346901326,-141.28370865536746)
rate=c(2.3466577257612586, 0.33236829864285716,0.29674275088185004,0.29619184109558916,0.29619184109558916,0.2964897390416924,0.2971291434252715,0.29746434105683384,0.29748804329344214,0.2656575708836563,0.11451438951256036,0.08777523858213544,0.08578546078580176,0.08538035463547036,0.0848046370450066,0.0843698876698541,0.08433055883852209,0.08430596840910776,0.08430596840910776,0.08428751085332123,0.08428751085332123,0.08423986644683931,0.08423986644683931,0.08423986644683931,0.08406852021149863,0.083872297707442,0.083872297707442,0.08384249108709813,0.0837704538710978,0.08370282041022192,0.08364657088671236,0.0835774931478386,0.0834074003986415,0.08324977019444928,0.08311053946711418,0.08287069084072611,0.08254927291593156,0.08245437452013507,0.08223420825207886,0.08205133040811807,0.08199483404120478,0.0819078190570274,0.0819078190570274,0.08147145582268042,0.08137619522704077,0.0811311355347043,0.08089416671424803,0.08064970227835502,0.0805016649564368,0.08038558060693687,0.08014691799193821,0.08013445863604804,0.0801207115727949,0.08006906534199819,0.08000726824090432,0.07980189529318334,0.07963230655097238,0.07939260491938535,0.07927023606212813,0.07907116723212705,0.07891325441132224,0.07883925587124582,0.07857542973474264,0.07843451355248138,0.07812533584544404,0.07798884979054352,0.07798884979054352,0.07788416621999499,0.07788416621999499,0.07788416621999499,0.07795878626830996,0.07795878626830996,0.07788416621999499,0.07770680131303538,0.07767000426370102,0.07767000426370102,0.07762321793468066,0.07762321793468066,0.07762321793468066,0.07762321793468066,0.07762321793468066,0.07759452722438402,0.0775754400449091,0.0775754400449091,0.0775551399511446,0.0775754400449091,0.0775754400449091,0.0775754400449091,0.0775754400449091,0.0775551399511446,0.0775551399511446,0.0775551399511446,0.0775551399511446,0.0775551399511446,0.0775754400449091,0.0775754400449091,0.0775754400449091,0.0775754400449091,0.0775754400449091,0.0775754400449091)
minHPD=c(0.7134680059092291, 0.1770406667255401,0.17940607198037098,0.17940607198037098,0.1781487409882971,0.1781487409882971,0.17940607198037098,0.1781487409882971,0.1770406667255401,0.0671025085998388,0.057721382590486627,0.050300284658349424,0.050861575104952504,0.050300284658349424,0.05155281984766745,0.053823964383384305,0.053823964383384305,0.053823964383384305,0.053823964383384305,0.053823964383384305,0.053823964383384305,0.05397297140679822,0.05397297140679822,0.053823964383384305,0.053823964383384305,0.053823964383384305,0.053823964383384305,0.05155281984766745,0.05155281984766745,0.05155281984766745,0.05155281984766745,0.050300284658349424,0.05155281984766745,0.050861575104952504,0.050300284658349424,0.050300284658349424,0.04373711225010706,0.04237140746704598,0.03672319455091149,0.03672319455091149,0.03334611935051638,0.020755824242249327,0.01970413278300306,0.01970413278300306,0.020755824242249327,0.01734686717159365,0.01734686717159365,0.013820507346789593,0.013820507346789593,0.013820507346789593,0.012877402225819705,0.012877402225819705,0.012877402225819705,0.013820507346789593,0.014058788310575486,0.014058788310575486,0.014251293781951791,0.012877402225819705,0.008911605317867409,0.008911605317867409,0.008911605317867409,0.008911605317867409,0.008215652810155964,0.008215652810155964,0.007877005339360803,0.008215652810155964,0.008215652810155964,0.008215652810155964,0.008215652810155964,0.008215652810155964,0.008215652810155964,0.008215652810155964,0.008215652810155964,0.008911605317867409,0.008911605317867409,0.008911605317867409,0.008911605317867409,0.008911605317867409,0.008911605317867409,0.008911605317867409,0.008911605317867409,0.008911605317867409,0.008911605317867409,0.008911605317867409,0.008911605317867409,0.008911605317867409,0.008911605317867409,0.008911605317867409,0.008215652810155964,0.008215652810155964,0.008215652810155964,0.008215652810155964,0.008215652810155964,0.008215652810155964,0.008215652810155964,0.008215652810155964,0.007877005339360803,0.0008649958830099224,0.0008649958830099224,0.0008649958830099224)
maxHPD=c(5.355590763645427, 1.7683404033258412,0.42092640434054274,0.41306439967267644,0.40955983098550275,0.40955983098550275,0.41306439967267644,0.41358346266691365,0.41358346266691365,0.3878551720577547,0.34276481329971253,0.25453064656938934,0.14250329478012327,0.1228025143765214,0.1157302160380926,0.11523650837495746,0.11506575308973414,0.11506575308973414,0.11506575308973414,0.11506575308973414,0.11506575308973414,0.11506575308973414,0.11506575308973414,0.11506575308973414,0.11506575308973414,0.11702162598623692,0.11702162598623692,0.11556504420539954,0.11598174976589345,0.11702162598623692,0.11971262595305872,0.11971262595305872,0.12197922222895713,0.1228025143765214,0.1228025143765214,0.1253430696796357,0.1253430696796357,0.1253430696796357,0.12724698835508724,0.12924742673434028,0.12924742673434028,0.11690501141581866,0.11702162598623692,0.11702162598623692,0.11869877315065865,0.11702162598623692,0.11702162598623692,0.11556504420539954,0.11598174976589345,0.11598174976589345,0.11540877088787709,0.11540877088787709,0.11523650837495746,0.11556504420539954,0.11556504420539954,0.11556504420539954,0.11556504420539954,0.11556504420539954,0.11228018703617484,0.11237335059784291,0.1125701917843878,0.11274253915697115,0.11274253915697115,0.11274253915697115,0.11274253915697115,0.11363891751165997,0.11363891751165997,0.11383137374296398,0.11383137374296398,0.11383137374296398,0.11414624962432353,0.11414624962432353,0.11414624962432353,0.11506575308973414,0.11506575308973414,0.11523650837495746,0.11523650837495746,0.11523650837495746,0.11523650837495746,0.11523650837495746,0.11523650837495746,0.11523650837495746,0.11523650837495746,0.11523650837495746,0.11523650837495746,0.11540877088787709,0.11540877088787709,0.11556504420539954,0.11506575308973414,0.11506575308973414,0.11506575308973414,0.11506575308973414,0.11506575308973414,0.11506575308973414,0.11540877088787709,0.11556504420539954,0.11556504420539954,0.10908428903541753,0.10908428903541753,0.10908428903541753)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 5.89114984000997), xlim = c(-141.6620456379849,-65.99464911449763), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.37680768279807, -67.14112481939895,-67.90544195599983,-68.66975909260071,-69.4340762292016,-70.19839336580249,-70.96271050240337,-71.72702763900425,-72.49134477560513,-73.25566191220601,-74.01997904880689,-74.78429618540777,-75.54861332200865,-76.31293045860953,-77.07724759521042,-77.8415647318113,-78.60588186841218,-79.37019900501306,-80.13451614161394,-80.89883327821482,-81.6631504148157,-82.42746755141658,-83.19178468801746,-83.95610182461834,-84.72041896121922,-85.48473609782012,-86.249053234421,-87.01337037102188,-87.77768750762276,-88.54200464422364,-89.30632178082452,-90.0706389174254,-90.83495605402628,-91.59927319062717,-92.36359032722805,-93.12790746382893,-93.89222460042981,-94.6565417370307,-95.42085887363157,-96.18517601023245,-96.94949314683333,-97.71381028343421,-98.4781274200351,-99.24244455663597,-100.00676169323685,-100.77107882983773,-101.53539596643863,-102.29971310303951,-103.06403023964039,-103.82834737624127,-104.59266451284215,-105.35698164944304,-106.12129878604392,-106.8856159226448,-107.64993305924568,-108.41425019584656,-109.17856733244744,-109.94288446904832,-110.7072016056492,-111.47151874225008,-112.23583587885096,-113.00015301545184,-113.76447015205272,-114.5287872886536,-115.29310442525448,-116.05742156185536,-116.82173869845626,-117.58605583505714,-118.35037297165802,-119.1146901082589,-119.87900724485978,-120.64332438146067,-121.40764151806155,-122.17195865466243,-122.93627579126331,-123.7005929278642,-124.46491006446507,-125.22922720106595,-125.99354433766683,-126.75786147426771,-127.5221786108686,-128.28649574746947,-129.05081288407035,-129.81513002067123,-130.5794471572721,-131.343764293873,-132.10808143047387,-132.87239856707475,-133.63671570367563,-134.4010328402765,-135.1653499768774,-135.92966711347827,-136.69398425007915,-137.45830138668006,-138.22261852328094,-138.98693565988182,-139.7512527964827,-140.51556993308358,-141.27988706968446)
counts=c(0.764, 0.228,0.008,0.003,0.006,0.005,0.004,0.005,0.284,0.264,0.347,0.058,0.016,0.023,0.005,0.002,0.0,0.0,0.001,0.0,0.002,0.0,0.003,0.007,0.005,0.002,0.003,0.002,0.004,0.004,0.002,0.003,0.002,0.005,0.003,0.006,0.007,0.009,0.003,0.005,0.003,0.004,0.006,0.003,0.01,0.007,0.005,0.004,0.006,0.002,0.003,0.001,0.002,0.002,0.006,0.006,0.007,0.003,0.004,0.003,0.006,0.001,0.007,0.004,0.002,0.004,0.0,0.0,0.003,0.0,0.0,0.004,0.001,0.001,0.002,0.001,0.0,0.0,0.0,0.001,0.001,0.001,0.001,0.002,0.0,0.001,0.0,0.002,0.0,0.0,0.0,0.0,0.002,0.001,0.001,0.001,0.0,0.0,0.0)
plot(mids,counts,type = 'h', xlim = c(-141.6620456379849,-65.99464911449763), ylim=c(0,0.764), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.37298609711507, -67.12966006234996,-67.88633402758481,-68.64300799281969,-69.39968195805457,-70.15635592328942,-70.9130298885243,-71.66970385375919,-72.42637781899404,-73.18305178422892,-73.9397257494638,-74.69639971469869,-75.45307367993354,-76.20974764516842,-76.9664216104033,-77.72309557563815,-78.47976954087304,-79.23644350610792,-79.99311747134277,-80.74979143657765,-81.50646540181253,-82.26313936704739,-83.01981333228227,-83.77648729751715,-84.533161262752,-85.28983522798688,-86.04650919322177,-86.80318315845665,-87.5598571236915,-88.31653108892638,-89.07320505416126,-89.82987901939612,-90.586552984631,-91.34322694986588,-92.09990091510073,-92.85657488033561,-93.6132488455705,-94.36992281080535,-95.12659677604023,-95.88327074127511,-96.63994470651,-97.39661867174485,-98.15329263697973,-98.90996660221461,-99.66664056744946,-100.42331453268434,-101.17998849791923,-101.93666246315408,-102.69333642838896,-103.45001039362384,-104.2066843588587,-104.96335832409358,-105.72003228932846,-106.47670625456331,-107.23338021979819,-107.99005418503307,-108.74672815026796,-109.50340211550281,-110.26007608073769,-111.01675004597257,-111.77342401120742,-112.5300979764423,-113.28677194167719,-114.04344590691204,-114.80011987214692,-115.5567938373818,-116.31346780261666,-117.07014176785154,-117.82681573308642,-118.5834896983213,-119.34016366355615,-120.09683762879104,-120.85351159402592,-121.61018555926077,-122.36685952449565,-123.12353348973053,-123.88020745496539,-124.63688142020027,-125.39355538543515,-126.15022935067,-126.90690331590488,-127.66357728113977,-128.42025124637462,-129.1769252116095,-129.93359917684438,-130.69027314207926,-131.44694710731412,-132.203621072549,-132.96029503778385,-133.71696900301873,-134.4736429682536,-135.2303169334885,-135.98699089872338,-136.74366486395823,-137.50033882919308,-138.25701279442796,-139.01368675966285,-139.77036072489773,-140.5270346901326,-141.28370865536746)
net_rate=c(-2.5215482989300613, -0.44725826262864055,-0.1661281841711544,-0.1635874238640766,-0.16448114129638003,-0.16571918329917054,-0.16777807534994965,-0.1693549894479008,-0.17005594658359258,-0.1136148901851907,-0.04788679418766197,0.022190819052740274,0.03546567695366739,0.03787532045654692,0.04102923306044493,0.04222050098522617,0.04228895276841437,0.04245436092374209,0.042900255995878586,0.043259591408729356,0.046516195395798564,0.06414299939331686,0.30820665029761546,0.4540644176148288,0.4244414344587017,0.3357668359808001,0.30910311237332955,0.3003312140776083,0.29441149327195437,0.29108936326342455,0.2899759157756758,0.2870544769496321,0.2793746057471062,0.25821713553058123,0.23341396137546253,0.18679099832761292,0.1330186851343964,0.09594017467044882,0.06879006553583215,0.04606086937231196,0.03200698715975405,0.019689007349282906,0.010259669545717786,0.0005876309948716827,-0.002474805926562089,-0.0072085951210235375,-0.009750895131859134,-0.012236863466086182,-0.013887092959913822,-0.014539941332063792,-0.014238776395730186,-0.014160849700740939,-0.01485199903867037,-0.01478414252034877,-0.014817831627377525,-0.014541244936941498,-0.014293080287112049,-0.013551824862796982,-0.01325745312490322,-0.013083813588829221,-0.012880717183114657,-0.01281374217710155,-0.012423298378671118,-0.012019637446675651,-0.011655618817286939,-0.011727881002147814,-0.011696778901599774,-0.011511363028367742,-0.011511363028367742,-0.011479347467632574,-0.011555709134577737,-0.011549476611807748,-0.011477620386625122,-0.011315146687724379,-0.010916233439392858,-0.01100563822476879,-0.010930054840144737,-0.010913159501631794,-0.01086644073281416,-0.01086644073281416,-0.010815248754784903,-0.010541072744967916,-0.010236787883720923,-0.010092194443768004,-0.009962833752063246,-0.009410160709112143,-0.009250123152006169,-0.0082646468544602,-0.008334790500260343,-0.0074660368375728155,-0.007107246971843157,-0.00695473297277423,-0.006297706784821798,-0.004047497464452729,-0.0031097690110563807,-0.0004220636025174435,0.002439618549099403,0.0067136001744174,0.01482949637508645,0.046265830308322445)
net_minHPD=c(-5.238047453051075, -1.6983637839913768,-0.31389041147232677,-0.30429342616205846,-0.29570415399491606,-0.29570415399491606,-0.29570415399491606,-0.29570415399491606,-0.31645991536820406,-0.2655811839717055,-0.2275250571898968,-0.14458169336368618,-0.03370875553356348,-0.014824153391018335,-0.012326332309549215,-0.009354876803301534,-0.009354876803301534,-0.010055626096126091,-0.012655060320378761,-0.014447073882839057,-0.010859683182144919,-0.01876333876784353,-0.010859683182144919,0.05631606266086228,0.031696840820733665,-0.0258168552562357,-0.01398506056029801,-0.01398506056029801,-0.01398506056029801,-0.01398506056029801,-0.01398506056029801,-0.015642917500947442,-0.02699534194693811,-0.06850136103699016,-0.07044436125146819,-0.10203668785004202,-0.08770588981378159,-0.09689163624188192,-0.09732870220300642,-0.09732870220300642,-0.10022207991307687,-0.09757482737914845,-0.10022207991307687,-0.10022207991307687,-0.10203668785004202,-0.10203668785004202,-0.09757482737914845,-0.09549115608770085,-0.09164290570186587,-0.09143057983793933,-0.09143057983793933,-0.09164290570186587,-0.09983038892609696,-0.09757482737914845,-0.09757482737914845,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.08579775919025036,-0.08579775919025036,-0.08579775919025036,-0.08579775919025036,-0.08579775919025036,-0.08579775919025036,-0.08579775919025036,-0.08603836354506184,-0.08603836354506184,-0.08603836354506184,-0.08603836354506184,-0.08603836354506184,-0.08603836354506184,-0.09143057983793933,-0.09136875051453593,-0.09143057983793933,-0.09143057983793933,-0.09143057983793933,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09732870220300642,-0.09549115608770085,-0.10203668785004202,-0.10203668785004202,-0.10203668785004202)
net_maxHPD=c(-0.5842051868229622, -0.0353266528307139,-0.0353266528307139,-0.03594274706618389,-0.0353266528307139,-0.03594274706618389,-0.03370875553356348,-0.03301382219677232,-0.05361769878084882,0.07817859497128019,0.08880500382448163,0.10114024607353866,0.11408147842882223,0.11408147842882223,0.10114024607353866,0.0981796763255147,0.0981796763255147,0.0981796763255147,0.09758182006341756,0.0981796763255147,0.11408147842882223,0.2826522648350996,0.755903866761536,1.0288173709059585,0.9420365077791067,0.6626106625592755,0.5731359604752606,0.5566642172289616,0.5566642172289616,0.5562513265888507,0.5566642172289616,0.5566642172289616,0.5543614751260719,0.5223528209380672,0.5144617167533637,0.47695153999674744,0.47049180701064375,0.4454047077347718,0.41790423382744496,0.3813138729851913,0.36713002193607797,0.34119447277433623,0.31359650245869836,0.20374551077449432,0.1593243605793085,0.1137810836594816,0.10191906765433785,0.09772552738264144,0.09804786907568303,0.09772552738264144,0.09772552738264144,0.09668511893640594,0.0840641883017314,0.0840641883017314,0.08347455248056569,0.08299948781804979,0.08299948781804979,0.0811938406614532,0.0811938406614532,0.08211869251503387,0.0811938406614532,0.07884772037593778,0.0811938406614532,0.08211869251503387,0.08299948781804979,0.08211869251503387,0.08211869251503387,0.08211869251503387,0.08211869251503387,0.08211869251503387,0.08299948781804979,0.08299948781804979,0.08347455248056569,0.08347455248056569,0.09772552738264144,0.09772552738264144,0.09772552738264144,0.09772552738264144,0.09772552738264144,0.09772552738264144,0.09772552738264144,0.09772552738264144,0.09804786907568303,0.09804786907568303,0.09929321451448937,0.10022267700419425,0.10114024607353866,0.09929321451448937,0.10022267700419425,0.10022267700419425,0.10244803688127775,0.10244803688127775,0.09804786907568303,0.10244803688127775,0.10544600895401418,0.12217637556414473,0.13998101933354434,0.17903896742046588,0.2599771311889193,0.4071054985025565)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-5.761852198356182, 1.1316991079965544), xlim = c(-141.6620456379849,-65.99464911449763), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.37298609711507, -67.12966006234996,-67.88633402758481,-68.64300799281969,-69.39968195805457,-70.15635592328942,-70.9130298885243,-71.66970385375919,-72.42637781899404,-73.18305178422892,-73.9397257494638,-74.69639971469869,-75.45307367993354,-76.20974764516842,-76.9664216104033,-77.72309557563815,-78.47976954087304,-79.23644350610792,-79.99311747134277,-80.74979143657765,-81.50646540181253,-82.26313936704739,-83.01981333228227,-83.77648729751715,-84.533161262752,-85.28983522798688,-86.04650919322177,-86.80318315845665,-87.5598571236915,-88.31653108892638,-89.07320505416126,-89.82987901939612,-90.586552984631,-91.34322694986588,-92.09990091510073,-92.85657488033561,-93.6132488455705,-94.36992281080535,-95.12659677604023,-95.88327074127511,-96.63994470651,-97.39661867174485,-98.15329263697973,-98.90996660221461,-99.66664056744946,-100.42331453268434,-101.17998849791923,-101.93666246315408,-102.69333642838896,-103.45001039362384,-104.2066843588587,-104.96335832409358,-105.72003228932846,-106.47670625456331,-107.23338021979819,-107.99005418503307,-108.74672815026796,-109.50340211550281,-110.26007608073769,-111.01675004597257,-111.77342401120742,-112.5300979764423,-113.28677194167719,-114.04344590691204,-114.80011987214692,-115.5567938373818,-116.31346780261666,-117.07014176785154,-117.82681573308642,-118.5834896983213,-119.34016366355615,-120.09683762879104,-120.85351159402592,-121.61018555926077,-122.36685952449565,-123.12353348973053,-123.88020745496539,-124.63688142020027,-125.39355538543515,-126.15022935067,-126.90690331590488,-127.66357728113977,-128.42025124637462,-129.1769252116095,-129.93359917684438,-130.69027314207926,-131.44694710731412,-132.203621072549,-132.96029503778385,-133.71696900301873,-134.4736429682536,-135.2303169334885,-135.98699089872338,-136.74366486395823,-137.50033882919308,-138.25701279442796,-139.01368675966285,-139.77036072489773,-140.5270346901326,-141.28370865536746)
rate=c(0.37573824816746154, 1.7048968223616388,3.289923678129306,3.3350381853453768,3.334292478449475,3.324784692310085,3.3039381112146975,3.290201312235384,3.2843726974683096,4.085665119924608,5.637092184074524,9.412630484959713,10.790546218790277,11.088806109013163,11.490670778498249,11.658521633346028,11.674846369300463,11.681215973084267,11.681215973084267,11.6837334850821,11.6837334850821,11.695836587889628,11.695836587889628,11.70315562152188,11.734015568402553,11.821214738338506,11.821888333563251,11.854267054956189,11.86795417850871,11.869328191736692,11.91795394792088,11.949978852278393,11.970395239929971,12.004415785664314,12.032964078242165,12.082299419607944,12.138231724340704,12.169865075474265,12.25031206327485,12.269528300426884,12.305455310432903,12.358226039631884,12.355115197438824,12.418196034222012,12.449678164800055,12.525978466411084,12.596698508398317,12.663074041331623,12.723623275849388,12.742655606009183,12.797519709735228,12.821045227145266,12.84576994310211,12.868289656488354,12.883193467187999,12.964802296274147,13.006649964994423,13.14260944392438,13.193653218142165,13.21993766756227,13.279603630644841,13.291425044455323,13.360761443874761,13.433209664196596,13.499220020844842,13.521533885409312,13.527222733315575,13.56217130228916,13.56217130228916,13.566982040579754,13.55206194131906,13.55206194131906,13.565271803198314,13.595235701140014,13.614694278153726,13.60685193848412,13.620860338500188,13.623995615617412,13.623995615617412,13.623995615617412,13.623995615617412,13.635101283209064,13.646107443897966,13.646933227691449,13.653836613982918,13.626138919875805,13.626138919875805,13.620715191653904,13.596433625524249,13.602824923310433,13.602824923310433,13.602824923310433,13.602824923310433,13.602824923310433,13.592723297685884,13.57551907286127,13.549454652977023,13.533057360278272,13.533057360278272,13.533057360278272)
minHPD=c(0.37573824816746154, 1.7048968223616388,3.289923678129306,3.3350381853453768,3.334292478449475,3.324784692310085,3.3039381112146975,3.290201312235384,3.2843726974683096,4.085665119924608,5.637092184074524,9.412630484959713,10.790546218790277,11.088806109013163,11.490670778498249,11.658521633346028,11.674846369300463,11.681215973084267,11.681215973084267,11.6837334850821,11.6837334850821,11.695836587889628,11.695836587889628,11.70315562152188,11.734015568402553,11.821214738338506,11.821888333563251,11.854267054956189,11.86795417850871,11.869328191736692,11.91795394792088,11.949978852278393,11.970395239929971,12.004415785664314,12.032964078242165,12.082299419607944,12.138231724340704,12.169865075474265,12.25031206327485,12.269528300426884,12.305455310432903,12.358226039631884,12.355115197438824,12.418196034222012,12.449678164800055,12.525978466411084,12.596698508398317,12.663074041331623,12.723623275849388,12.742655606009183,12.797519709735228,12.821045227145266,12.84576994310211,12.868289656488354,12.883193467187999,12.964802296274147,13.006649964994423,13.14260944392438,13.193653218142165,13.21993766756227,13.279603630644841,13.291425044455323,13.360761443874761,13.433209664196596,13.499220020844842,13.521533885409312,13.527222733315575,13.56217130228916,13.56217130228916,13.566982040579754,13.55206194131906,13.55206194131906,13.565271803198314,13.595235701140014,13.614694278153726,13.60685193848412,13.620860338500188,13.623995615617412,13.623995615617412,13.623995615617412,13.623995615617412,13.635101283209064,13.646107443897966,13.646933227691449,13.653836613982918,13.626138919875805,13.626138919875805,13.620715191653904,13.596433625524249,13.602824923310433,13.602824923310433,13.602824923310433,13.602824923310433,13.602824923310433,13.592723297685884,13.57551907286127,13.549454652977023,13.533057360278272,13.533057360278272,13.533057360278272)
maxHPD=c(0.37573824816746154, 1.7048968223616388,3.289923678129306,3.3350381853453768,3.334292478449475,3.324784692310085,3.3039381112146975,3.290201312235384,3.2843726974683096,4.085665119924608,5.637092184074524,9.412630484959713,10.790546218790277,11.088806109013163,11.490670778498249,11.658521633346028,11.674846369300463,11.681215973084267,11.681215973084267,11.6837334850821,11.6837334850821,11.695836587889628,11.695836587889628,11.70315562152188,11.734015568402553,11.821214738338506,11.821888333563251,11.854267054956189,11.86795417850871,11.869328191736692,11.91795394792088,11.949978852278393,11.970395239929971,12.004415785664314,12.032964078242165,12.082299419607944,12.138231724340704,12.169865075474265,12.25031206327485,12.269528300426884,12.305455310432903,12.358226039631884,12.355115197438824,12.418196034222012,12.449678164800055,12.525978466411084,12.596698508398317,12.663074041331623,12.723623275849388,12.742655606009183,12.797519709735228,12.821045227145266,12.84576994310211,12.868289656488354,12.883193467187999,12.964802296274147,13.006649964994423,13.14260944392438,13.193653218142165,13.21993766756227,13.279603630644841,13.291425044455323,13.360761443874761,13.433209664196596,13.499220020844842,13.521533885409312,13.527222733315575,13.56217130228916,13.56217130228916,13.566982040579754,13.55206194131906,13.55206194131906,13.565271803198314,13.595235701140014,13.614694278153726,13.60685193848412,13.620860338500188,13.623995615617412,13.623995615617412,13.623995615617412,13.623995615617412,13.635101283209064,13.646107443897966,13.646933227691449,13.653836613982918,13.626138919875805,13.626138919875805,13.620715191653904,13.596433625524249,13.602824923310433,13.602824923310433,13.602824923310433,13.602824923310433,13.602824923310433,13.592723297685884,13.57551907286127,13.549454652977023,13.533057360278272,13.533057360278272,13.533057360278272)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 15.01922027538121), xlim = c(-141.6620456379849,-65.99464911449763), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()