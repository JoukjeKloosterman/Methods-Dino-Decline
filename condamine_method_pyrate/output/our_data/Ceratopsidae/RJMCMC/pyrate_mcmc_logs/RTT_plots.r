

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.15028530463664, -66.42192013245291,-66.69355496026917,-66.96518978808542,-67.2368246159017,-67.50845944371795,-67.78009427153421,-68.05172909935047,-68.32336392716674,-68.594998754983,-68.86663358279925,-69.13826841061552,-69.40990323843178,-69.68153806624804,-69.95317289406431,-70.22480772188057,-70.49644254969682,-70.7680773775131,-71.03971220532935,-71.31134703314561,-71.58298186096188,-71.85461668877814,-72.1262515165944,-72.39788634441065,-72.66952117222692,-72.94115600004318,-73.21279082785944,-73.48442565567571,-73.75606048349196,-74.02769531130822,-74.29933013912449,-74.57096496694075,-74.842599794757,-75.11423462257328,-75.38586945038954,-75.65750427820579,-75.92913910602205,-76.20077393383832,-76.47240876165458,-76.74404358947083,-77.0156784172871,-77.28731324510336,-77.55894807291962,-77.83058290073589,-78.10221772855215,-78.3738525563684,-78.64548738418468,-78.91712221200093,-79.18875703981719,-79.46039186763345,-79.73202669544972,-80.00366152326598,-80.27529635108223,-80.5469311788985,-80.81856600671476,-81.09020083453102,-81.36183566234729,-81.63347049016355,-81.9051053179798,-82.17674014579607,-82.44837497361233,-82.72000980142859,-82.99164462924485,-83.26327945706112,-83.53491428487737,-83.80654911269363,-84.0781839405099,-84.34981876832616,-84.62145359614242,-84.89308842395867,-85.16472325177494,-85.4363580795912,-85.70799290740747,-85.97962773522373,-86.25126256303999,-86.52289739085624,-86.79453221867252,-87.06616704648877,-87.33780187430504,-87.6094367021213,-87.88107152993756,-88.15270635775381,-88.42434118557007,-88.69597601338634,-88.9676108412026,-89.23924566901887,-89.51088049683513,-89.78251532465138,-90.05415015246764,-90.32578498028391,-90.59741980810017,-90.86905463591644,-91.1406894637327,-91.41232429154896,-91.68395911936521,-91.95559394718147,-92.22722877499774,-92.498863602814,-92.77049843063027,-93.04213325844653)
rate=c(0.11984969415384121, 0.11984969415384121,0.11985976308024573,0.11996848890627153,0.11985976308024573,0.11969615761244318,0.11951211266679607,0.11955015313817036,0.11955015313817036,0.11957607489161848,0.11951211266679607,0.11951211266679607,0.11951211266679607,0.11951211266679607,0.11951211266679607,0.11955015313817036,0.11955015313817036,0.11955015313817036,0.11955015313817036,0.11951211266679607,0.11945690839559671,0.11945690839559671,0.11939532269006885,0.11945690839559671,0.11945690839559671,0.11939532269006885,0.11939532269006885,0.11939532269006885,0.11939532269006885,0.11939532269006885,0.11939532269006885,0.11933144850584251,0.11933144850584251,0.11928566874325064,0.11925655244323644,0.11923320173864377,0.11919919245331176,0.11919919245331176,0.11919919245331176,0.11919919245331176,0.11919919245331176,0.11919919245331176,0.11923320173864377,0.11923320173864377,0.11928566874325064,0.11945690839559671,0.11957607489161848,0.1199701659303303,0.12045839781133871,0.12136911256284369,0.12264520969616668,0.12505101440548128,0.12724881522870132,0.12853845896111532,0.12917849321933772,0.12940086772808865,0.12966137776240833,0.1299987175063696,0.1310173205381927,0.13241479597222583,0.13557948557710525,0.14405500263330084,0.20635923529302927,0.2873477677299118,0.36056688785871693,0.4172971427407902,0.44849540080807787,0.460114022915161,0.4732896879617978,0.47714634541492146,0.4738244804576014,0.46738355294578215,0.4625422390445202,0.45993876021479985,0.4569327560208397,0.4511904212037866,0.44714528611694454,0.4464148715361098,0.4449266800931533,0.44351329189011823,0.44329549951504316,0.4438160990129315,0.44351329189011823,0.44329549951504316,0.44351329189011823,0.44231399961052165,0.44351329189011823,0.4438160990129315,0.44351329189011823,0.4438160990129315,0.44714217713665194,0.4494443981253261,0.4502311984060633,0.4502311984060633,0.45053033446544277,0.45287076883612964,0.45585038203845096,0.4574952173898932,0.460690938591177,0.46200298165128173)
minHPD=c(0.07438953675859827, 0.07323954788403102,0.07438953675859827,0.07595195197799201,0.07703866313304394,0.07703866313304394,0.07498670111089185,0.07538061616992014,0.07595195197799201,0.07595195197799201,0.07703866313304394,0.07703866313304394,0.07703866313304394,0.07703866313304394,0.07703866313304394,0.07705719424556148,0.07705719424556148,0.07705719424556148,0.07705719424556148,0.07703866313304394,0.07703866313304394,0.07703866313304394,0.07705719424556148,0.07705719424556148,0.07705719424556148,0.07705719424556148,0.07705719424556148,0.07705719424556148,0.07705719424556148,0.07705719424556148,0.07705719424556148,0.07703866313304394,0.07703866313304394,0.07703866313304394,0.07703866313304394,0.07703866313304394,0.07703866313304394,0.07703866313304394,0.07703866313304394,0.07703866313304394,0.07703866313304394,0.07703866313304394,0.07703866313304394,0.07573927853094334,0.07438953675859827,0.07703866313304394,0.07703866313304394,0.07438953675859827,0.07323954788403102,0.07049430308851175,0.07323954788403102,0.07703866313304394,0.07974742025224897,0.07703866313304394,0.07974742025224897,0.07703866313304394,0.07438953675859827,0.07899602784205469,0.07899602784205469,0.07899602784205469,0.07899602784205469,0.07438953675859827,0.07703866313304394,0.0832118088112338,0.0832118088112338,0.07974742025224897,0.09735268193439625,0.09903998354278908,0.10516519670916628,0.10032063263954716,0.11462731685693872,0.11462731685693872,0.06658099669409481,0.10764172754283675,0.07176030314073234,0.07880664663563801,0.0894259309753068,0.10032063263954716,0.07880664663563801,0.10764172754283675,0.08184043630242445,0.10764172754283675,0.1149589376169249,0.10032063263954716,0.10032063263954716,0.10032063263954716,0.1149589376169249,0.1149589376169249,0.1149589376169249,0.1149589376169249,0.10764172754283675,0.10764172754283675,0.12191881165269894,0.12734024168256658,0.12734024168256658,0.12191881165269894,0.13050807432533237,0.12102959921162808,0.1443283259943912,0.1443283259943912)
maxHPD=c(0.1689233303904533, 0.16541709509600325,0.16541709509600325,0.16541709509600325,0.1652300629383275,0.16421513972116558,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16086491581213894,0.16040738521738687,0.16040738521738687,0.16086491581213894,0.1616028813539456,0.16086491581213894,0.16086491581213894,0.1616028813539456,0.1616028813539456,0.1616028813539456,0.1616028813539456,0.1616028813539456,0.1616028813539456,0.16086491581213894,0.16086491581213894,0.16398574468939384,0.16491822647140533,0.16596901100714853,0.17881803867861426,0.2183791588789666,0.25269549883375103,0.30454872098463415,0.3212921704018002,0.32207558160963895,0.33558367199977285,0.33526990818442975,0.33929868553587883,0.3523443233026063,0.3601115125477955,0.37317980113473986,0.4490611476148556,0.531340481632587,0.6159679301933857,0.7048019419646695,0.8224414588411226,0.9715157255080029,1.119463364345985,1.1558252231157133,1.175367127346753,1.1558252231157133,1.1558252231157133,1.0852447797158826,0.9982168480321559,0.9982168480321559,0.9270592842834755,0.8956618645559938,0.8956618645559938,0.8956618645559938,0.8766293527851855,0.8956618645559938,0.8766293527851855,0.8956618645559938,0.8956618645559938,0.8766293527851855,0.8766293527851855,0.8766293527851855,0.8956618645559938,0.8941027923111742,0.8941027923111742,0.8956618645559938,0.8956618645559938,0.8956618645559938,0.9220112403657714,0.9220112403657714,0.9220112403657714,0.9220112403657714,0.9634251712660088,0.9634251712660088,1.0171224457517765,1.0171224457517765)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.2929038400814283), xlim = c(-93.17795067235465,-66.01446789072851), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.15165719770641, -66.42603581166225,-66.70041442561805,-66.97479303957388,-67.24917165352969,-67.52355026748552,-67.79792888144135,-68.07230749539715,-68.34668610935299,-68.62106472330879,-68.89544333726462,-69.16982195122043,-69.44420056517626,-69.71857917913206,-69.9929577930879,-70.26733640704373,-70.54171502099953,-70.81609363495537,-71.09047224891117,-71.364850862867,-71.6392294768228,-71.91360809077864,-72.18798670473444,-72.46236531869027,-72.7367439326461,-73.01112254660191,-73.28550116055774,-73.55987977451355,-73.83425838846938,-74.10863700242518,-74.38301561638102,-74.65739423033682,-74.93177284429265,-75.20615145824846,-75.48053007220429,-75.75490868616012,-76.02928730011593,-76.30366591407176,-76.57804452802756,-76.8524231419834,-77.1268017559392,-77.40118036989503,-77.67555898385083,-77.94993759780667,-78.2243162117625,-78.4986948257183,-78.77307343967414,-79.04745205362994,-79.32183066758577,-79.59620928154158,-79.87058789549741,-80.14496650945321,-80.41934512340904,-80.69372373736485,-80.96810235132068,-81.24248096527651,-81.51685957923232,-81.79123819318815,-82.06561680714395,-82.33999542109979,-82.61437403505559,-82.88875264901142,-83.16313126296723,-83.43750987692306,-83.71188849087886,-83.9862671048347,-84.26064571879053,-84.53502433274633,-84.80940294670216,-85.08378156065797,-85.3581601746138,-85.6325387885696,-85.90691740252544,-86.18129601648124,-86.45567463043707,-86.7300532443929,-87.00443185834871,-87.27881047230454,-87.55318908626035,-87.82756770021618,-88.10194631417198,-88.37632492812781,-88.65070354208362,-88.92508215603945,-89.19946076999528,-89.47383938395109,-89.74821799790692,-90.02259661186272,-90.29697522581856,-90.57135383977436,-90.8457324537302,-91.120111067686,-91.39448968164183,-91.66886829559763,-91.94324690955347,-92.2176255235093,-92.4920041374651,-92.76638275142093,-93.04076136537674)
counts=c(0.003, 0.001,0.004,0.002,0.003,0.004,0.002,0.003,0.001,0.002,0.001,0.002,0.0,0.0,0.001,0.0,0.0,0.0,0.002,0.002,0.001,0.001,0.0,0.001,0.0,0.0,0.0,0.001,0.0,0.0,0.001,0.0,0.005,0.002,0.001,0.001,0.001,0.0,0.0,0.0,0.001,0.001,0.003,0.003,0.004,0.007,0.011,0.022,0.028,0.03,0.06,0.03,0.021,0.007,0.011,0.007,0.014,0.02,0.039,0.073,0.11,0.111,0.123,0.112,0.08,0.033,0.027,0.024,0.019,0.018,0.015,0.019,0.015,0.015,0.008,0.008,0.009,0.008,0.013,0.005,0.006,0.004,0.006,0.002,0.009,0.002,0.005,0.006,0.007,0.008,0.005,0.006,0.006,0.005,0.01,0.011,0.008,0.005,0.004)
plot(mids,counts,type = 'h', xlim = c(-93.17795067235465,-66.01446789072851), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.028237562344640903
bf6 = 0.1767595073879041
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.15028530463664, -66.42192013245291,-66.69355496026917,-66.96518978808542,-67.2368246159017,-67.50845944371795,-67.78009427153421,-68.05172909935047,-68.32336392716674,-68.594998754983,-68.86663358279925,-69.13826841061552,-69.40990323843178,-69.68153806624804,-69.95317289406431,-70.22480772188057,-70.49644254969682,-70.7680773775131,-71.03971220532935,-71.31134703314561,-71.58298186096188,-71.85461668877814,-72.1262515165944,-72.39788634441065,-72.66952117222692,-72.94115600004318,-73.21279082785944,-73.48442565567571,-73.75606048349196,-74.02769531130822,-74.29933013912449,-74.57096496694075,-74.842599794757,-75.11423462257328,-75.38586945038954,-75.65750427820579,-75.92913910602205,-76.20077393383832,-76.47240876165458,-76.74404358947083,-77.0156784172871,-77.28731324510336,-77.55894807291962,-77.83058290073589,-78.10221772855215,-78.3738525563684,-78.64548738418468,-78.91712221200093,-79.18875703981719,-79.46039186763345,-79.73202669544972,-80.00366152326598,-80.27529635108223,-80.5469311788985,-80.81856600671476,-81.09020083453102,-81.36183566234729,-81.63347049016355,-81.9051053179798,-82.17674014579607,-82.44837497361233,-82.72000980142859,-82.99164462924485,-83.26327945706112,-83.53491428487737,-83.80654911269363,-84.0781839405099,-84.34981876832616,-84.62145359614242,-84.89308842395867,-85.16472325177494,-85.4363580795912,-85.70799290740747,-85.97962773522373,-86.25126256303999,-86.52289739085624,-86.79453221867252,-87.06616704648877,-87.33780187430504,-87.6094367021213,-87.88107152993756,-88.15270635775381,-88.42434118557007,-88.69597601338634,-88.9676108412026,-89.23924566901887,-89.51088049683513,-89.78251532465138,-90.05415015246764,-90.32578498028391,-90.59741980810017,-90.86905463591644,-91.1406894637327,-91.41232429154896,-91.68395911936521,-91.95559394718147,-92.22722877499774,-92.498863602814,-92.77049843063027,-93.04213325844653)
rate=c(2.0426622410124557, 1.3441651296533745,0.9615972068720231,0.223993983084949,0.15038290656665718,0.14151534612551342,0.13723541925232463,0.13681419148725532,0.13647563556383727,0.13647563556383727,0.13647563556383727,0.13637176112316982,0.1361196593884598,0.135920247313156,0.1361196593884598,0.1361196593884598,0.13647563556383727,0.13647563556383727,0.1369741648289866,0.13738655424047783,0.14278745965431283,0.17181250094891215,0.37637550548048726,0.48544495580237834,0.48432228910481334,0.3504207625155176,0.182366604086228,0.13649275143030606,0.12162512298514026,0.11539570378331375,0.10889703543218987,0.10383432013086713,0.10118670820242365,0.09955937646883498,0.09882853620585473,0.0984019689443495,0.0975941853378916,0.09741624674828694,0.09663029460199947,0.09610424447820837,0.09601282517796726,0.09594190806569601,0.09573963640572127,0.09555322042380701,0.09549749199015078,0.09546796594289311,0.09532668328459609,0.09527602820186704,0.09527602820186704,0.09526837010750078,0.09522767129529938,0.09518660088027897,0.095085199451131,0.09496461448454384,0.09476025255590667,0.09465764400421547,0.09451558372886787,0.0942957601871717,0.09414895613111832,0.09414895613111832,0.09402044151358038,0.09375347741190572,0.09375347741190572,0.0936875099727128,0.09361690271314718,0.09361690271314718,0.09359362979012453,0.09359362979012453,0.09359362979012453,0.0935802302018696,0.0935802302018696,0.0935802302018696,0.0935802302018696,0.0935802302018696,0.09350008735640634,0.09350008735640634,0.09359362979012453,0.09359362979012453,0.09359362979012453,0.0935802302018696,0.0935802302018696,0.09350008735640634,0.0935802302018696,0.0935802302018696,0.09359362979012453,0.0935802302018696,0.0935802302018696,0.0935802302018696,0.0935802302018696,0.0935802302018696,0.0935802302018696,0.0935802302018696,0.09359362979012453,0.09363993907437959,0.09387926241136842,0.09402044151358038,0.09410898723317396,0.09410898723317396,0.09410898723317396,0.09410898723317396)
minHPD=c(0.6187650924929798, 0.04732716113186862,0.04732716113186862,0.014159858298320352,0.019490630614394346,0.019490630614394346,0.022279546430132163,0.026938074790512165,0.030739732640056458,0.030739732640056458,0.030739732640056458,0.030739732640056458,0.030739732640056458,0.030739732640056458,0.030739732640056458,0.030739732640056458,0.030739732640056458,0.030739732640056458,0.02287188833050924,0.022279546430132163,0.019490630614394346,0.022279546430132163,0.04244748456612027,0.10156837836164881,0.10156837836164881,0.06703116746140354,0.054809658740871355,0.04872193833694395,0.052871032254481976,0.052871032254481976,0.04872193833694395,0.052871032254481976,0.052871032254481976,0.04872193833694395,0.050799845106593126,0.052871032254481976,0.052871032254481976,0.050799845106593126,0.052871032254481976,0.05636975538992203,0.055692014436891084,0.05636975538992203,0.056404698221391804,0.05636975538992203,0.05636975538992203,0.05636975538992203,0.05636975538992203,0.052871032254481976,0.052871032254481976,0.052871032254481976,0.052871032254481976,0.052871032254481976,0.052871032254481976,0.05076147442910168,0.050799845106593126,0.050799845106593126,0.04795431525545031,0.04795431525545031,0.04822172247732117,0.04822172247732117,0.04795431525545031,0.0477362126300889,0.0477362126300889,0.04822172247732117,0.0477362126300889,0.05053939120439787,0.05053939120439787,0.05053939120439787,0.05053939120439787,0.04872193833694395,0.04872193833694395,0.04795431525545031,0.04795431525545031,0.0477362126300889,0.0477362126300889,0.0477362126300889,0.0477362126300889,0.0477362126300889,0.0477362126300889,0.0477362126300889,0.0477362126300889,0.0477362126300889,0.05053939120439787,0.051445097536987054,0.051445097536987054,0.051445097536987054,0.050799845106593126,0.05076147442910168,0.05076147442910168,0.05076147442910168,0.05076147442910168,0.05053939120439787,0.05053939120439787,0.04795431525545031,0.041903215196264616,0.04306734996597848,0.04306734996597848,0.04306734996597848,0.04306734996597848,0.04306734996597848)
maxHPD=c(5.389839362100766, 2.9883191111709833,2.3654825600974285,1.8389253657974631,1.070216703021837,0.3427213702186552,0.2922651481627139,0.2922651481627139,0.2945416781811221,0.2945416781811221,0.2945416781811221,0.29327982675257314,0.29327982675257314,0.2922651481627139,0.2922651481627139,0.2922651481627139,0.29327982675257314,0.2945416781811221,0.2922651481627139,0.2945416781811221,0.4730713138074515,0.9192433092121506,1.1500867504381207,1.1527776894987705,1.1527776894987705,1.0907395211706965,0.7933857508299647,0.5787836404880786,0.47642177578214195,0.3791511671009987,0.3025145228593103,0.2673670049470113,0.23090638541185282,0.21126667343581762,0.18954679313079048,0.18237400594858677,0.17544802829279268,0.1706028759291245,0.16714787509223047,0.16812993224194248,0.16714787509223047,0.16714787509223047,0.16714787509223047,0.1669574564683001,0.1669574564683001,0.1657721531595794,0.1647376562390625,0.16101764667387222,0.16101764667387222,0.16101764667387222,0.16071277312410637,0.16101764667387222,0.16101764667387222,0.1578326547931502,0.15692085672186207,0.15692085672186207,0.15332393313695247,0.15332393313695247,0.15332393313695247,0.15332393313695247,0.15332393313695247,0.1542578039381219,0.1542578039381219,0.15692085672186207,0.1578326547931502,0.16101764667387222,0.16200565159975264,0.16200565159975264,0.16200565159975264,0.16101764667387222,0.16101764667387222,0.16071277312410637,0.16071277312410637,0.16071277312410637,0.16101764667387222,0.16101764667387222,0.16101764667387222,0.1617504745489364,0.1617504745489364,0.1617504745489364,0.1617504745489364,0.1617504745489364,0.16606031887039918,0.16714787509223047,0.16714787509223047,0.16714787509223047,0.16714787509223047,0.16714787509223047,0.16714787509223047,0.16714787509223047,0.16812993224194248,0.16850625399791966,0.16902139072680467,0.16812993224194248,0.16850625399791966,0.17333565342729393,0.17372694516776874,0.17372694516776874,0.17372694516776874,0.17372694516776874)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 5.928823298310843), xlim = c(-93.17795067235465,-66.01446789072851), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.15165719770641, -66.42603581166225,-66.70041442561805,-66.97479303957388,-67.24917165352969,-67.52355026748552,-67.79792888144135,-68.07230749539715,-68.34668610935299,-68.62106472330879,-68.89544333726462,-69.16982195122043,-69.44420056517626,-69.71857917913206,-69.9929577930879,-70.26733640704373,-70.54171502099953,-70.81609363495537,-71.09047224891117,-71.364850862867,-71.6392294768228,-71.91360809077864,-72.18798670473444,-72.46236531869027,-72.7367439326461,-73.01112254660191,-73.28550116055774,-73.55987977451355,-73.83425838846938,-74.10863700242518,-74.38301561638102,-74.65739423033682,-74.93177284429265,-75.20615145824846,-75.48053007220429,-75.75490868616012,-76.02928730011593,-76.30366591407176,-76.57804452802756,-76.8524231419834,-77.1268017559392,-77.40118036989503,-77.67555898385083,-77.94993759780667,-78.2243162117625,-78.4986948257183,-78.77307343967414,-79.04745205362994,-79.32183066758577,-79.59620928154158,-79.87058789549741,-80.14496650945321,-80.41934512340904,-80.69372373736485,-80.96810235132068,-81.24248096527651,-81.51685957923232,-81.79123819318815,-82.06561680714395,-82.33999542109979,-82.61437403505559,-82.88875264901142,-83.16313126296723,-83.43750987692306,-83.71188849087886,-83.9862671048347,-84.26064571879053,-84.53502433274633,-84.80940294670216,-85.08378156065797,-85.3581601746138,-85.6325387885696,-85.90691740252544,-86.18129601648124,-86.45567463043707,-86.7300532443929,-87.00443185834871,-87.27881047230454,-87.55318908626035,-87.82756770021618,-88.10194631417198,-88.37632492812781,-88.65070354208362,-88.92508215603945,-89.19946076999528,-89.47383938395109,-89.74821799790692,-90.02259661186272,-90.29697522581856,-90.57135383977436,-90.8457324537302,-91.120111067686,-91.39448968164183,-91.66886829559763,-91.94324690955347,-92.2176255235093,-92.4920041374651,-92.76638275142093,-93.04076136537674)
counts=c(0.31, 0.147,0.212,0.234,0.08,0.027,0.008,0.007,0.002,0.001,0.001,0.001,0.002,0.002,0.003,0.002,0.004,0.007,0.012,0.059,0.209,0.271,0.032,0.006,0.114,0.236,0.12,0.057,0.051,0.05,0.056,0.036,0.028,0.017,0.014,0.012,0.009,0.007,0.006,0.001,0.001,0.003,0.003,0.001,0.002,0.003,0.001,0.001,0.001,0.0,0.005,0.006,0.004,0.003,0.003,0.003,0.003,0.0,0.002,0.001,0.003,0.001,0.002,0.001,0.004,0.001,0.0,0.003,0.0,0.001,0.001,0.001,0.002,0.001,0.002,0.002,0.003,0.002,0.0,0.002,0.001,0.003,0.0,0.002,0.002,0.001,0.0,0.001,0.001,0.005,0.001,0.004,0.008,0.001,0.002,0.0,0.0,0.0,0.002)
plot(mids,counts,type = 'h', xlim = c(-93.17795067235465,-66.01446789072851), ylim=c(0,0.31), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.15028530463664, -66.42192013245291,-66.69355496026917,-66.96518978808542,-67.2368246159017,-67.50845944371795,-67.78009427153421,-68.05172909935047,-68.32336392716674,-68.594998754983,-68.86663358279925,-69.13826841061552,-69.40990323843178,-69.68153806624804,-69.95317289406431,-70.22480772188057,-70.49644254969682,-70.7680773775131,-71.03971220532935,-71.31134703314561,-71.58298186096188,-71.85461668877814,-72.1262515165944,-72.39788634441065,-72.66952117222692,-72.94115600004318,-73.21279082785944,-73.48442565567571,-73.75606048349196,-74.02769531130822,-74.29933013912449,-74.57096496694075,-74.842599794757,-75.11423462257328,-75.38586945038954,-75.65750427820579,-75.92913910602205,-76.20077393383832,-76.47240876165458,-76.74404358947083,-77.0156784172871,-77.28731324510336,-77.55894807291962,-77.83058290073589,-78.10221772855215,-78.3738525563684,-78.64548738418468,-78.91712221200093,-79.18875703981719,-79.46039186763345,-79.73202669544972,-80.00366152326598,-80.27529635108223,-80.5469311788985,-80.81856600671476,-81.09020083453102,-81.36183566234729,-81.63347049016355,-81.9051053179798,-82.17674014579607,-82.44837497361233,-82.72000980142859,-82.99164462924485,-83.26327945706112,-83.53491428487737,-83.80654911269363,-84.0781839405099,-84.34981876832616,-84.62145359614242,-84.89308842395867,-85.16472325177494,-85.4363580795912,-85.70799290740747,-85.97962773522373,-86.25126256303999,-86.52289739085624,-86.79453221867252,-87.06616704648877,-87.33780187430504,-87.6094367021213,-87.88107152993756,-88.15270635775381,-88.42434118557007,-88.69597601338634,-88.9676108412026,-89.23924566901887,-89.51088049683513,-89.78251532465138,-90.05415015246764,-90.32578498028391,-90.59741980810017,-90.86905463591644,-91.1406894637327,-91.41232429154896,-91.68395911936521,-91.95559394718147,-92.22722877499774,-92.498863602814,-92.77049843063027,-93.04213325844653)
net_rate=c(-2.305799238489609, -1.2005117979802977,-0.8416626021018886,-0.4741976852398844,-0.1397964449128509,-0.05372312718846951,-0.0317668872930989,-0.0275597181179672,-0.02660921163662152,-0.026291219201711614,-0.02646644993300927,-0.02618714423731335,-0.02605454372959303,-0.02564385179702628,-0.02583814401348389,-0.02570535632152612,-0.026246705784480476,-0.026572110018613287,-0.02957512370372966,-0.03083959776436322,-0.058500047149891564,-0.16495344345313462,-0.36395788696892745,-0.40514326012718466,-0.40487445857093723,-0.34045898168084204,-0.17218989883302735,-0.08604594711433595,-0.05344079979834525,-0.03539691909427936,-0.01979129138593183,-0.006361184337491439,0.0029182584693658946,0.007329419933716962,0.010041434608299375,0.011866265016717744,0.013184509442922274,0.014123468688741002,0.015498364464956615,0.0163073735240565,0.016446786376330996,0.016579945344238137,0.01684160089888294,0.017182798356856786,0.017608755961870583,0.018366453292189878,0.019304325210604063,0.020959483022617985,0.023631907014658636,0.027229407219832108,0.031486316508646923,0.0426620835057015,0.05023644921042626,0.05513798167652297,0.05886463759875011,0.06056862337244822,0.062329809017842866,0.0652978966188399,0.06873564630446136,0.07429150829563363,0.09435869979119996,0.12722018627601703,0.17087127489625523,0.2241480434023314,0.29964565689161093,0.36485020221000236,0.4094583719414179,0.4301864900373106,0.4462509175276716,0.44228749265544925,0.43811557102740617,0.42194123834654923,0.4086942427076242,0.401969186440152,0.39290307213323084,0.38470595286697007,0.3804425336587596,0.3782318651268932,0.3772811231776321,0.3762415600778822,0.37472861226590914,0.3748079554460307,0.37317494281381675,0.37220164220312735,0.3728737515320346,0.3724426111080871,0.37350840520178435,0.3734915487252233,0.37311857289476696,0.3745712460030388,0.3766712977990354,0.3765793173247592,0.3799467697627276,0.3792756379156598,0.37621838876624014,0.37752353843351155,0.38179992028690113,0.38550754462665004,0.3896027446715918,0.3920587605676368)
net_minHPD=c(-5.284638956920155, -2.8903434160553894,-2.2448302843213663,-1.7389528535861543,-0.9891875505905647,-0.232255627062772,-0.17980909515613316,-0.17170947382986113,-0.17170947382986113,-0.17170947382986113,-0.17170947382986113,-0.17170947382986113,-0.17170947382986113,-0.17980909515613316,-0.16800694761483304,-0.16800694761483304,-0.17980909515613316,-0.17170947382986113,-0.18862523914504115,-0.18402948721876436,-0.3444200952989064,-0.8053165682143155,-1.0413796678056098,-1.0244992168557332,-1.0244992168557332,-0.9781275758163194,-0.6722899950504433,-0.4698240856475478,-0.35902626947918526,-0.27027290515731683,-0.19853398075862844,-0.14621378353502934,-0.12161641782312807,-0.09541993635281874,-0.08330851137100628,-0.06379670483733965,-0.06140456645870726,-0.06140456645870726,-0.05595483500066546,-0.05959719189287235,-0.054497617219661676,-0.05959719189287235,-0.05595483500066546,-0.05595483500066546,-0.05959719189287235,-0.054497617219661676,-0.054497617219661676,-0.05595483500066546,-0.06379670483733965,-0.06379670483733965,-0.0680894629508242,-0.05595483500066546,-0.06245601316517646,-0.0680894629508242,-0.04703876003297426,-0.04964765911403213,-0.0523033199192775,-0.04964765911403213,-0.04655608104341069,-0.04703876003297426,-0.04964765911403213,-0.04964765911403213,-0.04655608104341069,-0.04616625423229029,-0.04109073894783273,-0.03984953067747725,-0.029840292109259536,9.526309420342105e-05,0.014737711536587025,0.014737711536587025,0.014493433520136462,-0.01940408339786863,0.006735295543263561,-0.0043930500844020365,0.009949345527372394,-0.0043930500844020365,0.006735295543263561,-0.0043930500844020365,-0.0043930500844020365,-0.0043930500844020365,9.526309420342105e-05,-0.0043930500844020365,-0.0043930500844020365,-0.0021951437861658096,-0.0021951437861658096,-0.0021951437861658096,-0.0021951437861658096,0.006735295543263561,0.006735295543263561,0.0007215589899045444,-0.031945348363852294,-0.031945348363852294,-0.0021951437861658096,-0.031945348363852294,-0.025980284798551342,-0.031945348363852294,-0.031945348363852294,-0.025980284798551342,-0.031945348363852294,-0.02109749614958112)
net_maxHPD=c(-0.5012502515798922, 0.09106475413412528,0.07691024884086038,0.0961472989379728,0.11618409580745498,0.11425395621523601,0.11383941538101516,0.11425395621523601,0.11383941538101516,0.11383941538101516,0.11425395621523601,0.11383941538101516,0.11383941538101516,0.1043086216942656,0.11425395621523601,0.11425395621523601,0.1043086216942656,0.11383941538101516,0.10394296421392074,0.11425395621523601,0.13371059503858176,0.11221476853974344,0.0704368372608391,0.040341154437432955,0.040341154437432955,0.07581598661830248,0.08341200585286201,0.08432134692589004,0.08341200585286201,0.08432134692589004,0.08432134692589004,0.08432134692589004,0.08001982639416766,0.08432134692589004,0.08650254203648539,0.08650254203648539,0.08432134692589004,0.08186667486846688,0.08341200585286201,0.07593306105446662,0.08062338075963298,0.07496024637849491,0.07650048386692831,0.07650048386692831,0.07496024637849491,0.08062338075963298,0.08112165295528236,0.08261113203258141,0.08839744712635748,0.12618277240582543,0.15005844930077672,0.21748689340007296,0.22595150251621207,0.23042039024380848,0.261970854344216,0.261970854344216,0.2641477774776785,0.2705101013300144,0.2795622868245722,0.2851528682653958,0.34801486138487664,0.44410960551048106,0.5190223122177187,0.6068631433568539,0.7261985357014539,0.8708070249442571,1.0162342062040455,1.084875718431006,1.110447698541156,1.084875718431006,1.0635379837969166,0.9506119132681595,0.9341995842185941,0.8814261575344854,0.8698627235605064,0.8129783256512021,0.8129783256512021,0.7892605561383255,0.7892605561383255,0.7808060008788368,0.7892605561383255,0.7808060008788368,0.7808060008788368,0.7766116151577597,0.7766116151577597,0.7766116151577597,0.7808060008788368,0.7892605561383255,0.7892605561383255,0.7892605561383255,0.7650739826441944,0.7766116151577597,0.8185684313679442,0.7892605561383255,0.8185684313679442,0.8185684313679442,0.8612139099792755,0.8814261575344854,0.9077272969371318,0.9244823073450468)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-5.813102852612171, 1.2214924683952717), xlim = c(-93.17795067235465,-66.01446789072851), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.15028530463664, -66.42192013245291,-66.69355496026917,-66.96518978808542,-67.2368246159017,-67.50845944371795,-67.78009427153421,-68.05172909935047,-68.32336392716674,-68.594998754983,-68.86663358279925,-69.13826841061552,-69.40990323843178,-69.68153806624804,-69.95317289406431,-70.22480772188057,-70.49644254969682,-70.7680773775131,-71.03971220532935,-71.31134703314561,-71.58298186096188,-71.85461668877814,-72.1262515165944,-72.39788634441065,-72.66952117222692,-72.94115600004318,-73.21279082785944,-73.48442565567571,-73.75606048349196,-74.02769531130822,-74.29933013912449,-74.57096496694075,-74.842599794757,-75.11423462257328,-75.38586945038954,-75.65750427820579,-75.92913910602205,-76.20077393383832,-76.47240876165458,-76.74404358947083,-77.0156784172871,-77.28731324510336,-77.55894807291962,-77.83058290073589,-78.10221772855215,-78.3738525563684,-78.64548738418468,-78.91712221200093,-79.18875703981719,-79.46039186763345,-79.73202669544972,-80.00366152326598,-80.27529635108223,-80.5469311788985,-80.81856600671476,-81.09020083453102,-81.36183566234729,-81.63347049016355,-81.9051053179798,-82.17674014579607,-82.44837497361233,-82.72000980142859,-82.99164462924485,-83.26327945706112,-83.53491428487737,-83.80654911269363,-84.0781839405099,-84.34981876832616,-84.62145359614242,-84.89308842395867,-85.16472325177494,-85.4363580795912,-85.70799290740747,-85.97962773522373,-86.25126256303999,-86.52289739085624,-86.79453221867252,-87.06616704648877,-87.33780187430504,-87.6094367021213,-87.88107152993756,-88.15270635775381,-88.42434118557007,-88.69597601338634,-88.9676108412026,-89.23924566901887,-89.51088049683513,-89.78251532465138,-90.05415015246764,-90.32578498028391,-90.59741980810017,-90.86905463591644,-91.1406894637327,-91.41232429154896,-91.68395911936521,-91.95559394718147,-92.22722877499774,-92.498863602814,-92.77049843063027,-93.04213325844653)
rate=c(0.4118329563353808, 0.7560972615879543,1.0375671598725096,1.676816279347416,3.823654697361835,5.710812405210554,6.557455931325504,6.743833047639658,6.796573973046782,6.808913973629071,6.808913973629071,6.822506873263367,6.831824015525273,6.851046510602628,6.8419391710829425,6.8455133288847145,6.820238785932126,6.805135912488522,6.668851815148565,6.616352952920728,5.59489137067509,3.506460417720025,2.0656636414525136,1.9036156922695964,1.9045902613178218,2.17147212062971,3.421751424158513,4.851918352952222,5.764423289110861,6.433598364636689,7.151623835761087,7.9216823172469235,8.550197023048629,8.902053791793632,9.138601699901523,9.300778557064493,9.420227586469933,9.508536104475317,9.634490165730053,9.710175055369762,9.723337763286743,9.73661114729807,9.75969073898296,9.778300218713351,9.788464549267571,9.8011421664082,9.837250399066546,9.847496915307685,9.847496915307685,9.852657162158959,9.861294333829353,9.874926732130122,9.905988066384474,9.962169787177592,10.011901057092782,10.029549098122866,10.061000684271898,10.110469167391162,10.123482763097389,10.123482763097389,10.13629983117711,10.163703283449117,10.167821638497667,10.182621570277721,10.216275959891266,10.222293157482758,10.243405280518436,10.243405280518436,10.243405280518436,10.252612261697028,10.253445773387366,10.244495956374609,10.244495956374609,10.214009383250719,10.224141920860879,10.224545090500666,10.21082508866881,10.205478636402436,10.175427580641427,10.180109970792968,10.183461767863399,10.188843278253811,10.10020718833783,10.075956333783537,10.06734434537382,10.069141880227761,10.061439406204958,10.057499450079987,10.057499450079987,10.055891124940372,9.999684903847763,9.89019105303576,9.848602285133127,9.737890941815369,9.272908092198607,9.214034057487668,9.144567707457144,9.144567707457144,9.144567707457144,9.144567707457144)
minHPD=c(0.4118329563353808, 0.7560972615879543,1.0375671598725096,1.676816279347416,3.823654697361835,5.710812405210554,6.557455931325504,6.743833047639658,6.796573973046782,6.808913973629071,6.808913973629071,6.822506873263367,6.831824015525273,6.851046510602628,6.8419391710829425,6.8455133288847145,6.820238785932126,6.805135912488522,6.668851815148565,6.616352952920728,5.59489137067509,3.506460417720025,2.0656636414525136,1.9036156922695964,1.9045902613178218,2.17147212062971,3.421751424158513,4.851918352952222,5.764423289110861,6.433598364636689,7.151623835761087,7.9216823172469235,8.550197023048629,8.902053791793632,9.138601699901523,9.300778557064493,9.420227586469933,9.508536104475317,9.634490165730053,9.710175055369762,9.723337763286743,9.73661114729807,9.75969073898296,9.778300218713351,9.788464549267571,9.8011421664082,9.837250399066546,9.847496915307685,9.847496915307685,9.852657162158959,9.861294333829353,9.874926732130122,9.905988066384474,9.962169787177592,10.011901057092782,10.029549098122866,10.061000684271898,10.110469167391162,10.123482763097389,10.123482763097389,10.13629983117711,10.163703283449117,10.167821638497667,10.182621570277721,10.216275959891266,10.222293157482758,10.243405280518436,10.243405280518436,10.243405280518436,10.252612261697028,10.253445773387366,10.244495956374609,10.244495956374609,10.214009383250719,10.224141920860879,10.224545090500666,10.21082508866881,10.205478636402436,10.175427580641427,10.180109970792968,10.183461767863399,10.188843278253811,10.10020718833783,10.075956333783537,10.06734434537382,10.069141880227761,10.061439406204958,10.057499450079987,10.057499450079987,10.055891124940372,9.999684903847763,9.89019105303576,9.848602285133127,9.737890941815369,9.272908092198607,9.214034057487668,9.144567707457144,9.144567707457144,9.144567707457144,9.144567707457144)
maxHPD=c(0.4118329563353808, 0.7560972615879543,1.0375671598725096,1.676816279347416,3.823654697361835,5.710812405210554,6.557455931325504,6.743833047639658,6.796573973046782,6.808913973629071,6.808913973629071,6.822506873263367,6.831824015525273,6.851046510602628,6.8419391710829425,6.8455133288847145,6.820238785932126,6.805135912488522,6.668851815148565,6.616352952920728,5.59489137067509,3.506460417720025,2.0656636414525136,1.9036156922695964,1.9045902613178218,2.17147212062971,3.421751424158513,4.851918352952222,5.764423289110861,6.433598364636689,7.151623835761087,7.9216823172469235,8.550197023048629,8.902053791793632,9.138601699901523,9.300778557064493,9.420227586469933,9.508536104475317,9.634490165730053,9.710175055369762,9.723337763286743,9.73661114729807,9.75969073898296,9.778300218713351,9.788464549267571,9.8011421664082,9.837250399066546,9.847496915307685,9.847496915307685,9.852657162158959,9.861294333829353,9.874926732130122,9.905988066384474,9.962169787177592,10.011901057092782,10.029549098122866,10.061000684271898,10.110469167391162,10.123482763097389,10.123482763097389,10.13629983117711,10.163703283449117,10.167821638497667,10.182621570277721,10.216275959891266,10.222293157482758,10.243405280518436,10.243405280518436,10.243405280518436,10.252612261697028,10.253445773387366,10.244495956374609,10.244495956374609,10.214009383250719,10.224141920860879,10.224545090500666,10.21082508866881,10.205478636402436,10.175427580641427,10.180109970792968,10.183461767863399,10.188843278253811,10.10020718833783,10.075956333783537,10.06734434537382,10.069141880227761,10.061439406204958,10.057499450079987,10.057499450079987,10.055891124940372,9.999684903847763,9.89019105303576,9.848602285133127,9.737890941815369,9.272908092198607,9.214034057487668,9.144567707457144,9.144567707457144,9.144567707457144,9.144567707457144)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 11.278790350726103), xlim = c(-93.17795067235465,-66.01446789072851), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()