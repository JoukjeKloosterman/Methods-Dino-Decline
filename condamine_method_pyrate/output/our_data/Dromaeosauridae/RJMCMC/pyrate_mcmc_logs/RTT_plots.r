

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-62.53042067076215, -63.37222322339396,-64.21402577602578,-65.05582832865758,-65.89763088128942,-66.73943343392122,-67.58123598655305,-68.42303853918486,-69.26484109181666,-70.1066436444485,-70.9484461970803,-71.79024874971213,-72.63205130234394,-73.47385385497574,-74.31565640760758,-75.15745896023938,-75.99926151287121,-76.84106406550302,-77.68286661813482,-78.52466917076666,-79.36647172339846,-80.2082742760303,-81.0500768286621,-81.8918793812939,-82.73368193392574,-83.57548448655754,-84.41728703918938,-85.25908959182118,-86.10089214445298,-86.94269469708482,-87.78449724971662,-88.62629980234846,-89.46810235498026,-90.30990490761207,-91.1517074602439,-91.9935100128757,-92.83531256550754,-93.67711511813934,-94.51891767077115,-95.36072022340298,-96.20252277603478,-97.04432532866662,-97.88612788129842,-98.72793043393023,-99.56973298656206,-100.41153553919386,-101.2533380918257,-102.0951406444575,-102.9369431970893,-103.77874574972114,-104.62054830235294,-105.46235085498478,-106.30415340761658,-107.14595596024839,-107.98775851288022,-108.82956106551202,-109.67136361814386,-110.51316617077566,-111.35496872340747,-112.1967712760393,-113.0385738286711,-113.88037638130294,-114.72217893393474,-115.56398148656655,-116.40578403919838,-117.24758659183018,-118.08938914446202,-118.93119169709382,-119.77299424972563,-120.61479680235746,-121.45659935498927,-122.2984019076211,-123.1402044602529,-123.98200701288471,-124.82380956551654,-125.66561211814835,-126.50741467078015,-127.34921722341198,-128.19101977604382,-129.03282232867562,-129.87462488130743,-130.71642743393923,-131.55822998657106,-132.4000325392029,-133.2418350918347,-134.0836376444665,-134.9254401970983,-135.76724274973014,-136.60904530236198,-137.45084785499378,-138.2926504076256,-139.1344529602574,-139.97625551288922,-140.81805806552106,-141.65986061815286,-142.50166317078467,-143.34346572341647,-144.1852682760483,-145.02707082868014,-145.86887338131194)
rate=c(0.0750582038773405, 0.07504742398192743,0.07504742398192743,0.07504742398192743,0.07503633684097201,0.07504886044520004,0.07504886044520004,0.07504886044520004,0.0750582038773405,0.0750582038773405,0.0750687410640305,0.0750687410640305,0.0750687410640305,0.07507203471904736,0.07507203471904736,0.07507203471904736,0.07507203471904736,0.07507203471904736,0.07508930724895113,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07512444297306983,0.07512444297306983,0.07512444297306983,0.07512444297306983,0.07512444297306983,0.07512444297306983,0.07512444297306983,0.07512444297306983,0.07512444297306983,0.07512444297306983,0.07512444297306983,0.07512444297306983,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07510996450426707,0.07508930724895113,0.07507203471904736,0.0750687410640305,0.0750687410640305,0.0750687410640305,0.0750687410640305,0.0750687410640305,0.0750582038773405,0.0750582038773405,0.0750582038773405,0.0750687410640305,0.0750687410640305,0.0750687410640305,0.07507203471904736,0.07508930724895113,0.07510996450426707,0.07508930724895113,0.07512444297306983,0.07518584859490976,0.07518584859490976,0.07518584859490976,0.07518584859490976,0.07520774689191617,0.07520774689191617,0.07520774689191617,0.07520774689191617,0.07518584859490976,0.07520774689191617,0.07520774689191617,0.07520774689191617,0.07520774689191617,0.07520774689191617,0.07520774689191617,0.07520774689191617,0.07520774689191617,0.0752307379334233,0.0752307379334233,0.0752307379334233,0.07526894966455316,0.07526894966455316,0.07533837330275699,0.07566910704402295,0.07591406070349849,0.07597574892120607,0.07602377426613013,0.0761213306357693,0.07691337149551704,0.07963961086731039,0.09373647566129112)
minHPD=c(0.05606300145069774, 0.05606300145069774,0.05606300145069774,0.0560834800025904,0.0560834800025904,0.05606300145069774,0.05645629725956646,0.05645629725956646,0.0566115858863811,0.0566518440340118,0.0566115858863811,0.0566115858863811,0.0566115858863811,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.0566115858863811,0.0566115858863811,0.0566115858863811,0.0566115858863811,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.05645629725956646,0.0566115858863811,0.0566115858863811,0.0566518440340118,0.0566518440340118,0.0566518440340118,0.0566518440340118,0.0566518440340118,0.0566518440340118,0.0566518440340118,0.0566518440340118,0.0566518440340118,0.0566518440340118,0.0566518440340118,0.0566518440340118,0.0566518440340118,0.0566518440340118,0.0566115858863811,0.0566115858863811,0.0566115858863811,0.05606300145069774,0.05606300145069774,0.05606300145069774,0.05606300145069774,0.058591768240380857,0.058591768240380857,0.058591768240380857,0.058591768240380857,0.058591768240380857,0.058591768240380857,0.0566518440340118,0.0566518440340118,0.0566115858863811,0.0566115858863811,0.0566115858863811,0.0566115858863811,0.0566115858863811,0.0566115858863811,0.0560834800025904,0.05606300145069774,0.05606300145069774,0.0566115858863811,0.05606300145069774,0.05606300145069774,0.05606300145069774,0.04672783328788392,0.048432936969236826,0.04672783328788392,0.048432936969236826,0.048432936969236826,0.05089931068562542,0.05437057632690466)
maxHPD=c(0.09447357966836427, 0.0940188922814538,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.0935988994883838,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.0935988994883838,0.0935988994883838,0.0935988994883838,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0935988994883838,0.0935988994883838,0.0935988994883838,0.0935988994883838,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0932401001655092,0.0935988994883838,0.0935988994883838,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.09374122863867985,0.0935988994883838,0.0940188922814538,0.0940188922814538,0.09447357966836427,0.09763665801019136,0.09763665801019136,0.09763665801019136,0.09763665801019136,0.09763665801019136,0.09763665801019136,0.09572817851890393,0.09572817851890393,0.09572817851890393,0.09572817851890393,0.0961950744996053,0.0961950744996053,0.0961950744996053,0.0961950744996053,0.09572817851890393,0.09572817851890393,0.0961950744996053,0.09713973031600756,0.0968528082752398,0.09918681460045395,0.10428096404678354,0.11134348160740257,0.12057390876051031,0.13471869703535302,0.17796068921442562,0.309663085169327,0.8532171423593929,1.3318919080467786)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.4650810988514567), xlim = c(-146.28977465762785,-62.10951939444624), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-62.53467219880574, -63.38497780752475,-64.23528341624376,-65.08558902496276,-65.93589463368177,-66.78620024240078,-67.63650585111978,-68.48681145983879,-69.3371170685578,-70.1874226772768,-71.03772828599581,-71.88803389471481,-72.73833950343382,-73.58864511215282,-74.43895072087183,-75.28925632959084,-76.13956193830984,-76.98986754702885,-77.84017315574786,-78.69047876446686,-79.54078437318587,-80.39108998190488,-81.24139559062388,-82.09170119934288,-82.94200680806189,-83.7923124167809,-84.6426180254999,-85.49292363421891,-86.34322924293792,-87.19353485165692,-88.04384046037593,-88.89414606909494,-89.74445167781394,-90.59475728653295,-91.44506289525195,-92.29536850397096,-93.14567411268996,-93.99597972140897,-94.84628533012798,-95.69659093884698,-96.54689654756599,-97.397202156285,-98.247507765004,-99.09781337372301,-99.94811898244203,-100.79842459116102,-101.64873019988002,-102.49903580859903,-103.34934141731804,-104.19964702603704,-105.04995263475605,-105.90025824347507,-106.75056385219406,-107.60086946091307,-108.45117506963209,-109.30148067835108,-110.15178628707008,-111.0020918957891,-111.8523975045081,-112.7027031132271,-113.55300872194611,-114.40331433066513,-115.25361993938412,-116.10392554810313,-116.95423115682215,-117.80453676554114,-118.65484237426016,-119.50514798297917,-120.35545359169816,-121.20575920041716,-122.05606480913619,-122.90637041785519,-123.75667602657418,-124.6069816352932,-125.4572872440122,-126.3075928527312,-127.15789846145022,-128.00820407016923,-128.85850967888823,-129.70881528760722,-130.55912089632622,-131.40942650504525,-132.25973211376427,-133.11003772248327,-133.96034333120227,-134.81064893992126,-135.66095454864026,-136.5112601573593,-137.3615657660783,-138.2118713747973,-139.0621769835163,-139.9124825922353,-140.7627882009543,-141.6130938096733,-142.46339941839233,-143.31370502711133,-144.16401063583035,-145.01431624454935,-145.86462185326835)
counts=c(0.002, 0.001,0.001,0.001,0.002,0.001,0.0,0.001,0.001,0.002,0.0,0.0,0.001,0.0,0.001,0.0,0.0,0.002,0.001,0.0,0.001,0.0,0.001,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.001,0.0,0.001,0.001,0.002,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.001,0.0,0.0,0.001,0.0,0.001,0.002,0.001,0.006,0.0,0.002,0.0,0.002,0.0,0.0,0.0,0.001,0.001,0.0,0.0,0.001,0.001,0.001,0.0,0.0,0.001,0.001,0.001,0.002,0.001,0.009,0.011,0.016,0.005,0.007,0.013,0.039,0.147,0.217,0.212)
plot(mids,counts,type = 'h', xlim = c(-146.28977465762785,-62.10951939444624), ylim=c(0,0.217), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.033543474951747955
bf6 = 0.20411129351439913
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-62.53042067076215, -63.37222322339396,-64.21402577602578,-65.05582832865758,-65.89763088128942,-66.73943343392122,-67.58123598655305,-68.42303853918486,-69.26484109181666,-70.1066436444485,-70.9484461970803,-71.79024874971213,-72.63205130234394,-73.47385385497574,-74.31565640760758,-75.15745896023938,-75.99926151287121,-76.84106406550302,-77.68286661813482,-78.52466917076666,-79.36647172339846,-80.2082742760303,-81.0500768286621,-81.8918793812939,-82.73368193392574,-83.57548448655754,-84.41728703918938,-85.25908959182118,-86.10089214445298,-86.94269469708482,-87.78449724971662,-88.62629980234846,-89.46810235498026,-90.30990490761207,-91.1517074602439,-91.9935100128757,-92.83531256550754,-93.67711511813934,-94.51891767077115,-95.36072022340298,-96.20252277603478,-97.04432532866662,-97.88612788129842,-98.72793043393023,-99.56973298656206,-100.41153553919386,-101.2533380918257,-102.0951406444575,-102.9369431970893,-103.77874574972114,-104.62054830235294,-105.46235085498478,-106.30415340761658,-107.14595596024839,-107.98775851288022,-108.82956106551202,-109.67136361814386,-110.51316617077566,-111.35496872340747,-112.1967712760393,-113.0385738286711,-113.88037638130294,-114.72217893393474,-115.56398148656655,-116.40578403919838,-117.24758659183018,-118.08938914446202,-118.93119169709382,-119.77299424972563,-120.61479680235746,-121.45659935498927,-122.2984019076211,-123.1402044602529,-123.98200701288471,-124.82380956551654,-125.66561211814835,-126.50741467078015,-127.34921722341198,-128.19101977604382,-129.03282232867562,-129.87462488130743,-130.71642743393923,-131.55822998657106,-132.4000325392029,-133.2418350918347,-134.0836376444665,-134.9254401970983,-135.76724274973014,-136.60904530236198,-137.45084785499378,-138.2926504076256,-139.1344529602574,-139.97625551288922,-140.81805806552106,-141.65986061815286,-142.50166317078467,-143.34346572341647,-144.1852682760483,-145.02707082868014,-145.86887338131194)
rate=c(0.7740221590895466, 0.7561014348798374,0.7173532086751393,0.6901118005954769,0.6147902059646919,0.06860972771636673,0.061078593938491015,0.06049295477173774,0.06034143348260655,0.06034143348260655,0.06034143348260655,0.06034143348260655,0.06033354476541533,0.060288048043572476,0.06027316117399449,0.06027316117399449,0.06027316117399449,0.06027316117399449,0.06027316117399449,0.06026255235205747,0.0602496289942243,0.060233444626988805,0.060233444626988805,0.060233444626988805,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.0602496289942243,0.06026255235205747,0.06027316117399449,0.06027316117399449,0.06027316117399449,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.060288048043572476,0.06031215303190637,0.06031215303190637,0.06031215303190637,0.06031215303190637,0.06031215303190637,0.060288048043572476,0.060288048043572476,0.06027316117399449,0.06026255235205747,0.060233444626988805,0.06021209260113275,0.06017838111036007,0.06017838111036007,0.06021209260113275)
minHPD=c(0.20909188011581561, 0.04269642389755293,0.04269642389755293,0.04269642389755293,0.04017798653977373,0.03997058093258937,0.03968987043877184,0.04352374104115373,0.042519458044350804,0.042519458044350804,0.042519458044350804,0.042519458044350804,0.042519458044350804,0.043052856239973035,0.043052856239973035,0.043052856239973035,0.043052856239973035,0.043052856239973035,0.043052856239973035,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.043052856239973035,0.043052856239973035,0.043052856239973035,0.043052856239973035,0.04352374104115373,0.04352374104115373,0.043052856239973035,0.043052856239973035,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.04352374104115373,0.043052856239973035,0.043052856239973035,0.0426150379995315,0.0426150379995315,0.042519458044350804)
maxHPD=c(1.6291646508828275, 1.5360187975248574,1.469869104991063,1.4091649589519346,1.281967052437521,0.9983229264511724,0.13517485620523803,0.08006749760561319,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07676615394411071,0.07689485072119774,0.07676615394411071,0.07676615394411071,0.07676615394411071,0.07676615394411071,0.07676615394411071,0.0770825852358934,0.0770825852358934,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.07689485072119774,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.07676615394411071,0.07676615394411071,0.07676615394411071,0.07676615394411071,0.0770825852358934,0.0770825852358934,0.07676615394411071,0.07676615394411071,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.0770825852358934,0.07689485072119774,0.0770825852358934,0.07689485072119774,0.0770825852358934,0.07676615394411071,0.07676615394411071,0.07676615394411071)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.7920811159711103), xlim = c(-146.28977465762785,-62.10951939444624), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-62.53467219880574, -63.38497780752475,-64.23528341624376,-65.08558902496276,-65.93589463368177,-66.78620024240078,-67.63650585111978,-68.48681145983879,-69.3371170685578,-70.1874226772768,-71.03772828599581,-71.88803389471481,-72.73833950343382,-73.58864511215282,-74.43895072087183,-75.28925632959084,-76.13956193830984,-76.98986754702885,-77.84017315574786,-78.69047876446686,-79.54078437318587,-80.39108998190488,-81.24139559062388,-82.09170119934288,-82.94200680806189,-83.7923124167809,-84.6426180254999,-85.49292363421891,-86.34322924293792,-87.19353485165692,-88.04384046037593,-88.89414606909494,-89.74445167781394,-90.59475728653295,-91.44506289525195,-92.29536850397096,-93.14567411268996,-93.99597972140897,-94.84628533012798,-95.69659093884698,-96.54689654756599,-97.397202156285,-98.247507765004,-99.09781337372301,-99.94811898244203,-100.79842459116102,-101.64873019988002,-102.49903580859903,-103.34934141731804,-104.19964702603704,-105.04995263475605,-105.90025824347507,-106.75056385219406,-107.60086946091307,-108.45117506963209,-109.30148067835108,-110.15178628707008,-111.0020918957891,-111.8523975045081,-112.7027031132271,-113.55300872194611,-114.40331433066513,-115.25361993938412,-116.10392554810313,-116.95423115682215,-117.80453676554114,-118.65484237426016,-119.50514798297917,-120.35545359169816,-121.20575920041716,-122.05606480913619,-122.90637041785519,-123.75667602657418,-124.6069816352932,-125.4572872440122,-126.3075928527312,-127.15789846145022,-128.00820407016923,-128.85850967888823,-129.70881528760722,-130.55912089632622,-131.40942650504525,-132.25973211376427,-133.11003772248327,-133.96034333120227,-134.81064893992126,-135.66095454864026,-136.5112601573593,-137.3615657660783,-138.2118713747973,-139.0621769835163,-139.9124825922353,-140.7627882009543,-141.6130938096733,-142.46339941839233,-143.31370502711133,-144.16401063583035,-145.01431624454935,-145.86462185326835)
counts=c(0.034, 0.055,0.071,0.116,0.401,0.299,0.04,0.006,0.0,0.0,0.0,0.001,0.003,0.001,0.0,0.0,0.0,0.001,0.001,0.002,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.002,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.001,0.0,0.0,0.0,0.002,0.0,0.001,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.001,0.0,0.001,0.001,0.003,0.001,0.001,0.003,0.001,0.0)
plot(mids,counts,type = 'h', xlim = c(-146.28977465762785,-62.10951939444624), ylim=c(0,0.401), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-62.53042067076215, -63.37222322339396,-64.21402577602578,-65.05582832865758,-65.89763088128942,-66.73943343392122,-67.58123598655305,-68.42303853918486,-69.26484109181666,-70.1066436444485,-70.9484461970803,-71.79024874971213,-72.63205130234394,-73.47385385497574,-74.31565640760758,-75.15745896023938,-75.99926151287121,-76.84106406550302,-77.68286661813482,-78.52466917076666,-79.36647172339846,-80.2082742760303,-81.0500768286621,-81.8918793812939,-82.73368193392574,-83.57548448655754,-84.41728703918938,-85.25908959182118,-86.10089214445298,-86.94269469708482,-87.78449724971662,-88.62629980234846,-89.46810235498026,-90.30990490761207,-91.1517074602439,-91.9935100128757,-92.83531256550754,-93.67711511813934,-94.51891767077115,-95.36072022340298,-96.20252277603478,-97.04432532866662,-97.88612788129842,-98.72793043393023,-99.56973298656206,-100.41153553919386,-101.2533380918257,-102.0951406444575,-102.9369431970893,-103.77874574972114,-104.62054830235294,-105.46235085498478,-106.30415340761658,-107.14595596024839,-107.98775851288022,-108.82956106551202,-109.67136361814386,-110.51316617077566,-111.35496872340747,-112.1967712760393,-113.0385738286711,-113.88037638130294,-114.72217893393474,-115.56398148656655,-116.40578403919838,-117.24758659183018,-118.08938914446202,-118.93119169709382,-119.77299424972563,-120.61479680235746,-121.45659935498927,-122.2984019076211,-123.1402044602529,-123.98200701288471,-124.82380956551654,-125.66561211814835,-126.50741467078015,-127.34921722341198,-128.19101977604382,-129.03282232867562,-129.87462488130743,-130.71642743393923,-131.55822998657106,-132.4000325392029,-133.2418350918347,-134.0836376444665,-134.9254401970983,-135.76724274973014,-136.60904530236198,-137.45084785499378,-138.2926504076256,-139.1344529602574,-139.97625551288922,-140.81805806552106,-141.65986061815286,-142.50166317078467,-143.34346572341647,-144.1852682760483,-145.02707082868014,-145.86887338131194)
net_rate=c(-0.7739525352685818, -0.734860501344744,-0.6793293127596086,-0.6151854039903687,-0.5243192880524314,-0.2147551119129148,-0.0019452747343579836,0.012040351551556836,0.014233665072675138,0.014271316657671626,0.014323503449281539,0.014323503449281539,0.014393119666285585,0.014636396127926254,0.014669568599041262,0.014669568599041262,0.01467622376352226,0.01467622376352226,0.014707345541784355,0.014810731613704121,0.01482191262237329,0.014869043432342013,0.014869043432342013,0.014883151213931476,0.014876392316873177,0.014876392316873177,0.014876392316873177,0.014900625151688733,0.014900625151688733,0.014900625151688733,0.014900625151688733,0.014900625151688733,0.014900625151688733,0.014900625151688733,0.014900625151688733,0.014900625151688733,0.014900625151688733,0.014900625151688733,0.014900625151688733,0.014887297028906007,0.014920275958004835,0.014920275958004835,0.014920275958004835,0.014920275958004835,0.014926581863702255,0.014926581863702255,0.014926581863702255,0.014926581863702255,0.014926581863702255,0.01494573385585854,0.01494573385585854,0.014891229044230014,0.01488308049636077,0.014832733362058361,0.014832733362058361,0.014799665598847588,0.014799665598847588,0.014799665598847588,0.01478883645615843,0.014755133982243783,0.014741071528599718,0.014704212518865696,0.014704212518865696,0.014663019438377268,0.014682862592202668,0.014737459141691518,0.014756102157813365,0.01475326441965809,0.01497808738428621,0.015165099108168004,0.015165099108168004,0.015203222760846674,0.015237503420978125,0.015240323263761396,0.015240323263761396,0.015240323263761396,0.015240323263761396,0.01522927556418582,0.015278876463294592,0.015278876463294592,0.015353952917800447,0.015353952917800447,0.015408942208954864,0.01542592929459507,0.01542592929459507,0.01542592929459507,0.015459390294687495,0.015529901314450133,0.015580162349248663,0.01598066703058196,0.016092296467638992,0.01713943813712723,0.01911020993482162,0.02197716248345532,0.022565689132944322,0.02409952300324615,0.02741108176905074,0.04619061001187554,0.1426251180787659,0.33397142473768476)
net_minHPD=c(-1.551420562849853, -1.4743645272233452,-1.3998143256466913,-1.3347178772304025,-1.225165508115401,-0.9239717398662997,-0.05516279427217825,-0.009987317694929373,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.007608283993919732,-0.008392311645647715,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.008392311645647715,-0.008392311645647715,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.00814901495549572,-0.009639508134367002,-0.009723991380904268,-0.010733910056499263,-0.010939263960353843,-0.010999052003250728,-0.012818007132284717,-0.01721731934576201,-0.02332141871540873,-0.024449530690915017,-0.02332141871540873,-0.024449530690915017,-0.022776045409926962,-0.016219659282345728)
net_maxHPD=c(-0.12639725528987036, 0.03594077714118776,0.04098230946278091,0.04657667318355114,0.04203504049567966,0.049400132566943644,0.049400132566943644,0.04098230946278091,0.040762165821272005,0.040658070641854706,0.04052967870503854,0.04052967870503854,0.04098230946278091,0.03905123476501687,0.03905123476501687,0.03905123476501687,0.03905123476501687,0.03905123476501687,0.03905123476501687,0.03905123476501687,0.03905123476501687,0.03899781227457735,0.03899781227457735,0.03899781227457735,0.03899781227457735,0.03899781227457735,0.03899781227457735,0.03884837631525181,0.03884837631525181,0.03884837631525181,0.03884837631525181,0.03884837631525181,0.03884837631525181,0.03884837631525181,0.03884837631525181,0.03884837631525181,0.03884837631525181,0.03884837631525181,0.03884837631525181,0.03884837631525181,0.03899781227457735,0.03899781227457735,0.03899781227457735,0.03899781227457735,0.03899781227457735,0.03899781227457735,0.03899781227457735,0.03899781227457735,0.03899781227457735,0.03905123476501687,0.03905123476501687,0.03930818769978797,0.03930818769978797,0.03983348786537722,0.03983348786537722,0.039856262944562924,0.039856262944562924,0.039856262944562924,0.039856262944562924,0.039856262944562924,0.039856262944562924,0.04032753491912585,0.04032753491912585,0.039856262944562924,0.039856262944562924,0.04032753491912585,0.04032753491912585,0.04032753491912585,0.04052967870503854,0.040762165821272005,0.040762165821272005,0.04092568340815279,0.04098230946278091,0.04098230946278091,0.04098230946278091,0.04098230946278091,0.04098230946278091,0.04098230946278091,0.04092568340815279,0.04092568340815279,0.04098230946278091,0.04098230946278091,0.04146739699944645,0.04193468801479599,0.04193468801479599,0.04193468801479599,0.04203504049567966,0.04098230946278091,0.04098230946278091,0.04098230946278091,0.04098230946278091,0.043385183222046625,0.047302612435125256,0.061687472053951614,0.061687472053951614,0.08186197032557943,0.11691028206295016,0.25054329812316456,0.7887634345839544,1.2742084683378048)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-1.7065626191348384, 1.4016293151715853), xlim = c(-146.28977465762785,-62.10951939444624), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-62.53042067076215, -63.37222322339396,-64.21402577602578,-65.05582832865758,-65.89763088128942,-66.73943343392122,-67.58123598655305,-68.42303853918486,-69.26484109181666,-70.1066436444485,-70.9484461970803,-71.79024874971213,-72.63205130234394,-73.47385385497574,-74.31565640760758,-75.15745896023938,-75.99926151287121,-76.84106406550302,-77.68286661813482,-78.52466917076666,-79.36647172339846,-80.2082742760303,-81.0500768286621,-81.8918793812939,-82.73368193392574,-83.57548448655754,-84.41728703918938,-85.25908959182118,-86.10089214445298,-86.94269469708482,-87.78449724971662,-88.62629980234846,-89.46810235498026,-90.30990490761207,-91.1517074602439,-91.9935100128757,-92.83531256550754,-93.67711511813934,-94.51891767077115,-95.36072022340298,-96.20252277603478,-97.04432532866662,-97.88612788129842,-98.72793043393023,-99.56973298656206,-100.41153553919386,-101.2533380918257,-102.0951406444575,-102.9369431970893,-103.77874574972114,-104.62054830235294,-105.46235085498478,-106.30415340761658,-107.14595596024839,-107.98775851288022,-108.82956106551202,-109.67136361814386,-110.51316617077566,-111.35496872340747,-112.1967712760393,-113.0385738286711,-113.88037638130294,-114.72217893393474,-115.56398148656655,-116.40578403919838,-117.24758659183018,-118.08938914446202,-118.93119169709382,-119.77299424972563,-120.61479680235746,-121.45659935498927,-122.2984019076211,-123.1402044602529,-123.98200701288471,-124.82380956551654,-125.66561211814835,-126.50741467078015,-127.34921722341198,-128.19101977604382,-129.03282232867562,-129.87462488130743,-130.71642743393923,-131.55822998657106,-132.4000325392029,-133.2418350918347,-134.0836376444665,-134.9254401970983,-135.76724274973014,-136.60904530236198,-137.45084785499378,-138.2926504076256,-139.1344529602574,-139.97625551288922,-140.81805806552106,-141.65986061815286,-142.50166317078467,-143.34346572341647,-144.1852682760483,-145.02707082868014,-145.86887338131194)
rate=c(1.1766217508843897, 1.2338842382317232,1.324906548451167,1.447913695761602,1.6673093962915972,3.4439768433192324,12.897060417398349,15.735289062809144,16.287314184965947,16.287314184965947,16.287314184965947,16.287314184965947,16.305802701963586,16.357516177732176,16.366396899463414,16.366396899463414,16.366396899463414,16.366396899463414,16.36840995682539,16.381773028207686,16.384774141205536,16.39446755485448,16.39446755485448,16.39446755485448,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.40163777739384,16.40163777739384,16.39274691743702,16.39274691743702,16.39274691743702,16.39274691743702,16.38369531692901,16.379921465645072,16.366097587968177,16.366097587968177,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.349395015378185,16.349395015378185,16.349395015378185,16.349395015378185,16.349395015378185,16.35294472760658,16.35294472760658,16.359506831911425,16.373577422827083,16.393459250434155,16.408123928396666,16.42200315488043,16.40805265793824,16.35290191312401)
minHPD=c(1.1766217508843897, 1.2338842382317232,1.324906548451167,1.447913695761602,1.6673093962915972,3.4439768433192324,12.897060417398349,15.735289062809144,16.287314184965947,16.287314184965947,16.287314184965947,16.287314184965947,16.305802701963586,16.357516177732176,16.366396899463414,16.366396899463414,16.366396899463414,16.366396899463414,16.36840995682539,16.381773028207686,16.384774141205536,16.39446755485448,16.39446755485448,16.39446755485448,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.40163777739384,16.40163777739384,16.39274691743702,16.39274691743702,16.39274691743702,16.39274691743702,16.38369531692901,16.379921465645072,16.366097587968177,16.366097587968177,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.349395015378185,16.349395015378185,16.349395015378185,16.349395015378185,16.349395015378185,16.35294472760658,16.35294472760658,16.359506831911425,16.373577422827083,16.393459250434155,16.408123928396666,16.42200315488043,16.40805265793824,16.35290191312401)
maxHPD=c(1.1766217508843897, 1.2338842382317232,1.324906548451167,1.447913695761602,1.6673093962915972,3.4439768433192324,12.897060417398349,15.735289062809144,16.287314184965947,16.287314184965947,16.287314184965947,16.287314184965947,16.305802701963586,16.357516177732176,16.366396899463414,16.366396899463414,16.366396899463414,16.366396899463414,16.36840995682539,16.381773028207686,16.384774141205536,16.39446755485448,16.39446755485448,16.39446755485448,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.39265110947028,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.401517968192586,16.40163777739384,16.40163777739384,16.39274691743702,16.39274691743702,16.39274691743702,16.39274691743702,16.38369531692901,16.379921465645072,16.366097587968177,16.366097587968177,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.35507148982711,16.349395015378185,16.349395015378185,16.349395015378185,16.349395015378185,16.349395015378185,16.35294472760658,16.35294472760658,16.359506831911425,16.373577422827083,16.393459250434155,16.408123928396666,16.42200315488043,16.40805265793824,16.35290191312401)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 18.064203470368472), xlim = c(-146.28977465762785,-62.10951939444624), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()