

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-64.0760173181749, -64.89992916680775,-65.72384101544058,-66.54775286407342,-67.37166471270625,-68.1955765613391,-69.01948840997193,-69.84340025860476,-70.66731210723759,-71.49122395587044,-72.31513580450327,-73.1390476531361,-73.96295950176894,-74.78687135040178,-75.61078319903461,-76.43469504766745,-77.2586068963003,-78.08251874493313,-78.90643059356596,-79.73034244219879,-80.55425429083164,-81.37816613946447,-82.2020779880973,-83.02598983673015,-83.84990168536298,-84.67381353399581,-85.49772538262864,-86.32163723126149,-87.14554907989432,-87.96946092852716,-88.79337277716,-89.61728462579283,-90.44119647442567,-91.2651083230585,-92.08902017169133,-92.91293202032418,-93.73684386895701,-94.56075571758986,-95.38466756622269,-96.20857941485552,-97.03249126348835,-97.85640311212119,-98.68031496075403,-99.50422680938686,-100.32813865801971,-101.15205050665254,-101.97596235528538,-102.79987420391821,-103.62378605255104,-104.44769790118387,-105.27160974981672,-106.09552159844955,-106.9194334470824,-107.74334529571523,-108.56725714434806,-109.3911689929809,-110.21508084161373,-111.03899269024657,-111.8629045388794,-112.68681638751225,-113.51072823614508,-114.33464008477792,-115.15855193341075,-115.98246378204358,-116.80637563067643,-117.63028747930926,-118.4541993279421,-119.27811117657494,-120.10202302520777,-120.9259348738406,-121.74984672247344,-122.57375857110627,-123.39767041973911,-124.22158226837195,-125.0454941170048,-125.86940596563763,-126.69331781427046,-127.51722966290329,-128.34114151153614,-129.16505336016894,-129.9889652088018,-130.8128770574346,-131.63678890606747,-132.46070075470033,-133.28461260333313,-134.108524451966,-134.9324363005988,-135.75634814923166,-136.58025999786446,-137.40417184649732,-138.22808369513018,-139.05199554376298,-139.87590739239585,-140.69981924102865,-141.5237310896615,-142.3476429382943,-143.17155478692717,-143.99546663556004,-144.81937848419284,-145.6432903328257)
rate=c(0.012717100065966373, 0.012717100065966373,0.012729357099482742,0.013293485807174057,0.0421453583362048,0.10160197887495588,0.10286063821169389,0.10290095711979044,0.10290666037005872,0.10290095711979044,0.10290095711979044,0.10280764765649697,0.1021217621493288,0.10185042043826413,0.10179083740140776,0.10177459127585005,0.10177459127585005,0.10177459127585005,0.10177459127585005,0.10177459127585005,0.10177459127585005,0.10192260827103437,0.26549753572498147,0.35350547581439895,0.35418061455148503,0.3536844974447277,0.3214228686812337,0.2818171565433365,0.08518010822625907,0.08010047884134974,0.07963245378136666,0.07889653884909942,0.07838408590343035,0.07838408590343035,0.07838408590343035,0.078373729791844,0.07837016059269991,0.07837016059269991,0.07824629926202067,0.07813084374690704,0.07802655756713606,0.07797526850095701,0.07794879895136096,0.07787678284558512,0.07778087527173663,0.07770667253190089,0.07769416742661177,0.07755127661046868,0.07753471994675665,0.07734337805756336,0.07734337805756336,0.07734337805756336,0.07734337805756336,0.07722271488284771,0.07722271488284771,0.07722271488284771,0.07722271488284771,0.07712401554813636,0.07712401554813636,0.07708383343343335,0.07702383001281074,0.07702383001281074,0.07702383001281074,0.07702383001281074,0.07711342168035695,0.07738985332004518,0.07754852953427638,0.07787678284558512,0.07992582468482887,0.09059359479351473,0.13518450042359337,0.14892453081190946,0.15581862421201026,0.16541316137919207,0.17183250430947902,0.17458152461838822,0.17582199144370553,0.1766174350772216,0.1766174350772216,0.1766174350772216,0.17655517985431357,0.17655517985431357,0.17669044324790611,0.17680341764912488,0.17722789111794096,0.17729352908830626,0.1773629837193638,0.17758458496127721,0.17758458496127721,0.17781644725320678,0.17788286960876976,0.17890327416667323,0.17890327416667323,0.17890327416667323,0.17892228531999776,0.1791027027926108,0.17989212448041048,0.18064686896548826,0.181810322741774,0.1835743135424004)
minHPD=c(0.0007460311401296851, 0.0007460311401296851,0.0007460311401296851,0.0007460311401296851,0.004056770996218667,0.017989188762806235,0.07677922537979245,0.07964920414517622,0.07964920414517622,0.07964920414517622,0.07974671943023434,0.0816611389809312,0.07946963480113867,0.08128088232268124,0.0816470840988283,0.0816470840988283,0.0816470840988283,0.0816470840988283,0.0816470840988283,0.0816470840988283,0.0816470840988283,0.0816470840988283,0.08576071965055547,0.23161646852548312,0.23161646852548312,0.23161646852548312,0.0601206916776517,0.0601206916776517,0.04981937476734784,0.04601643175985804,0.05287449180877644,0.05019137986744958,0.05224434042475344,0.05224434042475344,0.05224434042475344,0.05224434042475344,0.05224434042475344,0.05224434042475344,0.05224434042475344,0.05287449180877644,0.05287449180877644,0.05287449180877644,0.05287449180877644,0.05224434042475344,0.05224434042475344,0.050757617197130706,0.050757617197130706,0.050757617197130706,0.05019137986744958,0.05019137986744958,0.05019137986744958,0.05019137986744958,0.05019137986744958,0.05019137986744958,0.05019137986744958,0.05019137986744958,0.05019137986744958,0.05019137986744958,0.05019137986744958,0.04981937476734784,0.04981937476734784,0.05019137986744958,0.05019137986744958,0.05019137986744958,0.04981937476734784,0.04981937476734784,0.04555957218993921,0.04401126196818872,0.048905333300635685,0.044366317136621584,0.0601206916776517,0.0601206916776517,0.06160705749102772,0.06766699008116277,0.07710946551675024,0.07937512511867202,0.08552304713318339,0.08552304713318339,0.08552304713318339,0.08552304713318339,0.08493525645804227,0.08493525645804227,0.08493525645804227,0.08493525645804227,0.08552304713318339,0.08493525645804227,0.08552304713318339,0.08552304713318339,0.08552304713318339,0.08552304713318339,0.08493525645804227,0.07992415681617578,0.07992415681617578,0.07992415681617578,0.07992415681617578,0.07992415681617578,0.07992415681617578,0.08567703199860603,0.07992415681617578,0.07750776307586268)
maxHPD=c(0.04193752113870123, 0.04193752113870123,0.0423817144373845,0.09335534061966398,0.11508418305752606,0.12542204211315805,0.1260724583067762,0.1260724583067762,0.12542204211315805,0.12542204211315805,0.12542204211315805,0.12542204211315805,0.12167848387452097,0.12167848387452097,0.12167848387452097,0.12167848387452097,0.12167848387452097,0.12167848387452097,0.12167848387452097,0.12167848387452097,0.12167848387452097,0.1228831812639476,0.4011031873146625,0.5237826596616165,0.5191931010954125,0.5210654898306711,0.45011386639954026,0.39883445316749594,0.329601339028011,0.1287127307807923,0.12076407239365047,0.11486411648629707,0.11486411648629707,0.11486411648629707,0.11486411648629707,0.11486411648629707,0.11486411648629707,0.11486411648629707,0.11353642632763436,0.11385114386733752,0.11353642632763436,0.11385114386733752,0.11403727514058096,0.11353642632763436,0.11403727514058096,0.11353642632763436,0.11353642632763436,0.11353642632763436,0.11353642632763436,0.11385114386733752,0.11403727514058096,0.11403727514058096,0.11403727514058096,0.11486411648629707,0.11486411648629707,0.11486411648629707,0.11486411648629707,0.115308385848939,0.115308385848939,0.11591642766180593,0.11647093044441677,0.11706213927588298,0.11706213927588298,0.11706213927588298,0.11798714408912114,0.12076407239365047,0.11949278564096079,0.1250033181672157,0.1904117459679297,0.20709464335887276,0.22656607213348084,0.22656607213348084,0.2283456715397398,0.24069028241986695,0.24315451629674117,0.24315451629674117,0.247016259099076,0.24578401614498915,0.24578401614498915,0.24578401614498915,0.24458548589456724,0.24458548589456724,0.24458548589456724,0.24458548589456724,0.24458548589456724,0.24458548589456724,0.24458548589456724,0.24578401614498915,0.24578401614498915,0.247016259099076,0.24721768007958173,0.247016259099076,0.247016259099076,0.247016259099076,0.24721768007958173,0.2486239870373399,0.2502273853501314,0.26152665804811415,0.2631612520431962,0.3178122932455162)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.5761609256277782), xlim = c(-146.0552462571421,-63.66406139385849), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-64.0801784891276, -64.9124126796658,-65.74464687020404,-66.57688106074227,-67.40911525128047,-68.2413494418187,-69.0735836323569,-69.90581782289513,-70.73805201343336,-71.57028620397156,-72.40252039450979,-73.234754585048,-74.06698877558622,-74.89922296612443,-75.73145715666266,-76.56369134720089,-77.39592553773909,-78.22815972827732,-79.06039391881552,-79.89262810935375,-80.72486229989198,-81.55709649043018,-82.38933068096841,-83.22156487150662,-84.05379906204485,-84.88603325258305,-85.71826744312128,-86.55050163365951,-87.38273582419771,-88.21497001473594,-89.04720420527414,-89.87943839581237,-90.7116725863506,-91.5439067768888,-92.37614096742703,-93.20837515796524,-94.04060934850347,-94.87284353904167,-95.7050777295799,-96.53731192011813,-97.36954611065633,-98.20178030119456,-99.03401449173276,-99.86624868227099,-100.69848287280922,-101.53071706334742,-102.36295125388565,-103.19518544442386,-104.02741963496209,-104.85965382550029,-105.69188801603852,-106.52412220657675,-107.35635639711495,-108.18859058765318,-109.02082477819138,-109.85305896872961,-110.68529315926784,-111.51752734980604,-112.34976154034428,-113.18199573088248,-114.01422992142071,-114.84646411195891,-115.67869830249714,-116.51093249303537,-117.34316668357357,-118.1754008741118,-119.00763506465,-119.83986925518823,-120.67210344572646,-121.50433763626467,-122.3365718268029,-123.1688060173411,-124.00104020787933,-124.83327439841753,-125.66550858895576,-126.49774277949399,-127.32997697003219,-128.16221116057042,-128.99444535110865,-129.82667954164685,-130.65891373218506,-131.4911479227233,-132.32338211326152,-133.15561630379972,-133.98785049433795,-134.82008468487618,-135.65231887541438,-136.48455306595258,-137.31678725649084,-138.14902144702904,-138.98125563756724,-139.81348982810547,-140.6457240186437,-141.4779582091819,-142.31019239972014,-143.14242659025837,-143.97466078079657,-144.80689497133477,-145.639129161873)
counts=c(0.0, 0.001,0.044,0.445,0.402,0.074,0.002,0.003,0.001,0.003,0.01,0.029,0.011,0.002,0.001,0.0,0.0,0.0,0.0,0.0,0.013,0.588,0.399,0.003,0.027,0.264,0.235,0.359,0.087,0.016,0.015,0.004,0.0,0.001,0.001,0.002,0.001,0.006,0.002,0.006,0.001,0.003,0.004,0.004,0.002,0.003,0.003,0.005,0.003,0.001,0.0,0.002,0.001,0.0,0.0,0.002,0.0,0.001,0.002,0.002,0.0,0.0,0.001,0.011,0.008,0.014,0.053,0.143,0.227,0.112,0.04,0.045,0.087,0.034,0.024,0.008,0.002,0.0,0.0,0.003,0.002,0.003,0.006,0.005,0.002,0.003,0.0,0.004,0.001,0.016,0.002,0.002,0.003,0.002,0.004,0.006,0.015,0.027,0.011)
plot(mids,counts,type = 'h', xlim = c(-146.0552462571421,-63.66406139385849), ylim=c(0,0.588), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.0334855783905188
bf6 = 0.2038210823685952
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-64.0760173181749, -64.89992916680775,-65.72384101544058,-66.54775286407342,-67.37166471270625,-68.1955765613391,-69.01948840997193,-69.84340025860476,-70.66731210723759,-71.49122395587044,-72.31513580450327,-73.1390476531361,-73.96295950176894,-74.78687135040178,-75.61078319903461,-76.43469504766745,-77.2586068963003,-78.08251874493313,-78.90643059356596,-79.73034244219879,-80.55425429083164,-81.37816613946447,-82.2020779880973,-83.02598983673015,-83.84990168536298,-84.67381353399581,-85.49772538262864,-86.32163723126149,-87.14554907989432,-87.96946092852716,-88.79337277716,-89.61728462579283,-90.44119647442567,-91.2651083230585,-92.08902017169133,-92.91293202032418,-93.73684386895701,-94.56075571758986,-95.38466756622269,-96.20857941485552,-97.03249126348835,-97.85640311212119,-98.68031496075403,-99.50422680938686,-100.32813865801971,-101.15205050665254,-101.97596235528538,-102.79987420391821,-103.62378605255104,-104.44769790118387,-105.27160974981672,-106.09552159844955,-106.9194334470824,-107.74334529571523,-108.56725714434806,-109.3911689929809,-110.21508084161373,-111.03899269024657,-111.8629045388794,-112.68681638751225,-113.51072823614508,-114.33464008477792,-115.15855193341075,-115.98246378204358,-116.80637563067643,-117.63028747930926,-118.4541993279421,-119.27811117657494,-120.10202302520777,-120.9259348738406,-121.74984672247344,-122.57375857110627,-123.39767041973911,-124.22158226837195,-125.0454941170048,-125.86940596563763,-126.69331781427046,-127.51722966290329,-128.34114151153614,-129.16505336016894,-129.9889652088018,-130.8128770574346,-131.63678890606747,-132.46070075470033,-133.28461260333313,-134.108524451966,-134.9324363005988,-135.75634814923166,-136.58025999786446,-137.40417184649732,-138.22808369513018,-139.05199554376298,-139.87590739239585,-140.69981924102865,-141.5237310896615,-142.3476429382943,-143.17155478692717,-143.99546663556004,-144.81937848419284,-145.6432903328257)
rate=c(1.3041383238314557, 0.19034021511381655,0.1747156772909516,0.16698612526942302,0.1658297312918122,0.1658297312918122,0.1658297312918122,0.1660583130129189,0.1679128703326066,0.17560901496458559,0.22504404266280745,0.3102438121726156,0.18772108937677578,0.06973519679010692,0.0694723139759203,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.06944651289677706,0.0694193666338618,0.0694193666338618,0.06941656236023723,0.06941656236023723,0.06941656236023723,0.06941656236023723,0.06941656236023723,0.06941656236023723,0.06941656236023723,0.06941656236023723,0.06941656236023723,0.06941656236023723,0.06941656236023723,0.06941656236023723,0.06941656236023723,0.06941656236023723,0.0694193666338618,0.0694723139759203,0.0694723139759203,0.0694723139759203,0.06947345199649177,0.06947345199649177,0.06947780392249345,0.06947780392249345,0.06950340420109813,0.06950340420109813,0.06950340420109813,0.06950340420109813,0.06950340420109813,0.06950340420109813,0.06953019576228736,0.06954195149427622,0.06954195149427622,0.06954195149427622,0.06954195149427622,0.06954195149427622,0.06954195149427622,0.06954195149427622,0.06954195149427622,0.06954195149427622,0.06954195149427622,0.06954195149427622,0.06954195149427622,0.06954195149427622,0.06955399895200856,0.0695598821741117,0.0695598821741117,0.06956362644771363,0.06957784755935228,0.06960423867969218,0.06960423867969218,0.06960914945943175,0.06960914945943175,0.06960423867969218,0.06960423867969218,0.06960423867969218,0.06960423867969218,0.06959595499195145,0.06960423867969218,0.06959595499195145,0.06960423867969218,0.06960423867969218)
minHPD=c(0.11917252139487453, 0.07944116871008518,0.09860073737844192,0.10632195219190499,0.11092789808329222,0.11245522136515558,0.11263177810025146,0.11245522136515558,0.11245522136515558,0.11109661358584966,0.11155492186514866,0.16005773420678926,0.05659631626271196,0.056553309845768646,0.05789470425889937,0.05788091055616116,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05791410496113079,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05789470425889937,0.05788091055616116,0.05788091055616116,0.05788091055616116,0.05760865415634535,0.05760865415634535,0.05760865415634535,0.05760865415634535,0.05760865415634535,0.05760865415634535,0.05760865415634535,0.05760865415634535,0.05760865415634535,0.05760865415634535,0.05760865415634535,0.05760865415634535,0.05760865415634535,0.05733083699887516,0.05789470425889937,0.05788091055616116,0.05789470425889937,0.0574611187615129,0.05733083699887516,0.05714500303292515,0.057032273444516626,0.057032273444516626,0.057032273444516626,0.057032273444516626,0.057032273444516626,0.05657663501089776,0.056553309845768646,0.056553309845768646,0.056553309845768646,0.056553309845768646,0.056553309845768646)
maxHPD=c(3.675227244847961, 1.4820426681281034,0.9002827043597754,0.24161859556511361,0.22947662924836065,0.23061797792019445,0.23061797792019445,0.23061797792019445,0.23539737878599784,0.280276170811264,0.46984598206060585,0.5426811019839305,0.3677948779517918,0.08380904006876948,0.08119848170348318,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08109477054748575,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08125907901739435,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08119848170348318,0.08125907901739435,0.08125907901739435,0.08208821927528613,0.08218208724616462,0.08226939978045365,0.08226939978045365,0.08226939978045365,0.08226939978045365,0.08226939978045365,0.08226939978045365,0.08226939978045365,0.08226939978045365,0.08226939978045365,0.08226939978045365,0.08226939978045365,0.08245681804264841,0.08282288474624279,0.0829482380981113,0.0829482380981113)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 4.042749969332758), xlim = c(-146.0552462571421,-63.66406139385849), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-64.0801784891276, -64.9124126796658,-65.74464687020404,-66.57688106074227,-67.40911525128047,-68.2413494418187,-69.0735836323569,-69.90581782289513,-70.73805201343336,-71.57028620397156,-72.40252039450979,-73.234754585048,-74.06698877558622,-74.89922296612443,-75.73145715666266,-76.56369134720089,-77.39592553773909,-78.22815972827732,-79.06039391881552,-79.89262810935375,-80.72486229989198,-81.55709649043018,-82.38933068096841,-83.22156487150662,-84.05379906204485,-84.88603325258305,-85.71826744312128,-86.55050163365951,-87.38273582419771,-88.21497001473594,-89.04720420527414,-89.87943839581237,-90.7116725863506,-91.5439067768888,-92.37614096742703,-93.20837515796524,-94.04060934850347,-94.87284353904167,-95.7050777295799,-96.53731192011813,-97.36954611065633,-98.20178030119456,-99.03401449173276,-99.86624868227099,-100.69848287280922,-101.53071706334742,-102.36295125388565,-103.19518544442386,-104.02741963496209,-104.85965382550029,-105.69188801603852,-106.52412220657675,-107.35635639711495,-108.18859058765318,-109.02082477819138,-109.85305896872961,-110.68529315926784,-111.51752734980604,-112.34976154034428,-113.18199573088248,-114.01422992142071,-114.84646411195891,-115.67869830249714,-116.51093249303537,-117.34316668357357,-118.1754008741118,-119.00763506465,-119.83986925518823,-120.67210344572646,-121.50433763626467,-122.3365718268029,-123.1688060173411,-124.00104020787933,-124.83327439841753,-125.66550858895576,-126.49774277949399,-127.32997697003219,-128.16221116057042,-128.99444535110865,-129.82667954164685,-130.65891373218506,-131.4911479227233,-132.32338211326152,-133.15561630379972,-133.98785049433795,-134.82008468487618,-135.65231887541438,-136.48455306595258,-137.31678725649084,-138.14902144702904,-138.98125563756724,-139.81348982810547,-140.6457240186437,-141.4779582091819,-142.31019239972014,-143.14242659025837,-143.97466078079657,-144.80689497133477,-145.639129161873)
counts=c(0.644, 0.247,0.144,0.029,0.003,0.002,0.005,0.025,0.083,0.43,0.097,0.573,0.4,0.026,0.001,0.001,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.0,0.001,0.001,0.0,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.001,0.001,0.0,0.001,0.0,0.001,0.0,0.0,0.001,0.0,0.0,0.001,0.0,0.0,0.002,0.001,0.0,0.001,0.0,0.0,0.0,0.001,0.0,0.0,0.001,0.0,0.001,0.003,0.003,0.002,0.001,0.003,0.002,0.003,0.001,0.0,0.001,0.0,0.001,0.002,0.004,0.002,0.001,0.001,0.0,0.003)
plot(mids,counts,type = 'h', xlim = c(-146.0552462571421,-63.66406139385849), ylim=c(0,0.644), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-64.0760173181749, -64.89992916680775,-65.72384101544058,-66.54775286407342,-67.37166471270625,-68.1955765613391,-69.01948840997193,-69.84340025860476,-70.66731210723759,-71.49122395587044,-72.31513580450327,-73.1390476531361,-73.96295950176894,-74.78687135040178,-75.61078319903461,-76.43469504766745,-77.2586068963003,-78.08251874493313,-78.90643059356596,-79.73034244219879,-80.55425429083164,-81.37816613946447,-82.2020779880973,-83.02598983673015,-83.84990168536298,-84.67381353399581,-85.49772538262864,-86.32163723126149,-87.14554907989432,-87.96946092852716,-88.79337277716,-89.61728462579283,-90.44119647442567,-91.2651083230585,-92.08902017169133,-92.91293202032418,-93.73684386895701,-94.56075571758986,-95.38466756622269,-96.20857941485552,-97.03249126348835,-97.85640311212119,-98.68031496075403,-99.50422680938686,-100.32813865801971,-101.15205050665254,-101.97596235528538,-102.79987420391821,-103.62378605255104,-104.44769790118387,-105.27160974981672,-106.09552159844955,-106.9194334470824,-107.74334529571523,-108.56725714434806,-109.3911689929809,-110.21508084161373,-111.03899269024657,-111.8629045388794,-112.68681638751225,-113.51072823614508,-114.33464008477792,-115.15855193341075,-115.98246378204358,-116.80637563067643,-117.63028747930926,-118.4541993279421,-119.27811117657494,-120.10202302520777,-120.9259348738406,-121.74984672247344,-122.57375857110627,-123.39767041973911,-124.22158226837195,-125.0454941170048,-125.86940596563763,-126.69331781427046,-127.51722966290329,-128.34114151153614,-129.16505336016894,-129.9889652088018,-130.8128770574346,-131.63678890606747,-132.46070075470033,-133.28461260333313,-134.108524451966,-134.9324363005988,-135.75634814923166,-136.58025999786446,-137.40417184649732,-138.22808369513018,-139.05199554376298,-139.87590739239585,-140.69981924102865,-141.5237310896615,-142.3476429382943,-143.17155478692717,-143.99546663556004,-144.81937848419284,-145.6432903328257)
net_rate=c(-1.5428363488378178, -0.39426178955612295,-0.24385876662705006,-0.16352642279683138,-0.1113263784896128,-0.0715702357122492,-0.06537475099554398,-0.06558499193028686,-0.06779985863513281,-0.07774399617781774,-0.16494165528505306,-0.2202049440055782,-0.07356295824689073,0.02793612837448294,0.031693171377474634,0.03169567993248972,0.03173905535825944,0.03173905535825944,0.03173905535825944,0.03173905535825944,0.0317429171918411,0.032754458511502486,0.15808427979943995,0.2952040151035178,0.29771516344854343,0.2959941042745194,0.22550756942880718,0.15986962022318593,0.05323769548680271,0.020325044308158857,0.01610893820540774,0.013304906775980316,0.011807129885050095,0.011807129885050095,0.011793148653419907,0.011761055042279386,0.011756322163031838,0.011761606411471776,0.011516440665540442,0.011318799157060626,0.011030932166804341,0.010901058144843517,0.0108335898604013,0.010653629121481021,0.010403520784000248,0.010128288791013322,0.01008054639044958,0.00991974319960073,0.009769563528293853,0.00940985329701124,0.009374966371163768,0.009374966371163768,0.009374966371163768,0.009194357503406832,0.0091822562007381,0.00913156604307258,0.00913156604307258,0.009039136686946206,0.009030197263509633,0.008897570864032684,0.008820030917376877,0.008789451991831666,0.00878598510972328,0.00878598510972328,0.009101918785538534,0.010222220736252043,0.010717523746985197,0.012392118296830396,0.020383512091608942,0.040522637248917706,0.06746369588382642,0.07276144128742916,0.07707125966403072,0.08633885310548779,0.094828858822536,0.09754917630940137,0.09988780762327834,0.10078530488941358,0.10085976532411949,0.10085229572248725,0.10065290831785693,0.10064168323542444,0.10089291393364162,0.10085281967820932,0.10133563206393295,0.10148380488027686,0.10132728698140939,0.10171929934617933,0.10170326744563261,0.10223517078812423,0.10267472798176552,0.10487094047993867,0.10494297115198367,0.10494094911433119,0.10519237918441611,0.10546878608462117,0.10586877882922581,0.10932344327605895,0.11494737445458536,0.14616548885204142)
net_minHPD=c(-3.656524098677166, -1.5248970219181477,-0.8843941753787454,-0.22832987957844092,-0.20444386061155256,-0.1486382436537902,-0.1393846923256563,-0.1393846923256563,-0.1481446205689561,-0.18248963449142497,-0.37463300001137023,-0.4447610250910238,-0.26770402557712225,0.0058034744523428605,0.008921026585219496,0.008921026585219496,0.008921026585219496,0.008921026585219496,0.008921026585219496,0.008921026585219496,0.008921026585219496,0.010030404823821976,0.010037868318520632,0.15812654459573455,0.1672568146203574,0.15931565278938167,-0.012354497727042599,-0.012354497727042599,-0.024375421570984095,-0.025311158075044388,-0.020275334573953335,-0.02130741226866762,-0.019578497425976053,-0.019578497425976053,-0.019578497425976053,-0.019578497425976053,-0.019578497425976053,-0.019578497425976053,-0.019283123652725394,-0.019695300779861175,-0.019695300779861175,-0.019695300779861175,-0.019695300779861175,-0.019695300779861175,-0.019578497425976053,-0.019832545065371014,-0.019832545065371014,-0.019832545065371014,-0.0242700382782138,-0.0242700382782138,-0.024375421570984095,-0.024375421570984095,-0.024375421570984095,-0.023740482015886043,-0.023740482015886043,-0.023740482015886043,-0.023740482015886043,-0.0242700382782138,-0.0242700382782138,-0.024375421570984095,-0.023740482015886043,-0.023740482015886043,-0.023740482015886043,-0.023740482015886043,-0.023740482015886043,-0.024375421570984095,-0.024375421570984095,-0.027360970266479906,-0.024375421570984095,-0.025535981639143626,-0.012414449086927383,-0.012414449086927383,-0.007838783664632712,-0.00601460599126942,0.005434370083385931,0.009018535150595003,0.009117808151694815,0.009749037893806586,0.009749037893806586,0.009749037893806586,0.009117808151694815,0.009749037893806586,0.009749037893806586,0.009749037893806586,0.009749037893806586,0.009749037893806586,0.009749037893806586,0.008784949151926139,0.008784949151926139,0.009749037893806586,0.008784949151926139,0.008784949151926139,0.008784949151926139,0.008784949151926139,0.009749037893806586,0.009749037893806586,0.009749037893806586,0.0077791435904770445,0.008784949151926139,0.004342565501527881)
net_maxHPD=c(-0.10434290251424709, -0.06606713713435376,-0.03881188529408486,-0.035426167287194166,-0.010582746308538726,-0.0027407635460233726,-0.0015353092225752762,-0.0027407635460233726,-0.0043063025828515705,0.0085808761319449,-0.010043191844430255,-0.0546911470509418,0.05808216782258376,0.06004275559931165,0.054225116572375665,0.054225116572375665,0.0541051270300297,0.0541051270300297,0.0541051270300297,0.0541051270300297,0.0541051270300297,0.056270479445467175,0.33003780742561867,0.4509049198044685,0.4573698081419453,0.4509049198044685,0.38073732577533187,0.3286878941061574,0.26097065720060414,0.060640775030412,0.05214130654025318,0.04742192797366659,0.04727109230633922,0.04727109230633922,0.04727109230633922,0.04727109230633922,0.04727109230633922,0.04727109230633922,0.04742192797366659,0.04667530943109707,0.046377506600788716,0.04667530943109707,0.04667530943109707,0.04667530943109707,0.04727109230633922,0.04727109230633922,0.04727109230633922,0.04727109230633922,0.04324260227601709,0.04324260227601709,0.04324260227601709,0.04324260227601709,0.04324260227601709,0.04428498946437427,0.04428498946437427,0.04428498946437427,0.04428498946437427,0.0440623834811065,0.0440623834811065,0.04428498946437427,0.04543743282393725,0.04558560685013871,0.04558560685013871,0.04558560685013871,0.04614745940844352,0.04742192797366659,0.04947268020445818,0.05347615536660587,0.11693386347962893,0.14025284911609415,0.1583789720463045,0.15714542239471746,0.16049204540559975,0.1685099341439819,0.17527077416462494,0.17484222814244954,0.17373942982876023,0.17389700096954164,0.17389700096954164,0.17389700096954164,0.17268296014478662,0.17389700096954164,0.17438839688722388,0.17438839688722388,0.17484222814244954,0.17438839688722388,0.17527077416462494,0.17527077416462494,0.17527077416462494,0.17697090615229874,0.17697090615229874,0.18306268342813137,0.18306268342813137,0.18306268342813137,0.18451519845800513,0.18558009550980653,0.1863156548336291,0.19112209543172953,0.2050147694375929,0.28357391311401575)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-4.022176508544883, 0.5031067889561398), xlim = c(-146.0552462571421,-63.66406139385849), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-64.0760173181749, -64.89992916680775,-65.72384101544058,-66.54775286407342,-67.37166471270625,-68.1955765613391,-69.01948840997193,-69.84340025860476,-70.66731210723759,-71.49122395587044,-72.31513580450327,-73.1390476531361,-73.96295950176894,-74.78687135040178,-75.61078319903461,-76.43469504766745,-77.2586068963003,-78.08251874493313,-78.90643059356596,-79.73034244219879,-80.55425429083164,-81.37816613946447,-82.2020779880973,-83.02598983673015,-83.84990168536298,-84.67381353399581,-85.49772538262864,-86.32163723126149,-87.14554907989432,-87.96946092852716,-88.79337277716,-89.61728462579283,-90.44119647442567,-91.2651083230585,-92.08902017169133,-92.91293202032418,-93.73684386895701,-94.56075571758986,-95.38466756622269,-96.20857941485552,-97.03249126348835,-97.85640311212119,-98.68031496075403,-99.50422680938686,-100.32813865801971,-101.15205050665254,-101.97596235528538,-102.79987420391821,-103.62378605255104,-104.44769790118387,-105.27160974981672,-106.09552159844955,-106.9194334470824,-107.74334529571523,-108.56725714434806,-109.3911689929809,-110.21508084161373,-111.03899269024657,-111.8629045388794,-112.68681638751225,-113.51072823614508,-114.33464008477792,-115.15855193341075,-115.98246378204358,-116.80637563067643,-117.63028747930926,-118.4541993279421,-119.27811117657494,-120.10202302520777,-120.9259348738406,-121.74984672247344,-122.57375857110627,-123.39767041973911,-124.22158226837195,-125.0454941170048,-125.86940596563763,-126.69331781427046,-127.51722966290329,-128.34114151153614,-129.16505336016894,-129.9889652088018,-130.8128770574346,-131.63678890606747,-132.46070075470033,-133.28461260333313,-134.108524451966,-134.9324363005988,-135.75634814923166,-136.58025999786446,-137.40417184649732,-138.22808369513018,-139.05199554376298,-139.87590739239585,-140.69981924102865,-141.5237310896615,-142.3476429382943,-143.17155478692717,-143.99546663556004,-144.81937848419284,-145.6432903328257)
rate=c(0.6410165825471665, 2.4304438224821783,3.8293073272322555,5.417424635605069,5.8924214782811655,5.900425020610765,5.902692619545328,5.886495260700084,5.803843423495535,5.487751084917476,3.7125756239586525,3.084928613200897,5.690494831776318,13.61339381898184,14.357387604435822,14.362351505140234,14.371304441385693,14.371304441385693,14.371304441385693,14.371304441385693,14.372102087102974,14.372102087102974,14.372102087102974,14.372102087102974,14.372102087102974,14.371941240147464,14.371941240147464,14.371941240147464,14.371941240147464,14.371941240147464,14.376189764023946,14.376189764023946,14.376189764023946,14.376189764023946,14.376189764023946,14.376189764023946,14.376884158893638,14.376884158893638,14.384505975446999,14.384505975446999,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.38431558029921,14.373834995899342,14.373834995899342,14.373834995899342,14.371988284547957,14.371988284547957,14.369340982388598,14.369340982388598,14.368625183301198,14.368625183301198,14.368625183301198,14.368625183301198,14.367315796346466,14.367315796346466,14.362100932353012,14.334593239247937,14.334593239247937,14.334593239247937,14.334766345722334,14.334766345722334,14.334766345722334,14.335983407853181,14.335983407853181,14.335983407853181,14.335983407853181,14.334448416559614,14.334448416559614,14.327003246034714,14.320478789542129,14.29259204283912,14.237064180016864,14.223845836187406,14.15936729585991,14.141202770756873,14.13799754029528,14.124031348065165,14.124031348065165,14.124454240801656,14.124454240801656,14.123323070656395,14.118933534813614,14.148680993730023,14.14006363394186,14.150120091193248,14.138361846788078,14.138361846788078)
minHPD=c(0.6410165825471665, 2.4304438224821783,3.8293073272322555,5.417424635605069,5.8924214782811655,5.900425020610765,5.902692619545328,5.886495260700084,5.803843423495535,5.487751084917476,3.7125756239586525,3.084928613200897,5.690494831776318,13.61339381898184,14.357387604435822,14.362351505140234,14.371304441385693,14.371304441385693,14.371304441385693,14.371304441385693,14.372102087102974,14.372102087102974,14.372102087102974,14.372102087102974,14.372102087102974,14.371941240147464,14.371941240147464,14.371941240147464,14.371941240147464,14.371941240147464,14.376189764023946,14.376189764023946,14.376189764023946,14.376189764023946,14.376189764023946,14.376189764023946,14.376884158893638,14.376884158893638,14.384505975446999,14.384505975446999,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.38431558029921,14.373834995899342,14.373834995899342,14.373834995899342,14.371988284547957,14.371988284547957,14.369340982388598,14.369340982388598,14.368625183301198,14.368625183301198,14.368625183301198,14.368625183301198,14.367315796346466,14.367315796346466,14.362100932353012,14.334593239247937,14.334593239247937,14.334593239247937,14.334766345722334,14.334766345722334,14.334766345722334,14.335983407853181,14.335983407853181,14.335983407853181,14.335983407853181,14.334448416559614,14.334448416559614,14.327003246034714,14.320478789542129,14.29259204283912,14.237064180016864,14.223845836187406,14.15936729585991,14.141202770756873,14.13799754029528,14.124031348065165,14.124031348065165,14.124454240801656,14.124454240801656,14.123323070656395,14.118933534813614,14.148680993730023,14.14006363394186,14.150120091193248,14.138361846788078,14.138361846788078)
maxHPD=c(0.6410165825471665, 2.4304438224821783,3.8293073272322555,5.417424635605069,5.8924214782811655,5.900425020610765,5.902692619545328,5.886495260700084,5.803843423495535,5.487751084917476,3.7125756239586525,3.084928613200897,5.690494831776318,13.61339381898184,14.357387604435822,14.362351505140234,14.371304441385693,14.371304441385693,14.371304441385693,14.371304441385693,14.372102087102974,14.372102087102974,14.372102087102974,14.372102087102974,14.372102087102974,14.371941240147464,14.371941240147464,14.371941240147464,14.371941240147464,14.371941240147464,14.376189764023946,14.376189764023946,14.376189764023946,14.376189764023946,14.376189764023946,14.376189764023946,14.376884158893638,14.376884158893638,14.384505975446999,14.384505975446999,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.386819879023191,14.38431558029921,14.373834995899342,14.373834995899342,14.373834995899342,14.371988284547957,14.371988284547957,14.369340982388598,14.369340982388598,14.368625183301198,14.368625183301198,14.368625183301198,14.368625183301198,14.367315796346466,14.367315796346466,14.362100932353012,14.334593239247937,14.334593239247937,14.334593239247937,14.334766345722334,14.334766345722334,14.334766345722334,14.335983407853181,14.335983407853181,14.335983407853181,14.335983407853181,14.334448416559614,14.334448416559614,14.327003246034714,14.320478789542129,14.29259204283912,14.237064180016864,14.223845836187406,14.15936729585991,14.141202770756873,14.13799754029528,14.124031348065165,14.124031348065165,14.124454240801656,14.124454240801656,14.123323070656395,14.118933534813614,14.148680993730023,14.14006363394186,14.150120091193248,14.138361846788078,14.138361846788078)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 15.825501866925512), xlim = c(-146.0552462571421,-63.66406139385849), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()