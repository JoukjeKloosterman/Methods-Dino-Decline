

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.32396473867504, -66.88578991925269,-67.4476150998303,-68.00944028040794,-68.57126546098559,-69.1330906415632,-69.69491582214084,-70.25674100271846,-70.8185661832961,-71.38039136387371,-71.94221654445136,-72.50404172502897,-73.06586690560661,-73.62769208618425,-74.18951726676187,-74.75134244733951,-75.31316762791712,-75.87499280849477,-76.43681798907238,-76.99864316965002,-77.56046835022767,-78.12229353080528,-78.68411871138292,-79.24594389196054,-79.80776907253818,-80.36959425311579,-80.93141943369343,-81.49324461427105,-82.05506979484869,-82.61689497542633,-83.17872015600395,-83.74054533658159,-84.3023705171592,-84.86419569773685,-85.42602087831446,-85.9878460588921,-86.54967123946972,-87.11149642004736,-87.673321600625,-88.23514678120262,-88.79697196178026,-89.35879714235787,-89.92062232293551,-90.48244750351313,-91.04427268409077,-91.60609786466841,-92.16792304524603,-92.72974822582367,-93.29157340640128,-93.85339858697893,-94.41522376755654,-94.97704894813418,-95.5388741287118,-96.10069930928944,-96.66252448986708,-97.2243496704447,-97.78617485102234,-98.34800003159995,-98.9098252121776,-99.47165039275521,-100.03347557333285,-100.5953007539105,-101.1571259344881,-101.71895111506575,-102.28077629564336,-102.842601476221,-103.40442665679862,-103.96625183737626,-104.52807701795388,-105.08990219853152,-105.65172737910916,-106.21355255968678,-106.77537774026442,-107.33720292084203,-107.89902810141967,-108.46085328199729,-109.02267846257493,-109.58450364315254,-110.14632882373019,-110.70815400430783,-111.26997918488544,-111.83180436546309,-112.3936295460407,-112.95545472661834,-113.51727990719596,-114.0791050877736,-114.64093026835121,-115.20275544892885,-115.7645806295065,-116.32640581008411,-116.88823099066175,-117.45005617123937,-118.01188135181701,-118.57370653239462,-119.13553171297227,-119.69735689354988,-120.25918207412752,-120.82100725470517,-121.38283243528278,-121.94465761586042)
rate=c(0.0826739657491111, 0.08266597346466048,0.08264113279314104,0.08264113279314104,0.08264113279314104,0.08266100355837483,0.08266597346466048,0.08266597346466048,0.08266597346466048,0.08266597346466048,0.0826739657491111,0.08283046155979401,0.08283046155979401,0.08292713801781344,0.08292713801781344,0.08292713801781344,0.08310851648151792,0.08317337299985975,0.08317337299985975,0.08332047719077759,0.08335211597466828,0.08337106614985992,0.08337106614985992,0.08346892049311291,0.08374948536923082,0.08392477586863223,0.08426960079677615,0.08470096012690306,0.0849087902778734,0.08508003135702207,0.0857507616621905,0.08599360543986151,0.08609603345232167,0.08599360543986151,0.08618748472388621,0.08650145795772149,0.08650145795772149,0.08618748472388621,0.08599360543986151,0.085900966648425,0.085900966648425,0.08599360543986151,0.08599360543986151,0.08606031418957397,0.08606031418957397,0.08606031418957397,0.08606031418957397,0.08606031418957397,0.08599360543986151,0.085900966648425,0.085900966648425,0.085900966648425,0.0858449882011233,0.085900966648425,0.08593918479846543,0.08593918479846543,0.085900966648425,0.0858449882011233,0.0858449882011233,0.0858449882011233,0.0858449882011233,0.085900966648425,0.085900966648425,0.085900966648425,0.08579280440163259,0.0858449882011233,0.08575974976662325,0.08575974976662325,0.08574365625586192,0.08574365625586192,0.08574365625586192,0.08574365625586192,0.08574365625586192,0.08574365625586192,0.08574365625586192,0.08575974976662325,0.08574365625586192,0.08575974976662325,0.08575974976662325,0.08575974976662325,0.0858449882011233,0.0858449882011233,0.0858449882011233,0.08593918479846543,0.08593918479846543,0.08599360543986151,0.08606031418957397,0.08609603345232167,0.08628178386345192,0.08631633769383748,0.08642557502002202,0.08650145795772149,0.08655294748612438,0.08665689951835523,0.08672549108001668,0.08750694900571795,0.08776090598329755,0.08803408162436685,0.0882489300199577,0.08896247888866288)
minHPD=c(0.04319941305979641, 0.043615563219740486,0.04222781885762198,0.04222781885762198,0.04319941305979641,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.043615563219740486,0.04319941305979641,0.04911775858839624,0.04911775858839624,0.04623620341269673,0.044728967053027535,0.04319941305979641,0.04581385219725749,0.04222781885762198,0.046586943090978716,0.04222781885762198,0.046586943090978716,0.04367581767286741,0.043122053397638985,0.043824102513313166,0.046586943090978716,0.046586943090978716,0.046586943090978716,0.04581385219725749,0.04581385219725749,0.04581385219725749,0.04581385219725749,0.04581385219725749,0.04581385219725749,0.04581385219725749,0.04581385219725749,0.043122053397638985,0.043122053397638985,0.043122053397638985,0.043122053397638985,0.0424836299659998,0.04222781885762198,0.04222781885762198,0.04222781885762198,0.043122053397638985,0.043122053397638985,0.043122053397638985,0.043122053397638985,0.043122053397638985,0.043122053397638985,0.043122053397638985,0.043122053397638985,0.043122053397638985,0.043122053397638985,0.043122053397638985,0.043122053397638985,0.04222781885762198,0.04222781885762198,0.04222781885762198,0.04222781885762198,0.03871538010618482,0.03871538010618482,0.03871538010618482,0.039851359709081366,0.039851359709081366,0.039851359709081366,0.039851359709081366,0.03683528510113891,0.03683528510113891,0.03683528510113891,0.0424836299659998,0.0424836299659998,0.0424836299659998,0.04222781885762198,0.04222781885762198,0.04222781885762198,0.03871538010618482,0.03683528510113891,0.03683528510113891,0.03871538010618482,0.03871538010618482,0.03871538010618482,0.02196161259323556,0.017747066394378185,0.026114430216477906,0.0173931783041911,0.0173931783041911)
maxHPD=c(0.12690566078835294, 0.12690566078835294,0.12385010132147528,0.12385010132147528,0.1242040801695698,0.1242040801695698,0.1242040801695698,0.1242040801695698,0.1242040801695698,0.1242040801695698,0.1242040801695698,0.12362805727105156,0.12362805727105156,0.12362805727105156,0.12362805727105156,0.12362805727105156,0.12362805727105156,0.12362805727105156,0.12385010132147528,0.12362805727105156,0.12385010132147528,0.12385010132147528,0.1242040801695698,0.1242040801695698,0.1242040801695698,0.12946972359428977,0.13027161558741657,0.13027161558741657,0.13027161558741657,0.13027161558741657,0.13643777204317,0.13643777204317,0.14221432819446042,0.13546650232358598,0.14221432819446042,0.14221432819446042,0.14195578162160594,0.14195578162160594,0.14221432819446042,0.14221432819446042,0.14221432819446042,0.14221432819446042,0.14221432819446042,0.14329559316692367,0.14329559316692367,0.14221432819446042,0.14221432819446042,0.14221432819446042,0.14221432819446042,0.13866281845997336,0.13866281845997336,0.13866281845997336,0.13866281845997336,0.13866281845997336,0.13866281845997336,0.13866281845997336,0.14011265065763062,0.14143736396923076,0.14143736396923076,0.14143736396923076,0.14143736396923076,0.1419144866448144,0.1419144866448144,0.1419144866448144,0.1419144866448144,0.14195578162160594,0.14221432819446042,0.14221432819446042,0.14221432819446042,0.14195578162160594,0.14329559316692367,0.14329559316692367,0.14329559316692367,0.14221432819446042,0.14329559316692367,0.14496281729531135,0.14764930915300786,0.14764930915300786,0.14764930915300786,0.14764930915300786,0.14764930915300786,0.14764930915300786,0.14764930915300786,0.1564047129010307,0.1564047129010307,0.1564047129010307,0.1564047129010307,0.1576714955838836,0.1591603628906999,0.1564047129010307,0.1591603628906999,0.1591603628906999,0.1693931824543795,0.1703185320933955,0.17183993165575565,0.17345027995703657,0.18537399787349604,0.21724292703543618,0.24636076952948316,0.3274684013714224)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.3602152415085647), xlim = c(-122.22557020614923,-66.04305214838624), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.32680223958707, -66.8943024219887,-67.46180260439036,-68.02930278679199,-68.59680296919365,-69.1643031515953,-69.73180333399694,-70.2993035163986,-70.86680369880023,-71.43430388120188,-72.00180406360352,-72.56930424600517,-73.1368044284068,-73.70430461080846,-74.27180479321012,-74.83930497561175,-75.40680515801341,-75.97430534041504,-76.5418055228167,-77.10930570521833,-77.67680588761999,-78.24430607002162,-78.81180625242328,-79.37930643482494,-79.94680661722657,-80.51430679962823,-81.08180698202986,-81.64930716443152,-82.21680734683315,-82.78430752923481,-83.35180771163644,-83.9193078940381,-84.48680807643973,-85.05430825884139,-85.62180844124305,-86.18930862364468,-86.75680880604634,-87.32430898844797,-87.89180917084963,-88.45930935325126,-89.02680953565292,-89.59430971805455,-90.1618099004562,-90.72931008285786,-91.2968102652595,-91.86431044766115,-92.43181063006278,-92.99931081246444,-93.56681099486607,-94.13431117726773,-94.70181135966936,-95.26931154207102,-95.83681172447268,-96.40431190687431,-96.97181208927597,-97.5393122716776,-98.10681245407926,-98.67431263648089,-99.24181281888255,-99.80931300128418,-100.37681318368584,-100.9443133660875,-101.51181354848913,-102.07931373089079,-102.64681391329242,-103.21431409569408,-103.78181427809571,-104.34931446049737,-104.916814642899,-105.48431482530066,-106.05181500770232,-106.61931519010395,-107.1868153725056,-107.75431555490724,-108.3218157373089,-108.88931591971053,-109.45681610211219,-110.02431628451382,-110.59181646691547,-111.15931664931713,-111.72681683171876,-112.29431701412042,-112.86181719652205,-113.42931737892371,-113.99681756132534,-114.564317743727,-115.13181792612863,-115.69931810853029,-116.26681829093192,-116.83431847333358,-117.40181865573524,-117.96931883813687,-118.53681902053853,-119.10431920294016,-119.67181938534182,-120.23931956774345,-120.80681975014511,-121.37431993254674,-121.9418201149484)
counts=c(0.002, 0.004,0.001,0.001,0.001,0.001,0.0,0.0,0.0,0.002,0.003,0.001,0.0,0.001,0.001,0.003,0.001,0.001,0.002,0.002,0.002,0.001,0.003,0.006,0.008,0.005,0.009,0.004,0.009,0.008,0.007,0.012,0.008,0.003,0.005,0.007,0.002,0.004,0.002,0.001,0.001,0.001,0.004,0.002,0.001,0.0,0.001,0.001,0.004,0.001,0.0,0.001,0.003,0.0,0.001,0.003,0.001,0.0,0.0,0.0,0.003,0.0,0.001,0.002,0.002,0.003,0.001,0.001,0.001,0.001,0.001,0.005,0.002,0.003,0.001,0.001,0.0,0.0,0.002,0.001,0.0,0.003,0.0,0.0,0.003,0.002,0.001,0.003,0.004,0.001,0.007,0.003,0.002,0.012,0.01,0.008,0.018,0.018,0.011)
plot(mids,counts,type = 'h', xlim = c(-122.22557020614923,-66.04305214838624), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.031912870374088874
bf6 = 0.19586953835962417
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.32396473867504, -66.88578991925269,-67.4476150998303,-68.00944028040794,-68.57126546098559,-69.1330906415632,-69.69491582214084,-70.25674100271846,-70.8185661832961,-71.38039136387371,-71.94221654445136,-72.50404172502897,-73.06586690560661,-73.62769208618425,-74.18951726676187,-74.75134244733951,-75.31316762791712,-75.87499280849477,-76.43681798907238,-76.99864316965002,-77.56046835022767,-78.12229353080528,-78.68411871138292,-79.24594389196054,-79.80776907253818,-80.36959425311579,-80.93141943369343,-81.49324461427105,-82.05506979484869,-82.61689497542633,-83.17872015600395,-83.74054533658159,-84.3023705171592,-84.86419569773685,-85.42602087831446,-85.9878460588921,-86.54967123946972,-87.11149642004736,-87.673321600625,-88.23514678120262,-88.79697196178026,-89.35879714235787,-89.92062232293551,-90.48244750351313,-91.04427268409077,-91.60609786466841,-92.16792304524603,-92.72974822582367,-93.29157340640128,-93.85339858697893,-94.41522376755654,-94.97704894813418,-95.5388741287118,-96.10069930928944,-96.66252448986708,-97.2243496704447,-97.78617485102234,-98.34800003159995,-98.9098252121776,-99.47165039275521,-100.03347557333285,-100.5953007539105,-101.1571259344881,-101.71895111506575,-102.28077629564336,-102.842601476221,-103.40442665679862,-103.96625183737626,-104.52807701795388,-105.08990219853152,-105.65172737910916,-106.21355255968678,-106.77537774026442,-107.33720292084203,-107.89902810141967,-108.46085328199729,-109.02267846257493,-109.58450364315254,-110.14632882373019,-110.70815400430783,-111.26997918488544,-111.83180436546309,-112.3936295460407,-112.95545472661834,-113.51727990719596,-114.0791050877736,-114.64093026835121,-115.20275544892885,-115.7645806295065,-116.32640581008411,-116.88823099066175,-117.45005617123937,-118.01188135181701,-118.57370653239462,-119.13553171297227,-119.69735689354988,-120.25918207412752,-120.82100725470517,-121.38283243528278,-121.94465761586042)
rate=c(2.4080395598073174, 0.06696463382430407,0.05813766705329541,0.05792366014517881,0.05792366014517881,0.05792366014517881,0.05804446489376548,0.05792366014517881,0.05792366014517881,0.057806245490216644,0.057806245490216644,0.057599739878497876,0.05712490547016916,0.05676219491862766,0.056702170684736486,0.056376683551938006,0.0562585985328721,0.056224805706258624,0.05619847213065288,0.055951341910556326,0.054190243078654034,0.05316972525649938,0.052680296433627635,0.05227347599514677,0.0516482898929031,0.051206114792941314,0.050348853269625946,0.04988485644575534,0.04941679206265376,0.049061064266764154,0.04887774839474444,0.04887774839474444,0.048746974505860186,0.048514066576227144,0.048379541614552116,0.04831482747502853,0.04825494373173401,0.04812751127132486,0.04812603868980503,0.048054909079629574,0.04793554162980018,0.047758953910359406,0.0475753565181097,0.047468808442394955,0.04735783175135491,0.047328866427595734,0.04729872227700872,0.047272260074687884,0.04726278477955004,0.04722238477153371,0.04722238477153371,0.04716312129198402,0.04716312129198402,0.047140825444878125,0.047140825444878125,0.04711058161090341,0.047024189576162057,0.047024189576162057,0.047024189576162057,0.046955208118659296,0.046955208118659296,0.046955208118659296,0.046955208118659296,0.046955208118659296,0.046955208118659296,0.046955208118659296,0.046955208118659296,0.046955208118659296,0.04689363559457392,0.04689363559457392,0.04689363559457392,0.04689363559457392,0.04689363559457392,0.04689363559457392,0.04686623298496076,0.04686623298496076,0.04686623298496076,0.04686623298496076,0.04686623298496076,0.04686623298496076,0.04689363559457392,0.04689363559457392,0.04689363559457392,0.04689363559457392,0.04689363559457392,0.04689363559457392,0.04692316179449541,0.04692316179449541,0.04692316179449541,0.04692316179449541,0.046955208118659296,0.046955208118659296,0.046955208118659296,0.04692316179449541,0.046955208118659296,0.046955208118659296,0.04711058161090341,0.04711058161090341,0.04711058161090341,0.047140825444878125)
minHPD=c(0.7173566973694757, 0.020936160589304944,0.02433165183241257,0.025816375159844404,0.025816375159844404,0.026655749939219167,0.02433165183241257,0.025816375159844404,0.025816375159844404,0.025816375159844404,0.025816375159844404,0.025816375159844404,0.026004973065531692,0.025816375159844404,0.025816375159844404,0.025978338432942914,0.02347393594824879,0.02347393594824879,0.02226401979759513,0.02339997088529693,0.006332880734640061,0.009780917702426705,0.006332880734640061,0.005323426673386166,0.006332880734640061,0.005323426673386166,0.005413747886631406,0.005323426673386166,0.006154994501507706,0.004319123121141819,0.005323426673386166,0.005323426673386166,0.005323426673386166,0.005323426673386166,0.005323426673386166,0.005323426673386166,0.0055839273375515456,0.0055839273375515456,0.0055839273375515456,0.0020635409088376796,0.0020635409088376796,0.0020635409088376796,0.0020635409088376796,0.0020635409088376796,0.0020635409088376796,0.0017671706003970918,0.0017671706003970918,0.0019048506627071537,0.0019048506627071537,0.0017671706003970918,0.0017671706003970918,0.0019048506627071537,0.0019048506627071537,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0017671706003970918,0.0014139905083233265,0.0014139905083233265,0.0014139905083233265,0.0014139905083233265,0.0014139905083233265,0.0014139905083233265,0.0014139905083233265,0.0014139905083233265,0.0014139905083233265,0.0014139905083233265,0.0014139905083233265,0.0014139905083233265,0.0014139905083233265,0.0010988530682870693,0.0010988530682870693,0.0010988530682870693,0.0010988530682870693,0.004492585811188641,0.004492585811188641,0.004319123121141819,0.004319123121141819,0.004319123121141819,0.004319123121141819,0.004026413558316729,0.004026413558316729,0.004026413558316729,0.0025092279094818025)
maxHPD=c(5.183421975010712, 2.210934683763189,0.1425186437213472,0.13834816476774725,0.13834816476774725,0.13834816476774725,0.1353176935236492,0.13617428597080472,0.13617428597080472,0.13617428597080472,0.1353176935236492,0.1348756987645943,0.13110633298628574,0.12867742084572903,0.12842797695522984,0.12764698518117876,0.12393310942155786,0.12304161717705121,0.12393310942155786,0.12304161717705121,0.10706024748121594,0.10099295924275391,0.09691226330380046,0.09387797175940148,0.09174106354288611,0.08907634618120122,0.0829094856172451,0.08180337463024592,0.0822766675276365,0.07890072493019461,0.07953698496694768,0.07953698496694768,0.07931325828982032,0.07876555478007477,0.07890072493019461,0.07876555478007477,0.07890072493019461,0.07890072493019461,0.07890072493019461,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07516650228914053,0.07516650228914053,0.07490917482428955,0.07490917482428955,0.07490917482428955,0.07490917482428955,0.07453615514949805,0.07453615514949805,0.07490917482428955,0.07490917482428955,0.07490917482428955,0.07516650228914053,0.07516650228914053,0.07516650228914053,0.07516650228914053,0.07516650228914053,0.07516650228914053,0.07516650228914053,0.07516650228914053,0.07516650228914053,0.07516650228914053,0.07516650228914053,0.07516650228914053,0.07516650228914053,0.07516650228914053,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07534367918497367,0.07890072493019461,0.07890072493019461,0.07890072493019461,0.07890072493019461,0.07890072493019461,0.07890072493019461,0.07953698496694768,0.07953698496694768,0.07990868256898027,0.07876555478007477)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 5.701764172511784), xlim = c(-122.22557020614923,-66.04305214838624), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.32680223958707, -66.8943024219887,-67.46180260439036,-68.02930278679199,-68.59680296919365,-69.1643031515953,-69.73180333399694,-70.2993035163986,-70.86680369880023,-71.43430388120188,-72.00180406360352,-72.56930424600517,-73.1368044284068,-73.70430461080846,-74.27180479321012,-74.83930497561175,-75.40680515801341,-75.97430534041504,-76.5418055228167,-77.10930570521833,-77.67680588761999,-78.24430607002162,-78.81180625242328,-79.37930643482494,-79.94680661722657,-80.51430679962823,-81.08180698202986,-81.64930716443152,-82.21680734683315,-82.78430752923481,-83.35180771163644,-83.9193078940381,-84.48680807643973,-85.05430825884139,-85.62180844124305,-86.18930862364468,-86.75680880604634,-87.32430898844797,-87.89180917084963,-88.45930935325126,-89.02680953565292,-89.59430971805455,-90.1618099004562,-90.72931008285786,-91.2968102652595,-91.86431044766115,-92.43181063006278,-92.99931081246444,-93.56681099486607,-94.13431117726773,-94.70181135966936,-95.26931154207102,-95.83681172447268,-96.40431190687431,-96.97181208927597,-97.5393122716776,-98.10681245407926,-98.67431263648089,-99.24181281888255,-99.80931300128418,-100.37681318368584,-100.9443133660875,-101.51181354848913,-102.07931373089079,-102.64681391329242,-103.21431409569408,-103.78181427809571,-104.34931446049737,-104.916814642899,-105.48431482530066,-106.05181500770232,-106.61931519010395,-107.1868153725056,-107.75431555490724,-108.3218157373089,-108.88931591971053,-109.45681610211219,-110.02431628451382,-110.59181646691547,-111.15931664931713,-111.72681683171876,-112.29431701412042,-112.86181719652205,-113.42931737892371,-113.99681756132534,-114.564317743727,-115.13181792612863,-115.69931810853029,-116.26681829093192,-116.83431847333358,-117.40181865573524,-117.96931883813687,-118.53681902053853,-119.10431920294016,-119.67181938534182,-120.23931956774345,-120.80681975014511,-121.37431993254674,-121.9418201149484)
counts=c(0.786, 0.207,0.008,0.001,0.002,0.001,0.001,0.002,0.002,0.002,0.003,0.007,0.009,0.003,0.005,0.005,0.001,0.005,0.013,0.036,0.028,0.013,0.009,0.013,0.016,0.022,0.01,0.013,0.011,0.0,0.001,0.004,0.005,0.002,0.003,0.002,0.004,0.001,0.003,0.002,0.004,0.003,0.001,0.001,0.003,0.001,0.001,0.001,0.001,0.0,0.002,0.0,0.002,0.001,0.001,0.001,0.0,0.002,0.001,0.0,0.002,0.0,0.0,0.0,0.0,0.0,0.003,0.0,0.0,0.0,0.0,0.002,0.001,0.0,0.0,0.0,0.0,0.0,0.001,0.001,0.0,0.0,0.0,0.0,0.003,0.0,0.0,0.0,0.001,0.0,0.001,0.001,0.001,0.0,0.004,0.0,0.001,0.002,0.0)
plot(mids,counts,type = 'h', xlim = c(-122.22557020614923,-66.04305214838624), ylim=c(0,0.786), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.32396473867504, -66.88578991925269,-67.4476150998303,-68.00944028040794,-68.57126546098559,-69.1330906415632,-69.69491582214084,-70.25674100271846,-70.8185661832961,-71.38039136387371,-71.94221654445136,-72.50404172502897,-73.06586690560661,-73.62769208618425,-74.18951726676187,-74.75134244733951,-75.31316762791712,-75.87499280849477,-76.43681798907238,-76.99864316965002,-77.56046835022767,-78.12229353080528,-78.68411871138292,-79.24594389196054,-79.80776907253818,-80.36959425311579,-80.93141943369343,-81.49324461427105,-82.05506979484869,-82.61689497542633,-83.17872015600395,-83.74054533658159,-84.3023705171592,-84.86419569773685,-85.42602087831446,-85.9878460588921,-86.54967123946972,-87.11149642004736,-87.673321600625,-88.23514678120262,-88.79697196178026,-89.35879714235787,-89.92062232293551,-90.48244750351313,-91.04427268409077,-91.60609786466841,-92.16792304524603,-92.72974822582367,-93.29157340640128,-93.85339858697893,-94.41522376755654,-94.97704894813418,-95.5388741287118,-96.10069930928944,-96.66252448986708,-97.2243496704447,-97.78617485102234,-98.34800003159995,-98.9098252121776,-99.47165039275521,-100.03347557333285,-100.5953007539105,-101.1571259344881,-101.71895111506575,-102.28077629564336,-102.842601476221,-103.40442665679862,-103.96625183737626,-104.52807701795388,-105.08990219853152,-105.65172737910916,-106.21355255968678,-106.77537774026442,-107.33720292084203,-107.89902810141967,-108.46085328199729,-109.02267846257493,-109.58450364315254,-110.14632882373019,-110.70815400430783,-111.26997918488544,-111.83180436546309,-112.3936295460407,-112.95545472661834,-113.51727990719596,-114.0791050877736,-114.64093026835121,-115.20275544892885,-115.7645806295065,-116.32640581008411,-116.88823099066175,-117.45005617123937,-118.01188135181701,-118.57370653239462,-119.13553171297227,-119.69735689354988,-120.25918207412752,-120.82100725470517,-121.38283243528278,-121.94465761586042)
net_rate=c(-2.5554967693629487, -0.3686950003591056,0.00997182977864889,0.017432770758628757,0.017386660456703857,0.017742830818777804,0.017750699821867215,0.017938375861269045,0.01797411154944431,0.018003932205668705,0.01800030009745381,0.01831014107693449,0.019174612323753695,0.0198213914302752,0.02027214852202358,0.02068206611834181,0.02110899632749574,0.021230371135226318,0.021224384033190605,0.022038208838472757,0.025229397048260008,0.028084280684576298,0.02933482654309367,0.030338432644740086,0.03180500023107151,0.03347101038759924,0.03595331143222751,0.03742186331483935,0.038543470111773115,0.04184300271110473,0.04872705136375612,0.051056192638724573,0.049252341043934895,0.046635121209286506,0.04732694727627862,0.05062525536088515,0.04965574782302962,0.0475885218520299,0.04520106806341408,0.044534094924835864,0.04464030254442132,0.044846669754989764,0.044997999805497554,0.04535703192620116,0.04503846548661339,0.04508275290157995,0.04511778608836092,0.04523007021689201,0.0450138463404966,0.044257203648404804,0.04407855001590004,0.04414639594288102,0.043673488045981326,0.043721889938781906,0.04360958976598566,0.043631898608769225,0.04355957494569052,0.043565303523117334,0.04355644085861517,0.04360754171322604,0.043677766351704776,0.04376044220117517,0.04377740447328539,0.04377740447328539,0.04359889065889418,0.043795886116496596,0.04368774820229102,0.043691027091114616,0.04372495615394724,0.04400844244730873,0.04417984876205101,0.04417984876205101,0.044181323134997404,0.0444818706184899,0.04463577195580195,0.04477303310572493,0.044675328966391516,0.044712074483741766,0.044712074483741766,0.044712074483741766,0.04531884685630072,0.04532101849213645,0.04532101849213645,0.04581299812892488,0.04581299812892488,0.04589377997931333,0.04603532593039345,0.046237124212953756,0.04657967943122461,0.04698727964848024,0.048491807831047506,0.04854818756570041,0.049705877538642904,0.04997711030615896,0.050292159016769394,0.05399094516330184,0.05757490045170875,0.0597431243421376,0.06823198541725749,0.0843230094298933)
net_minHPD=c(-5.153422276604344, -2.220803576209997,-0.062150621300959025,-0.05601616288558135,-0.05601616288558135,-0.05601616288558135,-0.05601616288558135,-0.05601616288558135,-0.05601616288558135,-0.05601616288558135,-0.05601616288558135,-0.054720578761260255,-0.04918697545054482,-0.046894187852476635,-0.046894187852476635,-0.046894187852476635,-0.04788220428413649,-0.04788220428413649,-0.046662236759425685,-0.046894187852476635,-0.039478150830395436,-0.03605025516250185,-0.032047987338874526,-0.024003286032870705,-0.021678649042749354,-0.016813139166378964,-0.01366626108435462,-0.013613997118800333,-0.01366626108435462,-0.01366626108435462,-0.014728485907324187,-0.014896515328216016,-0.010415939368417136,-0.016813139166378964,-0.009955990500301826,-0.01366626108435462,-0.010415939368417136,-0.00931587828319623,-0.016813139166378964,-0.016813139166378964,-0.016813139166378964,-0.014896515328216016,-0.014896515328216016,-0.00918164558070328,-0.00918164558070328,-0.00918164558070328,-0.00918164558070328,-0.00918164558070328,-0.00918164558070328,-0.008974321758248388,-0.008974321758248388,-0.008974321758248388,-0.008974321758248388,-0.00918164558070328,-0.00918164558070328,-0.00918164558070328,-0.00931587828319623,-0.00931587828319623,-0.00931587828319623,-0.00931587828319623,-0.00931587828319623,-0.00931587828319623,-0.00931587828319623,-0.00931587828319623,-0.010415939368417136,-0.01366626108435462,-0.01366626108435462,-0.01366626108435462,-0.014728485907324187,-0.014896515328216016,-0.014896515328216016,-0.014896515328216016,-0.014896515328216016,-0.016861439385369784,-0.016861439385369784,-0.016861439385369784,-0.016861439385369784,-0.016861439385369784,-0.016861439385369784,-0.016861439385369784,-0.016861439385369784,-0.016861439385369784,-0.016861439385369784,-0.018917072360395366,-0.018917072360395366,-0.018917072360395366,-0.024595394779713745,-0.024595394779713745,-0.018917072360395366,-0.018917072360395366,-0.024595394779713745,-0.024595394779713745,-0.035929877404610136,-0.035929877404610136,-0.039993201664395746,-0.035929877404610136,-0.03021756394141128,-0.03837558731054068,-0.054747062116528654,-0.054747062116528654)
net_maxHPD=c(-0.6647422723991626, 0.09309333450454356,0.08480297420123303,0.08350621696366411,0.0820068983255798,0.07984634742977598,0.07984634742977598,0.07934226463476393,0.07934226463476393,0.07934226463476393,0.07934226463476393,0.07984634742977598,0.08015136980423433,0.08015136980423433,0.07933093325146136,0.07671076365230667,0.07671076365230667,0.07671076365230667,0.07934226463476393,0.07671076365230667,0.08350621696366411,0.08350621696366411,0.08829617662118285,0.09309333450454356,0.09309333450454356,0.0959023481947125,0.09631386184623661,0.09631386184623661,0.09631386184623661,0.09703487720431425,0.09863994496837704,0.10379260124443046,0.10934894350991303,0.09863994496837704,0.1082637954281742,0.10771942148790548,0.1082637954281742,0.10771942148790548,0.09863994496837704,0.09863994496837704,0.09863994496837704,0.1012876081861083,0.1012876081861083,0.10771942148790548,0.10771942148790548,0.10771942148790548,0.10771942148790548,0.10771942148790548,0.10771942148790548,0.10771942148790548,0.10771942148790548,0.10771942148790548,0.10771942148790548,0.10771942148790548,0.1082637954281742,0.1082637954281742,0.1082637954281742,0.10934894350991303,0.10934894350991303,0.10934894350991303,0.10934894350991303,0.11001086881619027,0.1108299829986091,0.1108299829986091,0.1108299829986091,0.1082637954281742,0.10890474233367517,0.10890474233367517,0.1082637954281742,0.1082637954281742,0.10934894350991303,0.10934894350991303,0.10934894350991303,0.10890474233367517,0.10934894350991303,0.11001086881619027,0.1108299829986091,0.1108299829986091,0.1108299829986091,0.1108299829986091,0.1154173361457245,0.1154173361457245,0.1154173361457245,0.1154173361457245,0.1154173361457245,0.1154173361457245,0.11001086881619027,0.1108299829986091,0.12047962098777058,0.12089547700622327,0.12089547700622327,0.12089547700622327,0.12169072828018074,0.12384468090916004,0.12384468090916004,0.14905319001523987,0.1745059411534144,0.1745059411534144,0.22039480825293614,0.35062497562723416)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-5.668764504264779, 0.3856874731899576), xlim = c(-122.22557020614923,-66.04305214838624), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.32396473867504, -66.88578991925269,-67.4476150998303,-68.00944028040794,-68.57126546098559,-69.1330906415632,-69.69491582214084,-70.25674100271846,-70.8185661832961,-71.38039136387371,-71.94221654445136,-72.50404172502897,-73.06586690560661,-73.62769208618425,-74.18951726676187,-74.75134244733951,-75.31316762791712,-75.87499280849477,-76.43681798907238,-76.99864316965002,-77.56046835022767,-78.12229353080528,-78.68411871138292,-79.24594389196054,-79.80776907253818,-80.36959425311579,-80.93141943369343,-81.49324461427105,-82.05506979484869,-82.61689497542633,-83.17872015600395,-83.74054533658159,-84.3023705171592,-84.86419569773685,-85.42602087831446,-85.9878460588921,-86.54967123946972,-87.11149642004736,-87.673321600625,-88.23514678120262,-88.79697196178026,-89.35879714235787,-89.92062232293551,-90.48244750351313,-91.04427268409077,-91.60609786466841,-92.16792304524603,-92.72974822582367,-93.29157340640128,-93.85339858697893,-94.41522376755654,-94.97704894813418,-95.5388741287118,-96.10069930928944,-96.66252448986708,-97.2243496704447,-97.78617485102234,-98.34800003159995,-98.9098252121776,-99.47165039275521,-100.03347557333285,-100.5953007539105,-101.1571259344881,-101.71895111506575,-102.28077629564336,-102.842601476221,-103.40442665679862,-103.96625183737626,-104.52807701795388,-105.08990219853152,-105.65172737910916,-106.21355255968678,-106.77537774026442,-107.33720292084203,-107.89902810141967,-108.46085328199729,-109.02267846257493,-109.58450364315254,-110.14632882373019,-110.70815400430783,-111.26997918488544,-111.83180436546309,-112.3936295460407,-112.95545472661834,-113.51727990719596,-114.0791050877736,-114.64093026835121,-115.20275544892885,-115.7645806295065,-116.32640581008411,-116.88823099066175,-117.45005617123937,-118.01188135181701,-118.57370653239462,-119.13553171297227,-119.69735689354988,-120.25918207412752,-120.82100725470517,-121.38283243528278,-121.94465761586042)
rate=c(0.37875902487623453, 2.2062043596711107,13.557967038350855,15.085905153934409,15.101129433506008,15.1707164455096,15.159937772441673,15.203193245322595,15.211457578096374,15.218360864707943,15.209313007090522,15.241814884605791,15.445324186143662,15.59076363279872,15.7011054637985,15.80807485864429,15.864847823683299,15.887932173049759,15.876389711282615,16.05897724343731,16.90916644733618,17.729563833021523,18.112957056231,18.368029743452684,18.780526805576258,19.144896759597472,19.875392540102048,20.168593223839565,20.443661278979043,20.740231243803073,20.828799612589705,20.828799612589705,20.886986646670252,21.04649555162334,21.10475804898874,21.169818827480935,21.235940510097635,21.34038983391039,21.361842452351368,21.43955951743804,21.488489766621605,21.529894788493035,21.600271065076235,21.650129773367606,21.697969184132386,21.741550161283207,21.758122796603363,21.811410074940348,21.824129746716164,21.847841534996125,21.847841534996125,21.880274382615013,21.87907323638161,21.90799603163377,21.812629043238786,21.82324855268398,21.83148476305747,21.843716623299983,21.83948863955908,21.863889101288105,21.897510181664106,21.897510181664106,21.912769742994126,21.912769742994126,21.912769742994126,21.912769742994126,21.912769742994126,21.912769742994126,21.974174356721164,21.974174356721164,21.974174356721164,21.974174356721164,21.974174356721164,21.97774373171309,21.995431264986195,21.995431264986195,21.995431264986195,21.995431264986195,21.995431264986195,21.995431264986195,21.981918863769977,21.982968258630798,21.982968258630798,21.982968258630798,21.982968258630798,21.982968258630798,21.94789107079924,21.94789107079924,21.94789107079924,21.94789107079924,21.896164112839823,21.896164112839823,21.86591175922937,21.885868587083674,21.87831423709753,21.87831423709753,21.421753194711453,21.421753194711453,21.36321160543036,21.11579567467813)
minHPD=c(0.37875902487623453, 2.2062043596711107,13.557967038350855,15.085905153934409,15.101129433506008,15.1707164455096,15.159937772441673,15.203193245322595,15.211457578096374,15.218360864707943,15.209313007090522,15.241814884605791,15.445324186143662,15.59076363279872,15.7011054637985,15.80807485864429,15.864847823683299,15.887932173049759,15.876389711282615,16.05897724343731,16.90916644733618,17.729563833021523,18.112957056231,18.368029743452684,18.780526805576258,19.144896759597472,19.875392540102048,20.168593223839565,20.443661278979043,20.740231243803073,20.828799612589705,20.828799612589705,20.886986646670252,21.04649555162334,21.10475804898874,21.169818827480935,21.235940510097635,21.34038983391039,21.361842452351368,21.43955951743804,21.488489766621605,21.529894788493035,21.600271065076235,21.650129773367606,21.697969184132386,21.741550161283207,21.758122796603363,21.811410074940348,21.824129746716164,21.847841534996125,21.847841534996125,21.880274382615013,21.87907323638161,21.90799603163377,21.812629043238786,21.82324855268398,21.83148476305747,21.843716623299983,21.83948863955908,21.863889101288105,21.897510181664106,21.897510181664106,21.912769742994126,21.912769742994126,21.912769742994126,21.912769742994126,21.912769742994126,21.912769742994126,21.974174356721164,21.974174356721164,21.974174356721164,21.974174356721164,21.974174356721164,21.97774373171309,21.995431264986195,21.995431264986195,21.995431264986195,21.995431264986195,21.995431264986195,21.995431264986195,21.981918863769977,21.982968258630798,21.982968258630798,21.982968258630798,21.982968258630798,21.982968258630798,21.94789107079924,21.94789107079924,21.94789107079924,21.94789107079924,21.896164112839823,21.896164112839823,21.86591175922937,21.885868587083674,21.87831423709753,21.87831423709753,21.421753194711453,21.421753194711453,21.36321160543036,21.11579567467813)
maxHPD=c(0.37875902487623453, 2.2062043596711107,13.557967038350855,15.085905153934409,15.101129433506008,15.1707164455096,15.159937772441673,15.203193245322595,15.211457578096374,15.218360864707943,15.209313007090522,15.241814884605791,15.445324186143662,15.59076363279872,15.7011054637985,15.80807485864429,15.864847823683299,15.887932173049759,15.876389711282615,16.05897724343731,16.90916644733618,17.729563833021523,18.112957056231,18.368029743452684,18.780526805576258,19.144896759597472,19.875392540102048,20.168593223839565,20.443661278979043,20.740231243803073,20.828799612589705,20.828799612589705,20.886986646670252,21.04649555162334,21.10475804898874,21.169818827480935,21.235940510097635,21.34038983391039,21.361842452351368,21.43955951743804,21.488489766621605,21.529894788493035,21.600271065076235,21.650129773367606,21.697969184132386,21.741550161283207,21.758122796603363,21.811410074940348,21.824129746716164,21.847841534996125,21.847841534996125,21.880274382615013,21.87907323638161,21.90799603163377,21.812629043238786,21.82324855268398,21.83148476305747,21.843716623299983,21.83948863955908,21.863889101288105,21.897510181664106,21.897510181664106,21.912769742994126,21.912769742994126,21.912769742994126,21.912769742994126,21.912769742994126,21.912769742994126,21.974174356721164,21.974174356721164,21.974174356721164,21.974174356721164,21.974174356721164,21.97774373171309,21.995431264986195,21.995431264986195,21.995431264986195,21.995431264986195,21.995431264986195,21.995431264986195,21.981918863769977,21.982968258630798,21.982968258630798,21.982968258630798,21.982968258630798,21.982968258630798,21.94789107079924,21.94789107079924,21.94789107079924,21.94789107079924,21.896164112839823,21.896164112839823,21.86591175922937,21.885868587083674,21.87831423709753,21.87831423709753,21.421753194711453,21.421753194711453,21.36321160543036,21.11579567467813)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 24.194974391484816), xlim = c(-122.22557020614923,-66.04305214838624), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()