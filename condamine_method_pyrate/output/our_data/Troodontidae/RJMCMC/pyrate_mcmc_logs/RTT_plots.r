

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.36424225056884, -67.0510754512805,-67.73790865199214,-68.4247418527038,-69.11157505341545,-69.7984082541271,-70.48524145483876,-71.1720746555504,-71.85890785626206,-72.54574105697371,-73.23257425768537,-73.91940745839702,-74.60624065910866,-75.29307385982032,-75.97990706053197,-76.66674026124363,-77.35357346195528,-78.04040666266692,-78.72723986337859,-79.41407306409023,-80.10090626480189,-80.78773946551354,-81.47457266622519,-82.16140586693685,-82.84823906764849,-83.53507226836015,-84.2219054690718,-84.90873866978345,-85.5955718704951,-86.28240507120675,-86.96923827191841,-87.65607147263006,-88.3429046733417,-89.02973787405337,-89.71657107476501,-90.40340427547667,-91.09023747618832,-91.77707067689997,-92.46390387761163,-93.15073707832327,-93.83757027903494,-94.52440347974658,-95.21123668045823,-95.89806988116989,-96.58490308188154,-97.2717362825932,-97.95856948330484,-98.64540268401649,-99.33223588472815,-100.01906908543981,-100.70590228615146,-101.3927354868631,-102.07956868757475,-102.76640188828641,-103.45323508899807,-104.14006828970972,-104.82690149042136,-105.51373469113301,-106.20056789184467,-106.88740109255633,-107.57423429326798,-108.26106749397962,-108.94790069469127,-109.63473389540293,-110.32156709611459,-111.00840029682624,-111.69523349753788,-112.38206669824953,-113.06889989896119,-113.75573309967285,-114.4425663003845,-115.12939950109615,-115.81623270180779,-116.50306590251945,-117.18989910323111,-117.87673230394276,-118.5635655046544,-119.25039870536605,-119.93723190607771,-120.62406510678937,-121.31089830750102,-121.99773150821267,-122.68456470892431,-123.37139790963597,-124.05823111034763,-124.74506431105928,-125.43189751177093,-126.11873071248259,-126.80556391319423,-127.4923971139059,-128.17923031461754,-128.8660635153292,-129.55289671604086,-130.2397299167525,-130.92656311746416,-131.6133963181758,-132.30022951888745,-132.9870627195991,-133.67389592031074,-134.36072912102242)
rate=c(0.08940145889825299, 0.08940145889825299,0.08940871170768791,0.08940871170768791,0.08940871170768791,0.08941505742025385,0.08941505742025385,0.08941505742025385,0.08941505742025385,0.0894270301441698,0.0894270301441698,0.08943946414733571,0.08943946414733571,0.08947241939123624,0.08949918609312438,0.08949918609312438,0.08954669313488726,0.08956319859879602,0.08957615051870811,0.08957615051870811,0.08957615051870811,0.08957615051870811,0.08957615051870811,0.08957615051870811,0.08958864885586534,0.08962624953104659,0.08972374417099,0.08979654895231645,0.08966771330688572,0.08966771330688572,0.08962624953104659,0.08958864885586534,0.08958864885586534,0.08962624953104659,0.08962624953104659,0.08962624953104659,0.08957615051870811,0.08957615051870811,0.08957615051870811,0.08957615051870811,0.08957615051870811,0.08956319859879602,0.08956319859879602,0.08956319859879602,0.08956319859879602,0.08956319859879602,0.08954669313488726,0.08954669313488726,0.08956319859879602,0.08958864885586534,0.08958864885586534,0.08962624953104659,0.08962624953104659,0.08966771330688572,0.08962624953104659,0.08966771330688572,0.08966771330688572,0.08966771330688572,0.08969144110989422,0.08969144110989422,0.08969144110989422,0.08969144110989422,0.08969144110989422,0.08979654895231645,0.08979654895231645,0.08979654895231645,0.08979654895231645,0.08979654895231645,0.08985342206883436,0.08999546788568513,0.08999546788568513,0.08985342206883436,0.08979654895231645,0.08972374417099,0.08972374417099,0.08972374417099,0.08972374417099,0.08972374417099,0.08972374417099,0.08972374417099,0.08972374417099,0.08999546788568513,0.08999546788568513,0.09077672511140841,0.09214201792552328,0.11211658870226192,1.183509003089671,1.4014925601302552,1.4437167536621571,1.4477830750889202,1.4477830750889202,1.4477830750889202,1.4477830750889202,1.4437167536621571,1.445050861421241,1.445050861421241,1.444270002592041,1.444270002592041,1.444270002592041,1.4504308128740342)
minHPD=c(0.053741420819296094, 0.053741420819296094,0.053129003049079235,0.053129003049079235,0.053129003049079235,0.053129003049079235,0.053363139278627195,0.053363139278627195,0.053363139278627195,0.053741420819296094,0.053741420819296094,0.053968011217129255,0.053968011217129255,0.053968011217129255,0.053129003049079235,0.053129003049079235,0.053129003049079235,0.053129003049079235,0.053129003049079235,0.053129003049079235,0.053363139278627195,0.053363139278627195,0.053363139278627195,0.053363139278627195,0.053129003049079235,0.053741420819296094,0.053129003049079235,0.053129003049079235,0.053129003049079235,0.053129003049079235,0.053129003049079235,0.053129003049079235,0.05536621247541279,0.05536621247541279,0.05536621247541279,0.05536621247541279,0.053968011217129255,0.053968011217129255,0.053968011217129255,0.053968011217129255,0.053968011217129255,0.05559349172938768,0.05536621247541279,0.05559349172938768,0.05559349172938768,0.05559349172938768,0.05536621247541279,0.05536621247541279,0.05559349172938768,0.05536621247541279,0.05536621247541279,0.05536621247541279,0.05536621247541279,0.05536621247541279,0.05536621247541279,0.053968011217129255,0.053968011217129255,0.053968011217129255,0.05404876319077976,0.05404876319077976,0.053968011217129255,0.053968011217129255,0.053968011217129255,0.053968011217129255,0.053968011217129255,0.053968011217129255,0.053968011217129255,0.053968011217129255,0.053741420819296094,0.053363139278627195,0.053363139278627195,0.053363139278627195,0.053968011217129255,0.053741420819296094,0.053741420819296094,0.053363139278627195,0.053129003049079235,0.053129003049079235,0.0513646046769513,0.053129003049079235,0.053129003049079235,0.053363139278627195,0.0513646046769513,0.03592725853686401,0.03592725853686401,0.03592725853686401,0.05404876319077976,0.06152315014289354,0.31141590532001984,0.32343723589890166,0.31141590532001984,0.32343723589890166,0.32343723589890166,0.32343723589890166,0.32343723589890166,0.32343723589890166,0.32343723589890166,0.32343723589890166,0.31141590532001984,0.31141590532001984)
maxHPD=c(0.13129365144957827, 0.13129365144957827,0.13028433300778763,0.13028433300778763,0.13028433300778763,0.13028433300778763,0.13028433300778763,0.13028433300778763,0.13028433300778763,0.13028433300778763,0.13028433300778763,0.13028433300778763,0.13028433300778763,0.13028433300778763,0.12849089840930097,0.12849089840930097,0.12849089840930097,0.12807774583791484,0.12807774583791484,0.12807774583791484,0.12807774583791484,0.12807774583791484,0.12807774583791484,0.12807774583791484,0.12807774583791484,0.13028433300778763,0.13028433300778763,0.13102552711766258,0.13129365144957827,0.13129365144957827,0.13129365144957827,0.13129365144957827,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13175559503512663,0.13175559503512663,0.13175559503512663,0.13175559503512663,0.13175559503512663,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13335780603108646,0.13335780603108646,0.13335780603108646,0.13356523658363936,0.13356523658363936,0.13335780603108646,0.13335780603108646,0.13335780603108646,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13356523658363936,0.13540533619356507,0.13540533619356507,0.13540533619356507,0.13540533619356507,0.13540533619356507,0.13540533619356507,0.13540533619356507,0.1383467564505071,0.1390995084521791,0.141414468397839,0.141414468397839,0.1481904465274568,0.6009335514550974,1.8481677009857,2.661214736734043,3.1913905449575837,3.4716913232254742,3.414211625437128,3.414211625437128,3.414211625437128,3.414211625437128,3.414211625437128,3.4309723242181,3.442555963178049,3.442555963178049,3.442555963178049,3.4309723242181,3.4309723242181)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 3.818860455548022), xlim = c(-134.70414572137824,-66.02082565021301), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.36771110511788, -67.06148201492763,-67.75525292473739,-68.44902383454715,-69.14279474435688,-69.83656565416663,-70.53033656397639,-71.22410747378615,-71.91787838359588,-72.61164929340563,-73.30542020321539,-73.99919111302515,-74.69296202283488,-75.38673293264463,-76.08050384245439,-76.77427475226415,-77.46804566207388,-78.16181657188363,-78.85558748169339,-79.54935839150315,-80.24312930131288,-80.93690021112263,-81.63067112093239,-82.32444203074212,-83.01821294055188,-83.71198385036163,-84.40575476017139,-85.09952566998112,-85.79329657979088,-86.48706748960063,-87.18083839941039,-87.87460930922012,-88.56838021902988,-89.26215112883963,-89.95592203864939,-90.64969294845912,-91.34346385826888,-92.03723476807863,-92.73100567788839,-93.42477658769812,-94.11854749750788,-94.81231840731763,-95.50608931712739,-96.19986022693712,-96.89363113674688,-97.58740204655663,-98.28117295636639,-98.97494386617612,-99.66871477598588,-100.36248568579563,-101.05625659560536,-101.75002750541512,-102.44379841522488,-103.13756932503463,-103.83134023484436,-104.52511114465412,-105.21888205446388,-105.91265296427363,-106.60642387408336,-107.30019478389312,-107.99396569370288,-108.68773660351263,-109.38150751332236,-110.07527842313212,-110.76904933294188,-111.46282024275163,-112.15659115256136,-112.85036206237112,-113.54413297218088,-114.23790388199063,-114.93167479180036,-115.62544570161012,-116.31921661141988,-117.01298752122963,-117.70675843103936,-118.40052934084912,-119.09430025065888,-119.78807116046863,-120.48184207027836,-121.17561298008812,-121.86938388989788,-122.5631547997076,-123.25692570951736,-123.95069661932712,-124.64446752913688,-125.3382384389466,-126.03200934875636,-126.72578025856612,-127.41955116837588,-128.1133220781856,-128.80709298799536,-129.50086389780512,-130.19463480761485,-130.8884057174246,-131.58217662723436,-132.27594753704412,-132.96971844685388,-133.6634893566636,-134.35726026647336)
counts=c(0.0, 0.001,0.001,0.0,0.001,0.002,0.0,0.001,0.001,0.001,0.002,0.0,0.001,0.001,0.0,0.004,0.0,0.002,0.001,0.001,0.0,0.0,0.0,0.001,0.006,0.003,0.006,0.005,0.003,0.001,0.001,0.001,0.002,0.001,0.001,0.002,0.0,0.001,0.0,0.001,0.003,0.0,0.002,0.0,0.002,0.0,0.002,0.0,0.002,0.0,0.002,0.001,0.001,0.004,0.001,0.0,0.002,0.0,0.001,0.0,0.0,0.001,0.002,0.0,0.0,0.0,0.001,0.002,0.0,0.001,0.003,0.002,0.0,0.0,0.001,0.001,0.001,0.004,0.003,0.007,0.002,0.013,0.045,0.275,0.443,0.179,0.043,0.012,0.006,0.003,0.004,0.005,0.008,0.004,0.008,0.003,0.006,0.004,0.0)
plot(mids,counts,type = 'h', xlim = c(-134.70414572137824,-66.02082565021301), ylim=c(0,0.443), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03263319687330622
bf6 = 0.19952789000846893
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.36424225056884, -67.0510754512805,-67.73790865199214,-68.4247418527038,-69.11157505341545,-69.7984082541271,-70.48524145483876,-71.1720746555504,-71.85890785626206,-72.54574105697371,-73.23257425768537,-73.91940745839702,-74.60624065910866,-75.29307385982032,-75.97990706053197,-76.66674026124363,-77.35357346195528,-78.04040666266692,-78.72723986337859,-79.41407306409023,-80.10090626480189,-80.78773946551354,-81.47457266622519,-82.16140586693685,-82.84823906764849,-83.53507226836015,-84.2219054690718,-84.90873866978345,-85.5955718704951,-86.28240507120675,-86.96923827191841,-87.65607147263006,-88.3429046733417,-89.02973787405337,-89.71657107476501,-90.40340427547667,-91.09023747618832,-91.77707067689997,-92.46390387761163,-93.15073707832327,-93.83757027903494,-94.52440347974658,-95.21123668045823,-95.89806988116989,-96.58490308188154,-97.2717362825932,-97.95856948330484,-98.64540268401649,-99.33223588472815,-100.01906908543981,-100.70590228615146,-101.3927354868631,-102.07956868757475,-102.76640188828641,-103.45323508899807,-104.14006828970972,-104.82690149042136,-105.51373469113301,-106.20056789184467,-106.88740109255633,-107.57423429326798,-108.26106749397962,-108.94790069469127,-109.63473389540293,-110.32156709611459,-111.00840029682624,-111.69523349753788,-112.38206669824953,-113.06889989896119,-113.75573309967285,-114.4425663003845,-115.12939950109615,-115.81623270180779,-116.50306590251945,-117.18989910323111,-117.87673230394276,-118.5635655046544,-119.25039870536605,-119.93723190607771,-120.62406510678937,-121.31089830750102,-121.99773150821267,-122.68456470892431,-123.37139790963597,-124.05823111034763,-124.74506431105928,-125.43189751177093,-126.11873071248259,-126.80556391319423,-127.4923971139059,-128.17923031461754,-128.8660635153292,-129.55289671604086,-130.2397299167525,-130.92656311746416,-131.6133963181758,-132.30022951888745,-132.9870627195991,-133.67389592031074,-134.36072912102242)
rate=c(1.818840766321876, 0.0866929828230015,0.08059486600747279,0.07967107555711922,0.07915872751916728,0.07904505547823151,0.07903070139510415,0.07903070139510415,0.07904505547823151,0.07904505547823151,0.07903070139510415,0.07903070139510415,0.07903070139510415,0.0790195777278529,0.0790195777278529,0.0790195777278529,0.0790195777278529,0.0790195777278529,0.07900871696657225,0.0789658833087156,0.0789658833087156,0.07888703303268402,0.07888703303268402,0.07880990605612723,0.07877303574969842,0.07876153299459973,0.07876153299459973,0.07876153299459973,0.07876153299459973,0.07876153299459973,0.07876153299459973,0.07876153299459973,0.07876153299459973,0.07876153299459973,0.07876153299459973,0.07873948761943501,0.07873948761943501,0.07873948761943501,0.07877303574969842,0.07877303574969842,0.07880990605612723,0.07888703303268402,0.0790195777278529,0.07903070139510415,0.07903070139510415,0.07903070139510415,0.07906046356995358,0.07915872751916728,0.07928678459915045,0.07942730943284636,0.07944244525075073,0.07956168264818661,0.07979918189955945,0.0800505664643905,0.08021611066157769,0.08059486600747279,0.08107050195431437,0.08147590088131172,0.0819252581180274,0.08249960210745422,0.08301099310433921,0.08381818602750646,0.08445378714014211,0.08491378021922076,0.08503350962763406,0.08628730158593284,0.08674346621325033,0.08725030820251597,0.08729266477771688,0.08786708799789572,0.08855364617285663,0.08979988065097069,0.09015873075710584,0.09087906550010168,0.0914340772280757,0.09257666801702197,0.09357007786778268,0.09396390501679816,0.09423107003441678,0.09445302886183568,0.09452838371494668,0.09466723337601343,0.09477257226846883,0.09466723337601343,0.09477767011925385,0.0948083590487927,0.09487407730737897,0.09543124533124088,0.09663179095358591,0.09859179662156627,0.09954407349705584,0.1031170623880519,0.10427626670472737,0.10760024169135048,0.11158203938362224,0.11780210479573103,0.1304756756391946,0.14070181109512941,0.1530946344041949,0.16915684970635103)
minHPD=c(0.2654313611504056, 0.024941421157474813,0.026886225786537314,0.03914205720855454,0.04154717203603799,0.0422387192045407,0.0422387192045407,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.04303899950872721,0.0422387192045407,0.0422387192045407,0.0422387192045407,0.04154717203603799,0.04154717203603799,0.0422387192045407,0.0422387192045407,0.0422387192045407,0.03919288811952861,0.03914205720855454,0.0422387192045407,0.03914205720855454,0.03914205720855454,0.03914205720855454,0.03552930817961067,0.03919288811952861,0.03552930817961067,0.03919288811952861,0.03919288811952861,0.03446224731218568,0.024854147605023424,0.028505594156505956,0.0422387192045407,0.04238532360224876,0.04321082839931328,0.04238532360224876,0.04238532360224876,0.04513811547581785,0.04303899950872721,0.04321082839931328,0.04238532360224876,0.04238532360224876,0.04238532360224876,0.04238532360224876,0.04546859335986241,0.04238532360224876,0.04238532360224876,0.04321082839931328,0.04238532360224876,0.05068164856018353,0.04914020411138352,0.04914020411138352,0.05068164856018353,0.04914020411138352,0.04914020411138352,0.04914020411138352,0.05091357865830071,0.05068164856018353,0.04914020411138352,0.04238532360224876,0.04321082839931328,0.04321082839931328,0.04238532360224876,0.04238532360224876,0.04321082839931328,0.04238532360224876,0.04238532360224876,0.04238532360224876,0.04238532360224876,0.03922285339320103,0.03922285339320103,0.03922285339320103)
maxHPD=c(4.251736852807039, 1.4213825802612745,0.1490677420699511,0.1239182187775898,0.11984813394620068,0.11879440339668416,0.11856532584373344,0.11879440339668416,0.11879440339668416,0.11856532584373344,0.11833922910713084,0.11833922910713084,0.11833922910713084,0.11785595920017304,0.11785595920017304,0.11785595920017304,0.11785595920017304,0.11785595920017304,0.11799661583676875,0.11833922910713084,0.11833922910713084,0.11833922910713084,0.11833922910713084,0.11799661583676875,0.11799661583676875,0.11799661583676875,0.11799661583676875,0.11799661583676875,0.11799661583676875,0.11799661583676875,0.11799661583676875,0.11799661583676875,0.11799661583676875,0.11799661583676875,0.11799661583676875,0.11799661583676875,0.11833922910713084,0.11856532584373344,0.11856532584373344,0.11856532584373344,0.11879440339668416,0.11879440339668416,0.11879440339668416,0.11984813394620068,0.11984813394620068,0.11984813394620068,0.11984813394620068,0.12140516083461012,0.12531633209434573,0.12243440368981685,0.12316103200854144,0.12531633209434573,0.12471059192415214,0.13367771687747418,0.13367771687747418,0.1442199558422194,0.14917485361925942,0.14917485361925942,0.1513668629609308,0.17320589209842285,0.19073813644021947,0.2053123963258809,0.214966694282103,0.22272960939884806,0.22272960939884806,0.23114876979091012,0.23114876979091012,0.23114876979091012,0.23114876979091012,0.23485546810596175,0.2457957921925635,0.25270387092160973,0.2580353275000348,0.261917545448086,0.261917545448086,0.27557396054418787,0.2988903742133755,0.31119546595736947,0.3107379175660798,0.31119546595736947,0.31119546595736947,0.3107379175660798,0.3107379175660798,0.3107379175660798,0.315311903738433,0.315311903738433,0.3168025648127056,0.3346474252976663,0.3731055486766048,0.5285366779598779,0.9203459054057422,1.2700887231267683,1.421144826184696,1.5500122578650972,1.904385703560408,2.0264533139690104,2.091786458765179,2.211087195198017,2.383084744353347,2.470929195403056)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 4.676910538087744), xlim = c(-134.70414572137824,-66.02082565021301), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.36771110511788, -67.06148201492763,-67.75525292473739,-68.44902383454715,-69.14279474435688,-69.83656565416663,-70.53033656397639,-71.22410747378615,-71.91787838359588,-72.61164929340563,-73.30542020321539,-73.99919111302515,-74.69296202283488,-75.38673293264463,-76.08050384245439,-76.77427475226415,-77.46804566207388,-78.16181657188363,-78.85558748169339,-79.54935839150315,-80.24312930131288,-80.93690021112263,-81.63067112093239,-82.32444203074212,-83.01821294055188,-83.71198385036163,-84.40575476017139,-85.09952566998112,-85.79329657979088,-86.48706748960063,-87.18083839941039,-87.87460930922012,-88.56838021902988,-89.26215112883963,-89.95592203864939,-90.64969294845912,-91.34346385826888,-92.03723476807863,-92.73100567788839,-93.42477658769812,-94.11854749750788,-94.81231840731763,-95.50608931712739,-96.19986022693712,-96.89363113674688,-97.58740204655663,-98.28117295636639,-98.97494386617612,-99.66871477598588,-100.36248568579563,-101.05625659560536,-101.75002750541512,-102.44379841522488,-103.13756932503463,-103.83134023484436,-104.52511114465412,-105.21888205446388,-105.91265296427363,-106.60642387408336,-107.30019478389312,-107.99396569370288,-108.68773660351263,-109.38150751332236,-110.07527842313212,-110.76904933294188,-111.46282024275163,-112.15659115256136,-112.85036206237112,-113.54413297218088,-114.23790388199063,-114.93167479180036,-115.62544570161012,-116.31921661141988,-117.01298752122963,-117.70675843103936,-118.40052934084912,-119.09430025065888,-119.78807116046863,-120.48184207027836,-121.17561298008812,-121.86938388989788,-122.5631547997076,-123.25692570951736,-123.95069661932712,-124.64446752913688,-125.3382384389466,-126.03200934875636,-126.72578025856612,-127.41955116837588,-128.1133220781856,-128.80709298799536,-129.50086389780512,-130.19463480761485,-130.8884057174246,-131.58217662723436,-132.27594753704412,-132.96971844685388,-133.6634893566636,-134.35726026647336)
counts=c(0.808, 0.143,0.03,0.014,0.003,0.001,0.001,0.002,0.002,0.001,0.0,0.003,0.0,0.0,0.0,0.0,0.001,0.001,0.001,0.0,0.001,0.0,0.001,0.001,0.001,0.001,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.001,0.001,0.001,0.002,0.0,0.002,0.001,0.003,0.0,0.0,0.004,0.002,0.004,0.001,0.003,0.003,0.005,0.006,0.005,0.012,0.004,0.008,0.01,0.006,0.012,0.016,0.015,0.015,0.007,0.01,0.018,0.007,0.005,0.006,0.019,0.015,0.011,0.015,0.011,0.016,0.019,0.012,0.006,0.005,0.004,0.002,0.005,0.003,0.001,0.004,0.005,0.008,0.019,0.024,0.021,0.03,0.023,0.03,0.034,0.03,0.026,0.031,0.025,0.02,0.0)
plot(mids,counts,type = 'h', xlim = c(-134.70414572137824,-66.02082565021301), ylim=c(0,0.808), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.36424225056884, -67.0510754512805,-67.73790865199214,-68.4247418527038,-69.11157505341545,-69.7984082541271,-70.48524145483876,-71.1720746555504,-71.85890785626206,-72.54574105697371,-73.23257425768537,-73.91940745839702,-74.60624065910866,-75.29307385982032,-75.97990706053197,-76.66674026124363,-77.35357346195528,-78.04040666266692,-78.72723986337859,-79.41407306409023,-80.10090626480189,-80.78773946551354,-81.47457266622519,-82.16140586693685,-82.84823906764849,-83.53507226836015,-84.2219054690718,-84.90873866978345,-85.5955718704951,-86.28240507120675,-86.96923827191841,-87.65607147263006,-88.3429046733417,-89.02973787405337,-89.71657107476501,-90.40340427547667,-91.09023747618832,-91.77707067689997,-92.46390387761163,-93.15073707832327,-93.83757027903494,-94.52440347974658,-95.21123668045823,-95.89806988116989,-96.58490308188154,-97.2717362825932,-97.95856948330484,-98.64540268401649,-99.33223588472815,-100.01906908543981,-100.70590228615146,-101.3927354868631,-102.07956868757475,-102.76640188828641,-103.45323508899807,-104.14006828970972,-104.82690149042136,-105.51373469113301,-106.20056789184467,-106.88740109255633,-107.57423429326798,-108.26106749397962,-108.94790069469127,-109.63473389540293,-110.32156709611459,-111.00840029682624,-111.69523349753788,-112.38206669824953,-113.06889989896119,-113.75573309967285,-114.4425663003845,-115.12939950109615,-115.81623270180779,-116.50306590251945,-117.18989910323111,-117.87673230394276,-118.5635655046544,-119.25039870536605,-119.93723190607771,-120.62406510678937,-121.31089830750102,-121.99773150821267,-122.68456470892431,-123.37139790963597,-124.05823111034763,-124.74506431105928,-125.43189751177093,-126.11873071248259,-126.80556391319423,-127.4923971139059,-128.17923031461754,-128.8660635153292,-129.55289671604086,-130.2397299167525,-130.92656311746416,-131.6133963181758,-132.30022951888745,-132.9870627195991,-133.67389592031074,-134.36072912102242)
net_rate=c(-1.9261181019201716, -0.19198399545912836,-0.014399616744133235,0.00423799659441121,0.009058436209323461,0.00982049184251196,0.010114660314991626,0.010263201305932244,0.010216685561459583,0.010416715435939507,0.010520451067713342,0.010554843691501073,0.010581133410736675,0.010750184110585396,0.010822572842394578,0.010822572842394578,0.011001235610942335,0.011076082126495164,0.011171085519542708,0.011256770660513529,0.011215473703587215,0.011248165497746765,0.011248165497746765,0.01131958900591055,0.01172631516589878,0.013519798639514188,0.014248662012526418,0.014092004683922594,0.013127687097031316,0.012150462296167088,0.012068604397172273,0.012044726263691534,0.012066443475854113,0.012123446328013272,0.012123446328013272,0.012120781841060734,0.011710692459730531,0.011658917954527307,0.01148356890084164,0.01148356890084164,0.011405900760414206,0.011381113594345672,0.011122462866394785,0.010993729075866559,0.010993729075866559,0.010993729075866559,0.010546515889743324,0.010307989934589007,0.010037201763146757,0.01000024628732339,0.00977982735335028,0.009316412690451375,0.008737352899390668,0.007436998990784529,0.006741041833771544,0.005894023298590838,0.0049825549394488695,0.004459697836487187,0.0033101439048019857,0.0014733562735582094,0.00022389700951053022,-0.0025942428027700298,-0.004792040505581749,-0.005693564626586816,-0.006218391704847237,-0.008717170462378144,-0.010623363630005635,-0.012000621535767373,-0.012249230448118925,-0.012890802977614288,-0.01527117746598591,-0.01814421452938925,-0.02019512868251197,-0.02461760629448529,-0.02436622435516869,-0.027902596324168097,-0.032340272970047844,-0.034677774375014556,-0.03566782385464786,-0.03581853473098506,-0.03488792243990314,-0.03371681388319507,-0.032625162037314456,-0.02397356052346601,0.016864234749952092,0.41074349099580587,1.0825231268007605,1.4426077332422034,1.471262486875891,1.4496139690406704,1.4147742383743778,1.367012126274905,1.3458842778044573,1.3039341685533328,1.2574029728834508,1.2140828510595632,1.1766677523512987,1.1370421214980055,1.109965032168579,1.0854454722227478)
net_minHPD=c(-4.1769593850763655, -1.3262613294561614,-0.06406310832832053,-0.043966124347041405,-0.04152979761871421,-0.04152979761871421,-0.042027673998592086,-0.042027673998592086,-0.042027673998592086,-0.04121550948099083,-0.0395193474028972,-0.0395193474028972,-0.0395193474028972,-0.04020993467715554,-0.04020993467715554,-0.04020993467715554,-0.04020993467715554,-0.04020993467715554,-0.0395193474028972,-0.0395193474028972,-0.0395193474028972,-0.0395193474028972,-0.0395193474028972,-0.04020993467715554,-0.0395193474028972,-0.04141524214897992,-0.042027673998592086,-0.04152979761871421,-0.04152979761871421,-0.04152979761871421,-0.04152979761871421,-0.04152979761871421,-0.04152979761871421,-0.04152979761871421,-0.04152979761871421,-0.04152979761871421,-0.042027673998592086,-0.04152979761871421,-0.04152979761871421,-0.04152979761871421,-0.04152979761871421,-0.04299585284356478,-0.043966124347041405,-0.043966124347041405,-0.043966124347041405,-0.043966124347041405,-0.04578895635328978,-0.04152979761871421,-0.04299585284356478,-0.0438174760730973,-0.044533092476081296,-0.04578895635328978,-0.049251003867203366,-0.05093767585641516,-0.05206228049455681,-0.05839087046485823,-0.05839087046485823,-0.05914411839792347,-0.06550752346161773,-0.08863610474742357,-0.10000995551024058,-0.10862666139069932,-0.12229621983866444,-0.14644571671074386,-0.14427624980229645,-0.14784957222580664,-0.1511011399385832,-0.1511011399385832,-0.15259710281090394,-0.1528919409721366,-0.16153047040183732,-0.1672403243802203,-0.17308116412541308,-0.1866926098013744,-0.1866926098013744,-0.20744969091203386,-0.22284976719649718,-0.22579886470745802,-0.22959372927568628,-0.23060561043809796,-0.22959372927568628,-0.23369813195156813,-0.23611539730678177,-0.2638377217788473,-0.317863107137523,-0.2638377217788473,-0.16327007835850577,-0.06601979567599803,-0.021442337229697683,0.09327540956988489,-0.03881880203618793,-0.3118322774203701,-0.5803273651870944,-0.8017193008503338,-1.2787359623100267,-1.6823143823920201,-1.6823143823920201,-1.6823143823920201,-1.6823143823920201,-1.7760758596704695)
net_maxHPD=c(-0.2076894909569353, 0.09615579999093334,0.09615579999093334,0.07139818635754043,0.06562996886890564,0.06509796372009534,0.06392247073879839,0.06392247073879839,0.06392247073879839,0.06392247073879839,0.06521901458084833,0.06509796372009534,0.06509796372009534,0.06392247073879839,0.06392247073879839,0.06392247073879839,0.06392247073879839,0.06392247073879839,0.06509796372009534,0.06521901458084833,0.06509796372009534,0.06509796372009534,0.06509796372009534,0.06392247073879839,0.06509796372009534,0.06392247073879839,0.06392247073879839,0.06509796372009534,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06392247073879839,0.06509796372009534,0.06521901458084833,0.06521901458084833,0.06562996886890564,0.06562996886890564,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06562996886890564,0.07139818635754043,0.07091933219233473,0.07091933219233473,0.07091933219233473,0.07091933219233473,0.07091933219233473,0.07493992777026202,0.07493992777026202,0.07441735180803669,0.08037779268696249,0.08339932491482986,0.09386012217075278,0.08084932422816077,0.07493992777026202,0.08084932422816077,0.0826828518476741,0.06562996886890564,0.06562996886890564,0.06521901458084833,0.06509796372009534,0.06521901458084833,0.06521901458084833,0.06878075929825583,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06521901458084833,0.06878075929825583,0.07493992777026202,0.4955918446424991,1.7385552910868718,2.5937249614347184,3.1763846436029914,3.3700272722699767,3.6353972816663926,3.6353972816663926,3.6068364626103486,3.5735257335590362,3.6353972816663926,3.6353972816663926,3.3887256990860624,3.3887256990860624,3.3887256990860624,3.3887256990860624,3.3700272722699767)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-4.594655323584003, 3.9989370098330324), xlim = c(-134.70414572137824,-66.02082565021301), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.36424225056884, -67.0510754512805,-67.73790865199214,-68.4247418527038,-69.11157505341545,-69.7984082541271,-70.48524145483876,-71.1720746555504,-71.85890785626206,-72.54574105697371,-73.23257425768537,-73.91940745839702,-74.60624065910866,-75.29307385982032,-75.97990706053197,-76.66674026124363,-77.35357346195528,-78.04040666266692,-78.72723986337859,-79.41407306409023,-80.10090626480189,-80.78773946551354,-81.47457266622519,-82.16140586693685,-82.84823906764849,-83.53507226836015,-84.2219054690718,-84.90873866978345,-85.5955718704951,-86.28240507120675,-86.96923827191841,-87.65607147263006,-88.3429046733417,-89.02973787405337,-89.71657107476501,-90.40340427547667,-91.09023747618832,-91.77707067689997,-92.46390387761163,-93.15073707832327,-93.83757027903494,-94.52440347974658,-95.21123668045823,-95.89806988116989,-96.58490308188154,-97.2717362825932,-97.95856948330484,-98.64540268401649,-99.33223588472815,-100.01906908543981,-100.70590228615146,-101.3927354868631,-102.07956868757475,-102.76640188828641,-103.45323508899807,-104.14006828970972,-104.82690149042136,-105.51373469113301,-106.20056789184467,-106.88740109255633,-107.57423429326798,-108.26106749397962,-108.94790069469127,-109.63473389540293,-110.32156709611459,-111.00840029682624,-111.69523349753788,-112.38206669824953,-113.06889989896119,-113.75573309967285,-114.4425663003845,-115.12939950109615,-115.81623270180779,-116.50306590251945,-117.18989910323111,-117.87673230394276,-118.5635655046544,-119.25039870536605,-119.93723190607771,-120.62406510678937,-121.31089830750102,-121.99773150821267,-122.68456470892431,-123.37139790963597,-124.05823111034763,-124.74506431105928,-125.43189751177093,-126.11873071248259,-126.80556391319423,-127.4923971139059,-128.17923031461754,-128.8660635153292,-129.55289671604086,-130.2397299167525,-130.92656311746416,-131.6133963181758,-132.30022951888745,-132.9870627195991,-133.67389592031074,-134.36072912102242)
rate=c(0.4958611169810108, 3.5390762034718954,9.520367442096667,11.573823736668082,12.257691609468619,12.355677569163896,12.397265811806964,12.420137521739653,12.41311942955422,12.433201910223142,12.449258541301234,12.449258541301234,12.452217391953367,12.471357802601288,12.471357802601288,12.471357802601288,12.471357802601288,12.47168600802592,12.482914363763303,12.494511775771805,12.494511775771805,12.499617469609099,12.499617469609099,12.510786681226882,12.516679796717401,12.532810763120597,12.534012155151256,12.534012155151256,12.534012155151256,12.534012155151256,12.530421817629,12.530421817629,12.530421817629,12.530421817629,12.530421817629,12.533509248041794,12.528301739169844,12.520180566318862,12.492540580697021,12.492540580697021,12.480431162848072,12.466588266549719,12.421049993808525,12.404096845836305,12.404096845836305,12.404096845836305,12.333508481606115,12.29733143090879,12.249563395590554,12.211369698592716,12.178589598680787,12.100055023643712,12.015864006015574,11.823851770732352,11.758471096997205,11.6133477197753,11.491705727907556,11.423069983848219,11.263388562764996,11.035089631796113,10.88974677033856,10.565503830829659,10.325731667397838,10.204118114547283,10.149449727681674,9.898413785176094,9.715106353478808,9.586832549202354,9.560097028185861,9.491133818086967,9.281443249498361,9.043573951221804,8.877051560441938,8.545496415001901,8.563893228799719,8.314942655092361,8.02173765265458,7.873093694396376,7.809757327428478,7.787190965310058,7.817540033703893,7.79878773768551,7.7961356446321615,7.789591372742685,7.752450549479109,7.697091345273685,7.614885067626422,7.104793784445457,5.878331570126384,4.964103650344621,4.222476111510713,3.5023762533373484,3.25512071997382,2.881590381923372,2.49740708877594,2.2511784918395357,2.0942615996490166,1.9325936325362563,1.8455386855942997,1.7538560568902386)
minHPD=c(0.4958611169810108, 3.5390762034718954,9.520367442096667,11.573823736668082,12.257691609468619,12.355677569163896,12.397265811806964,12.420137521739653,12.41311942955422,12.433201910223142,12.449258541301234,12.449258541301234,12.452217391953367,12.471357802601288,12.471357802601288,12.471357802601288,12.471357802601288,12.47168600802592,12.482914363763303,12.494511775771805,12.494511775771805,12.499617469609099,12.499617469609099,12.510786681226882,12.516679796717401,12.532810763120597,12.534012155151256,12.534012155151256,12.534012155151256,12.534012155151256,12.530421817629,12.530421817629,12.530421817629,12.530421817629,12.530421817629,12.533509248041794,12.528301739169844,12.520180566318862,12.492540580697021,12.492540580697021,12.480431162848072,12.466588266549719,12.421049993808525,12.404096845836305,12.404096845836305,12.404096845836305,12.333508481606115,12.29733143090879,12.249563395590554,12.211369698592716,12.178589598680787,12.100055023643712,12.015864006015574,11.823851770732352,11.758471096997205,11.6133477197753,11.491705727907556,11.423069983848219,11.263388562764996,11.035089631796113,10.88974677033856,10.565503830829659,10.325731667397838,10.204118114547283,10.149449727681674,9.898413785176094,9.715106353478808,9.586832549202354,9.560097028185861,9.491133818086967,9.281443249498361,9.043573951221804,8.877051560441938,8.545496415001901,8.563893228799719,8.314942655092361,8.02173765265458,7.873093694396376,7.809757327428478,7.787190965310058,7.817540033703893,7.79878773768551,7.7961356446321615,7.789591372742685,7.752450549479109,7.697091345273685,7.614885067626422,7.104793784445457,5.878331570126384,4.964103650344621,4.222476111510713,3.5023762533373484,3.25512071997382,2.881590381923372,2.49740708877594,2.2511784918395357,2.0942615996490166,1.9325936325362563,1.8455386855942997,1.7538560568902386)
maxHPD=c(0.4958611169810108, 3.5390762034718954,9.520367442096667,11.573823736668082,12.257691609468619,12.355677569163896,12.397265811806964,12.420137521739653,12.41311942955422,12.433201910223142,12.449258541301234,12.449258541301234,12.452217391953367,12.471357802601288,12.471357802601288,12.471357802601288,12.471357802601288,12.47168600802592,12.482914363763303,12.494511775771805,12.494511775771805,12.499617469609099,12.499617469609099,12.510786681226882,12.516679796717401,12.532810763120597,12.534012155151256,12.534012155151256,12.534012155151256,12.534012155151256,12.530421817629,12.530421817629,12.530421817629,12.530421817629,12.530421817629,12.533509248041794,12.528301739169844,12.520180566318862,12.492540580697021,12.492540580697021,12.480431162848072,12.466588266549719,12.421049993808525,12.404096845836305,12.404096845836305,12.404096845836305,12.333508481606115,12.29733143090879,12.249563395590554,12.211369698592716,12.178589598680787,12.100055023643712,12.015864006015574,11.823851770732352,11.758471096997205,11.6133477197753,11.491705727907556,11.423069983848219,11.263388562764996,11.035089631796113,10.88974677033856,10.565503830829659,10.325731667397838,10.204118114547283,10.149449727681674,9.898413785176094,9.715106353478808,9.586832549202354,9.560097028185861,9.491133818086967,9.281443249498361,9.043573951221804,8.877051560441938,8.545496415001901,8.563893228799719,8.314942655092361,8.02173765265458,7.873093694396376,7.809757327428478,7.787190965310058,7.817540033703893,7.79878773768551,7.7961356446321615,7.789591372742685,7.752450549479109,7.697091345273685,7.614885067626422,7.104793784445457,5.878331570126384,4.964103650344621,4.222476111510713,3.5023762533373484,3.25512071997382,2.881590381923372,2.49740708877594,2.2511784918395357,2.0942615996490166,1.9325936325362563,1.8455386855942997,1.7538560568902386)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 13.787413370666382), xlim = c(-134.70414572137824,-66.02082565021301), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()