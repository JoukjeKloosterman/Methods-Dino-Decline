# 1 files combined:
# 	./PyRate_Inputs_2_BDMCMC_Grj_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='./PyRate_Inputs_2_BDMCMC_Grj_marginal_rates_RTT.pdf',width=10.8, height=8.4)
par(mfrow=c(2,2))
library(scales)
plot_RTT <- function (age,hpd_M,hpd_m,mean_m,color){
    N=100
    beta=(1:(N-1))/N
    alpha_shape=0.25
    cat=1-(beta^(1./alpha_shape))
    for (i in 1:(N-1)){
        trans= 1/N + 2/N
        polygon(c(age, rev(age)), c(hpd_M-((hpd_M-mean_m)*cat[i]), rev(hpd_m+((mean_m-hpd_m)*cat[i]))), col = alpha(color,trans), border = NA)
    }
    lines(rev(age), rev(mean_m), col = color, lwd=3)
}
    
L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.033132845297311,0.033132845297311,0.034170276833524,0.034390557631366,0.035407659388269,0.035407659388269,0.035407659388269,0.035554231716987,0.035554231716987,0.035554231716987,0.035407659388269,0.035407659388269,0.036279137392553,0.035923321981121,0.036522135614682,0.036522135614682,0.035923321981121,0.037615710340222,0.035923321981121,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.03718623914533,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.03718623914533,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.03718623914533,0.03718623914533,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.036522135614682,0.036522135614682,0.037725770912942,0.03718623914533,0.03718623914533,0.03718623914533,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.036522135614682,0.036522135614682,0.036522135614682,0.036522135614682,0.036522135614682,0.036279137392553,0.035923321981121,0.037090063607033,0.037090063607033,0.037090063607033,0.037090063607033,0.03718623914533,0.037090063607033,0.037431744303712,0.037090063607033,0.035923321981121,0.034390557631366,0.028352001099836,0.011155280488353,0.027296947713953)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.075068440448936,0.075359951977402,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075359951977402,0.075068440448936,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.077612314506227,0.080597125366333,0.076979334022678,0.074791546422418,0.074106934449482,0.074106934449482,0.074106934449482,0.074106934449482,0.074106934449482,0.074106934449482,0.073925871897691,0.073925871897691,0.073440605465798,0.073440605465798,0.073440605465798,0.073440605465798,0.073440605465798,0.073925871897691,0.074106934449482,0.073925871897691,0.073925871897691,0.073925871897691,0.073925871897691,0.074106934449482,0.074106934449482,0.074106934449482,0.074106934449482,0.074106934449482,0.074106934449482,0.074106934449482,0.074106934449482,0.074106934449482,0.074106934449482,0.074106934449482,0.074106934449482,0.074106934449482,0.075660834634537,0.075359951977402,0.075359951977402,0.075359951977402,0.075359951977402,0.075359951977402,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.075660834634537,0.076257078403613,0.078031837006164,0.078031837006164,0.078931810110979,0.079068812698501,0.079566750399445,0.07977508436553,0.080597125366333,0.080961025222847,0.080961025222847,0.080961025222847,0.090212540175157,0.211875882957203,0.744561066366308)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.024751059191146,0.020978437178329,0.020978437178329,0.024751059191146,0.024751059191146,0.024751059191146,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.02479168145351,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.024751059191146,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329,0.020978437178329)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.050666124522385,0.050666124522385,0.050666124522385,0.050666124522385,0.050666124522385,0.054231847117506,0.050418544905028,0.050418544905028,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053767558972792,0.053993831972511,0.053993831972511,0.050418544905028,0.050418544905028,0.050418544905028,0.050549088525057,0.050549088525057,0.050549088525057,0.050549088525057,0.050549088525057,0.050549088525057,0.050549088525057,0.050666124522385,0.050666124522385,0.050666124522385,0.050666124522385,0.050666124522385,0.050666124522385,0.050666124522385,0.050666124522385,0.051023370517155)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.00981817672663,-0.00981817672663,-0.00981817672663,-0.00981817672663,-0.007435949705008,-0.007435949705008,-0.007435949705008,-0.007435949705008,-0.007300328778467,-0.007435949705008,-0.007435949705008,-0.007300328778467,-0.007300328778467,-0.007300328778467,-0.007435949705008,-0.007300328778467,-0.00676066576034,-0.008875245937565,-0.008875245937565,-0.003464693364146,-0.003464693364146,-0.003464693364146,-0.003464693364146,-0.003464693364146,-0.003464693364146,-0.003320258670422,-0.003127245948806,-0.003127245948806,-0.005758771968773,-0.005758771968773,-0.005758771968773,-0.005758771968773,-0.005758771968773,-0.005758771968773,-0.005758771968773,-0.00430707925752,-0.00430707925752,-0.00430707925752,-0.00430707925752,-0.00430707925752,-0.00430707925752,-0.00430707925752,-0.00430707925752,-0.00430707925752,-0.00430707925752,-0.00430707925752,-0.00430707925752,-0.00430707925752,-0.00430707925752,-0.00430707925752,-0.005758771968773,-0.005758771968773,-0.005758771968773,-0.006561791461306,-0.006561791461306,-0.006561791461306,-0.00676066576034,-0.004043008139048,-0.007435949705008,-0.005053174374063,-0.005053174374063,-0.005053174374063,-0.005053174374063,-0.005053174374063,-0.003464693364146,-0.003464693364146,-0.00430707925752,-0.00430707925752,-0.00430707925752,-0.003464693364146,-0.003464693364146,-0.003464693364146,-0.003464693364146,-0.005758771968773,-0.00430707925752,-0.00460761445351,-0.007435949705008,-0.007435949705008,-0.006810686806875,-0.006561791461306,-0.006810686806875,-0.007435949705008,-0.006561791461306,-0.007435949705008,-0.008875245937565,-0.01035898491175,-0.014244643739018,-0.031262900790534,-0.014822902353274)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.040829065987842,0.040829065987842,0.040727932147242,0.040727932147242,0.042293459083828,0.041881860154397,0.041881860154397,0.041308069595391,0.040829065987842,0.040829065987842,0.040829065987842,0.040727932147242,0.040727932147242,0.040829065987842,0.040366632248854,0.040727932147242,0.043818737535391,0.043818737535391,0.041881860154397,0.043818737535391,0.043818737535391,0.043818737535391,0.043818737535391,0.043818737535391,0.043818737535391,0.043818737535391,0.043818737535391,0.043818737535391,0.040829065987842,0.040829065987842,0.040829065987842,0.040829065987842,0.040829065987842,0.040829065987842,0.040829065987842,0.041881860154397,0.041308069595391,0.041308069595391,0.041308069595391,0.041308069595391,0.041308069595391,0.041881860154397,0.041881860154397,0.041881860154397,0.041881860154397,0.041881860154397,0.041881860154397,0.041881860154397,0.041881860154397,0.041881860154397,0.040829065987842,0.040829065987842,0.041308069595391,0.040829065987842,0.040829065987842,0.040829065987842,0.040829065987842,0.043818737535391,0.041308069595391,0.043818737535391,0.043818737535391,0.043818737535391,0.043818737535391,0.043818737535391,0.045649700323145,0.045649700323145,0.044309451035741,0.044309451035741,0.044309451035741,0.045649700323145,0.04598034896795,0.04598034896795,0.04598034896795,0.043818737535391,0.045649700323145,0.04598034896795,0.043818737535391,0.043818737535391,0.045649700323145,0.04598034896795,0.046282323531091,0.046282323531091,0.048246592044078,0.048670232864177,0.048670232864177,0.048246592044078,0.054801738211965,0.181098687447106,0.702996896663668)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.05464844252755,0.054639235567401,0.054709948977521,0.054759897075311,0.054848648901249,0.054848648901249,0.054848648901249,0.054906223968775,0.054906223968775,0.054969390393797,0.054989879226215,0.05501969395345,0.055044826338948,0.055117742442952,0.055204808594925,0.057056602648985,0.059874612791993,0.064075989302499,0.061071204692406,0.057056445639052,0.056537001936712,0.056537001936712,0.056557444576085,0.056557444576085,0.056557444576085,0.056453212235612,0.056289729201237,0.056289729201237,0.056166458353543,0.05606967883053,0.05606967883053,0.056086496469942,0.05608014273456,0.056044117177623,0.056068695001035,0.055989671316171,0.056008157677905,0.056008157677905,0.056008157677905,0.05603164798527,0.05603164798527,0.05607523152344,0.056070860055851,0.056070860055851,0.056070860055851,0.056070860055851,0.056070860055851,0.056070860055851,0.056070860055851,0.056099887456668,0.056144647455729,0.056144647455729,0.056253292518056,0.056310028085954,0.056310028085954,0.056310028085954,0.056327384210263,0.056355179649347,0.056372815631733,0.056372815631733,0.056372815631733,0.056372815631733,0.056365092522733,0.056365092522733,0.056386758563126,0.056295429071982,0.056295429071982,0.056295373554727,0.056295373554727,0.056345511243289,0.056345511243289,0.056345511243289,0.056345511243289,0.056345511243289,0.056416284395232,0.056470791455304,0.056643342887522,0.056643342887522,0.057137691522825,0.057153165473957,0.057406140441973,0.057693344352032,0.057967208470631,0.059098314153519,0.059415879644381,0.060166256700732,0.065857630219968,0.084020780077866,0.155283375271091)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.038108418908023,0.038108418908023,0.038108418908023,0.038116940438932,0.038116940438932,0.038141594740489,0.038113620095922,0.038113620095922,0.038017836475356,0.038017836475356,0.038017836475356,0.037973231458829,0.037973231458829,0.037973231458829,0.037973231458829,0.037973231458829,0.037973231458829,0.037973231458829,0.037973231458829,0.037973231458829,0.037971968220021,0.037971968220021,0.037971968220021,0.037971968220021,0.037971968220021,0.037971968220021,0.037971968220021,0.037971968220021,0.037948846195913,0.037948846195913,0.037948846195913,0.037948846195913,0.037948846195913,0.037948846195913,0.037960469671377,0.037960469671377,0.037960469671377,0.037960469671377,0.037960469671377,0.037960469671377,0.037960469671377,0.037960469671377,0.037960469671377,0.037960469671377,0.037935389810898,0.037935389810898,0.037935389810898,0.037935389810898,0.037972859286782,0.037983632454155,0.037983632454155,0.037983632454155,0.037983632454155,0.037983632454155,0.037983632454155,0.037983632454155,0.037983632454155,0.037983632454155,0.037983632454155,0.037946166436041,0.037946166436041,0.037946166436041,0.037946166436041,0.037946166436041,0.037959945589218,0.037959945589218,0.037917246687228,0.037917246687228,0.037902570905502,0.037902570905502,0.03786263891305,0.03786263891305,0.03786263891305,0.03788102483736,0.03788102483736,0.037890208085279,0.037894682846667,0.037894682846667,0.037894682846667,0.037894682846667,0.037812275344805,0.037812275344805,0.037812275344805,0.037812275344805,0.037812275344805,0.037812275344805,0.03780676562925,0.03780676562925,0.037935482553607)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.016540023619527,0.016530816659379,0.016601530069498,0.016642956636378,0.016731708462316,0.01670705416076,0.016735028805327,0.016792603872853,0.016888387493419,0.01695155391844,0.016972042750858,0.017046462494621,0.017071594880119,0.017144510984123,0.017231577136096,0.019083371190156,0.021901381333165,0.02610275784367,0.023097973233578,0.019083214180223,0.018565033716692,0.018565033716692,0.018585476356064,0.018585476356064,0.018585476356064,0.018481244015592,0.018317760981216,0.018317760981216,0.01821761215763,0.018120832634617,0.018120832634617,0.018137650274028,0.018131296538647,0.01809527098171,0.018108225329658,0.018029201644794,0.018047688006528,0.018047688006528,0.018047688006528,0.018071178313893,0.018071178313893,0.018114761852063,0.018110390384474,0.018110390384474,0.018135470244953,0.018135470244953,0.018135470244953,0.018135470244953,0.018098000769069,0.018116255002513,0.018161015001573,0.018161015001573,0.018269660063901,0.018326395631799,0.018326395631799,0.018326395631799,0.018343751756108,0.018371547195191,0.018389183177578,0.018426649195692,0.018426649195692,0.018426649195692,0.018418926086692,0.018418926086692,0.018426812973908,0.018335483482764,0.018378182384754,0.018378126867499,0.018392802649225,0.018442940337787,0.018482872330239,0.018482872330239,0.018482872330239,0.018464486405929,0.018535259557871,0.018580583370025,0.018748660040856,0.018748660040856,0.019243008676158,0.01925848262729,0.019593865097168,0.019881069007227,0.020154933125826,0.021286038808715,0.021603604299576,0.022353981355928,0.028050864590719,0.046214014448617,0.117347892717484)
trans=0.5
age=(0:(156-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.8190171730029389), xlim = c(-163.8,-59.2), ylab = 'Speciation rate', xlab = 'Ma',main='PyRate' )
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 0.059655031829256605), xlim = c(-163.8,-59.2), ylab = 'Extinction rate', xlab = 'Ma' )
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.03438919086958741, 0.773296586330035), xlim = c(-163.8,-59.2), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
n <- dev.off()