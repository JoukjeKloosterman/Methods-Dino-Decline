

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.41276094282645, -67.31351500908781,-68.2142690753492,-69.11502314161055,-70.01577720787193,-70.91653127413329,-71.81728534039468,-72.71803940665603,-73.61879347291742,-74.51954753917877,-75.42030160544016,-76.32105567170152,-77.2218097379629,-78.12256380422426,-79.02331787048564,-79.924071936747,-80.82482600300838,-81.72558006926974,-82.62633413553112,-83.52708820179248,-84.42784226805387,-85.32859633431522,-86.2293504005766,-87.13010446683796,-88.03085853309935,-88.9316125993607,-89.83236666562209,-90.73312073188345,-91.63387479814483,-92.53462886440619,-93.43538293066757,-94.33613699692893,-95.23689106319031,-96.13764512945167,-97.03839919571305,-97.93915326197441,-98.8399073282358,-99.74066139449715,-100.64141546075854,-101.5421695270199,-102.44292359328128,-103.34367765954264,-104.24443172580402,-105.14518579206538,-106.04593985832676,-106.94669392458812,-107.8474479908495,-108.74820205711086,-109.64895612337224,-110.5497101896336,-111.45046425589499,-112.35121832215634,-113.25197238841773,-114.15272645467908,-115.05348052094047,-115.95423458720182,-116.85498865346321,-117.75574271972457,-118.65649678598595,-119.55725085224731,-120.45800491850869,-121.35875898477005,-122.25951305103143,-123.16026711729279,-124.06102118355417,-124.96177524981553,-125.86252931607692,-126.76328338233827,-127.66403744859966,-128.564791514861,-129.4655455811224,-130.36629964738376,-131.2670537136451,-132.1678077799065,-133.06856184616788,-133.96931591242924,-134.8700699786906,-135.77082404495198,-136.67157811121336,-137.57233217747472,-138.47308624373608,-139.37384030999746,-140.27459437625885,-141.1753484425202,-142.07610250878156,-142.97685657504294,-143.87761064130433,-144.7783647075657,-145.67911877382704,-146.57987284008843,-147.4806269063498,-148.38138097261117,-149.28213503887253,-150.1828891051339,-151.0836431713953,-151.98439723765665,-152.885151303918,-153.7859053701794,-154.68665943644078,-155.58741350270213)
rate=c(0.05293860045718947, 0.05293860045718947,0.052959335206753014,0.052959335206753014,0.05298081121670696,0.053012969054589965,0.05305615562303661,0.05308610906267334,0.05308610906267334,0.05308610906267334,0.05309610328836331,0.05309610328836331,0.05318701585633187,0.05318993937114315,0.05319924181253918,0.05319924181253918,0.053272141445276644,0.053272141445276644,0.05329217406481826,0.05341755467779881,0.0534385711105593,0.05345293744294856,0.05345293744294856,0.05345293744294856,0.05345293744294856,0.0534385711105593,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.05341755467779881,0.05341755467779881,0.05341755467779881,0.05341755467779881,0.05341755467779881,0.05341755467779881,0.05341755467779881,0.05341755467779881,0.05341755467779881,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534290196280342,0.0534385711105593,0.0534385711105593,0.05345293744294856,0.05345293744294856,0.05345293744294856,0.05345293744294856,0.05345293744294856,0.05345293744294856,0.05345293744294856,0.05345293744294856,0.05345293744294856,0.05345293744294856,0.0534385711105593,0.0534385711105593,0.05345293744294856,0.05345293744294856,0.05345293744294856,0.05345293744294856,0.05345293744294856,0.05345293744294856,0.05346839694155341,0.05346839694155341,0.05346839694155341,0.05346839694155341,0.05346839694155341,0.05346839694155341,0.05348015043223678,0.0534924881763046,0.0534924881763046,0.0534924881763046,0.053510632542901906,0.05352320647012529,0.053510632542901906,0.05352320647012529,0.05353755645558462,0.05359333867353412,0.053713151674819055,0.05421240802728193,0.05524032136878898,0.056660018149608526)
minHPD=c(0.03408208216290836, 0.03408208216290836,0.03408208216290836,0.03408208216290836,0.034640320383777866,0.034640320383777866,0.035381102048102187,0.035381102048102187,0.03561764857498617,0.03561764857498617,0.03566272614029378,0.03566272614029378,0.034640320383777866,0.034640320383777866,0.034640320383777866,0.034640320383777866,0.037178711804757035,0.037178711804757035,0.037178711804757035,0.03770356430212062,0.037178711804757035,0.0377566741529264,0.0377566741529264,0.0377566741529264,0.0377566741529264,0.0377566741529264,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03794108162353047,0.03770356430212062,0.03770356430212062,0.037178711804757035,0.037178711804757035,0.037178711804757035,0.037178711804757035,0.037178711804757035,0.036977913415061694,0.036977913415061694,0.036977913415061694,0.034640320383777866,0.034640320383777866,0.034640320383777866,0.03566272614029378,0.03566272614029378,0.03566272614029378,0.03566272614029378,0.034640320383777866,0.034640320383777866,0.03602534849318941,0.03602534849318941,0.03602534849318941,0.03602534849318941,0.03602534849318941,0.03602534849318941,0.03583161824060543,0.03566272614029378,0.03566272614029378,0.03566272614029378,0.035381102048102187,0.034640320383777866,0.034640320383777866,0.03408208216290836,0.03377523399820591,0.034640320383777866,0.03232760324948866,0.03232760324948866,0.03466038042656809,0.03408208216290836,0.035381102048102187,0.034640320383777866,0.03158667305116655,0.02870182807669241,0.03158667305116655,0.02870182807669241)
maxHPD=c(0.07241905443966008, 0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07221828109411237,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07097197997372916,0.07044144834822871,0.07015579186390626,0.07015579186390626,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07044144834822871,0.07044144834822871,0.07044144834822871,0.07177561015721047,0.07177561015721047,0.07177561015721047,0.07177561015721047,0.07097197997372916,0.07097197997372916,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07221828109411237,0.07241905443966008,0.07241905443966008,0.07241905443966008,0.07388689346852792,0.07241905443966008,0.07311971563803292,0.07561622421859181,0.07561622421859181,0.07818489039199354,0.07881141517114444,0.086397935593367,0.15318306263144113,0.4459056261448501,0.7152128736764983)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.7867341610441482), xlim = c(-156.0377905358328,-65.96238390969576), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.41731020578736, -67.32716279797056,-68.23701539015377,-69.14686798233697,-70.05672057452017,-70.96657316670337,-71.87642575888658,-72.78627835106978,-73.69613094325298,-74.60598353543618,-75.5158361276194,-76.4256887198026,-77.33554131198579,-78.24539390416899,-79.15524649635219,-80.0650990885354,-80.9749516807186,-81.8848042729018,-82.79465686508502,-83.70450945726822,-84.61436204945142,-85.52421464163461,-86.43406723381781,-87.34391982600101,-88.25377241818423,-89.16362501036743,-90.07347760255062,-90.98333019473384,-91.89318278691704,-92.80303537910024,-93.71288797128344,-94.62274056346664,-95.53259315564985,-96.44244574783305,-97.35229834001625,-98.26215093219946,-99.17200352438266,-100.08185611656586,-100.99170870874906,-101.90156130093226,-102.81141389311546,-103.72126648529867,-104.63111907748187,-105.54097166966508,-106.45082426184828,-107.36067685403148,-108.27052944621468,-109.18038203839788,-110.09023463058108,-111.00008722276428,-111.90993981494749,-112.81979240713069,-113.7296449993139,-114.6394975914971,-115.5493501836803,-116.4592027758635,-117.3690553680467,-118.2789079602299,-119.18876055241311,-120.09861314459631,-121.00846573677953,-121.91831832896273,-122.82817092114593,-123.73802351332913,-124.64787610551232,-125.55772869769552,-126.46758128987872,-127.37743388206194,-128.28728647424512,-129.19713906642835,-130.10699165861155,-131.01684425079475,-131.92669684297795,-132.83654943516115,-133.74640202734437,-134.65625461952757,-135.56610721171077,-136.47595980389397,-137.38581239607717,-138.29566498826037,-139.20551758044357,-140.11537017262677,-141.02522276480997,-141.93507535699317,-142.84492794917637,-143.75478054135957,-144.66463313354276,-145.574485725726,-146.4843383179092,-147.3941909100924,-148.3040435022756,-149.21389609445882,-150.12374868664202,-151.03360127882522,-151.94345387100842,-152.85330646319161,-153.7631590553748,-154.673011647558,-155.5828642397412)
counts=c(0.0, 0.001,0.0,0.001,0.003,0.001,0.002,0.002,0.001,0.001,0.001,0.003,0.001,0.001,0.0,0.005,0.0,0.002,0.002,0.001,0.002,0.0,0.001,0.001,0.0,0.001,0.0,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.001,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.001,0.0,0.001,0.0,0.0,0.001,0.001,0.0,0.0,0.002,0.001,0.0,0.001,0.0,0.0,0.0,0.002,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.001,0.001,0.0,0.0,0.002,0.002,0.001,0.003,0.001,0.002,0.002,0.002,0.001,0.002,0.004,0.005,0.014,0.028,0.061,0.067,0.123)
plot(mids,counts,type = 'h', xlim = c(-156.0377905358328,-65.96238390969576), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.033875055314730826
bf6 = 0.20576996659481225
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.41276094282645, -67.31351500908781,-68.2142690753492,-69.11502314161055,-70.01577720787193,-70.91653127413329,-71.81728534039468,-72.71803940665603,-73.61879347291742,-74.51954753917877,-75.42030160544016,-76.32105567170152,-77.2218097379629,-78.12256380422426,-79.02331787048564,-79.924071936747,-80.82482600300838,-81.72558006926974,-82.62633413553112,-83.52708820179248,-84.42784226805387,-85.32859633431522,-86.2293504005766,-87.13010446683796,-88.03085853309935,-88.9316125993607,-89.83236666562209,-90.73312073188345,-91.63387479814483,-92.53462886440619,-93.43538293066757,-94.33613699692893,-95.23689106319031,-96.13764512945167,-97.03839919571305,-97.93915326197441,-98.8399073282358,-99.74066139449715,-100.64141546075854,-101.5421695270199,-102.44292359328128,-103.34367765954264,-104.24443172580402,-105.14518579206538,-106.04593985832676,-106.94669392458812,-107.8474479908495,-108.74820205711086,-109.64895612337224,-110.5497101896336,-111.45046425589499,-112.35121832215634,-113.25197238841773,-114.15272645467908,-115.05348052094047,-115.95423458720182,-116.85498865346321,-117.75574271972457,-118.65649678598595,-119.55725085224731,-120.45800491850869,-121.35875898477005,-122.25951305103143,-123.16026711729279,-124.06102118355417,-124.96177524981553,-125.86252931607692,-126.76328338233827,-127.66403744859966,-128.564791514861,-129.4655455811224,-130.36629964738376,-131.2670537136451,-132.1678077799065,-133.06856184616788,-133.96931591242924,-134.8700699786906,-135.77082404495198,-136.67157811121336,-137.57233217747472,-138.47308624373608,-139.37384030999746,-140.27459437625885,-141.1753484425202,-142.07610250878156,-142.97685657504294,-143.87761064130433,-144.7783647075657,-145.67911877382704,-146.57987284008843,-147.4806269063498,-148.38138097261117,-149.28213503887253,-150.1828891051339,-151.0836431713953,-151.98439723765665,-152.885151303918,-153.7859053701794,-154.68665943644078,-155.58741350270213)
rate=c(3.806218607001777, 0.03553938991844272,0.03553938991844272,0.03553938991844272,0.03553938991844272,0.03553938991844272,0.03553938991844272,0.03553938991844272,0.035501825989790764,0.03549365712537464,0.03549365712537464,0.03548978795523093,0.035483697918273036,0.03546677380545143,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.035445708334572654,0.035445708334572654,0.0354359112631797,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.035445708334572654,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.035426419888197655,0.035426419888197655,0.035426419888197655,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.0354359112631797,0.035426419888197655,0.035426419888197655,0.035426419888197655,0.03542293512028779,0.03540679360851624,0.03540679360851624,0.03540679360851624,0.03540679360851624,0.03540679360851624,0.03542293512028779,0.03542293512028779,0.03542293512028779,0.03540679360851624,0.03540679360851624,0.03540679360851624)
minHPD=c(1.3981931434363661, 0.02238144511918959,0.02238144511918959,0.02238144511918959,0.02238144511918959,0.02238144511918959,0.02238144511918959,0.02016547511529777,0.023128675159593992,0.023628344422238195,0.023657271027877867,0.023657271027877867,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.02385465090979742,0.023657271027877867,0.023657271027877867,0.023657271027877867,0.023657271027877867,0.023657271027877867,0.023657271027877867,0.023657271027877867,0.023657271027877867,0.023628344422238195,0.023628344422238195,0.023628344422238195,0.023628344422238195,0.023628344422238195,0.023628344422238195,0.023628344422238195,0.023628344422238195,0.023628344422238195,0.020718935085537935,0.020718935085537935,0.020718935085537935,0.020718935085537935,0.020718935085537935,0.020718935085537935,0.020767940724137242,0.020767940724137242,0.020767940724137242,0.020767940724137242,0.020767940724137242,0.020767940724137242,0.020767940724137242,0.020767940724137242,0.020718935085537935,0.020718935085537935,0.020447246202408065,0.020447246202408065,0.020447246202408065,0.020447246202408065,0.020447246202408065,0.020447246202408065,0.020447246202408065,0.020447246202408065,0.020447246202408065,0.020447246202408065,0.020447246202408065,0.021927314077600287,0.02237087724123251,0.02237087724123251,0.02237087724123251,0.02237087724123251,0.02237087724123251,0.02237087724123251,0.02237087724123251,0.02237087724123251,0.02237087724123251,0.02226464927948963,0.02226464927948963,0.02226464927948963,0.022170737412878668,0.022170737412878668,0.022170737412878668)
maxHPD=c(7.103261666643979, 0.05240572184278305,0.05240572184278305,0.05240572184278305,0.05240572184278305,0.05240572184278305,0.05240572184278305,0.05011842938485966,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.04987621905218565,0.04987621905218565,0.04987621905218565,0.04987621905218565,0.04987621905218565,0.04987621905218565,0.04997661295156238,0.04997661295156238,0.04997661295156238,0.04997661295156238,0.04997661295156238,0.04997661295156238,0.04997661295156238,0.04997661295156238,0.04997661295156238,0.05011842938485966,0.04997661295156238,0.04997661295156238,0.04997661295156238,0.04997661295156238,0.04997661295156238,0.05011842938485966,0.05011842938485966,0.05011842938485966,0.05011842938485966,0.05011842938485966,0.05011842938485966,0.051778073305360856,0.05239171347433315,0.05239171347433315,0.05239171347433315,0.05239171347433315,0.05240572184278305,0.05240572184278305,0.05240572184278305,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532,0.05242306690054532)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 7.813587833308378), xlim = c(-156.0377905358328,-65.96238390969576), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.41731020578736, -67.32716279797056,-68.23701539015377,-69.14686798233697,-70.05672057452017,-70.96657316670337,-71.87642575888658,-72.78627835106978,-73.69613094325298,-74.60598353543618,-75.5158361276194,-76.4256887198026,-77.33554131198579,-78.24539390416899,-79.15524649635219,-80.0650990885354,-80.9749516807186,-81.8848042729018,-82.79465686508502,-83.70450945726822,-84.61436204945142,-85.52421464163461,-86.43406723381781,-87.34391982600101,-88.25377241818423,-89.16362501036743,-90.07347760255062,-90.98333019473384,-91.89318278691704,-92.80303537910024,-93.71288797128344,-94.62274056346664,-95.53259315564985,-96.44244574783305,-97.35229834001625,-98.26215093219946,-99.17200352438266,-100.08185611656586,-100.99170870874906,-101.90156130093226,-102.81141389311546,-103.72126648529867,-104.63111907748187,-105.54097166966508,-106.45082426184828,-107.36067685403148,-108.27052944621468,-109.18038203839788,-110.09023463058108,-111.00008722276428,-111.90993981494749,-112.81979240713069,-113.7296449993139,-114.6394975914971,-115.5493501836803,-116.4592027758635,-117.3690553680467,-118.2789079602299,-119.18876055241311,-120.09861314459631,-121.00846573677953,-121.91831832896273,-122.82817092114593,-123.73802351332913,-124.64787610551232,-125.55772869769552,-126.46758128987872,-127.37743388206194,-128.28728647424512,-129.19713906642835,-130.10699165861155,-131.01684425079475,-131.92669684297795,-132.83654943516115,-133.74640202734437,-134.65625461952757,-135.56610721171077,-136.47595980389397,-137.38581239607717,-138.29566498826037,-139.20551758044357,-140.11537017262677,-141.02522276480997,-141.93507535699317,-142.84492794917637,-143.75478054135957,-144.66463313354276,-145.574485725726,-146.4843383179092,-147.3941909100924,-148.3040435022756,-149.21389609445882,-150.12374868664202,-151.03360127882522,-151.94345387100842,-152.85330646319161,-153.7631590553748,-154.673011647558,-155.5828642397412)
counts=c(0.999, 0.0,0.0,0.0,0.0,0.0,0.001,0.004,0.001,0.001,0.002,0.0,0.001,0.002,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.001,0.0,0.0,0.001,0.0,0.0,0.002,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.001,0.0,0.0,0.0,0.001,0.0,0.001,0.0,0.001,0.0,0.0,0.001,0.0,0.001,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.002,0.001,0.0,0.001,0.0,0.0,0.0,0.001,0.0,0.0,0.001,0.0,0.0,0.001,0.001,0.0,0.001,0.001,0.001,0.0,0.0,0.001,0.0,0.001,0.0,0.0,0.002,0.001,0.0,0.0)
plot(mids,counts,type = 'h', xlim = c(-156.0377905358328,-65.96238390969576), ylim=c(0,0.999), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.41276094282645, -67.31351500908781,-68.2142690753492,-69.11502314161055,-70.01577720787193,-70.91653127413329,-71.81728534039468,-72.71803940665603,-73.61879347291742,-74.51954753917877,-75.42030160544016,-76.32105567170152,-77.2218097379629,-78.12256380422426,-79.02331787048564,-79.924071936747,-80.82482600300838,-81.72558006926974,-82.62633413553112,-83.52708820179248,-84.42784226805387,-85.32859633431522,-86.2293504005766,-87.13010446683796,-88.03085853309935,-88.9316125993607,-89.83236666562209,-90.73312073188345,-91.63387479814483,-92.53462886440619,-93.43538293066757,-94.33613699692893,-95.23689106319031,-96.13764512945167,-97.03839919571305,-97.93915326197441,-98.8399073282358,-99.74066139449715,-100.64141546075854,-101.5421695270199,-102.44292359328128,-103.34367765954264,-104.24443172580402,-105.14518579206538,-106.04593985832676,-106.94669392458812,-107.8474479908495,-108.74820205711086,-109.64895612337224,-110.5497101896336,-111.45046425589499,-112.35121832215634,-113.25197238841773,-114.15272645467908,-115.05348052094047,-115.95423458720182,-116.85498865346321,-117.75574271972457,-118.65649678598595,-119.55725085224731,-120.45800491850869,-121.35875898477005,-122.25951305103143,-123.16026711729279,-124.06102118355417,-124.96177524981553,-125.86252931607692,-126.76328338233827,-127.66403744859966,-128.564791514861,-129.4655455811224,-130.36629964738376,-131.2670537136451,-132.1678077799065,-133.06856184616788,-133.96931591242924,-134.8700699786906,-135.77082404495198,-136.67157811121336,-137.57233217747472,-138.47308624373608,-139.37384030999746,-140.27459437625885,-141.1753484425202,-142.07610250878156,-142.97685657504294,-143.87761064130433,-144.7783647075657,-145.67911877382704,-146.57987284008843,-147.4806269063498,-148.38138097261117,-149.28213503887253,-150.1828891051339,-151.0836431713953,-151.98439723765665,-152.885151303918,-153.7859053701794,-154.68665943644078,-155.58741350270213)
net_rate=c(-3.9561135966711873, 0.016391660086756982,0.01642201417771592,0.01642201417771592,0.016469185903623316,0.016573228484167354,0.016614884564954305,0.01670101306991479,0.01692473718438582,0.017088366512996757,0.0171424357977091,0.017148396091220184,0.01730090282970993,0.01735581711998277,0.01748313003700174,0.01748313003700174,0.017614464743188275,0.017614464743188275,0.01767046510748665,0.017811071856758707,0.01791561007586519,0.017958420258786027,0.017958420258786027,0.01797106078098059,0.01797106078098059,0.017965783510392786,0.01790291247742227,0.01790291247742227,0.01790291247742227,0.017902077631030546,0.017902077631030546,0.017902077631030546,0.017902077631030546,0.01788826541265244,0.017884458938959583,0.017884458938959583,0.017884458938959583,0.01789097745050657,0.01789097745050657,0.01789097745050657,0.017899428110151036,0.01789543690067711,0.017885761224182815,0.017881107554347363,0.017881107554347363,0.017881107554347363,0.017866010554935637,0.017866010554935637,0.017843973784415094,0.017843973784415094,0.01784352429743845,0.01784352429743845,0.01784352429743845,0.01784352429743845,0.017834508550763507,0.01789028797283589,0.0178964835625617,0.017880872378933793,0.017880872378933793,0.017880872378933793,0.01789726900740358,0.017897151185932696,0.0179425732264219,0.017940822254026986,0.017933404385170975,0.01799472426519671,0.01799472426519671,0.01799313320114916,0.018007717433251778,0.018007717433251778,0.018007717433251778,0.018023563688934374,0.018073219831898312,0.01806745938896852,0.01810161263782888,0.01810161263782888,0.01810161263782888,0.01810161263782888,0.018124636928162213,0.018124636928162213,0.0182213316337374,0.018263141696122424,0.018263141696122424,0.018263141696122424,0.018392954569803784,0.01845675268446161,0.01856760404122375,0.018733012613238734,0.018795674088007697,0.018979485455352305,0.019224666272691582,0.01946111134967467,0.019435534051984907,0.019595279965494813,0.020330226291669546,0.021619801733522927,0.025444025015899697,0.039194140343667076,0.06903479829234918,0.11440158038156986)
net_minHPD=c(-7.035625619666071, -0.004986493573446417,-0.004986493573446417,-0.004986493573446417,-0.005287690177201432,-0.004376648463983557,-0.005802564982119958,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.002704599502899613,-0.002704599502899613,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0038016938478128773,-0.0038016938478128773,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.0027117821663767833,-0.003217621574230667,-0.0027117821663767833,-0.0027117821663767833,-0.004376648463983557,-0.004376648463983557,-0.005287690177201432,-0.005206915593889833,-0.005287690177201432,-0.005287690177201432,-0.005802564982119958,-0.009741923389418976,-0.01227459338333843,-0.01227459338333843)
net_maxHPD=c(-1.3200491891281059, 0.040526099547542195,0.040526099547542195,0.040526099547542195,0.04009421761757778,0.040526099547542195,0.039006431256720424,0.04143952809028001,0.0404753199866639,0.04004949256232082,0.039977546971112984,0.039977546971112984,0.03958317371568884,0.039006431256720424,0.03870177690060458,0.03870177690060458,0.0382014810160156,0.0382014810160156,0.0382014810160156,0.03786089651295499,0.0382014810160156,0.037743107116432244,0.037743107116432244,0.037743107116432244,0.037743107116432244,0.037743107116432244,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.03758059921276252,0.037743107116432244,0.037743107116432244,0.037743107116432244,0.037743107116432244,0.037743107116432244,0.037743107116432244,0.037743107116432244,0.0382014810160156,0.0382014810160156,0.03822803848726537,0.03822803848726537,0.03822803848726537,0.03822803848726537,0.03822803848726537,0.03822803848726537,0.03822803848726537,0.03822803848726537,0.038864918946618136,0.038864918946618136,0.039006431256720424,0.039006431256720424,0.039006431256720424,0.039006431256720424,0.039006431256720424,0.03822803848726537,0.03822803848726537,0.03964218683980772,0.03964218683980772,0.03964218683980772,0.03964218683980772,0.03964218683980772,0.03964218683980772,0.03964218683980772,0.039977546971112984,0.039977546971112984,0.039977546971112984,0.0404753199866639,0.040526099547542195,0.04077693571888052,0.04077693571888052,0.04077693571888052,0.04143952809028001,0.040526099547542195,0.04077693571888052,0.04009421761757778,0.040526099547542195,0.04143952809028001,0.04357706688236025,0.052593894592064205,0.1293801737861432,0.41784792257329234,0.6910610471336031)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-7.739188181632679, 0.7601671518469634), xlim = c(-156.0377905358328,-65.96238390969576), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.41276094282645, -67.31351500908781,-68.2142690753492,-69.11502314161055,-70.01577720787193,-70.91653127413329,-71.81728534039468,-72.71803940665603,-73.61879347291742,-74.51954753917877,-75.42030160544016,-76.32105567170152,-77.2218097379629,-78.12256380422426,-79.02331787048564,-79.924071936747,-80.82482600300838,-81.72558006926974,-82.62633413553112,-83.52708820179248,-84.42784226805387,-85.32859633431522,-86.2293504005766,-87.13010446683796,-88.03085853309935,-88.9316125993607,-89.83236666562209,-90.73312073188345,-91.63387479814483,-92.53462886440619,-93.43538293066757,-94.33613699692893,-95.23689106319031,-96.13764512945167,-97.03839919571305,-97.93915326197441,-98.8399073282358,-99.74066139449715,-100.64141546075854,-101.5421695270199,-102.44292359328128,-103.34367765954264,-104.24443172580402,-105.14518579206538,-106.04593985832676,-106.94669392458812,-107.8474479908495,-108.74820205711086,-109.64895612337224,-110.5497101896336,-111.45046425589499,-112.35121832215634,-113.25197238841773,-114.15272645467908,-115.05348052094047,-115.95423458720182,-116.85498865346321,-117.75574271972457,-118.65649678598595,-119.55725085224731,-120.45800491850869,-121.35875898477005,-122.25951305103143,-123.16026711729279,-124.06102118355417,-124.96177524981553,-125.86252931607692,-126.76328338233827,-127.66403744859966,-128.564791514861,-129.4655455811224,-130.36629964738376,-131.2670537136451,-132.1678077799065,-133.06856184616788,-133.96931591242924,-134.8700699786906,-135.77082404495198,-136.67157811121336,-137.57233217747472,-138.47308624373608,-139.37384030999746,-140.27459437625885,-141.1753484425202,-142.07610250878156,-142.97685657504294,-143.87761064130433,-144.7783647075657,-145.67911877382704,-146.57987284008843,-147.4806269063498,-148.38138097261117,-149.28213503887253,-150.1828891051339,-151.0836431713953,-151.98439723765665,-152.885151303918,-153.7859053701794,-154.68665943644078,-155.58741350270213)
rate=c(0.24942827241089566, 27.275192611613114,27.275192611613114,27.275192611613114,27.275192611613114,27.275192611613114,27.275192611613114,27.324945424594787,27.487442350828545,27.611632619406578,27.62310643628978,27.627655103764983,27.651643006586458,27.665445750953623,27.727086399321486,27.727086399321486,27.727086399321486,27.727086399321486,27.727086399321486,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.726970398467376,27.724044347838905,27.724044347838905,27.724044347838905,27.729055528978602,27.729055528978602,27.729055528978602,27.735554768537117,27.732484826590394,27.732484826590394,27.732484826590394,27.732484826590394,27.732484826590394,27.732484826590394,27.732484826590394,27.715546902350262,27.715546902350262,27.715201632538193,27.715201632538193,27.715201632538193,27.715201632538193,27.70827807540479,27.70827807540479,27.713035547911964,27.67812769128293,27.67812769128293,27.67812769128293,27.67812769128293,27.678037431051845,27.678037431051845,27.676696122057063,27.676696122057063,27.676696122057063,27.676696122057063,27.675477421445034,27.675477421445034,27.675477421445034,27.675477421445034,27.687619901670217,27.70539119304473,27.70097024770036,27.70097024770036,27.70097024770036,27.70097024770036,27.70097024770036,27.71864906851389,27.71864906851389,27.71864906851389,27.71700788457775,27.71700788457775,27.71700788457775,27.738004375917903,27.75826809372686,27.75826809372686,27.75613826583292,27.797078424300434,27.81281054057496,27.81281054057496,27.81281054057496,27.82635592080308,27.82635592080308,27.78080277425402,27.78080277425402,27.78080277425402,27.794855913702403,27.78049802483247,27.78049802483247)
minHPD=c(0.24942827241089566, 27.275192611613114,27.275192611613114,27.275192611613114,27.275192611613114,27.275192611613114,27.275192611613114,27.324945424594787,27.487442350828545,27.611632619406578,27.62310643628978,27.627655103764983,27.651643006586458,27.665445750953623,27.727086399321486,27.727086399321486,27.727086399321486,27.727086399321486,27.727086399321486,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.726970398467376,27.724044347838905,27.724044347838905,27.724044347838905,27.729055528978602,27.729055528978602,27.729055528978602,27.735554768537117,27.732484826590394,27.732484826590394,27.732484826590394,27.732484826590394,27.732484826590394,27.732484826590394,27.732484826590394,27.715546902350262,27.715546902350262,27.715201632538193,27.715201632538193,27.715201632538193,27.715201632538193,27.70827807540479,27.70827807540479,27.713035547911964,27.67812769128293,27.67812769128293,27.67812769128293,27.67812769128293,27.678037431051845,27.678037431051845,27.676696122057063,27.676696122057063,27.676696122057063,27.676696122057063,27.675477421445034,27.675477421445034,27.675477421445034,27.675477421445034,27.687619901670217,27.70539119304473,27.70097024770036,27.70097024770036,27.70097024770036,27.70097024770036,27.70097024770036,27.71864906851389,27.71864906851389,27.71864906851389,27.71700788457775,27.71700788457775,27.71700788457775,27.738004375917903,27.75826809372686,27.75826809372686,27.75613826583292,27.797078424300434,27.81281054057496,27.81281054057496,27.81281054057496,27.82635592080308,27.82635592080308,27.78080277425402,27.78080277425402,27.78080277425402,27.794855913702403,27.78049802483247,27.78049802483247)
maxHPD=c(0.24942827241089566, 27.275192611613114,27.275192611613114,27.275192611613114,27.275192611613114,27.275192611613114,27.275192611613114,27.324945424594787,27.487442350828545,27.611632619406578,27.62310643628978,27.627655103764983,27.651643006586458,27.665445750953623,27.727086399321486,27.727086399321486,27.727086399321486,27.727086399321486,27.727086399321486,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.73759309140201,27.726970398467376,27.724044347838905,27.724044347838905,27.724044347838905,27.729055528978602,27.729055528978602,27.729055528978602,27.735554768537117,27.732484826590394,27.732484826590394,27.732484826590394,27.732484826590394,27.732484826590394,27.732484826590394,27.732484826590394,27.715546902350262,27.715546902350262,27.715201632538193,27.715201632538193,27.715201632538193,27.715201632538193,27.70827807540479,27.70827807540479,27.713035547911964,27.67812769128293,27.67812769128293,27.67812769128293,27.67812769128293,27.678037431051845,27.678037431051845,27.676696122057063,27.676696122057063,27.676696122057063,27.676696122057063,27.675477421445034,27.675477421445034,27.675477421445034,27.675477421445034,27.687619901670217,27.70539119304473,27.70097024770036,27.70097024770036,27.70097024770036,27.70097024770036,27.70097024770036,27.71864906851389,27.71864906851389,27.71864906851389,27.71700788457775,27.71700788457775,27.71700788457775,27.738004375917903,27.75826809372686,27.75826809372686,27.75613826583292,27.797078424300434,27.81281054057496,27.81281054057496,27.81281054057496,27.82635592080308,27.82635592080308,27.78080277425402,27.78080277425402,27.78080277425402,27.794855913702403,27.78049802483247,27.78049802483247)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 30.608991512883392), xlim = c(-156.0377905358328,-65.96238390969576), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()