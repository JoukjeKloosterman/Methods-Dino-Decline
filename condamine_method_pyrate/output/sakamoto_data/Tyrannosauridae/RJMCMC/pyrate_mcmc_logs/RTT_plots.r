

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.35768514597171, -67.05560243547848,-67.75351972498527,-68.45143701449203,-69.14935430399882,-69.84727159350558,-70.54518888301234,-71.24310617251913,-71.9410234620259,-72.63894075153266,-73.33685804103945,-74.03477533054621,-74.732692620053,-75.43060990955976,-76.12852719906653,-76.82644448857332,-77.52436177808008,-78.22227906758684,-78.92019635709363,-79.61811364660039,-80.31603093610718,-81.01394822561394,-81.7118655151207,-82.4097828046275,-83.10770009413426,-83.80561738364102,-84.50353467314781,-85.20145196265457,-85.89936925216136,-86.59728654166813,-87.29520383117489,-87.99312112068168,-88.69103841018844,-89.3889556996952,-90.08687298920199,-90.78479027870875,-91.48270756821555,-92.18062485772231,-92.87854214722907,-93.57645943673586,-94.27437672624262,-94.97229401574938,-95.67021130525617,-96.36812859476294,-97.06604588426973,-97.76396317377649,-98.46188046328325,-99.15979775279004,-99.8577150422968,-100.55563233180357,-101.25354962131036,-101.95146691081712,-102.64938420032391,-103.34730148983067,-104.04521877933743,-104.74313606884422,-105.44105335835098,-106.13897064785775,-106.83688793736454,-107.5348052268713,-108.23272251637809,-108.93063980588485,-109.62855709539161,-110.3264743848984,-111.02439167440517,-111.72230896391193,-112.42022625341872,-113.11814354292548,-113.81606083243227,-114.51397812193903,-115.2118954114458,-115.90981270095259,-116.60772999045935,-117.30564727996611,-118.0035645694729,-118.70148185897966,-119.39939914848645,-120.09731643799321,-120.79523372749998,-121.49315101700677,-122.19106830651353,-122.88898559602029,-123.58690288552708,-124.28482017503384,-124.98273746454063,-125.6806547540474,-126.37857204355416,-127.07648933306095,-127.77440662256771,-128.47232391207447,-129.17024120158123,-129.86815849108802,-130.56607578059482,-131.26399307010155,-131.96191035960834,-132.65982764911513,-133.3577449386219,-134.05566222812865,-134.75357951763544,-135.4514968071422)
rate=c(0.061625133860383846, 0.061625133860383846,0.06166927734756841,0.06172838177837641,0.06166927734756841,0.06161347243075416,0.06156887310208172,0.06156887310208172,0.061539931419727384,0.061539931419727384,0.061539931419727384,0.061539931419727384,0.061539931419727384,0.061539931419727384,0.061539931419727384,0.061539931419727384,0.061539931419727384,0.061539931419727384,0.061539931419727384,0.06159424734135377,0.06161347243075416,0.06161347243075416,0.06161347243075416,0.061648310652849134,0.061648310652849134,0.06166927734756841,0.061648310652849134,0.061625133860383846,0.06161347243075416,0.06159424734135377,0.06159424734135377,0.06159424734135377,0.06159424734135377,0.061625133860383846,0.061648310652849134,0.061648310652849134,0.061648310652849134,0.061625133860383846,0.06161347243075416,0.06159424734135377,0.06159424734135377,0.06159424734135377,0.06161347243075416,0.06161347243075416,0.06159424734135377,0.06159424734135377,0.06159424734135377,0.06159424734135377,0.06161347243075416,0.06161347243075416,0.06161347243075416,0.06159424734135377,0.06159424734135377,0.06156887310208172,0.061539931419727384,0.061539931419727384,0.061539931419727384,0.061539931419727384,0.061539931419727384,0.061539931419727384,0.06150907057981746,0.06150907057981746,0.06149690266414881,0.06148775920341328,0.06148775920341328,0.06148775920341328,0.06145674679839887,0.06145674679839887,0.06137997388042592,0.06137997388042592,0.06145674679839887,0.06145674679839887,0.06145674679839887,0.06145674679839887,0.06145674679839887,0.06145674679839887,0.06145674679839887,0.06145674679839887,0.06148775920341328,0.06148775920341328,0.06148775920341328,0.06148775920341328,0.06148775920341328,0.06145674679839887,0.06148775920341328,0.061539931419727384,0.061539931419727384,0.06156887310208172,0.06159424734135377,0.06156887310208172,0.06159424734135377,0.061625133860383846,0.061625133860383846,0.06172838177837641,0.061936220184489466,0.06205015145813646,0.06218152237201727,0.06239077761457858,0.06254684861675673,0.06313037060117248)
minHPD=c(0.03277221089215963, 0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.033750533315417414,0.033750533315417414,0.03394235311706473,0.03394235311706473,0.03394235311706473,0.03394235311706473,0.03394235311706473,0.03394235311706473,0.03394235311706473,0.03394235311706473,0.03413302677754246,0.03413302677754246,0.03413302677754246,0.03394235311706473,0.03413302677754246,0.03413302677754246,0.03413302677754246,0.033750533315417414,0.033750533315417414,0.033750533315417414,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.031533387498450666,0.031533387498450666,0.031533387498450666,0.031533387498450666,0.031533387498450666,0.031533387498450666,0.031533387498450666,0.031533387498450666,0.031533387498450666,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.03277221089215963,0.032002016100742534,0.031533387498450666,0.03048032501997773,0.03048032501997773,0.03048032501997773,0.03048032501997773,0.03048032501997773,0.03048032501997773,0.03048032501997773,0.029556486514674747,0.029556486514674747,0.029556486514674747,0.02932962672232439,0.02932962672232439,0.02932962672232439,0.02932962672232439,0.02932962672232439,0.02703178819176674,0.026538514309482397,0.031533387498450666,0.031533387498450666,0.03048032501997773,0.029556486514674747,0.02932962672232439,0.02764864029662732,0.026538514309482397,0.020281530256112807,0.020281530256112807,0.00884996068014773,0.02703178819176674,0.020423569827880083,0.013944890388957602,0.00884996068014773,0.00884996068014773)
maxHPD=c(0.09491258721443631, 0.09344363004045715,0.0927069911466197,0.09256544089779954,0.09225056456890539,0.09131350267160179,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09080271070839807,0.09099341614068729,0.09099341614068729,0.09113185089167418,0.09113185089167418,0.09113185089167418,0.09131350267160179,0.09169614301199841,0.09181603044449776,0.09181603044449776,0.09181603044449776,0.09225056456890539,0.09256544089779954,0.09256544089779954,0.09256544089779954,0.09256544089779954,0.09344363004045715,0.09344363004045715,0.0927069911466197,0.0927069911466197,0.0927069911466197,0.0927069911466197,0.09344363004045715,0.09344363004045715,0.09344363004045715,0.09344363004045715,0.09344363004045715,0.09491258721443631,0.09491258721443631,0.09491258721443631,0.09491258721443631,0.09495144812228011,0.09495144812228011,0.09495144812228011,0.09532450843260394,0.09532450843260394,0.09532450843260394,0.09563725988319965,0.09563725988319965,0.09563725988319965,0.09532450843260394,0.09563725988319965,0.09563725988319965,0.09563725988319965,0.09563725988319965,0.09563725988319965,0.09563725988319965,0.09563725988319965,0.09563725988319965,0.09495144812228011,0.09495144812228011,0.09495144812228011,0.09532450843260394,0.09532450843260394,0.09532450843260394,0.0969872451077614,0.0969872451077614,0.09563725988319965,0.0969872451077614,0.10368099487956518,0.10368099487956518,0.10368099487956518,0.10338480710076299,0.10338480710076299,0.10338480710076299,0.10533803732582976,0.10338480710076299,0.10533803732582976,0.10338480710076299,0.1282166184169929,0.1282166184169929,0.13242821784526124,0.15591322429863436,0.3060416254710377)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.3366457880181415), xlim = c(-135.8004554518956,-66.00872650121833), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.3612099807672, -67.06617693986496,-67.77114389896272,-68.47611085806045,-69.18107781715821,-69.88604477625597,-70.5910117353537,-71.29597869445146,-72.00094565354922,-72.70591261264696,-73.41087957174472,-74.11584653084248,-74.8208134899402,-75.52578044903797,-76.23074740813573,-76.93571436723346,-77.64068132633122,-78.34564828542895,-79.05061524452671,-79.75558220362447,-80.4605491627222,-81.16551612181996,-81.87048308091772,-82.57545004001545,-83.28041699911321,-83.98538395821097,-84.6903509173087,-85.39531787640647,-86.10028483550423,-86.80525179460196,-87.51021875369972,-88.21518571279748,-88.92015267189521,-89.62511963099297,-90.33008659009073,-91.03505354918846,-91.74002050828622,-92.44498746738395,-93.14995442648171,-93.85492138557947,-94.5598883446772,-95.26485530377497,-95.96982226287273,-96.67478922197046,-97.37975618106822,-98.08472314016598,-98.78969009926371,-99.49465705836147,-100.19962401745923,-100.90459097655696,-101.60955793565472,-102.31452489475248,-103.01949185385021,-103.72445881294797,-104.42942577204573,-105.13439273114346,-105.83935969024122,-106.54432664933896,-107.24929360843672,-107.95426056753448,-108.65922752663221,-109.36419448572997,-110.06916144482773,-110.77412840392546,-111.47909536302322,-112.18406232212098,-112.88902928121871,-113.59399624031647,-114.29896319941423,-115.00393015851196,-115.70889711760972,-116.41386407670748,-117.11883103580521,-117.82379799490298,-118.52876495400074,-119.23373191309847,-119.93869887219623,-120.64366583129399,-121.34863279039172,-122.05359974948948,-122.75856670858721,-123.46353366768497,-124.16850062678273,-124.87346758588046,-125.57843454497822,-126.28340150407598,-126.98836846317371,-127.69333542227147,-128.3983023813692,-129.10326934046697,-129.80823629956473,-130.5132032586625,-131.21817021776022,-131.92313717685798,-132.6281041359557,-133.33307109505347,-134.03803805415123,-134.743005013249,-135.44797197234672)
counts=c(0.004, 0.002,0.001,0.001,0.004,0.003,0.001,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.002,0.0,0.0,0.002,0.002,0.001,0.001,0.002,0.001,0.0,0.001,0.002,0.001,0.001,0.0,0.0,0.003,0.002,0.0,0.001,0.0,0.002,0.0,0.001,0.0,0.002,0.003,0.0,0.001,0.001,0.0,0.001,0.001,0.0,0.002,0.0,0.0,0.001,0.001,0.0,0.0,0.001,0.0,0.0,0.002,0.001,0.001,0.001,0.0,0.002,0.002,0.004,0.001,0.001,0.0,0.001,0.0,0.0,0.001,0.001,0.001,0.001,0.001,0.0,0.002,0.0,0.001,0.002,0.006,0.0,0.004,0.002,0.001,0.005,0.004,0.002,0.004,0.009,0.006,0.007,0.008,0.013,0.016,0.014)
plot(mids,counts,type = 'h', xlim = c(-135.8004554518956,-66.00872650121833), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03297733007430565
bf6 = 0.2012658355699082
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.35768514597171, -67.05560243547848,-67.75351972498527,-68.45143701449203,-69.14935430399882,-69.84727159350558,-70.54518888301234,-71.24310617251913,-71.9410234620259,-72.63894075153266,-73.33685804103945,-74.03477533054621,-74.732692620053,-75.43060990955976,-76.12852719906653,-76.82644448857332,-77.52436177808008,-78.22227906758684,-78.92019635709363,-79.61811364660039,-80.31603093610718,-81.01394822561394,-81.7118655151207,-82.4097828046275,-83.10770009413426,-83.80561738364102,-84.50353467314781,-85.20145196265457,-85.89936925216136,-86.59728654166813,-87.29520383117489,-87.99312112068168,-88.69103841018844,-89.3889556996952,-90.08687298920199,-90.78479027870875,-91.48270756821555,-92.18062485772231,-92.87854214722907,-93.57645943673586,-94.27437672624262,-94.97229401574938,-95.67021130525617,-96.36812859476294,-97.06604588426973,-97.76396317377649,-98.46188046328325,-99.15979775279004,-99.8577150422968,-100.55563233180357,-101.25354962131036,-101.95146691081712,-102.64938420032391,-103.34730148983067,-104.04521877933743,-104.74313606884422,-105.44105335835098,-106.13897064785775,-106.83688793736454,-107.5348052268713,-108.23272251637809,-108.93063980588485,-109.62855709539161,-110.3264743848984,-111.02439167440517,-111.72230896391193,-112.42022625341872,-113.11814354292548,-113.81606083243227,-114.51397812193903,-115.2118954114458,-115.90981270095259,-116.60772999045935,-117.30564727996611,-118.0035645694729,-118.70148185897966,-119.39939914848645,-120.09731643799321,-120.79523372749998,-121.49315101700677,-122.19106830651353,-122.88898559602029,-123.58690288552708,-124.28482017503384,-124.98273746454063,-125.6806547540474,-126.37857204355416,-127.07648933306095,-127.77440662256771,-128.47232391207447,-129.17024120158123,-129.86815849108802,-130.56607578059482,-131.26399307010155,-131.96191035960834,-132.65982764911513,-133.3577449386219,-134.05566222812865,-134.75357951763544,-135.4514968071422)
rate=c(0.5746492108382439, 0.5208151766684408,0.5171894202598161,0.5138116866350964,0.4612134335950573,0.03138441991891994,0.018706502760833493,0.017101757550265037,0.016454774687646632,0.016198654201399723,0.016107538367102932,0.016107538367102932,0.016107538367102932,0.016075291557062957,0.016065179658843694,0.016065179658843694,0.016065179658843694,0.016065179658843694,0.016065179658843694,0.016050420379137925,0.016050420379137925,0.016050420379137925,0.015994043678219057,0.01598078241970457,0.01587939552211371,0.015876947505504807,0.015853231362393937,0.01581550550785315,0.01579657046534961,0.015771466990439874,0.015771466990439874,0.015747946177230958,0.015747946177230958,0.015747946177230958,0.015747946177230958,0.015747946177230958,0.015747946177230958,0.015771466990439874,0.015747946177230958,0.015747946177230958,0.015747946177230958,0.015747946177230958,0.015747946177230958,0.015742008187389633,0.015722366097451278,0.015694476920453483,0.015694476920453483,0.015694476920453483,0.015694476920453483,0.01566888617225317,0.01566888617225317,0.01566888617225317,0.01566888617225317,0.01566888617225317,0.01566888617225317,0.01566888617225317,0.01566888617225317,0.01566888617225317,0.01566888617225317,0.01566888617225317,0.015616724097666606,0.015616724097666606,0.015616724097666606,0.015616724097666606,0.015616724097666606,0.01566888617225317,0.015616724097666606,0.015616724097666606,0.015616724097666606,0.015616724097666606,0.015616724097666606,0.015616724097666606,0.015616724097666606,0.015575374162651836,0.015575374162651836,0.015575374162651836,0.015575374162651836,0.015575374162651836,0.015564072227357863,0.015564072227357863,0.015564072227357863,0.015564072227357863,0.015575374162651836,0.015575374162651836,0.015575374162651836,0.01566888617225317,0.01566888617225317,0.01566888617225317,0.01566888617225317,0.01566888617225317,0.01566888617225317,0.015694476920453483,0.015694476920453483,0.01566888617225317,0.01566888617225317,0.01566888617225317,0.01566888617225317,0.015694476920453483,0.015722366097451278,0.015742008187389633)
minHPD=c(0.19888622853174476, 0.19888622853174476,0.20945827977433015,0.19888622853174476,0.004997779859571455,0.0007226933241124825,0.0007226933241124825,0.0007226933241124825,0.0019266414614646128,0.0028869212011562863,0.0034235904782447544,0.0034235904782447544,0.0034235904782447544,0.003695099421901524,0.003695099421901524,0.003695099421901524,0.003695099421901524,0.003695099421901524,0.003695099421901524,0.003695099421901524,0.003695099421901524,0.003695099421901524,0.003341205526572113,0.003341205526572113,0.003341205526572113,0.0019266414614646128,0.0019266414614646128,0.0024243933575139875,0.00236357131275232,0.003695099421901524,0.003695099421901524,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.0019266414614646128,0.0019266414614646128,0.0019266414614646128,0.0019266414614646128,0.0019266414614646128,0.0019266414614646128,0.0019266414614646128,0.0019266414614646128,0.0019266414614646128,0.0019266414614646128,0.0019266414614646128,0.0019266414614646128,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.00236357131275232,0.0019266414614646128,0.0019266414614646128,0.0019266414614646128,0.0007023503153842967,0.0007023503153842967,0.0007023503153842967,0.0007023503153842967,0.0007023503153842967,0.0007023503153842967,0.0007023503153842967,0.0007023503153842967,0.0007023503153842967,0.0007023503153842967,0.000717887219437847,0.0007023503153842967,0.001916566248980399,0.0007023503153842967,0.0007023503153842967)
maxHPD=c(2.6326792379983748, 0.9459137787543751,0.9421578965227896,0.9459137787543751,0.7989232979415519,0.630261611625281,0.42415383195836726,0.22667539334426307,0.041804572631719376,0.03670021576466292,0.036447488345279826,0.036447488345279826,0.036447488345279826,0.036447488345279826,0.03644333341920319,0.03644333341920319,0.03644333341920319,0.03644333341920319,0.03644333341920319,0.03644333341920319,0.03644333341920319,0.03644333341920319,0.03569286328824844,0.03569286328824844,0.03569286328824844,0.03425488919991004,0.03425488919991004,0.034912068958333035,0.034912068958333035,0.036447488345279826,0.036447488345279826,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034912068958333035,0.034735098286942954,0.034735098286942954,0.034735098286942954,0.034735098286942954,0.034735098286942954,0.034735098286942954,0.034735098286942954,0.034735098286942954,0.034735098286942954,0.034735098286942954,0.034735098286942954,0.034735098286942954,0.035314255429194225,0.035314255429194225,0.035314255429194225,0.035314255429194225,0.035314255429194225,0.035314255429194225,0.035314255429194225,0.035314255429194225,0.035314255429194225,0.035314255429194225,0.035314255429194225,0.035314255429194225,0.035314255429194225,0.035314255429194225,0.035314255429194225,0.035314255429194225,0.034912068958333035,0.034912068958333035,0.035199954603471584,0.03415313070303458,0.03415313070303458,0.03415313070303458,0.03415313070303458,0.03415313070303458,0.03415313070303458,0.03425488919991004,0.03425488919991004,0.03425488919991004,0.034531705926593735,0.034912068958333035,0.035199954603471584,0.036447488345279826,0.03569286328824844,0.03623777305861183)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 2.8959471617982127), xlim = c(-135.8004554518956,-66.00872650121833), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.3612099807672, -67.06617693986496,-67.77114389896272,-68.47611085806045,-69.18107781715821,-69.88604477625597,-70.5910117353537,-71.29597869445146,-72.00094565354922,-72.70591261264696,-73.41087957174472,-74.11584653084248,-74.8208134899402,-75.52578044903797,-76.23074740813573,-76.93571436723346,-77.64068132633122,-78.34564828542895,-79.05061524452671,-79.75558220362447,-80.4605491627222,-81.16551612181996,-81.87048308091772,-82.57545004001545,-83.28041699911321,-83.98538395821097,-84.6903509173087,-85.39531787640647,-86.10028483550423,-86.80525179460196,-87.51021875369972,-88.21518571279748,-88.92015267189521,-89.62511963099297,-90.33008659009073,-91.03505354918846,-91.74002050828622,-92.44498746738395,-93.14995442648171,-93.85492138557947,-94.5598883446772,-95.26485530377497,-95.96982226287273,-96.67478922197046,-97.37975618106822,-98.08472314016598,-98.78969009926371,-99.49465705836147,-100.19962401745923,-100.90459097655696,-101.60955793565472,-102.31452489475248,-103.01949185385021,-103.72445881294797,-104.42942577204573,-105.13439273114346,-105.83935969024122,-106.54432664933896,-107.24929360843672,-107.95426056753448,-108.65922752663221,-109.36419448572997,-110.06916144482773,-110.77412840392546,-111.47909536302322,-112.18406232212098,-112.88902928121871,-113.59399624031647,-114.29896319941423,-115.00393015851196,-115.70889711760972,-116.41386407670748,-117.11883103580521,-117.82379799490298,-118.52876495400074,-119.23373191309847,-119.93869887219623,-120.64366583129399,-121.34863279039172,-122.05359974948948,-122.75856670858721,-123.46353366768497,-124.16850062678273,-124.87346758588046,-125.57843454497822,-126.28340150407598,-126.98836846317371,-127.69333542227147,-128.3983023813692,-129.10326934046697,-129.80823629956473,-130.5132032586625,-131.21817021776022,-131.92313717685798,-132.6281041359557,-133.33307109505347,-134.03803805415123,-134.743005013249,-135.44797197234672)
counts=c(0.116, 0.015,0.009,0.152,0.423,0.268,0.089,0.042,0.016,0.004,0.0,0.001,0.002,0.001,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.002,0.001,0.003,0.001,0.001,0.002,0.002,0.0,0.0,0.001,0.0,0.0,0.001,0.0,0.0,0.002,0.0,0.0,0.0,0.001,0.001,0.0,0.001,0.001,0.0,0.0,0.0,0.001,0.001,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.001,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.001,0.0,0.001,0.002,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.001,0.001,0.003,0.002,0.001,0.002,0.004,0.0)
plot(mids,counts,type = 'h', xlim = c(-135.8004554518956,-66.00872650121833), ylim=c(0,0.423), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.35768514597171, -67.05560243547848,-67.75351972498527,-68.45143701449203,-69.14935430399882,-69.84727159350558,-70.54518888301234,-71.24310617251913,-71.9410234620259,-72.63894075153266,-73.33685804103945,-74.03477533054621,-74.732692620053,-75.43060990955976,-76.12852719906653,-76.82644448857332,-77.52436177808008,-78.22227906758684,-78.92019635709363,-79.61811364660039,-80.31603093610718,-81.01394822561394,-81.7118655151207,-82.4097828046275,-83.10770009413426,-83.80561738364102,-84.50353467314781,-85.20145196265457,-85.89936925216136,-86.59728654166813,-87.29520383117489,-87.99312112068168,-88.69103841018844,-89.3889556996952,-90.08687298920199,-90.78479027870875,-91.48270756821555,-92.18062485772231,-92.87854214722907,-93.57645943673586,-94.27437672624262,-94.97229401574938,-95.67021130525617,-96.36812859476294,-97.06604588426973,-97.76396317377649,-98.46188046328325,-99.15979775279004,-99.8577150422968,-100.55563233180357,-101.25354962131036,-101.95146691081712,-102.64938420032391,-103.34730148983067,-104.04521877933743,-104.74313606884422,-105.44105335835098,-106.13897064785775,-106.83688793736454,-107.5348052268713,-108.23272251637809,-108.93063980588485,-109.62855709539161,-110.3264743848984,-111.02439167440517,-111.72230896391193,-112.42022625341872,-113.11814354292548,-113.81606083243227,-114.51397812193903,-115.2118954114458,-115.90981270095259,-116.60772999045935,-117.30564727996611,-118.0035645694729,-118.70148185897966,-119.39939914848645,-120.09731643799321,-120.79523372749998,-121.49315101700677,-122.19106830651353,-122.88898559602029,-123.58690288552708,-124.28482017503384,-124.98273746454063,-125.6806547540474,-126.37857204355416,-127.07648933306095,-127.77440662256771,-128.47232391207447,-129.17024120158123,-129.86815849108802,-130.56607578059482,-131.26399307010155,-131.96191035960834,-132.65982764911513,-133.3577449386219,-134.05566222812865,-134.75357951763544,-135.4514968071422)
net_rate=c(-0.7371173480324894, -0.47831775336521093,-0.4713124211846128,-0.4684261546356598,-0.3700347580067527,-0.14637871541737368,-0.011217127182845026,0.024993937465479267,0.03822628428709239,0.04367513497129475,0.04442097080939709,0.04440621878662281,0.04439891820875312,0.044556234081618705,0.044604795502366186,0.044604795502366186,0.0446228111082807,0.04463927702671195,0.04463927702671195,0.044770299651915986,0.04484227765426811,0.04486839827441648,0.044966320723637175,0.04512062182012668,0.045200428101980855,0.04526200023449975,0.04523603602347991,0.045230894935546155,0.045233351118224296,0.04519940133812083,0.04519940133812083,0.04524303634061626,0.045300494208746274,0.045366342732119785,0.04545116249781176,0.04545193125108483,0.04545193125108483,0.04536122773654684,0.04533597222872764,0.045250813867484585,0.045250813867484585,0.04525791967172373,0.04540066808827434,0.0454020254275065,0.0453786407511749,0.04539230468503329,0.04539230468503329,0.04539230468503329,0.04541143139994217,0.04545716878567067,0.045455906522770026,0.045383765370418994,0.045383765370418994,0.04534240255104979,0.04531903948605884,0.04531903948605884,0.04531903948605884,0.045283554587171364,0.045283554587171364,0.045283554587171364,0.04525655083028951,0.04525655083028951,0.045221858756943456,0.04515803798013298,0.04515803798013298,0.04514563636023711,0.04510275454968223,0.045358733682647444,0.04537848916178634,0.04537848916178634,0.04540843388979447,0.04540843388979447,0.04541295193268725,0.045416682980289995,0.045416682980289995,0.0454622507339665,0.045463868519140936,0.045463868519140936,0.04555269719798848,0.04555269719798848,0.04555269719798848,0.045538998786015125,0.04550700516731122,0.04567004687458197,0.045718199364578375,0.04665071758766072,0.04665071758766072,0.04646656053234671,0.04690897557008461,0.04699533044438094,0.047285901562320966,0.0483933968993323,0.04846839779731671,0.04912327107166885,0.05240461383354868,0.05297615147866036,0.05606140683599456,0.05949181619650467,0.06409429795463253,0.07412954140445387)
net_minHPD=c(-2.570704432660889, -0.8485334651421763,-0.840495544927271,-0.8429794712181209,-0.7427697411916588,-0.5925361526801832,-0.3769019682617261,-0.16810158637565048,0.0004263864836099654,0.008207454521270634,0.0115224823539276,0.0115224823539276,0.0115224823539276,0.012012314840910868,0.012478338493230094,0.012478338493230094,0.012478338493230094,0.012478338493230094,0.012478338493230094,0.0115224823539276,0.012012314840910868,0.012012314840910868,0.012478338493230094,0.012478338493230094,0.012478338493230094,0.012478338493230094,0.012478338493230094,0.012012314840910868,0.0115224823539276,0.010929826358721313,0.010929826358721313,0.01117632298943964,0.010929826358721313,0.012478338493230094,0.012012314840910868,0.012012314840910868,0.012012314840910868,0.008224337192907955,0.010929826358721313,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.006811463352287467,0.006811463352287467,0.006360694755282718,0.006360694755282718,0.006360694755282718,0.006360694755282718,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.006811463352287467,0.010929826358721313,0.009665933585958054,0.009665933585958054,0.009665933585958054,0.009665933585958054,0.009665933585958054,0.009665933585958054,0.009665933585958054,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.008224337192907955,0.0075974365711018385,0.0075974365711018385,0.006811463352287467,0.003001101891887282,0.003001101891887282,0.003001101891887282,0.003001101891887282,0.003001101891887282,-0.000263128917853149,-0.000263128917853149,-0.000263128917853149,-0.000263128917853149,-0.000263128917853149,-0.000263128917853149,-0.007634443385564037,-0.022476226943445747,-0.03533021308241094,-0.024011152276420776)
net_maxHPD=c(-0.11657440889504626, -0.09249825643330928,-0.09177945008752426,-0.09177945008752426,0.07730694712404224,0.08062617023830651,0.09402028207619868,0.10504916648947389,0.08062617023830651,0.07914865918853689,0.08062617023830651,0.08062617023830651,0.08062617023830651,0.08062617023830651,0.08062617023830651,0.08062617023830651,0.08062617023830651,0.08019810112960757,0.08019810112960757,0.08062617023830651,0.08062617023830651,0.08062617023830651,0.08019810112960757,0.08062617023830651,0.08062617023830651,0.08062617023830651,0.08062617023830651,0.08062617023830651,0.08062617023830651,0.08019810112960757,0.08019810112960757,0.08019810112960757,0.08062617023830651,0.08264837099987817,0.08264837099987817,0.08264837099987817,0.08264837099987817,0.07914865918853689,0.08264837099987817,0.08019810112960757,0.08019810112960757,0.08019810112960757,0.08062617023830651,0.08062617023830651,0.08062617023830651,0.08062617023830651,0.08062617023830651,0.08062617023830651,0.08264837099987817,0.08258261334674577,0.08258261334674577,0.08258261334674577,0.08258261334674577,0.08264837099987817,0.08264837099987817,0.08264837099987817,0.08264837099987817,0.08264837099987817,0.08264837099987817,0.08264837099987817,0.08264837099987817,0.08264837099987817,0.08264837099987817,0.08264837099987817,0.08264837099987817,0.08264837099987817,0.08264837099987817,0.08786930397066946,0.08786930397066946,0.08786930397066946,0.08786930397066946,0.08786930397066946,0.08786930397066946,0.08786930397066946,0.08786930397066946,0.08702280332533549,0.08702280332533549,0.08702280332533549,0.08714911012479,0.08714911012479,0.08714911012479,0.08786930397066946,0.08786930397066946,0.08853118310351032,0.08945686819555806,0.08714911012479,0.08714911012479,0.08786930397066946,0.08945686819555806,0.089799547712864,0.08714911012479,0.089799547712864,0.09082864167934968,0.09268228645328563,0.10044456571793052,0.10952837112018857,0.11193948126323247,0.12246302853959673,0.2426619099524307,0.3679060408938415)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-2.8277748759269783, 0.40469664498322566), xlim = c(-135.8004554518956,-66.00872650121833), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.35768514597171, -67.05560243547848,-67.75351972498527,-68.45143701449203,-69.14935430399882,-69.84727159350558,-70.54518888301234,-71.24310617251913,-71.9410234620259,-72.63894075153266,-73.33685804103945,-74.03477533054621,-74.732692620053,-75.43060990955976,-76.12852719906653,-76.82644448857332,-77.52436177808008,-78.22227906758684,-78.92019635709363,-79.61811364660039,-80.31603093610718,-81.01394822561394,-81.7118655151207,-82.4097828046275,-83.10770009413426,-83.80561738364102,-84.50353467314781,-85.20145196265457,-85.89936925216136,-86.59728654166813,-87.29520383117489,-87.99312112068168,-88.69103841018844,-89.3889556996952,-90.08687298920199,-90.78479027870875,-91.48270756821555,-92.18062485772231,-92.87854214722907,-93.57645943673586,-94.27437672624262,-94.97229401574938,-95.67021130525617,-96.36812859476294,-97.06604588426973,-97.76396317377649,-98.46188046328325,-99.15979775279004,-99.8577150422968,-100.55563233180357,-101.25354962131036,-101.95146691081712,-102.64938420032391,-103.34730148983067,-104.04521877933743,-104.74313606884422,-105.44105335835098,-106.13897064785775,-106.83688793736454,-107.5348052268713,-108.23272251637809,-108.93063980588485,-109.62855709539161,-110.3264743848984,-111.02439167440517,-111.72230896391193,-112.42022625341872,-113.11814354292548,-113.81606083243227,-114.51397812193903,-115.2118954114458,-115.90981270095259,-116.60772999045935,-117.30564727996611,-118.0035645694729,-118.70148185897966,-119.39939914848645,-120.09731643799321,-120.79523372749998,-121.49315101700677,-122.19106830651353,-122.88898559602029,-123.58690288552708,-124.28482017503384,-124.98273746454063,-125.6806547540474,-126.37857204355416,-127.07648933306095,-127.77440662256771,-128.47232391207447,-129.17024120158123,-129.86815849108802,-130.56607578059482,-131.26399307010155,-131.96191035960834,-132.65982764911513,-133.3577449386219,-134.05566222812865,-134.75357951763544,-135.4514968071422)
rate=c(1.2485930259311886, 1.8463307032544047,1.8701358776789576,1.8800206748064614,2.307100004661986,4.777244685773833,13.57420402183094,26.696509782524075,41.43303721840102,53.51463038591274,55.739362774098154,55.739362774098154,55.71669000604187,56.20937188003969,56.363221321122865,56.363221321122865,56.363221321122865,56.363221321122865,56.363221321122865,56.403217562923395,56.403217562923395,56.403217562923395,56.71647063906473,56.852076894464574,57.098433151187024,57.23510983816023,57.28073263062246,57.44100986893406,57.518283992279486,57.58610412373648,57.58610412373648,57.73116926221223,57.73116926221223,57.73116926221223,57.75555612858547,57.75555612858547,57.75555612858547,57.70500584258448,57.83781181240862,57.83781181240862,57.83781181240862,57.861592010681086,57.861592010681086,57.86613669026461,57.91086481092382,57.94555169305269,57.94555169305269,57.94555169305269,57.94555169305269,58.09953160632818,58.09953160632818,58.13329460071263,58.13329460071263,58.13329460071263,58.173601927095724,58.173601927095724,58.173601927095724,58.173601927095724,58.173601927095724,58.173601927095724,58.24289235665644,58.24289235665644,58.24289235665644,58.24289235665644,58.24289235665644,58.19773033450398,58.249088440942224,58.249088440942224,58.249088440942224,58.249088440942224,58.249088440942224,58.249088440942224,58.249088440942224,58.26175047426849,58.26175047426849,58.26175047426849,58.26175047426849,58.26175047426849,58.29904824308775,58.29904824308775,58.29904824308775,58.29904824308775,58.1905114454353,58.1905114454353,57.64742680522074,57.29141744598825,57.29141744598825,57.29141744598825,57.29141744598825,57.29141744598825,57.29141744598825,57.08842152131412,57.08842152131412,57.13939305923495,56.89881588548366,54.84806630452936,53.168099350610184,52.41410041118739,46.67454958532256,43.872938045501016)
minHPD=c(1.2485930259311886, 1.8463307032544047,1.8701358776789576,1.8800206748064614,2.307100004661986,4.777244685773833,13.57420402183094,26.696509782524075,41.43303721840102,53.51463038591274,55.739362774098154,55.739362774098154,55.71669000604187,56.20937188003969,56.363221321122865,56.363221321122865,56.363221321122865,56.363221321122865,56.363221321122865,56.403217562923395,56.403217562923395,56.403217562923395,56.71647063906473,56.852076894464574,57.098433151187024,57.23510983816023,57.28073263062246,57.44100986893406,57.518283992279486,57.58610412373648,57.58610412373648,57.73116926221223,57.73116926221223,57.73116926221223,57.75555612858547,57.75555612858547,57.75555612858547,57.70500584258448,57.83781181240862,57.83781181240862,57.83781181240862,57.861592010681086,57.861592010681086,57.86613669026461,57.91086481092382,57.94555169305269,57.94555169305269,57.94555169305269,57.94555169305269,58.09953160632818,58.09953160632818,58.13329460071263,58.13329460071263,58.13329460071263,58.173601927095724,58.173601927095724,58.173601927095724,58.173601927095724,58.173601927095724,58.173601927095724,58.24289235665644,58.24289235665644,58.24289235665644,58.24289235665644,58.24289235665644,58.19773033450398,58.249088440942224,58.249088440942224,58.249088440942224,58.249088440942224,58.249088440942224,58.249088440942224,58.249088440942224,58.26175047426849,58.26175047426849,58.26175047426849,58.26175047426849,58.26175047426849,58.29904824308775,58.29904824308775,58.29904824308775,58.29904824308775,58.1905114454353,58.1905114454353,57.64742680522074,57.29141744598825,57.29141744598825,57.29141744598825,57.29141744598825,57.29141744598825,57.29141744598825,57.08842152131412,57.08842152131412,57.13939305923495,56.89881588548366,54.84806630452936,53.168099350610184,52.41410041118739,46.67454958532256,43.872938045501016)
maxHPD=c(1.2485930259311886, 1.8463307032544047,1.8701358776789576,1.8800206748064614,2.307100004661986,4.777244685773833,13.57420402183094,26.696509782524075,41.43303721840102,53.51463038591274,55.739362774098154,55.739362774098154,55.71669000604187,56.20937188003969,56.363221321122865,56.363221321122865,56.363221321122865,56.363221321122865,56.363221321122865,56.403217562923395,56.403217562923395,56.403217562923395,56.71647063906473,56.852076894464574,57.098433151187024,57.23510983816023,57.28073263062246,57.44100986893406,57.518283992279486,57.58610412373648,57.58610412373648,57.73116926221223,57.73116926221223,57.73116926221223,57.75555612858547,57.75555612858547,57.75555612858547,57.70500584258448,57.83781181240862,57.83781181240862,57.83781181240862,57.861592010681086,57.861592010681086,57.86613669026461,57.91086481092382,57.94555169305269,57.94555169305269,57.94555169305269,57.94555169305269,58.09953160632818,58.09953160632818,58.13329460071263,58.13329460071263,58.13329460071263,58.173601927095724,58.173601927095724,58.173601927095724,58.173601927095724,58.173601927095724,58.173601927095724,58.24289235665644,58.24289235665644,58.24289235665644,58.24289235665644,58.24289235665644,58.19773033450398,58.249088440942224,58.249088440942224,58.249088440942224,58.249088440942224,58.249088440942224,58.249088440942224,58.249088440942224,58.26175047426849,58.26175047426849,58.26175047426849,58.26175047426849,58.26175047426849,58.29904824308775,58.29904824308775,58.29904824308775,58.29904824308775,58.1905114454353,58.1905114454353,57.64742680522074,57.29141744598825,57.29141744598825,57.29141744598825,57.29141744598825,57.29141744598825,57.29141744598825,57.08842152131412,57.08842152131412,57.13939305923495,56.89881588548366,54.84806630452936,53.168099350610184,52.41410041118739,46.67454958532256,43.872938045501016)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 64.12895306739654), xlim = c(-135.8004554518956,-66.00872650121833), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()