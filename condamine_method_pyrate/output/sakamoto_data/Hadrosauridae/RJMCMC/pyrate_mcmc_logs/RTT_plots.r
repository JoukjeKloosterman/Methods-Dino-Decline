

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.49059832619955, -67.54342102110485,-68.59624371601015,-69.64906641091542,-70.70188910582073,-71.754711800726,-72.8075344956313,-73.8603571905366,-74.91317988544188,-75.96600258034718,-77.01882527525248,-78.07164797015776,-79.12447066506306,-80.17729335996833,-81.23011605487363,-82.28293874977894,-83.33576144468421,-84.38858413958951,-85.44140683449481,-86.49422952940009,-87.54705222430539,-88.59987491921066,-89.65269761411597,-90.70552030902127,-91.75834300392654,-92.81116569883184,-93.86398839373712,-94.91681108864242,-95.96963378354772,-97.022456478453,-98.0752791733583,-99.1281018682636,-100.18092456316887,-101.23374725807417,-102.28656995297945,-103.33939264788475,-104.39221534279005,-105.44503803769533,-106.49786073260063,-107.55068342750593,-108.6035061224112,-109.6563288173165,-110.70915151222178,-111.76197420712708,-112.81479690203238,-113.86761959693766,-114.92044229184296,-115.97326498674823,-117.02608768165354,-118.07891037655884,-119.13173307146411,-120.18455576636941,-121.23737846127472,-122.29020115617999,-123.34302385108529,-124.39584654599057,-125.44866924089587,-126.50149193580117,-127.55431463070644,-128.60713732561175,-129.65996002051705,-130.71278271542232,-131.76560541032762,-132.81842810523293,-133.8712508001382,-134.92407349504347,-135.9768961899488,-137.02971888485408,-138.08254157975935,-139.13536427466465,-140.18818696956995,-141.24100966447523,-142.29383235938053,-143.34665505428583,-144.3994777491911,-145.4523004440964,-146.5051231390017,-147.55794583390698,-148.6107685288123,-149.6635912237176,-150.71641391862286,-151.76923661352814,-152.82205930843344,-153.87488200333874,-154.927704698244,-155.98052739314932,-157.03335008805462,-158.0861727829599,-159.1389954778652,-160.1918181727705,-161.24464086767577,-162.29746356258107,-163.35028625748637,-164.40310895239165,-165.45593164729692,-166.50875434220222,-167.56157703710753,-168.6143997320128,-169.6672224269181,-170.7200451218234)
rate=c(0.15992791888599112, 0.15968322178909206,0.15943771326536263,0.15943771326536263,0.15934024255221158,0.15926911370605623,0.15904395397675486,0.15878295292599268,0.15878295292599268,0.15878295292599268,0.15878295292599268,0.15878295292599268,0.1589185929666626,0.1589185929666626,0.15911118729232415,0.15922325773470017,0.15969478855041433,0.15969478855041433,0.15958396994060142,0.15934024255221158,0.15842955649395365,0.15779499173421496,0.15581432404514636,0.1531819142665483,0.15049201894006786,0.14817116995996238,0.14361226367844732,0.14165445985455455,0.13578627104533394,0.1302384893744631,0.12347892756205453,0.09454553571741629,0.06753163357917275,0.05520546970877581,0.051141867736135646,0.046113998665105516,0.043574062483664966,0.04114199702063792,0.040163379705129204,0.038655150329628574,0.03790317386128641,0.03724681078276905,0.03679771019632506,0.036026719967290705,0.035445232819027096,0.03521888005359055,0.03502833319733556,0.03463618528490674,0.03433544865858212,0.03423271263298745,0.03417204381462963,0.03404876016081677,0.03404876016081677,0.03402441238625101,0.03394667952746028,0.03393143945622752,0.03354938450291734,0.03354938450291734,0.03348282140723169,0.03348282140723169,0.03344304827549773,0.03344304827549773,0.03344304827549773,0.03344304827549773,0.03344304827549773,0.03344304827549773,0.03354938450291734,0.03354938450291734,0.03354938450291734,0.03348282140723169,0.03348282140723169,0.03348282140723169,0.03348282140723169,0.03348282140723169,0.03348282140723169,0.03354938450291734,0.03354938450291734,0.03374914243634322,0.03374914243634322,0.03393143945622752,0.03394667952746028,0.03397854415433829,0.03404876016081677,0.03404876016081677,0.03404876016081677,0.03417204381462963,0.03419195770849355,0.03433544865858212,0.03436466281650824,0.03436466281650824,0.03457277729079596,0.03457277729079596,0.034575493400372165,0.034575493400372165,0.03459541879022041,0.03463618528490674,0.03466971676844083,0.03474915699349127,0.03506308965991343,0.03531405981386133)
minHPD=c(0.1174853368300976, 0.11947286811384603,0.11711652752529035,0.11711652752529035,0.1185683679611089,0.11947286811384603,0.11925770380651335,0.11925770380651335,0.11925770380651335,0.11925770380651335,0.11711652752529035,0.11711652752529035,0.11925770380651335,0.11925770380651335,0.1185683679611089,0.1185683679611089,0.11711652752529035,0.10817816654588998,0.10584855307135133,0.10902102292456659,0.09735632280057349,0.07673204561081946,0.026322188805032714,0.024221748575459043,0.017088989914344817,0.014612245434757915,0.011836742773109836,0.011836742773109836,0.011816445299572884,0.011816445299572884,0.009846817783270054,0.010448469266275693,0.009846817783270054,0.009846817783270054,0.008407302410799839,0.008407302410799839,0.008067305854468442,0.006394531677284578,0.006145950294907461,0.002528997408594119,0.005475257924681928,0.006145950294907461,0.0009501196932320656,0.004156097862723666,0.006394531677284578,0.006145950294907461,0.004061927455374534,0.004061927455374534,0.003242629600489234,0.004061927455374534,0.0004715997390698951,0.0009501196932320656,0.0013502215843524095,0.002003739132590179,0.002528997408594119,0.003242629600489234,0.004061927455374534,0.004061927455374534,0.004294741619458371,0.0004715997390698951,0.006043481614730405,0.006043481614730405,0.0013502215843524095,0.0018117352116846868,0.0018117352116846868,0.0004715997390698951,0.0004715997390698951,0.0004715997390698951,0.000892629051200876,0.000892629051200876,0.000892629051200876,0.0004715997390698951,0.0004715997390698951,0.0004715997390698951,0.0004715997390698951,0.000892629051200876,0.000892629051200876,0.000892629051200876,0.000892629051200876,0.000892629051200876,0.000892629051200876,0.000892629051200876,0.000892629051200876,0.000892629051200876,0.000892629051200876,0.000892629051200876,0.003242629600489234,0.004061927455374534,0.003242629600489234,0.003242629600489234,0.003242629600489234,0.003242629600489234,0.006043481614730405,0.005475257924681928,0.005475257924681928,0.005475257924681928,0.006043481614730405,0.006334449299771767,0.004494435986785312,0.003242629600489234)
maxHPD=c(0.21289303332445828, 0.21289303332445828,0.2085697757592758,0.2085697757592758,0.20936194315290158,0.20936194315290158,0.20830825931372546,0.20830825931372546,0.20830825931372546,0.20830825931372546,0.20568174909687445,0.20568174909687445,0.20830825931372546,0.20853105707279695,0.20936194315290158,0.20853105707279695,0.21022071825038852,0.20288421315065183,0.20288421315065183,0.20853105707279695,0.21270816420315525,0.2363610361055505,0.20212738210637302,0.20212738210637302,0.19796220257417854,0.19500338534887343,0.19142803366555083,0.19087417103789525,0.19031118102612432,0.1898925688059969,0.18620339298213445,0.18620339298213445,0.1857602337840252,0.18588658329999871,0.18159003967499354,0.17786738891319845,0.17483936043005083,0.17250753637549085,0.1696000638104789,0.16404501090481108,0.1637342479823061,0.16244267873399149,0.1532968465153098,0.1532968465153098,0.1532968465153098,0.15143295549029703,0.1473407323876746,0.1473407323876746,0.14385784621661932,0.14385784621661932,0.13737826269503425,0.13737826269503425,0.13737826269503425,0.13737826269503425,0.13737826269503425,0.13737826269503425,0.13737826269503425,0.13737826269503425,0.13737826269503425,0.13253446153298923,0.13737826269503425,0.13737826269503425,0.13253446153298923,0.13253446153298923,0.13253446153298923,0.13085149857296535,0.13029072883768042,0.13029072883768042,0.13029072883768042,0.13013000895815882,0.13013000895815882,0.12906959220035752,0.12732013783316243,0.12732013783316243,0.12732013783316243,0.12732013783316243,0.12732013783316243,0.12732013783316243,0.12732013783316243,0.12732013783316243,0.12732013783316243,0.12732013783316243,0.12732013783316243,0.12732013783316243,0.12732013783316243,0.12732013783316243,0.13029072883768042,0.13234701709010555,0.13212564085429937,0.13212564085429937,0.13234701709010555,0.13234701709010555,0.13557736907884424,0.13557736907884424,0.13557736907884424,0.13557736907884424,0.13634842339599448,0.13737826269503425,0.13737826269503425,0.14553192057045183)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.2599971397161056), xlim = c(-171.24645646927604,-65.96418697874691), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.49591561253746, -67.55937288011856,-68.62283014769966,-69.68628741528077,-70.74974468286187,-71.81320195044297,-72.87665921802407,-73.94011648560517,-75.00357375318627,-76.06703102076739,-77.13048828834849,-78.19394555592959,-79.25740282351069,-80.32086009109179,-81.38431735867289,-82.44777462625399,-83.5112318938351,-84.5746891614162,-85.6381464289973,-86.7016036965784,-87.7650609641595,-88.82851823174062,-89.89197549932172,-90.95543276690282,-92.01889003448392,-93.08234730206502,-94.14580456964612,-95.20926183722722,-96.27271910480832,-97.33617637238943,-98.39963363997053,-99.46309090755163,-100.52654817513273,-101.59000544271385,-102.65346271029495,-103.71691997787605,-104.78037724545715,-105.84383451303825,-106.90729178061935,-107.97074904820045,-109.03420631578155,-110.09766358336265,-111.16112085094375,-112.22457811852486,-113.28803538610596,-114.35149265368706,-115.41494992126817,-116.47840718884927,-117.54186445643037,-118.60532172401147,-119.66877899159257,-120.73223625917367,-121.79569352675477,-122.85915079433587,-123.92260806191697,-124.98606532949809,-126.04952259707919,-127.11297986466029,-128.17643713224138,-129.2398943998225,-130.3033516674036,-131.3668089349847,-132.4302662025658,-133.4937234701469,-134.557180737728,-135.6206380053091,-136.6840952728902,-137.74755254047133,-138.81100980805243,-139.87446707563353,-140.93792434321463,-142.00138161079573,-143.06483887837683,-144.12829614595793,-145.19175341353903,-146.25521068112013,-147.31866794870123,-148.38212521628233,-149.44558248386343,-150.50903975144453,-151.57249701902563,-152.63595428660673,-153.69941155418783,-154.76286882176893,-155.82632608935003,-156.88978335693113,-157.95324062451226,-159.01669789209336,-160.08015515967446,-161.14361242725556,-162.20706969483666,-163.27052696241776,-164.3339842299989,-165.39744149758,-166.4608987651611,-167.5243560327422,-168.5878133003233,-169.6512705679044,-170.7147278354855)
counts=c(0.006, 0.006,0.001,0.003,0.004,0.005,0.003,0.0,0.001,0.001,0.0,0.001,0.001,0.003,0.003,0.005,0.003,0.005,0.011,0.02,0.029,0.036,0.047,0.057,0.053,0.052,0.047,0.054,0.038,0.039,0.042,0.04,0.039,0.04,0.04,0.034,0.032,0.021,0.021,0.014,0.012,0.021,0.016,0.013,0.013,0.01,0.007,0.005,0.004,0.003,0.004,0.002,0.005,0.003,0.002,0.003,0.003,0.001,0.001,0.002,0.001,0.001,0.001,0.003,0.003,0.001,0.001,0.001,0.001,0.001,0.002,0.001,0.0,0.002,0.0,0.001,0.0,0.0,0.003,0.001,0.002,0.001,0.0,0.002,0.002,0.004,0.001,0.0,0.002,0.001,0.001,0.004,0.001,0.002,0.001,0.003,0.01,0.009,0.011)
plot(mids,counts,type = 'h', xlim = c(-171.24645646927604,-65.96418697874691), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.034373342566936936
bf6 = 0.2082517257323996
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.49059832619955, -67.54342102110485,-68.59624371601015,-69.64906641091542,-70.70188910582073,-71.754711800726,-72.8075344956313,-73.8603571905366,-74.91317988544188,-75.96600258034718,-77.01882527525248,-78.07164797015776,-79.12447066506306,-80.17729335996833,-81.23011605487363,-82.28293874977894,-83.33576144468421,-84.38858413958951,-85.44140683449481,-86.49422952940009,-87.54705222430539,-88.59987491921066,-89.65269761411597,-90.70552030902127,-91.75834300392654,-92.81116569883184,-93.86398839373712,-94.91681108864242,-95.96963378354772,-97.022456478453,-98.0752791733583,-99.1281018682636,-100.18092456316887,-101.23374725807417,-102.28656995297945,-103.33939264788475,-104.39221534279005,-105.44503803769533,-106.49786073260063,-107.55068342750593,-108.6035061224112,-109.6563288173165,-110.70915151222178,-111.76197420712708,-112.81479690203238,-113.86761959693766,-114.92044229184296,-115.97326498674823,-117.02608768165354,-118.07891037655884,-119.13173307146411,-120.18455576636941,-121.23737846127472,-122.29020115617999,-123.34302385108529,-124.39584654599057,-125.44866924089587,-126.50149193580117,-127.55431463070644,-128.60713732561175,-129.65996002051705,-130.71278271542232,-131.76560541032762,-132.81842810523293,-133.8712508001382,-134.92407349504347,-135.9768961899488,-137.02971888485408,-138.08254157975935,-139.13536427466465,-140.18818696956995,-141.24100966447523,-142.29383235938053,-143.34665505428583,-144.3994777491911,-145.4523004440964,-146.5051231390017,-147.55794583390698,-148.6107685288123,-149.6635912237176,-150.71641391862286,-151.76923661352814,-152.82205930843344,-153.87488200333874,-154.927704698244,-155.98052739314932,-157.03335008805462,-158.0861727829599,-159.1389954778652,-160.1918181727705,-161.24464086767577,-162.29746356258107,-163.35028625748637,-164.40310895239165,-165.45593164729692,-166.50875434220222,-167.56157703710753,-168.6143997320128,-169.6672224269181,-170.7200451218234)
rate=c(3.3178401551346424, 0.2679167202740793,0.2668625280843814,0.26626549696766605,0.26626549696766605,0.2650669416607567,0.226834568042623,0.1421665253325356,0.13658819671325906,0.13389178107219596,0.13350048518774588,0.13350048518774588,0.13345494268952063,0.13345494268952063,0.13345494268952063,0.13350048518774588,0.11869428019604307,0.010182463082833063,0.009185266570410789,0.00898921882904975,0.008957826056810394,0.008942886258466832,0.008926739003200181,0.008911799139910085,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.008911799139910085,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031,0.0089083472367031)
minHPD=c(0.33521380885032837, 0.12529577814402684,0.12529577814402684,0.12529577814402684,0.12529577814402684,0.12529577814402684,0.09442055204144512,0.07430597498592573,0.07430597498592573,0.07430597498592573,0.0744643113984101,0.0744643113984101,0.07430597498592573,0.07430597498592573,0.07430597498592573,0.07430597498592573,0.0016041077859384495,0.00025592024934165933,0.00025592024934165933,0.00025592024934165933,0.00025592024934165933,0.00038297779625097873,0.0005089756609808261,0.00025592024934165933,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005501315074933007,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261,0.0005089756609808261)
maxHPD=c(6.55492702310211, 0.45485512573241527,0.4518358144425524,0.4518358144425524,0.4518358144425524,0.45808465321387337,0.4429557727564423,0.283171652278443,0.22477778978194413,0.20921942717350508,0.2074041655769463,0.2074041655769463,0.2074041655769463,0.2074041655769463,0.2074041655769463,0.20859938116452562,0.19681108126328967,0.12576810599700466,0.07803693877352379,0.03050501756885686,0.028678974548895942,0.028209661523414097,0.028012020047275318,0.026821036268576078,0.026821036268576078,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026697208334765354,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078,0.026821036268576078)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 7.210419725412321), xlim = c(-171.24645646927604,-65.96418697874691), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.49591561253746, -67.55937288011856,-68.62283014769966,-69.68628741528077,-70.74974468286187,-71.81320195044297,-72.87665921802407,-73.94011648560517,-75.00357375318627,-76.06703102076739,-77.13048828834849,-78.19394555592959,-79.25740282351069,-80.32086009109179,-81.38431735867289,-82.44777462625399,-83.5112318938351,-84.5746891614162,-85.6381464289973,-86.7016036965784,-87.7650609641595,-88.82851823174062,-89.89197549932172,-90.95543276690282,-92.01889003448392,-93.08234730206502,-94.14580456964612,-95.20926183722722,-96.27271910480832,-97.33617637238943,-98.39963363997053,-99.46309090755163,-100.52654817513273,-101.59000544271385,-102.65346271029495,-103.71691997787605,-104.78037724545715,-105.84383451303825,-106.90729178061935,-107.97074904820045,-109.03420631578155,-110.09766358336265,-111.16112085094375,-112.22457811852486,-113.28803538610596,-114.35149265368706,-115.41494992126817,-116.47840718884927,-117.54186445643037,-118.60532172401147,-119.66877899159257,-120.73223625917367,-121.79569352675477,-122.85915079433587,-123.92260806191697,-124.98606532949809,-126.04952259707919,-127.11297986466029,-128.17643713224138,-129.2398943998225,-130.3033516674036,-131.3668089349847,-132.4302662025658,-133.4937234701469,-134.557180737728,-135.6206380053091,-136.6840952728902,-137.74755254047133,-138.81100980805243,-139.87446707563353,-140.93792434321463,-142.00138161079573,-143.06483887837683,-144.12829614595793,-145.19175341353903,-146.25521068112013,-147.31866794870123,-148.38212521628233,-149.44558248386343,-150.50903975144453,-151.57249701902563,-152.63595428660673,-153.69941155418783,-154.76286882176893,-155.82632608935003,-156.88978335693113,-157.95324062451226,-159.01669789209336,-160.08015515967446,-161.14361242725556,-162.20706969483666,-163.27052696241776,-164.3339842299989,-165.39744149758,-166.4608987651611,-167.5243560327422,-168.5878133003233,-169.6512705679044,-170.7147278354855)
counts=c(0.963, 0.004,0.002,0.0,0.008,0.092,0.424,0.031,0.026,0.008,0.0,0.001,0.0,0.0,0.004,0.395,0.472,0.08,0.02,0.009,0.002,0.003,0.002,0.002,0.002,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.001,0.001,0.001,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.001,0.001,0.0,0.001,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.002,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.0)
plot(mids,counts,type = 'h', xlim = c(-171.24645646927604,-65.96418697874691), ylim=c(0,0.963), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.49059832619955, -67.54342102110485,-68.59624371601015,-69.64906641091542,-70.70188910582073,-71.754711800726,-72.8075344956313,-73.8603571905366,-74.91317988544188,-75.96600258034718,-77.01882527525248,-78.07164797015776,-79.12447066506306,-80.17729335996833,-81.23011605487363,-82.28293874977894,-83.33576144468421,-84.38858413958951,-85.44140683449481,-86.49422952940009,-87.54705222430539,-88.59987491921066,-89.65269761411597,-90.70552030902127,-91.75834300392654,-92.81116569883184,-93.86398839373712,-94.91681108864242,-95.96963378354772,-97.022456478453,-98.0752791733583,-99.1281018682636,-100.18092456316887,-101.23374725807417,-102.28656995297945,-103.33939264788475,-104.39221534279005,-105.44503803769533,-106.49786073260063,-107.55068342750593,-108.6035061224112,-109.6563288173165,-110.70915151222178,-111.76197420712708,-112.81479690203238,-113.86761959693766,-114.92044229184296,-115.97326498674823,-117.02608768165354,-118.07891037655884,-119.13173307146411,-120.18455576636941,-121.23737846127472,-122.29020115617999,-123.34302385108529,-124.39584654599057,-125.44866924089587,-126.50149193580117,-127.55431463070644,-128.60713732561175,-129.65996002051705,-130.71278271542232,-131.76560541032762,-132.81842810523293,-133.8712508001382,-134.92407349504347,-135.9768961899488,-137.02971888485408,-138.08254157975935,-139.13536427466465,-140.18818696956995,-141.24100966447523,-142.29383235938053,-143.34665505428583,-144.3994777491911,-145.4523004440964,-146.5051231390017,-147.55794583390698,-148.6107685288123,-149.6635912237176,-150.71641391862286,-151.76923661352814,-152.82205930843344,-153.87488200333874,-154.927704698244,-155.98052739314932,-157.03335008805462,-158.0861727829599,-159.1389954778652,-160.1918181727705,-161.24464086767577,-162.29746356258107,-163.35028625748637,-164.40310895239165,-165.45593164729692,-166.50875434220222,-167.56157703710753,-168.6143997320128,-169.6672224269181,-170.7200451218234)
net_rate=c(-3.3405276086571813, -0.11220848626386914,-0.11130551347763043,-0.11040267155619563,-0.11063296014064847,-0.11098052958092725,-0.09522851053397628,0.008349308178531722,0.016801090363764485,0.021263263438842456,0.02232327002829099,0.02232327002829099,0.022546368252642324,0.022634657485164487,0.02292296885807884,0.023036562336062872,0.05042344386396831,0.1349258772297427,0.14566872275554088,0.14844312685908853,0.1453716913768469,0.14291426360262097,0.13726232231920707,0.13113189854540908,0.12461258294159511,0.1185609083029507,0.11056157691229251,0.10525622546889292,0.09835785243255879,0.09347708772637504,0.08879898961086391,0.08418997663365553,0.0798736061883315,0.07524926276037171,0.06952082794465882,0.06402649882794614,0.05988866061916386,0.05497909527789782,0.05273568159392216,0.04986064906328852,0.0481458435088616,0.04606669817093438,0.04404883208513225,0.04181247186373308,0.0400534581922324,0.03871084271758382,0.037665632257081604,0.03681819230049229,0.035604641992532216,0.03515123155007274,0.03493346240794893,0.03447768436385295,0.03443516298389579,0.0340846664331004,0.033798929943656277,0.03362349371628959,0.03330764693009183,0.03325588853721797,0.03304688413609031,0.03294457815968394,0.03264280686928999,0.03264055013718549,0.03256775252738749,0.03246198698003665,0.032389617750436306,0.03227651962220306,0.03229404558547162,0.03229404558547162,0.03224290494222098,0.0320498752573966,0.0320498752573966,0.0320275439260255,0.031926050867682076,0.031931397996512234,0.031931397996512234,0.03187539773546285,0.03187539773546285,0.03192926704754267,0.03192926704754267,0.03198313982981879,0.03207598565206046,0.032138289373870595,0.03223179029988085,0.03223179029988085,0.03223179029988085,0.032483365878757484,0.03273424122968445,0.03344857151509302,0.03361589461631567,0.033612683857151944,0.033888989994119004,0.033888989994119004,0.03426980013357888,0.03472296929197636,0.0347535598521433,0.03511128071614885,0.035386200127451604,0.03787347398795613,0.03955445570817508,0.045162224475882806)
net_minHPD=c(-6.350322519849222, -0.3048288961550899,-0.3027735662548544,-0.30126282088595735,-0.30126282088595735,-0.3048288961550899,-0.2966614590284332,-0.11391684051694889,-0.07007740986184005,-0.06124985522517504,-0.0590010220917572,-0.0590010220917572,-0.05922400043207762,-0.05922400043207762,-0.06014759879572243,-0.06029153642173621,-0.0590010220917572,0.018099032201809723,0.05640194467143558,0.07512637404714125,0.051249609075878534,0.048035843689406055,0.018159779843288884,0.008601242390922715,0.008542144294504115,0.006668895394361666,0.005165634428734328,0.004368359343772155,0.000314359142212482,0.000314359142212482,-0.000777484320201579,-0.004997165444152098,-0.008724542703529818,-0.009447750437009302,-0.006875536780786565,-0.004348749356291277,-0.009447750437009302,-0.0073154075119783845,-0.010248140951185074,-0.010248140951185074,-0.010150117492984815,-0.014763625568513445,-0.010248140951185074,-0.010150117492984815,-0.009559403974927175,-0.0073154075119783845,-0.01238514546924531,-0.011370528226721053,-0.01238514546924531,-0.011370528226721053,-0.011370528226721053,-0.010248140951185074,-0.010248140951185074,-0.014763625568513445,-0.015186613518106816,-0.013624648916313917,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.015186613518106816,-0.015186613518106816,-0.014763625568513445,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.01228648145197318,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.015186613518106816,-0.015186613518106816,-0.015186613518106816,-0.015186613518106816,-0.015186613518106816,-0.015186613518106816,-0.015186613518106816,-0.015186613518106816,-0.015186613518106816,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.015186613518106816,-0.015186613518106816,-0.015186613518106816,-0.01238514546924531,-0.01238514546924531,-0.01238514546924531,-0.015186613518106816,-0.010248140951185074)
net_maxHPD=c(-0.13329361294166506, 0.057700872477495446,0.04864683142485282,0.048341047027501166,0.048341047027501166,0.04864683142485282,0.0686292622378847,0.10351865169391657,0.10492217887272665,0.09870416647117838,0.09870416647117838,0.09870416647117838,0.09870416647117838,0.09870416647117838,0.09870416647117838,0.10110179321061792,0.17386283007832704,0.19847404806310656,0.19847404806310656,0.20923875038375175,0.1978124089763574,0.21192658601395045,0.19617282810214048,0.18878419222402198,0.1880033148557846,0.18663867951651164,0.18647831169112056,0.18642042834658742,0.18252834130593135,0.18252834130593135,0.18083175295821144,0.17552828008612625,0.17340241654418148,0.17275902439381352,0.17231922798757193,0.17231922798757193,0.16664462018203488,0.16694510370165247,0.16157857852651047,0.1576074772550438,0.1576074772550438,0.149157650209276,0.14792707312806827,0.14612476762248755,0.14493251464484905,0.14612476762248755,0.14017114763547306,0.1424383645061607,0.1384839931731118,0.1384839931731118,0.1384839931731118,0.1384839931731118,0.13805474127131828,0.13145481011172672,0.1305848165283994,0.13145481011172672,0.13121847164791894,0.13121847164791894,0.13036037097780562,0.12953953590733602,0.1258143494641526,0.1258143494641526,0.1258143494641526,0.12727926026039998,0.12727926026039998,0.12727926026039998,0.12727926026039998,0.12727926026039998,0.12661936411106423,0.1258143494641526,0.1258143494641526,0.1258143494641526,0.1252434420743009,0.1252434420743009,0.1252434420743009,0.12357214760996926,0.12357214760996926,0.12052508531506359,0.12052508531506359,0.12052508531506359,0.12052508531506359,0.12052508531506359,0.11989493660991696,0.11989493660991696,0.11989493660991696,0.12052508531506359,0.12357214760996926,0.1258143494641526,0.12661936411106423,0.12661936411106423,0.12727926026039998,0.12727926026039998,0.1258143494641526,0.12661936411106423,0.12661936411106423,0.12953953590733602,0.12953953590733602,0.1305848165283994,0.13145481011172672,0.1460902396769474)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-6.985354771834144, 0.23311924461534553), xlim = c(-171.24645646927604,-65.96418697874691), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.49059832619955, -67.54342102110485,-68.59624371601015,-69.64906641091542,-70.70188910582073,-71.754711800726,-72.8075344956313,-73.8603571905366,-74.91317988544188,-75.96600258034718,-77.01882527525248,-78.07164797015776,-79.12447066506306,-80.17729335996833,-81.23011605487363,-82.28293874977894,-83.33576144468421,-84.38858413958951,-85.44140683449481,-86.49422952940009,-87.54705222430539,-88.59987491921066,-89.65269761411597,-90.70552030902127,-91.75834300392654,-92.81116569883184,-93.86398839373712,-94.91681108864242,-95.96963378354772,-97.022456478453,-98.0752791733583,-99.1281018682636,-100.18092456316887,-101.23374725807417,-102.28656995297945,-103.33939264788475,-104.39221534279005,-105.44503803769533,-106.49786073260063,-107.55068342750593,-108.6035061224112,-109.6563288173165,-110.70915151222178,-111.76197420712708,-112.81479690203238,-113.86761959693766,-114.92044229184296,-115.97326498674823,-117.02608768165354,-118.07891037655884,-119.13173307146411,-120.18455576636941,-121.23737846127472,-122.29020115617999,-123.34302385108529,-124.39584654599057,-125.44866924089587,-126.50149193580117,-127.55431463070644,-128.60713732561175,-129.65996002051705,-130.71278271542232,-131.76560541032762,-132.81842810523293,-133.8712508001382,-134.92407349504347,-135.9768961899488,-137.02971888485408,-138.08254157975935,-139.13536427466465,-140.18818696956995,-141.24100966447523,-142.29383235938053,-143.34665505428583,-144.3994777491911,-145.4523004440964,-146.5051231390017,-147.55794583390698,-148.6107685288123,-149.6635912237176,-150.71641391862286,-151.76923661352814,-152.82205930843344,-153.87488200333874,-154.927704698244,-155.98052739314932,-157.03335008805462,-158.0861727829599,-159.1389954778652,-160.1918181727705,-161.24464086767577,-162.29746356258107,-163.35028625748637,-164.40310895239165,-165.45593164729692,-166.50875434220222,-167.56157703710753,-168.6143997320128,-169.6672224269181,-170.7200451218234)
rate=c(0.2852659029236943, 3.6496141333120766,3.6712822916447085,3.6833142971547583,3.6833142971547583,3.681752063373249,3.9195219250026554,6.615465346269647,7.007258491603755,7.2325710320585594,7.290233667844891,7.290233667844891,7.297209403298035,7.297209403298035,7.297209403298035,7.285073333906901,9.009151984100773,37.20029074042866,62.55020270231845,75.64582155924846,79.85225714714512,82.31253415388021,83.39991057336765,84.45482909868656,85.70240773964525,87.73882737717643,87.73882737717643,87.73882737717643,87.73882737717643,87.73882737717643,87.73882737717643,87.73882737717643,87.73882737717643,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.58754232670906,87.58754232670906,87.58754232670906,87.58754232670906,87.5186208131002,87.60293214259815,87.60293214259815,87.60293214259815,87.60293214259815,87.60293214259815,87.60293214259815,87.62021771015549,87.62021771015549,87.62021771015549,87.62021771015549,87.60289552022087,87.70635397921471,87.70635397921471,88.14949425015008,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.97119769078694,87.97119769078694,87.97119769078694,87.67177375773849,87.67177375773849,87.67177375773849,87.67177375773849,87.67177375773849,87.67599688537499,87.67599688537499,87.67599688537499)
minHPD=c(0.2852659029236943, 3.6496141333120766,3.6712822916447085,3.6833142971547583,3.6833142971547583,3.681752063373249,3.9195219250026554,6.615465346269647,7.007258491603755,7.2325710320585594,7.290233667844891,7.290233667844891,7.297209403298035,7.297209403298035,7.297209403298035,7.285073333906901,9.009151984100773,37.20029074042866,62.55020270231845,75.64582155924846,79.85225714714512,82.31253415388021,83.39991057336765,84.45482909868656,85.70240773964525,87.73882737717643,87.73882737717643,87.73882737717643,87.73882737717643,87.73882737717643,87.73882737717643,87.73882737717643,87.73882737717643,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.58754232670906,87.58754232670906,87.58754232670906,87.58754232670906,87.5186208131002,87.60293214259815,87.60293214259815,87.60293214259815,87.60293214259815,87.60293214259815,87.60293214259815,87.62021771015549,87.62021771015549,87.62021771015549,87.62021771015549,87.60289552022087,87.70635397921471,87.70635397921471,88.14949425015008,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.97119769078694,87.97119769078694,87.97119769078694,87.67177375773849,87.67177375773849,87.67177375773849,87.67177375773849,87.67177375773849,87.67599688537499,87.67599688537499,87.67599688537499)
maxHPD=c(0.2852659029236943, 3.6496141333120766,3.6712822916447085,3.6833142971547583,3.6833142971547583,3.681752063373249,3.9195219250026554,6.615465346269647,7.007258491603755,7.2325710320585594,7.290233667844891,7.290233667844891,7.297209403298035,7.297209403298035,7.297209403298035,7.285073333906901,9.009151984100773,37.20029074042866,62.55020270231845,75.64582155924846,79.85225714714512,82.31253415388021,83.39991057336765,84.45482909868656,85.70240773964525,87.73882737717643,87.73882737717643,87.73882737717643,87.73882737717643,87.73882737717643,87.73882737717643,87.73882737717643,87.73882737717643,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.38666580648308,87.58754232670906,87.58754232670906,87.58754232670906,87.58754232670906,87.5186208131002,87.60293214259815,87.60293214259815,87.60293214259815,87.60293214259815,87.60293214259815,87.60293214259815,87.62021771015549,87.62021771015549,87.62021771015549,87.62021771015549,87.60289552022087,87.70635397921471,87.70635397921471,88.14949425015008,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.99605255677793,87.97119769078694,87.97119769078694,87.97119769078694,87.67177375773849,87.67177375773849,87.67177375773849,87.67177375773849,87.67177375773849,87.67599688537499,87.67599688537499,87.67599688537499)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 96.9644436751651), xlim = c(-171.24645646927604,-65.96418697874691), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()