

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.20929787619693, -66.45235877763787,-66.69541967907884,-66.93848058051978,-67.18154148196075,-67.42460238340172,-67.66766328484266,-67.91072418628363,-68.15378508772457,-68.39684598916554,-68.63990689060648,-68.88296779204745,-69.1260286934884,-69.36908959492936,-69.6121504963703,-69.85521139781127,-70.09827229925224,-70.34133320069319,-70.58439410213415,-70.8274550035751,-71.07051590501607,-71.31357680645701,-71.55663770789798,-71.79969860933892,-72.04275951077989,-72.28582041222086,-72.5288813136618,-72.77194221510277,-73.01500311654371,-73.25806401798468,-73.50112491942562,-73.74418582086659,-73.98724672230753,-74.2303076237485,-74.47336852518944,-74.71642942663041,-74.95949032807138,-75.20255122951232,-75.4456121309533,-75.68867303239423,-75.9317339338352,-76.17479483527615,-76.41785573671712,-76.66091663815806,-76.90397753959903,-77.14703844104,-77.39009934248094,-77.6331602439219,-77.87622114536285,-78.11928204680382,-78.36234294824476,-78.60540384968573,-78.84846475112667,-79.09152565256764,-79.33458655400858,-79.57764745544955,-79.82070835689052,-80.06376925833146,-80.30683015977243,-80.54989106121337,-80.79295196265434,-81.03601286409528,-81.27907376553625,-81.5221346669772,-81.76519556841816,-82.0082564698591,-82.25131737130008,-82.49437827274105,-82.73743917418199,-82.98050007562296,-83.2235609770639,-83.46662187850487,-83.70968277994581,-83.95274368138678,-84.19580458282772,-84.43886548426869,-84.68192638570966,-84.9249872871506,-85.16804818859157,-85.41110909003251,-85.65416999147348,-85.89723089291442,-86.14029179435539,-86.38335269579633,-86.6264135972373,-86.86947449867824,-87.11253540011921,-87.35559630156018,-87.59865720300112,-87.8417181044421,-88.08477900588304,-88.327839907324,-88.57090080876495,-88.81396171020592,-89.05702261164686,-89.30008351308783,-89.5431444145288,-89.78620531596974,-90.02926621741071,-90.27232711885165)
rate=c(0.08982490920638941, 0.08959233461861196,0.08821797146587433,0.08356098941621584,0.08081990108758944,0.08026683780467331,0.0797028615774011,0.07931128584126353,0.078371864298221,0.07796599548104716,0.07743265700209266,0.07720633862999327,0.0770210989120006,0.07697884275668962,0.07693099521318321,0.07679961589617842,0.07645992636647761,0.07537495592229396,0.07430222891497948,0.07324986861357748,0.07261118077725014,0.07218422138956306,0.07188243657338514,0.07167365548014375,0.07149620498538858,0.07149620498538858,0.07132852786108568,0.07111321146212055,0.07079715911733507,0.07063601202572747,0.07051360466502016,0.07046781032542682,0.07027246261044576,0.07020310938867728,0.07013443401799162,0.0700729903974496,0.07003164270110006,0.07003164270110006,0.07000374251882435,0.06997892271601824,0.06989081787450219,0.06978588498446742,0.06968661399183057,0.06952749209407096,0.06952749209407096,0.06942434600673865,0.06932349403455851,0.06932349403455851,0.06924479318623097,0.06924479318623097,0.06918956677363283,0.06918956677363283,0.06886876869363107,0.06876737853830903,0.06866350899894752,0.0686074956488256,0.0686074956488256,0.06859968795453401,0.06859968795453401,0.0686074956488256,0.0686074956488256,0.06866350899894752,0.06876737853830903,0.06942434600673865,0.07003164270110006,0.07072315889219798,0.07283566994593518,0.07904189198132482,0.09471571154693159,0.3367438764487549,0.40363854841161273,0.43653479270143325,0.45314634718426916,0.46432282682044124,0.47496294782369397,0.4811725347037248,0.4871147714978644,0.49132366045801046,0.4962882226646199,0.49885718049444805,0.498483471768312,0.5024472723762665,0.5075555753538601,0.5114486857428824,0.5143218918205112,0.5183906608428339,0.5199060580261452,0.5203014560671675,0.5243292078602693,0.5283130657848077,0.5325009414579893,0.5339936364153965,0.5351654179620506,0.5380182433007895,0.5400541429179975,0.5403678510714862,0.5429498131833195,0.5444515930671203,0.5465489488897137,0.5483154832594633)
minHPD=c(0.030112104971979664, 0.03317732398233317,0.030112104971979664,0.03317732398233317,0.03415560870553213,0.02799580685207403,0.03317732398233317,0.03317732398233317,0.03415560870553213,0.03317732398233317,0.03612180458761845,0.030505648097044775,0.030112104971979664,0.030112104971979664,0.03317732398233317,0.03317732398233317,0.03404241550001628,0.02799580685207403,0.03317732398233317,0.02799580685207403,0.02799580685207403,0.03317732398233317,0.03404241550001628,0.03317732398233317,0.033572485707007896,0.033572485707007896,0.033572485707007896,0.032708575916033975,0.032708575916033975,0.032708575916033975,0.032938782403861375,0.032708575916033975,0.032938782403861375,0.032938782403861375,0.032708575916033975,0.032938782403861375,0.032938782403861375,0.032938782403861375,0.032938782403861375,0.03317732398233317,0.032708575916033975,0.032708575916033975,0.03317732398233317,0.03317732398233317,0.03317732398233317,0.032708575916033975,0.03125854297478901,0.030505648097044775,0.030505648097044775,0.030112104971979664,0.029460489860309105,0.029460489860309105,0.030505648097044775,0.029300092135836064,0.028559046750312303,0.02549151757679799,0.02549151757679799,0.024575257275334675,0.024575257275334675,0.024575257275334675,0.024575257275334675,0.024575257275334675,0.025123892661395524,0.02617859473810531,0.01508306202500527,0.007452518426116625,0.013963491251805205,0.006391082879685911,0.024575257275334675,0.019209939159142316,0.023000878591517112,0.025123892661395524,0.02549151757679799,0.028088505500080452,0.034832493250334995,0.02549151757679799,0.028088505500080452,0.02549151757679799,0.031796098498124814,0.02549151757679799,0.033572485707007896,0.030112104971979664,0.02549151757679799,0.040272084854277905,0.031796098498124814,0.034832493250334995,0.031796098498124814,0.031796098498124814,0.031796098498124814,0.040272084854277905,0.031796098498124814,0.04514423575041323,0.047451783943739695,0.047451783943739695,0.16591869185339464,0.14210989652029418,0.18469360955715253,0.14210989652029418,0.16591869185339464,0.16591869185339464)
maxHPD=c(0.6922876391990066, 0.6922876391990066,0.6734999918826762,0.4846977333937126,0.364099907472734,0.33573747929755443,0.3025554203221667,0.2981021122886885,0.26745740946652674,0.2572355724876079,0.25671289304541495,0.24597923424497725,0.24149205684756717,0.24149205684756717,0.24149205684756717,0.24149205684756717,0.24149205684756717,0.19681979408077083,0.17890664365049314,0.1391599255142657,0.1257364459762901,0.122973264169741,0.11960498573153398,0.11722969542999265,0.11722969542999265,0.11722969542999265,0.1166319529904993,0.11422476471910761,0.11267100355742427,0.10959378241531278,0.10959378241531278,0.10869123582630581,0.10869123582630581,0.10869123582630581,0.10869123582630581,0.10959378241531278,0.10959378241531278,0.10959378241531278,0.10959378241531278,0.10959378241531278,0.10869123582630581,0.10869123582630581,0.10959378241531278,0.10959378241531278,0.10959378241531278,0.10959378241531278,0.10959378241531278,0.10959378241531278,0.10959378241531278,0.10959378241531278,0.10959378241531278,0.10959378241531278,0.10959378241531278,0.10959378241531278,0.10959378241531278,0.10683824130834106,0.10683824130834106,0.10653109833377357,0.10653109833377357,0.10653109833377357,0.10653109833377357,0.10683824130834106,0.10861659879451885,0.11722969542999265,0.122973264169741,0.3043051727228681,0.4557605676785147,0.6265390685074773,0.7696181647490173,0.8607411880791214,0.8868852754405302,0.9050329970425965,0.909278292454676,0.9292513187256358,0.9563859002304337,0.9292513187256358,0.9387864684929006,0.9292513187256358,0.928572612786264,0.928572612786264,0.928572612786264,0.928572612786264,0.9387864684929006,0.9572502304163706,0.9572502304163706,0.9572502304163706,0.965168962069081,0.9732605108505298,0.9732605108505298,0.9892178455245005,0.9892178455245005,1.0150949837408578,1.0195050114561157,1.0288890073637424,1.1263602595547315,1.0947189177029362,1.1586596869107297,1.107911071050626,1.1263602595547315,1.1263602595547315)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.2745256556018028), xlim = c(-90.39385756957213,-66.08776742547644), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.21052545650723, -66.45604151856881,-66.70155758063038,-66.94707364269195,-67.19258970475352,-67.4381057668151,-67.68362182887667,-67.92913789093824,-68.17465395299982,-68.42017001506139,-68.66568607712296,-68.91120213918452,-69.15671820124611,-69.40223426330768,-69.64775032536924,-69.89326638743083,-70.1387824494924,-70.38429851155396,-70.62981457361553,-70.87533063567712,-71.12084669773868,-71.36636275980025,-71.61187882186182,-71.8573948839234,-72.10291094598497,-72.34842700804654,-72.59394307010812,-72.8394591321697,-73.08497519423126,-73.33049125629283,-73.57600731835441,-73.82152338041598,-74.06703944247755,-74.31255550453913,-74.5580715666007,-74.80358762866227,-75.04910369072384,-75.29461975278542,-75.54013581484699,-75.78565187690856,-76.03116793897014,-76.27668400103171,-76.52220006309328,-76.76771612515485,-77.01323218721643,-77.258748249278,-77.50426431133957,-77.74978037340115,-77.99529643546272,-78.24081249752429,-78.48632855958586,-78.73184462164744,-78.97736068370901,-79.22287674577058,-79.46839280783216,-79.71390886989373,-79.9594249319553,-80.20494099401687,-80.45045705607845,-80.69597311814002,-80.94148918020159,-81.18700524226317,-81.43252130432474,-81.6780373663863,-81.92355342844787,-82.16906949050946,-82.41458555257103,-82.6601016146326,-82.90561767669418,-83.15113373875575,-83.39664980081731,-83.64216586287888,-83.88768192494047,-84.13319798700203,-84.3787140490636,-84.62423011112519,-84.86974617318675,-85.11526223524832,-85.36077829730989,-85.60629435937147,-85.85181042143304,-86.09732648349461,-86.3428425455562,-86.58835860761776,-86.83387466967933,-87.0793907317409,-87.32490679380248,-87.57042285586405,-87.81593891792562,-88.0614549799872,-88.30697104204877,-88.55248710411034,-88.79800316617191,-89.04351922823348,-89.28903529029506,-89.53455135235663,-89.78006741441821,-90.02558347647978,-90.27109953854135)
counts=c(0.002, 0.008,0.069,0.053,0.017,0.018,0.009,0.019,0.007,0.007,0.008,0.007,0.0,0.005,0.004,0.01,0.022,0.02,0.022,0.017,0.011,0.009,0.002,0.001,0.0,0.005,0.007,0.007,0.004,0.006,0.0,0.003,0.0,0.003,0.001,0.002,0.0,0.001,0.003,0.002,0.001,0.002,0.003,0.001,0.003,0.002,0.001,0.0,0.001,0.001,0.001,0.004,0.001,0.001,0.001,0.002,0.001,0.001,0.0,0.002,0.003,0.009,0.022,0.029,0.05,0.1,0.182,0.143,0.085,0.068,0.052,0.049,0.035,0.024,0.022,0.02,0.022,0.017,0.01,0.012,0.017,0.016,0.014,0.011,0.013,0.006,0.012,0.013,0.012,0.012,0.011,0.008,0.011,0.01,0.01,0.003,0.005,0.002,0.003)
plot(mids,counts,type = 'h', xlim = c(-90.39385756957213,-66.08776742547644), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.027528580628075065
bf6 = 0.1729852891948883
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.20929787619693, -66.45235877763787,-66.69541967907884,-66.93848058051978,-67.18154148196075,-67.42460238340172,-67.66766328484266,-67.91072418628363,-68.15378508772457,-68.39684598916554,-68.63990689060648,-68.88296779204745,-69.1260286934884,-69.36908959492936,-69.6121504963703,-69.85521139781127,-70.09827229925224,-70.34133320069319,-70.58439410213415,-70.8274550035751,-71.07051590501607,-71.31357680645701,-71.55663770789798,-71.79969860933892,-72.04275951077989,-72.28582041222086,-72.5288813136618,-72.77194221510277,-73.01500311654371,-73.25806401798468,-73.50112491942562,-73.74418582086659,-73.98724672230753,-74.2303076237485,-74.47336852518944,-74.71642942663041,-74.95949032807138,-75.20255122951232,-75.4456121309533,-75.68867303239423,-75.9317339338352,-76.17479483527615,-76.41785573671712,-76.66091663815806,-76.90397753959903,-77.14703844104,-77.39009934248094,-77.6331602439219,-77.87622114536285,-78.11928204680382,-78.36234294824476,-78.60540384968573,-78.84846475112667,-79.09152565256764,-79.33458655400858,-79.57764745544955,-79.82070835689052,-80.06376925833146,-80.30683015977243,-80.54989106121337,-80.79295196265434,-81.03601286409528,-81.27907376553625,-81.5221346669772,-81.76519556841816,-82.0082564698591,-82.25131737130008,-82.49437827274105,-82.73743917418199,-82.98050007562296,-83.2235609770639,-83.46662187850487,-83.70968277994581,-83.95274368138678,-84.19580458282772,-84.43886548426869,-84.68192638570966,-84.9249872871506,-85.16804818859157,-85.41110909003251,-85.65416999147348,-85.89723089291442,-86.14029179435539,-86.38335269579633,-86.6264135972373,-86.86947449867824,-87.11253540011921,-87.35559630156018,-87.59865720300112,-87.8417181044421,-88.08477900588304,-88.327839907324,-88.57090080876495,-88.81396171020592,-89.05702261164686,-89.30008351308783,-89.5431444145288,-89.78620531596974,-90.02926621741071,-90.27232711885165)
rate=c(2.6681520076623695, 1.9349525231725613,0.3095715780287541,0.2772775311692194,0.27415294567409,0.2708998611157137,0.26999503472966346,0.269676800364908,0.269676800364908,0.269676800364908,0.26999503472966346,0.26999503472966346,0.27037658363205147,0.2708998611157137,0.2705700617884148,0.2708998611157137,0.2708998611157137,0.27126675973835146,0.27223552230485537,0.27223552230485537,0.2708998611157137,0.27223552230485537,0.2708998611157137,0.2708998611157137,0.2705700617884148,0.2705700617884148,0.26800826992466864,0.2613301804753337,0.2518363231932816,0.2356458300860683,0.21645799166107632,0.19931490196227647,0.18156366240372912,0.16472701000461124,0.1349775687974325,0.06808840982348952,0.05805732847209238,0.049228254135967105,0.04394119814206514,0.0407528156153078,0.03874342308285674,0.03669537372444512,0.03573196823892577,0.03495497398679545,0.03470631449020818,0.034414895912443316,0.034414895912443316,0.03431080792696284,0.03431080792696284,0.03431080792696284,0.03431080792696284,0.03419367680872408,0.03409719175789944,0.03409719175789944,0.03409719175789944,0.03419367680872408,0.03419367680872408,0.03419367680872408,0.03431080792696284,0.03431080792696284,0.03431080792696284,0.03431080792696284,0.03431080792696284,0.03431080792696284,0.03431080792696284,0.03419367680872408,0.03419367680872408,0.03419367680872408,0.03419367680872408,0.03409719175789944,0.03419367680872408,0.03431080792696284,0.03431080792696284,0.03431080792696284,0.03431080792696284,0.03431080792696284,0.03431080792696284,0.03431080792696284,0.03431080792696284,0.034414895912443316,0.034414895912443316,0.034414895912443316,0.034414895912443316,0.034414895912443316,0.034414895912443316,0.034414895912443316,0.034473843357482534,0.03452924389421304,0.03452924389421304,0.034606475047515295,0.03467910296078281,0.034688312914846836,0.03470631449020818,0.03470631449020818,0.03470631449020818,0.03470631449020818,0.034723325181155194,0.034723325181155194,0.034723325181155194,0.034723325181155194)
minHPD=c(0.3043846749992316, 0.13626419378677415,0.10725056323989444,0.06660632990419264,0.13206408304729747,0.13691233878413478,0.1476734301916282,0.1503768752083762,0.1432162089995355,0.15990046472933694,0.15990046472933694,0.15990046472933694,0.15990046472933694,0.16017401432749112,0.16017401432749112,0.14479291070143038,0.16348510690966267,0.16348510690966267,0.15990046472933694,0.15990046472933694,0.16348510690966267,0.15581729473399428,0.16092610594610018,0.16052771345830566,0.16052771345830566,0.16052771345830566,0.13691233878413478,0.03723826985754034,0.023624434707882603,0.019525961914048377,0.016485996306878345,0.013039265836073741,0.015093904321994343,0.013039265836073741,0.015045249358060514,0.015045249358060514,0.011934653199441893,0.011717160379791394,0.011717160379791394,0.011717160379791394,0.011717160379791394,0.011717160379791394,0.007886236850803143,0.011498112767437953,0.008738991211789414,0.011622866676724143,0.011622866676724143,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.011498112767437953,0.01190173016895042,0.01190173016895042,0.01190173016895042,0.011498112767437953,0.011498112767437953,0.01190173016895042,0.01190173016895042,0.01190173016895042,0.01190173016895042,0.01190173016895042,0.01190173016895042,0.011717160379791394,0.011717160379791394,0.011717160379791394,0.011717160379791394,0.011717160379791394,0.011622866676724143,0.011622866676724143,0.011622866676724143,0.011622866676724143,0.011622866676724143,0.011622866676724143,0.011498112767437953,0.010355419299898179,0.010355419299898179,0.01019053312608475,0.009588298688230787,0.009384656923367977,0.009384656923367977,0.008738991211789414,0.00822341390059074,0.00822341390059074,0.00822341390059074,0.008097011041555654)
maxHPD=c(5.546593910683937, 4.319240686168373,2.7110411783432706,0.7863850802426068,0.48865035306946203,0.47198098781987735,0.47198098781987735,0.47031571750796963,0.45763881730039097,0.4714266743760314,0.47198098781987735,0.4714266743760314,0.4714266743760314,0.47031571750796963,0.47031571750796963,0.4538957040405873,0.47198098781987735,0.4714266743760314,0.46651051575599833,0.46651051575599833,0.4714266743760314,0.46518896997078407,0.47031571750796963,0.47031571750796963,0.47031571750796963,0.47031571750796963,0.47031571750796963,0.43117587335953894,0.4122515699945108,0.38926975144222375,0.3697938711108549,0.3433223005801578,0.32381814763124933,0.3082246914106539,0.30246255584653664,0.2976925334958516,0.28488352604490613,0.27563356912130815,0.2503647985623655,0.23084866947683688,0.2134655136439737,0.1891999739094985,0.08918049574904063,0.07382831577936765,0.06730648811832368,0.06690441828174538,0.06690441828174538,0.0664159747367083,0.06603765665757237,0.06603765665757237,0.06579798910308633,0.06560910456530122,0.06560910456530122,0.06560910456530122,0.06560910456530122,0.06560910456530122,0.06560910456530122,0.06579798910308633,0.06603765665757237,0.06603765665757237,0.06603765665757237,0.06603765665757237,0.06603765665757237,0.06603765665757237,0.06603765665757237,0.06603765665757237,0.0668145303268706,0.0668145303268706,0.0668145303268706,0.06603765665757237,0.06603765665757237,0.0668145303268706,0.0668145303268706,0.0668145303268706,0.0668145303268706,0.0668145303268706,0.06690441828174538,0.06690441828174538,0.06690441828174538,0.06690441828174538,0.06690441828174538,0.06690441828174538,0.06690441828174538,0.06690441828174538,0.06690441828174538,0.06690441828174538,0.06690441828174538,0.06730648811832368,0.06809110493050667,0.06730648811832368,0.06730648811832368,0.06730648811832368,0.06730648811832368,0.06730648811832368,0.06730648811832368,0.06730648811832368,0.06730648811832368,0.06730648811832368,0.06730648811832368,0.06730648811832368)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 6.101253301752331), xlim = c(-90.39385756957213,-66.08776742547644), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.21052545650723, -66.45604151856881,-66.70155758063038,-66.94707364269195,-67.19258970475352,-67.4381057668151,-67.68362182887667,-67.92913789093824,-68.17465395299982,-68.42017001506139,-68.66568607712296,-68.91120213918452,-69.15671820124611,-69.40223426330768,-69.64775032536924,-69.89326638743083,-70.1387824494924,-70.38429851155396,-70.62981457361553,-70.87533063567712,-71.12084669773868,-71.36636275980025,-71.61187882186182,-71.8573948839234,-72.10291094598497,-72.34842700804654,-72.59394307010812,-72.8394591321697,-73.08497519423126,-73.33049125629283,-73.57600731835441,-73.82152338041598,-74.06703944247755,-74.31255550453913,-74.5580715666007,-74.80358762866227,-75.04910369072384,-75.29461975278542,-75.54013581484699,-75.78565187690856,-76.03116793897014,-76.27668400103171,-76.52220006309328,-76.76771612515485,-77.01323218721643,-77.258748249278,-77.50426431133957,-77.74978037340115,-77.99529643546272,-78.24081249752429,-78.48632855958586,-78.73184462164744,-78.97736068370901,-79.22287674577058,-79.46839280783216,-79.71390886989373,-79.9594249319553,-80.20494099401687,-80.45045705607845,-80.69597311814002,-80.94148918020159,-81.18700524226317,-81.43252130432474,-81.6780373663863,-81.92355342844787,-82.16906949050946,-82.41458555257103,-82.6601016146326,-82.90561767669418,-83.15113373875575,-83.39664980081731,-83.64216586287888,-83.88768192494047,-84.13319798700203,-84.3787140490636,-84.62423011112519,-84.86974617318675,-85.11526223524832,-85.36077829730989,-85.60629435937147,-85.85181042143304,-86.09732648349461,-86.3428425455562,-86.58835860761776,-86.83387466967933,-87.0793907317409,-87.32490679380248,-87.57042285586405,-87.81593891792562,-88.0614549799872,-88.30697104204877,-88.55248710411034,-88.79800316617191,-89.04351922823348,-89.28903529029506,-89.53455135235663,-89.78006741441821,-90.02558347647978,-90.27109953854135)
counts=c(0.279, 0.452,0.192,0.03,0.009,0.009,0.006,0.007,0.003,0.004,0.001,0.003,0.004,0.001,0.002,0.004,0.004,0.003,0.003,0.004,0.002,0.003,0.001,0.001,0.0,0.033,0.056,0.058,0.086,0.091,0.068,0.06,0.03,0.034,0.05,0.054,0.095,0.095,0.048,0.052,0.035,0.043,0.014,0.012,0.006,0.0,0.002,0.001,0.001,0.001,0.001,0.0,0.0,0.0,0.001,0.0,0.002,0.001,0.0,0.001,0.0,0.0,0.0,0.001,0.001,0.0,0.0,0.001,0.0,0.003,0.0,0.001,0.0,0.0,0.0,0.002,0.0,0.0,0.002,0.001,0.001,0.0,0.0,0.001,0.001,0.002,0.002,0.002,0.002,0.001,0.003,0.001,0.0,0.001,0.002,0.0,0.0,0.001,0.0)
plot(mids,counts,type = 'h', xlim = c(-90.39385756957213,-66.08776742547644), ylim=c(0,0.452), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.20929787619693, -66.45235877763787,-66.69541967907884,-66.93848058051978,-67.18154148196075,-67.42460238340172,-67.66766328484266,-67.91072418628363,-68.15378508772457,-68.39684598916554,-68.63990689060648,-68.88296779204745,-69.1260286934884,-69.36908959492936,-69.6121504963703,-69.85521139781127,-70.09827229925224,-70.34133320069319,-70.58439410213415,-70.8274550035751,-71.07051590501607,-71.31357680645701,-71.55663770789798,-71.79969860933892,-72.04275951077989,-72.28582041222086,-72.5288813136618,-72.77194221510277,-73.01500311654371,-73.25806401798468,-73.50112491942562,-73.74418582086659,-73.98724672230753,-74.2303076237485,-74.47336852518944,-74.71642942663041,-74.95949032807138,-75.20255122951232,-75.4456121309533,-75.68867303239423,-75.9317339338352,-76.17479483527615,-76.41785573671712,-76.66091663815806,-76.90397753959903,-77.14703844104,-77.39009934248094,-77.6331602439219,-77.87622114536285,-78.11928204680382,-78.36234294824476,-78.60540384968573,-78.84846475112667,-79.09152565256764,-79.33458655400858,-79.57764745544955,-79.82070835689052,-80.06376925833146,-80.30683015977243,-80.54989106121337,-80.79295196265434,-81.03601286409528,-81.27907376553625,-81.5221346669772,-81.76519556841816,-82.0082564698591,-82.25131737130008,-82.49437827274105,-82.73743917418199,-82.98050007562296,-83.2235609770639,-83.46662187850487,-83.70968277994581,-83.95274368138678,-84.19580458282772,-84.43886548426869,-84.68192638570966,-84.9249872871506,-85.16804818859157,-85.41110909003251,-85.65416999147348,-85.89723089291442,-86.14029179435539,-86.38335269579633,-86.6264135972373,-86.86947449867824,-87.11253540011921,-87.35559630156018,-87.59865720300112,-87.8417181044421,-88.08477900588304,-88.327839907324,-88.57090080876495,-88.81396171020592,-89.05702261164686,-89.30008351308783,-89.5431444145288,-89.78620531596974,-90.02926621741071,-90.27232711885165)
net_rate=c(-2.688055981040988, -1.7215029506372637,-0.5538508938320638,-0.20421032763563615,-0.18640060295025754,-0.18225626626508207,-0.17977651261932706,-0.17806917113374557,-0.18357525970245892,-0.185086026863724,-0.18686191037314484,-0.1881904921557278,-0.189379886855756,-0.18986855976723374,-0.19059971403559262,-0.19117225610693456,-0.19200217745336035,-0.19697901757792505,-0.20097617487765326,-0.205044565018478,-0.20713393947639078,-0.20955189027167312,-0.21053827374866343,-0.21100067357490215,-0.211079794799246,-0.211079794799246,-0.20451411709601278,-0.1895076700573521,-0.17233299401207303,-0.14857355394957947,-0.12495223930620201,-0.1046342349462003,-0.08656784041584185,-0.07659329154016754,-0.07020847406966037,-0.059961213421408456,-0.04902679062142327,-0.031304086418238945,-0.010204460344015209,0.0025661498293477547,0.01065001481958497,0.01966895840923245,0.026148571505730602,0.030432652813072572,0.03182178063651535,0.03291572029884095,0.03283017255861906,0.03300108623721883,0.03306921052555533,0.03302122659876593,0.03304687715099363,0.03310292965838432,0.03291424522160564,0.032724780183115046,0.032664831138610635,0.03258349335868108,0.03256825231583136,0.03249082619769466,0.03245190237870581,0.03247027920800167,0.03246678952064203,0.032664963116900494,0.033340765707597975,0.037245957132980415,0.043978208449751824,0.055095299432416034,0.08003476088758502,0.1397913651635634,0.23799480168104384,0.30977185156883325,0.354731218631424,0.38739339295419495,0.4094929854703041,0.433384465517556,0.4489671486569182,0.45701952316242916,0.46482930889052937,0.4720164586901335,0.47425475130028527,0.479296347219844,0.4767318129945325,0.4804325970122377,0.4892565593735557,0.49431824146537146,0.49934586882838283,0.5024249823900737,0.509384608270198,0.5100405789540152,0.5133005844427186,0.5200832197445265,0.5263791587724117,0.530366686525239,0.5361615682872061,0.5393867083718041,0.5450927798280495,0.5475045631650703,0.5537017755319072,0.5574787366771463,0.5602293155586183,0.5645365048710703)
net_minHPD=c(-5.484030656335887, -4.330534374421292,-2.6198836645217214,-0.8145064849273285,-0.4303581887031187,-0.39970668661723446,-0.39970668661723446,-0.3978359080217996,-0.39970668661723446,-0.39970668661723446,-0.39970668661723446,-0.3972611251588704,-0.3972611251588704,-0.39970668661723446,-0.39970668661723446,-0.39970668661723446,-0.4043395813038368,-0.4043395813038368,-0.40171508195435074,-0.3978359080217996,-0.4043395813038368,-0.40171508195435074,-0.40137341133755594,-0.39970668661723446,-0.3978359080217996,-0.3978359080217996,-0.3978359080217996,-0.3660172814989309,-0.3461847501779404,-0.33299396295101735,-0.3115581163849791,-0.28448792400529505,-0.2622772313017173,-0.25176291944257445,-0.24619833820729473,-0.2324447639109196,-0.2224251917227557,-0.21484630236607336,-0.18709921697538606,-0.16305689504237805,-0.14742300327538382,-0.12084946063536228,-0.029901112123684695,-0.01595723034735915,-0.01502042117434882,-0.014184823118588413,-0.014184823118588413,-0.014184823118588413,-0.014184823118588413,-0.014184823118588413,-0.014184823118588413,-0.014184823118588413,-0.014558428179778392,-0.014184823118588413,-0.014184823118588413,-0.014184823118588413,-0.014184823118588413,-0.014184823118588413,-0.014184823118588413,-0.014184823118588413,-0.014184823118588413,-0.01502042117434882,-0.01595723034735915,-0.022021000237874316,-0.039445879593711854,-0.039445879593711854,-0.027724591637114538,-0.03423937861888563,-0.020565830731422687,-0.010972482938048596,-0.01555317539669456,-0.0147132637830805,-0.014184823118588413,-0.008597758854069826,-0.008597758854069826,-0.008597758854069826,-0.006012951930757127,0.0022202439661916547,-0.008597758854069826,-0.006012951930757127,-0.006012951930757127,-0.006012951930757127,-0.006012951930757127,0.0022202439661916547,0.008611954757496751,0.009458156798236333,0.008611954757496751,0.005880611463018687,0.009458156798236333,0.01485715657977964,-0.006012951930757127,0.02123909386890359,0.02430726303839322,0.02123909386890359,0.02862466997639413,0.13220018882012513,0.15284879952079952,0.13220018882012513,0.1591375233983746,0.1591375233983746)
net_maxHPD=c(-0.2051921357449129, 0.24158624914911703,0.5571354484186818,0.5522229431979059,0.2323046586173561,0.1632198186504677,0.0941214435007223,0.08190609425162612,0.027347113940993734,0.019021185229561033,0.01499868844386687,0.012857538806121671,0.012857538806121671,0.00263427519836687,0.00263427519836687,0.00263427519836687,-0.006012951930757127,-0.03565437149765699,-0.04494904477854367,-0.05015949582111423,-0.06250317628625393,-0.06926605850724998,-0.06926605850724998,-0.06926605850724998,-0.06926605850724998,-0.06926605850724998,-0.048498178833701264,0.03471969893231577,0.049252847218254715,0.06159460937518275,0.06773534395551675,0.06773534395551675,0.06773534395551675,0.06773534395551675,0.06783061657342572,0.07334416968178867,0.07654388105360267,0.07654388105360267,0.08641210880149108,0.08821556128348444,0.08583994089040509,0.09428758225774855,0.09626852600179948,0.08821556128348444,0.08296542731763006,0.08059104908336479,0.08059104908336479,0.08044032783831781,0.08008591452126312,0.08044032783831781,0.08008591452126312,0.08008591452126312,0.07934914797970061,0.08008591452126312,0.08008591452126312,0.08044032783831781,0.08044032783831781,0.08073281687331962,0.08073281687331962,0.08073281687331962,0.08073281687331962,0.08073281687331962,0.08073281687331962,0.0835625889049151,0.09158759067640723,0.2615570366805306,0.42154871853644854,0.5915951458386801,0.7165841320351696,0.8370008242866342,0.8571347673715556,0.867839833383467,0.8743689222931298,0.8956411068153173,0.9076248881190143,0.8971793483502533,0.9020084263081765,0.9076248881190143,0.8849722320527187,0.8956411068153173,0.8849722320527187,0.8849722320527187,0.8971793483502533,0.9076248881190143,0.9225992825319487,0.9225992825319487,0.9299692071497744,0.9308874016511032,0.9308874016511032,0.9456343880418381,0.9456343880418381,0.9868752253937385,0.9881535759140955,1.0001817502078967,1.0196591820127057,1.1232817395143004,1.1550374972263127,1.1301011345046228,1.1517361271074735,1.1517361271074735)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-6.0324337219694755, 1.270541246948944), xlim = c(-90.39385756957213,-66.08776742547644), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.20929787619693, -66.45235877763787,-66.69541967907884,-66.93848058051978,-67.18154148196075,-67.42460238340172,-67.66766328484266,-67.91072418628363,-68.15378508772457,-68.39684598916554,-68.63990689060648,-68.88296779204745,-69.1260286934884,-69.36908959492936,-69.6121504963703,-69.85521139781127,-70.09827229925224,-70.34133320069319,-70.58439410213415,-70.8274550035751,-71.07051590501607,-71.31357680645701,-71.55663770789798,-71.79969860933892,-72.04275951077989,-72.28582041222086,-72.5288813136618,-72.77194221510277,-73.01500311654371,-73.25806401798468,-73.50112491942562,-73.74418582086659,-73.98724672230753,-74.2303076237485,-74.47336852518944,-74.71642942663041,-74.95949032807138,-75.20255122951232,-75.4456121309533,-75.68867303239423,-75.9317339338352,-76.17479483527615,-76.41785573671712,-76.66091663815806,-76.90397753959903,-77.14703844104,-77.39009934248094,-77.6331602439219,-77.87622114536285,-78.11928204680382,-78.36234294824476,-78.60540384968573,-78.84846475112667,-79.09152565256764,-79.33458655400858,-79.57764745544955,-79.82070835689052,-80.06376925833146,-80.30683015977243,-80.54989106121337,-80.79295196265434,-81.03601286409528,-81.27907376553625,-81.5221346669772,-81.76519556841816,-82.0082564698591,-82.25131737130008,-82.49437827274105,-82.73743917418199,-82.98050007562296,-83.2235609770639,-83.46662187850487,-83.70968277994581,-83.95274368138678,-84.19580458282772,-84.43886548426869,-84.68192638570966,-84.9249872871506,-85.16804818859157,-85.41110909003251,-85.65416999147348,-85.89723089291442,-86.14029179435539,-86.38335269579633,-86.6264135972373,-86.86947449867824,-87.11253540011921,-87.35559630156018,-87.59865720300112,-87.8417181044421,-88.08477900588304,-88.327839907324,-88.57090080876495,-88.81396171020592,-89.05702261164686,-89.30008351308783,-89.5431444145288,-89.78620531596974,-90.02926621741071,-90.27232711885165)
rate=c(0.34639579824251154, 0.5211019094199457,1.3380462478063646,2.838626866403952,3.2555227769110178,3.3783239006908965,3.4721018198921834,3.5089252556556216,3.5226152714726053,3.523687861701019,3.5216801167113867,3.528762589797602,3.522665670091305,3.516886531903536,3.5183785987305827,3.5151274628551805,3.512246302864036,3.5112257263903093,3.5070813878646785,3.5016168731167285,3.5062346374649267,3.5022906803763143,3.5085038067748986,3.5095569863408747,3.5105586298918574,3.5105586298918574,3.595655811146367,3.8095304078911694,4.087551009609086,4.5378771642486235,5.097844224776078,5.692337592543391,6.349382185516832,6.780981610828047,7.08938309435064,7.647179004706363,8.351459153755064,9.80544425292397,12.369935169941668,14.705224405091329,16.7510467489574,19.746833426371527,22.681647421571917,25.367485998144122,26.30575725416836,27.182161662659848,27.182161662659848,27.345598804277824,27.4236373669028,27.4236373669028,27.49461484124164,27.537053353518544,27.55343254871153,27.55343254871153,27.55343254871153,27.543544731311403,27.543544731311403,27.56119727235371,27.531661662154466,27.52581495972765,27.523171180550875,27.523171180550875,27.523171180550875,27.523171180550875,27.523171180550875,27.645380832203905,27.653358577417386,27.653358577417386,27.653358577417386,27.69723481544758,27.670436871702965,27.66476529985381,27.66476529985381,27.662081292068297,27.662081292068297,27.662081292068297,27.683626128259924,27.54107748832922,27.54107748832922,27.52889378847177,27.536499417669074,27.524186702517756,27.432290041077763,27.432290041077763,27.432290041077763,27.32990639905717,27.31856287379406,27.091576174908397,26.818806496134528,26.762235192808316,26.44922194640736,25.91677020640033,25.772008484121738,25.52810274061176,25.52810274061176,25.466977601416954,25.21777149738632,25.21777149738632,25.21777149738632,25.221195953512034)
minHPD=c(0.34639579824251154, 0.5211019094199457,1.3380462478063646,2.838626866403952,3.2555227769110178,3.3783239006908965,3.4721018198921834,3.5089252556556216,3.5226152714726053,3.523687861701019,3.5216801167113867,3.528762589797602,3.522665670091305,3.516886531903536,3.5183785987305827,3.5151274628551805,3.512246302864036,3.5112257263903093,3.5070813878646785,3.5016168731167285,3.5062346374649267,3.5022906803763143,3.5085038067748986,3.5095569863408747,3.5105586298918574,3.5105586298918574,3.595655811146367,3.8095304078911694,4.087551009609086,4.5378771642486235,5.097844224776078,5.692337592543391,6.349382185516832,6.780981610828047,7.08938309435064,7.647179004706363,8.351459153755064,9.80544425292397,12.369935169941668,14.705224405091329,16.7510467489574,19.746833426371527,22.681647421571917,25.367485998144122,26.30575725416836,27.182161662659848,27.182161662659848,27.345598804277824,27.4236373669028,27.4236373669028,27.49461484124164,27.537053353518544,27.55343254871153,27.55343254871153,27.55343254871153,27.543544731311403,27.543544731311403,27.56119727235371,27.531661662154466,27.52581495972765,27.523171180550875,27.523171180550875,27.523171180550875,27.523171180550875,27.523171180550875,27.645380832203905,27.653358577417386,27.653358577417386,27.653358577417386,27.69723481544758,27.670436871702965,27.66476529985381,27.66476529985381,27.662081292068297,27.662081292068297,27.662081292068297,27.683626128259924,27.54107748832922,27.54107748832922,27.52889378847177,27.536499417669074,27.524186702517756,27.432290041077763,27.432290041077763,27.432290041077763,27.32990639905717,27.31856287379406,27.091576174908397,26.818806496134528,26.762235192808316,26.44922194640736,25.91677020640033,25.772008484121738,25.52810274061176,25.52810274061176,25.466977601416954,25.21777149738632,25.21777149738632,25.21777149738632,25.221195953512034)
maxHPD=c(0.34639579824251154, 0.5211019094199457,1.3380462478063646,2.838626866403952,3.2555227769110178,3.3783239006908965,3.4721018198921834,3.5089252556556216,3.5226152714726053,3.523687861701019,3.5216801167113867,3.528762589797602,3.522665670091305,3.516886531903536,3.5183785987305827,3.5151274628551805,3.512246302864036,3.5112257263903093,3.5070813878646785,3.5016168731167285,3.5062346374649267,3.5022906803763143,3.5085038067748986,3.5095569863408747,3.5105586298918574,3.5105586298918574,3.595655811146367,3.8095304078911694,4.087551009609086,4.5378771642486235,5.097844224776078,5.692337592543391,6.349382185516832,6.780981610828047,7.08938309435064,7.647179004706363,8.351459153755064,9.80544425292397,12.369935169941668,14.705224405091329,16.7510467489574,19.746833426371527,22.681647421571917,25.367485998144122,26.30575725416836,27.182161662659848,27.182161662659848,27.345598804277824,27.4236373669028,27.4236373669028,27.49461484124164,27.537053353518544,27.55343254871153,27.55343254871153,27.55343254871153,27.543544731311403,27.543544731311403,27.56119727235371,27.531661662154466,27.52581495972765,27.523171180550875,27.523171180550875,27.523171180550875,27.523171180550875,27.523171180550875,27.645380832203905,27.653358577417386,27.653358577417386,27.653358577417386,27.69723481544758,27.670436871702965,27.66476529985381,27.66476529985381,27.662081292068297,27.662081292068297,27.662081292068297,27.683626128259924,27.54107748832922,27.54107748832922,27.52889378847177,27.536499417669074,27.524186702517756,27.432290041077763,27.432290041077763,27.432290041077763,27.32990639905717,27.31856287379406,27.091576174908397,26.818806496134528,26.762235192808316,26.44922194640736,25.91677020640033,25.772008484121738,25.52810274061176,25.52810274061176,25.466977601416954,25.21777149738632,25.21777149738632,25.21777149738632,25.221195953512034)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 30.46695829699234), xlim = c(-90.39385756957213,-66.08776742547644), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()