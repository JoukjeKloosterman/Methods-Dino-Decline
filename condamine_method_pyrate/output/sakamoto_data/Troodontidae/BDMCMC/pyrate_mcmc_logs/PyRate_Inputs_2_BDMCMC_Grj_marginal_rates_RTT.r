# 1 files combined:
# 	./PyRate_Inputs_2_BDMCMC_Grj_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='./PyRate_Inputs_2_BDMCMC_Grj_marginal_rates_RTT.pdf',width=10.8, height=8.4)
par(mfrow=c(2,2))
library(scales)
plot_RTT <- function (age,hpd_M,hpd_m,mean_m,color){
    N=100
    beta=(1:(N-1))/N
    alpha_shape=0.25
    cat=1-(beta^(1./alpha_shape))
    for (i in 1:(N-1)){
        trans= 1/N + 2/N
        polygon(c(age, rev(age)), c(hpd_M-((hpd_M-mean_m)*cat[i]), rev(hpd_m+((mean_m-hpd_m)*cat[i]))), col = alpha(color,trans), border = NA)
    }
    lines(rev(age), rev(mean_m), col = color, lwd=3)
}
    
L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.057043643675691,0.057043643675691,0.057043643675691,0.055765048542509,0.057043643675691,0.061041505641866,0.061041505641866,0.061041505641866,0.055262189521551,0.055765048542509,0.055765048542509,0.055262189521551,0.057043643675691,0.057043643675691,0.057043643675691,0.057043643675691,0.057043643675691,0.055262189521551,0.06345769723902,0.057043643675691,0.057043643675691,0.057043643675691,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.057043643675691,0.057043643675691,0.057043643675691,0.057043643675691,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.055262189521551,0.057043643675691,0.057043643675691,0.057043643675691,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.061041505641866,0.061041505641866,0.061041505641866,0.060576176779706,0.060576176779706,0.059934537985539,0.060576176779706,0.060576176779706,0.060576176779706,0.060576176779706,0.060576176779706,0.060576176779706,0.060576176779706,0.060576176779706,0.059934537985539,0.060576176779706,0.060576176779706,0.057158989105755,0.057043643675691,0.057043643675691,0.055262189521551,0.055262189521551,0.055262189521551,0.057043643675691,0.055262189521551,0.055262189521551,0.055262189521551)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.155813245254487,0.155813245254487,0.155813245254487,0.152660953969151,0.152660953969151,0.155813245254487,0.155813245254487,0.154666845416032,0.147496460088233,0.149018157198588,0.149018157198588,0.147496460088233,0.149018157198588,0.149018157198588,0.149018157198588,0.149018157198588,0.149018157198588,0.147073076355169,0.154666845416032,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147073076355169,0.149018157198588,0.149018157198588,0.149018157198588,0.149018157198588,0.149018157198588,0.149018157198588,0.149018157198588,0.154666845416032,0.154666845416032,0.154666845416032,0.154666845416032,0.154666845416032,0.154666845416032,0.155813245254487,0.155813245254487,0.155813245254487,0.155813245254487,0.155813245254487,0.155813245254487,0.155813245254487,0.155813245254487,0.155813245254487,0.157404533027952,0.157404533027952,0.154666845416032,0.154666845416032,0.155813245254487,0.154666845416032,0.155813245254487,0.157404533027952,0.161445378737292,0.161445378737292,0.165618003253784,0.170852922924796)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.030275592487274,0.030275592487274,0.038437495113666,0.038117301508783,0.037634771988384,0.037634771988384,0.037634771988384,0.038437495113666,0.038437495113666,0.038117301508783,0.038117301508783,0.038117301508783,0.038437495113666,0.038437495113666,0.038117301508783,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.038437495113666,0.038437495113666,0.038437495113666,0.038117301508783,0.038117301508783,0.038117301508783,0.038117301508783,0.037634771988384,0.037634771988384,0.037634771988384,0.038117301508783,0.038117301508783,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037147214499125,0.037147214499125,0.037147214499125,0.037147214499125,0.037147214499125,0.037147214499125,0.037147214499125,0.037147214499125,0.037147214499125,0.037147214499125,0.038437495113666,0.038117301508783,0.038117301508783,0.038117301508783,0.038437495113666,0.038437495113666,0.038437495113666,0.038437495113666,0.038437495113666,0.038117301508783,0.038117301508783,0.038437495113666,0.038117301508783,0.037634771988384,0.037634771988384,0.037634771988384,0.037147214499125,0.037147214499125,0.038437495113666,0.038437495113666,0.038437495113666,0.038117301508783,0.038117301508783,0.038117301508783,0.038117301508783,0.037634771988384,0.037634771988384,0.035684409948188,0.035360476191987,0.035360476191987)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.942439648333438,0.142275787888628,0.137726443896494,0.134991321544034,0.131143660101026,0.129078992903663,0.12819257920354,0.127572670063717,0.127572670063717,0.126928218682115,0.126928218682115,0.126928218682115,0.126928218682115,0.126928218682115,0.124879949203998,0.122416487763613,0.122416487763613,0.122416487763613,0.122416487763613,0.122416487763613,0.122416487763613,0.122416487763613,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.12235963665692,0.12235963665692,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.12235963665692,0.12235963665692,0.12235963665692,0.12235963665692,0.12235963665692,0.12235963665692,0.123323637325748,0.123323637325748,0.123323637325748,0.12235963665692,0.12235963665692,0.12235963665692,0.12235963665692,0.12235963665692,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.125468661900827,0.125468661900827,0.125468661900827,0.125468661900827,0.125468661900827,0.125468661900827,0.125468661900827,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.84750255986296,-0.073024221266509,-0.046358132188756,-0.046358132188756,-0.046358132188756,-0.046358132188756,-0.046260055089665,-0.046358132188756,-0.046358132188756,-0.046358132188756,-0.046358132188756,-0.046358132188756,-0.043572601667739,-0.046260055089665,-0.046260055089665,-0.043572601667739,-0.043572601667739,-0.046260055089665,-0.043572601667739,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.043572601667739,-0.043231350990088,-0.043231350990088,-0.043231350990088,-0.042258942766059,-0.04202552097558,-0.04202552097558,-0.042258942766059,-0.043231350990088,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.04202552097558,-0.04202552097558,-0.04202552097558,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.03854493768839,-0.03854493768839,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.04202552097558,-0.042258942766059,-0.04202552097558,-0.04202552097558,-0.042258942766059,-0.042258942766059,-0.043572601667739,-0.042258942766059,-0.040687371875351,-0.04202552097558,-0.042258942766059,-0.046260055089665,-0.046260055089665,-0.048786371019872)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.129266134510613,0.11081399383179,0.11081399383179,0.098467434776372,0.091375757753938,0.089265591943769,0.089265591943769,0.087586865371114,0.087586865371114,0.087304922272576,0.086995817140863,0.086995817140863,0.089265591943769,0.086144700714928,0.084490563822459,0.085244994536344,0.085244994536344,0.081674416658759,0.083584933222382,0.083584933222382,0.083584933222382,0.084490563822459,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.082314968047052,0.082314968047052,0.081674416658759,0.082751990317745,0.082314968047052,0.082314968047052,0.082314968047052,0.082751990317745,0.082751990317745,0.083178694000318,0.083178694000318,0.083178694000318,0.083178694000318,0.083584933222382,0.083584933222382,0.083584933222382,0.084490563822459,0.085244994536344,0.085244994536344,0.085244994536344,0.085244994536344,0.086144700714928,0.086144700714928,0.090595687925793,0.090595687925793,0.087304922272576,0.087586865371114,0.087586865371114,0.087586865371114,0.088268455313947,0.088268455313947,0.088268455313947,0.088594126756652,0.089265591943769,0.089265591943769,0.090595687925793,0.090595687925793,0.091375757753938,0.092098868208192,0.092098868208192,0.094566186591582,0.096681729634575,0.096681729634575,0.098667120770518,0.100791257706204,0.106843381728824,0.112918023316984)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.102241525314733,0.102246557855562,0.102246557855562,0.102851603400852,0.103249758087027,0.103244708698218,0.103197342813048,0.103392112344411,0.103548655081251,0.103625102247284,0.103697007052041,0.103753764750538,0.104588080722319,0.104598272679625,0.104598272679625,0.104598272679625,0.104600648386608,0.104549761152783,0.104409328087802,0.103867242692248,0.103791359538323,0.103791359538323,0.103714715832224,0.103714715832224,0.103714715832224,0.103714715832224,0.103641486600714,0.103641486600714,0.1036636819526,0.1036636819526,0.10376582566635,0.10376582566635,0.10376582566635,0.103761823627676,0.103796942866134,0.103796942866134,0.103793141793094,0.103855273399446,0.103855273399446,0.103879089506363,0.103879089506363,0.103879089506363,0.103778322455458,0.103635528402327,0.103588843310227,0.103588843310227,0.103588843310227,0.103588843310227,0.103588843310227,0.103588843310227,0.103588843310227,0.103611372696627,0.103682762133727,0.103682762133727,0.103682762133727,0.103859246664518,0.103859246664518,0.103859246664518,0.103859246664518,0.103912820044414,0.103937204423638,0.103983251128281,0.104128010877276,0.104128010877276,0.104293173702379,0.104350438172586,0.104357401263423,0.104357401263423,0.10428282775981,0.10428282775981,0.104295557633844,0.104308442317743,0.104308442317743,0.104352321155068,0.104457816364249,0.104432822626468,0.105068388996502,0.105173910015582,0.105219365897775,0.105372637806612,0.105627811976319,0.10681475881586,0.107871879185644,0.109261940251141,0.110633479914201,0.114595332662779)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.196261412511733,0.092287452906248,0.084841754849177,0.083436066340255,0.082215822099778,0.081854710213194,0.081562416485156,0.081113759354638,0.081113759354638,0.08088801242067,0.080819288174055,0.080778885732024,0.080652262190363,0.080498187267692,0.080014361058228,0.079628967867338,0.079628967867338,0.079463729538721,0.079463729538721,0.079359683407105,0.079320810945315,0.079291976170046,0.078959831543998,0.078768526234572,0.078719323687504,0.078719323687504,0.07877826661477,0.0786700587088,0.0786700587088,0.078821779449589,0.078821779449589,0.078751302371125,0.078751302371125,0.078700444715434,0.078618950486977,0.078679671184754,0.078679671184754,0.078679671184754,0.078679671184754,0.078563875767092,0.078563875767092,0.078600342372181,0.078578807792157,0.078578807792157,0.078578807792157,0.07862909084259,0.078650293774135,0.078650293774135,0.078697075073553,0.078705571286627,0.078705571286627,0.078620995787775,0.078620995787775,0.0785919242193,0.078662916316783,0.078662916316783,0.078796836396866,0.078727803054487,0.078727803054487,0.078727803054487,0.078716840703481,0.078716840703481,0.078716840703481,0.078716840703481,0.078716840703481,0.07886220019499,0.07886220019499,0.078796115548436,0.07897613124862,0.078881766184508,0.078894399252784,0.078894399252784,0.078847248582036,0.078847248582036,0.078736842151999,0.078753045220931,0.078753045220931,0.078665084994581,0.078665084994581,0.078665084994581,0.078665084994581,0.078955416335127,0.07894152427232,0.079318356914313,0.079403486554383,0.079396243281776)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.094019887197,0.009959104949314,0.017404803006385,0.019415537060597,0.021033935987249,0.021389998485024,0.021634926327892,0.022278352989773,0.022434895726613,0.022737089826614,0.022877718877987,0.022974879018515,0.023935818531956,0.024100085411933,0.024583911621397,0.024969304812288,0.024971680519271,0.025086031614062,0.024945598549081,0.024507559285143,0.024470548593007,0.024499383368277,0.024754884288225,0.024946189597652,0.02499539214472,0.02499539214472,0.024863219985944,0.024971427891915,0.0249936232438,0.024841902503011,0.024944046216761,0.025014523295225,0.025014523295225,0.025061378912242,0.025177992379156,0.025117271681379,0.025113470608339,0.025175602214692,0.025175602214692,0.025315213739271,0.025315213739271,0.025278747134182,0.025199514663301,0.02505672061017,0.02501003551807,0.024959752467637,0.024938549536092,0.024938549536092,0.024891768236674,0.024883272023601,0.024883272023601,0.024990376908853,0.025061766345953,0.025090837914427,0.025019845816945,0.025196330347735,0.025062410267652,0.025131443610031,0.025131443610031,0.025185016989927,0.025220363720157,0.0252664104248,0.025411170173795,0.025411170173795,0.025576332998898,0.025488237977596,0.025495201068432,0.025561285714986,0.02530669651119,0.025401061575302,0.02540115838106,0.025414043064959,0.025461193735706,0.025505072573032,0.02572097421225,0.025679777405537,0.026315343775571,0.026508825021001,0.026554280903194,0.026707552812031,0.026962726981738,0.027859342480733,0.028930354913325,0.029943583336828,0.031229993359818,0.035199089381003)
trans=0.5
age=(0:(153-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.18793821521727563), xlim = c(-160.65,-59.35), ylab = 'Speciation rate', xlab = 'Ma',main='PyRate' )
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.0366836131667818), xlim = c(-160.65,-59.35), ylab = 'Extinction rate', xlab = 'Ma' )
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.932252815849256, 0.1421927479616743), xlim = c(-160.65,-59.35), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
n <- dev.off()