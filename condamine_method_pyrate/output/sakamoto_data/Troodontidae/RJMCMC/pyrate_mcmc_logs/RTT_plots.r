

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.49966332659852, -67.37598931547848,-68.25231530435843,-69.12864129323837,-70.00496728211833,-70.88129327099828,-71.75761925987824,-72.6339452487582,-73.51027123763815,-74.3865972265181,-75.26292321539805,-76.139249204278,-77.01557519315796,-77.89190118203791,-78.76822717091787,-79.64455315979782,-80.52087914867778,-81.39720513755773,-82.27353112643767,-83.14985711531763,-84.02618310419759,-84.90250909307754,-85.7788350819575,-86.65516107083744,-87.53148705971739,-88.40781304859735,-89.2841390374773,-90.16046502635726,-91.03679101523721,-91.91311700411717,-92.78944299299712,-93.66576898187708,-94.54209497075702,-95.41842095963698,-96.29474694851693,-97.17107293739689,-98.04739892627684,-98.92372491515678,-99.80005090403674,-100.6763768929167,-101.55270288179665,-102.4290288706766,-103.30535485955656,-104.18168084843651,-105.05800683731647,-105.93433282619642,-106.81065881507638,-107.68698480395632,-108.56331079283628,-109.43963678171623,-110.31596277059619,-111.19228875947613,-112.06861474835608,-112.94494073723604,-113.821266726116,-114.69759271499595,-115.5739187038759,-116.45024469275586,-117.32657068163581,-118.20289667051577,-119.07922265939573,-119.95554864827568,-120.83187463715562,-121.70820062603558,-122.58452661491553,-123.46085260379547,-124.33717859267543,-125.21350458155538,-126.08983057043534,-126.9661565593153,-127.84248254819525,-128.7188085370752,-129.59513452595516,-130.47146051483512,-131.34778650371507,-132.22411249259503,-133.10043848147498,-133.97676447035494,-134.8530904592349,-135.72941644811485,-136.6057424369948,-137.48206842587473,-138.35839441475468,-139.23472040363464,-140.1110463925146,-140.98737238139455,-141.8636983702745,-142.74002435915446,-143.6163503480344,-144.49267633691434,-145.3690023257943,-146.24532831467425,-147.1216543035542,-147.99798029243416,-148.87430628131412,-149.75063227019407,-150.62695825907403,-151.50328424795399,-152.37961023683394,-153.2559362257139)
rate=c(0.0993990313334715, 0.0993990313334715,0.09935998518394969,0.09935998518394969,0.0993990313334715,0.0995268971819298,0.09959077045105647,0.09959077045105647,0.09972886780408488,0.09972886780408488,0.09979201688484843,0.09972886780408488,0.09979201688484843,0.09985321994709767,0.09991260097070122,0.09993148532635857,0.09993148532635857,0.10000004687673295,0.09993148532635857,0.09993148532635857,0.09989498876137365,0.09985321994709767,0.09972886780408488,0.09966905367145418,0.09959077045105647,0.0995330816017411,0.09947658251004474,0.09947658251004474,0.0995268971819298,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.0993990313334715,0.0993990313334715,0.0993990313334715,0.09935998518394969,0.09935998518394969,0.0993990313334715,0.0993990313334715,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.0995268971819298,0.0995268971819298,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.09947658251004474,0.0995268971819298,0.0995330816017411,0.0995330816017411,0.0995330816017411,0.0995330816017411,0.0995330816017411,0.0995330816017411,0.0995268971819298,0.0995268971819298,0.0995268971819298,0.09947658251004474,0.09947658251004474,0.0993990313334715,0.09947658251004474,0.09947658251004474,0.0995268971819298,0.0995268971819298,0.0995268971819298,0.0995268971819298,0.09947658251004474,0.0995268971819298,0.0995268971819298,0.09947658251004474,0.09947658251004474,0.0995268971819298,0.0995330816017411,0.0995330816017411,0.0995330816017411,0.0995330816017411,0.09966905367145418,0.09979201688484843,0.09979201688484843,0.10022415343903171,0.1003356851068865,0.10062899610445974)
minHPD=c(0.057139848171872114, 0.057139848171872114,0.057139848171872114,0.057139848171872114,0.057139848171872114,0.05786895574561162,0.059079552090930694,0.059079552090930694,0.05963100865681357,0.05963100865681357,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.06048737714934472,0.059079552090930694,0.059079552090930694,0.059079552090930694,0.059079552090930694,0.06048737714934472,0.059079552090930694,0.059079552090930694,0.057139848171872114,0.057139848171872114,0.057139848171872114,0.057139848171872114,0.057139848171872114,0.057139848171872114,0.05342425311737806,0.05342425311737806,0.05342425311737806,0.05342425311737806,0.056594044180477414,0.05346285826423789,0.05342425311737806,0.05342425311737806,0.05342425311737806,0.05342425311737806,0.05522542671759325,0.05522542671759325,0.05342425311737806,0.05342425311737806,0.05342425311737806,0.05342425311737806,0.05342425311737806,0.05342425311737806,0.05342425311737806,0.05342425311737806,0.05342425311737806,0.05342425311737806,0.05342425311737806,0.05342425311737806,0.05342425311737806,0.051823063580480444)
maxHPD=c(0.14855848790587645, 0.14855848790587645,0.14855848790587645,0.14855848790587645,0.14809088027980072,0.14809088027980072,0.14855848790587645,0.14855848790587645,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.1478985523719446,0.1478985523719446,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.1478985523719446,0.14809088027980072,0.1478985523719446,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14888504659794677,0.14888504659794677,0.14888504659794677,0.14888504659794677,0.14888504659794677,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14888504659794677,0.14888504659794677,0.14888504659794677,0.14888504659794677,0.14888504659794677,0.14888504659794677,0.14888504659794677,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14809088027980072,0.14888504659794677,0.14809088027980072,0.14809088027980072,0.14679266684213946,0.14679266684213946,0.14679266684213946,0.14679266684213946,0.14723412741517325,0.14723412741517325,0.14411124342117376,0.14428575263678786,0.14428575263678786,0.14428575263678786,0.14809088027980072,0.14561551488054944,0.14561551488054944,0.14561551488054944,0.14561551488054944,0.14561551488054944,0.14809088027980072,0.14809088027980072,0.14723412741517325,0.14723412741517325,0.14723412741517325,0.14723412741517325,0.14723412741517325,0.14766396333361917,0.14766396333361917,0.14888504659794677,0.15178207195196067,0.15274728325007944,0.1533510182196718,0.15803839884768336,0.16045958259304668,0.16383407947180148)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.18021748741898164), xlim = c(-153.69409922015387,-66.06150033215854), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.50408921543125, -67.38926698197666,-68.27444474852206,-69.15962251506747,-70.04480028161288,-70.92997804815829,-71.81515581470369,-72.7003335812491,-73.58551134779451,-74.47068911433992,-75.35586688088532,-76.24104464743073,-77.12622241397614,-78.01140018052155,-78.89657794706694,-79.78175571361236,-80.66693348015777,-81.55211124670318,-82.43728901324859,-83.32246677979398,-84.2076445463394,-85.0928223128848,-85.9780000794302,-86.86317784597561,-87.74835561252102,-88.63353337906644,-89.51871114561185,-90.40388891215724,-91.28906667870265,-92.17424444524806,-93.05942221179346,-93.94459997833887,-94.82977774488428,-95.7149555114297,-96.6001332779751,-97.4853110445205,-98.37048881106591,-99.25566657761132,-100.14084434415672,-101.02602211070213,-101.91119987724754,-102.79637764379295,-103.68155541033836,-104.56673317688377,-105.45191094342917,-106.33708870997458,-107.22226647651998,-108.10744424306539,-108.9926220096108,-109.87779977615621,-110.76297754270162,-111.64815530924703,-112.53333307579243,-113.41851084233784,-114.30368860888323,-115.18886637542865,-116.07404414197406,-116.95922190851947,-117.84439967506488,-118.72957744161029,-119.61475520815569,-120.4999329747011,-121.38511074124649,-122.2702885077919,-123.15546627433731,-124.04064404088273,-124.92582180742814,-125.81099957397355,-126.69617734051896,-127.58135510706434,-128.46653287360976,-129.35171064015515,-130.2368884067006,-131.12206617324597,-132.0072439397914,-132.8924217063368,-133.77759947288217,-134.6627772394276,-135.547955005973,-136.43313277251843,-137.31831053906382,-138.20348830560926,-139.08866607215464,-139.97384383870008,-140.85902160524546,-141.74419937179084,-142.62937713833628,-143.51455490488166,-144.3997326714271,-145.28491043797248,-146.17008820451792,-147.0552659710633,-147.9404437376087,-148.82562150415413,-149.7107992706995,-150.59597703724495,-151.48115480379033,-152.36633257033577,-153.25151033688115)
counts=c(0.0, 0.001,0.0,0.003,0.002,0.003,0.0,0.003,0.0,0.001,0.002,0.002,0.003,0.001,0.002,0.0,0.001,0.001,0.0,0.002,0.002,0.003,0.0,0.002,0.001,0.002,0.0,0.001,0.001,0.0,0.001,0.0,0.0,0.0,0.0,0.001,0.002,0.001,0.0,0.0,0.001,0.0,0.0,0.001,0.0,0.001,0.0,0.0,0.001,0.0,0.0,0.001,0.003,0.0,0.002,0.0,0.0,0.0,0.002,0.0,0.001,0.0,0.0,0.002,0.001,0.002,0.001,0.0,0.0,0.0,0.001,0.001,0.0,0.004,0.0,0.002,0.0,0.002,0.0,0.002,0.001,0.0,0.001,0.001,0.003,0.001,0.0,0.001,0.001,0.001,0.0,0.003,0.005,0.003,0.003,0.008,0.005,0.006,0.005)
plot(mids,counts,type = 'h', xlim = c(-153.69409922015387,-66.06150033215854), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.033653826592387394
bf6 = 0.2046639505641509
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.49966332659852, -67.37598931547848,-68.25231530435843,-69.12864129323837,-70.00496728211833,-70.88129327099828,-71.75761925987824,-72.6339452487582,-73.51027123763815,-74.3865972265181,-75.26292321539805,-76.139249204278,-77.01557519315796,-77.89190118203791,-78.76822717091787,-79.64455315979782,-80.52087914867778,-81.39720513755773,-82.27353112643767,-83.14985711531763,-84.02618310419759,-84.90250909307754,-85.7788350819575,-86.65516107083744,-87.53148705971739,-88.40781304859735,-89.2841390374773,-90.16046502635726,-91.03679101523721,-91.91311700411717,-92.78944299299712,-93.66576898187708,-94.54209497075702,-95.41842095963698,-96.29474694851693,-97.17107293739689,-98.04739892627684,-98.92372491515678,-99.80005090403674,-100.6763768929167,-101.55270288179665,-102.4290288706766,-103.30535485955656,-104.18168084843651,-105.05800683731647,-105.93433282619642,-106.81065881507638,-107.68698480395632,-108.56331079283628,-109.43963678171623,-110.31596277059619,-111.19228875947613,-112.06861474835608,-112.94494073723604,-113.821266726116,-114.69759271499595,-115.5739187038759,-116.45024469275586,-117.32657068163581,-118.20289667051577,-119.07922265939573,-119.95554864827568,-120.83187463715562,-121.70820062603558,-122.58452661491553,-123.46085260379547,-124.33717859267543,-125.21350458155538,-126.08983057043534,-126.9661565593153,-127.84248254819525,-128.7188085370752,-129.59513452595516,-130.47146051483512,-131.34778650371507,-132.22411249259503,-133.10043848147498,-133.97676447035494,-134.8530904592349,-135.72941644811485,-136.6057424369948,-137.48206842587473,-138.35839441475468,-139.23472040363464,-140.1110463925146,-140.98737238139455,-141.8636983702745,-142.74002435915446,-143.6163503480344,-144.49267633691434,-145.3690023257943,-146.24532831467425,-147.1216543035542,-147.99798029243416,-148.87430628131412,-149.75063227019407,-150.62695825907403,-151.50328424795399,-152.37961023683394,-153.2559362257139)
rate=c(1.383448569117292, 0.08064856618675437,0.07657935336710389,0.07626723332356661,0.07620196499310004,0.07620196499310004,0.07620196499310004,0.0761808564952279,0.0761808564952279,0.07617485816718253,0.07617485816718253,0.07612516187355703,0.07617485816718253,0.07617485816718253,0.07617485816718253,0.07617485816718253,0.07612516187355703,0.07617485816718253,0.07617485816718253,0.07606096778088278,0.07606096778088278,0.07602471202647723,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07583276694094265,0.07583276694094265,0.07583276694094265,0.07573280022325445,0.07573280022325445,0.07573280022325445,0.07573280022325445,0.07573280022325445,0.07573280022325445,0.07573280022325445,0.07583276694094265,0.07583276694094265,0.07583276694094265,0.07583276694094265,0.07583276694094265,0.07583276694094265,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07583276694094265,0.07583276694094265,0.07583276694094265,0.07583276694094265,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07593748295686908,0.07583276694094265,0.07583276694094265,0.07573280022325445,0.07573280022325445,0.07573280022325445,0.07566454837035158,0.07566454837035158,0.07562447903401912,0.07562447903401912,0.07562447903401912,0.07557604921318047,0.07557604921318047,0.07553405668977434,0.07553405668977434,0.07546872684606985,0.07546872684606985,0.07540843083417251,0.07546872684606985,0.07553405668977434,0.07557604921318047,0.07557604921318047,0.07562447903401912,0.07562447903401912,0.07566454837035158,0.07566454837035158,0.07566454837035158)
minHPD=c(0.060724810639934255, 0.03130877608667745,0.035983779046028494,0.035983779046028494,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.035983779046028494,0.035983779046028494,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.035983779046028494,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.03932053869738692,0.03932053869738692,0.03932053869738692,0.03932053869738692,0.03932053869738692,0.03932053869738692,0.03932053869738692,0.03932053869738692,0.03932053869738692,0.03932053869738692,0.03932053869738692,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.035983779046028494,0.035983779046028494,0.035983779046028494,0.035983779046028494,0.035983779046028494,0.035983779046028494,0.035983779046028494,0.035983779046028494,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.0365218491890483,0.035983779046028494,0.03425550007682143,0.03425550007682143,0.033807502552860295,0.033807502552860295,0.0365218491890483,0.0365218491890483,0.033807502552860295,0.033807502552860295,0.03425550007682143)
maxHPD=c(3.5693271243769766, 1.0214541314397017,0.1300439660842,0.12445786792844807,0.12445786792844807,0.1234712148568509,0.1234712148568509,0.12213385768412381,0.12213385768412381,0.12196313964427985,0.12178623367464293,0.12127153908399739,0.12127153908399739,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12044469111974888,0.12044469111974888,0.12044469111974888,0.12044469111974888,0.12002825227035947,0.11982075751317994,0.11982075751317994,0.11982075751317994,0.11982075751317994,0.11982075751317994,0.11982075751317994,0.11982075751317994,0.12213385768412381,0.12213385768412381,0.12213385768412381,0.12213385768412381,0.12213385768412381,0.12213385768412381,0.12213385768412381,0.12213385768412381,0.12213385768412381,0.12213385768412381,0.12213385768412381,0.11982075751317994,0.11982075751317994,0.12002825227035947,0.12002825227035947,0.12002825227035947,0.12002825227035947,0.12002825227035947,0.12002825227035947,0.12002825227035947,0.12002825227035947,0.12002825227035947,0.12002825227035947,0.12002825227035947,0.12044469111974888,0.12044469111974888,0.12044469111974888,0.12044469111974888,0.12044469111974888,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12127153908399739,0.12127153908399739,0.12127153908399739,0.12127153908399739,0.12178623367464293,0.12178623367464293,0.12196313964427985,0.12196313964427985,0.12213385768412381,0.12196313964427985,0.12196313964427985,0.12196313964427985,0.12196313964427985,0.12213385768412381,0.12213385768412381,0.12213385768412381,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12054551269424373,0.12386443213136444,0.12386443213136444,0.12213385768412381,0.12213385768412381,0.12293323362901437)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 3.926259836814675), xlim = c(-153.69409922015387,-66.06150033215854), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.50408921543125, -67.38926698197666,-68.27444474852206,-69.15962251506747,-70.04480028161288,-70.92997804815829,-71.81515581470369,-72.7003335812491,-73.58551134779451,-74.47068911433992,-75.35586688088532,-76.24104464743073,-77.12622241397614,-78.01140018052155,-78.89657794706694,-79.78175571361236,-80.66693348015777,-81.55211124670318,-82.43728901324859,-83.32246677979398,-84.2076445463394,-85.0928223128848,-85.9780000794302,-86.86317784597561,-87.74835561252102,-88.63353337906644,-89.51871114561185,-90.40388891215724,-91.28906667870265,-92.17424444524806,-93.05942221179346,-93.94459997833887,-94.82977774488428,-95.7149555114297,-96.6001332779751,-97.4853110445205,-98.37048881106591,-99.25566657761132,-100.14084434415672,-101.02602211070213,-101.91119987724754,-102.79637764379295,-103.68155541033836,-104.56673317688377,-105.45191094342917,-106.33708870997458,-107.22226647651998,-108.10744424306539,-108.9926220096108,-109.87779977615621,-110.76297754270162,-111.64815530924703,-112.53333307579243,-113.41851084233784,-114.30368860888323,-115.18886637542865,-116.07404414197406,-116.95922190851947,-117.84439967506488,-118.72957744161029,-119.61475520815569,-120.4999329747011,-121.38511074124649,-122.2702885077919,-123.15546627433731,-124.04064404088273,-124.92582180742814,-125.81099957397355,-126.69617734051896,-127.58135510706434,-128.46653287360976,-129.35171064015515,-130.2368884067006,-131.12206617324597,-132.0072439397914,-132.8924217063368,-133.77759947288217,-134.6627772394276,-135.547955005973,-136.43313277251843,-137.31831053906382,-138.20348830560926,-139.08866607215464,-139.97384383870008,-140.85902160524546,-141.74419937179084,-142.62937713833628,-143.51455490488166,-144.3997326714271,-145.28491043797248,-146.17008820451792,-147.0552659710633,-147.9404437376087,-148.82562150415413,-149.7107992706995,-150.59597703724495,-151.48115480379033,-152.36633257033577,-153.25151033688115)
counts=c(0.796, 0.123,0.011,0.001,0.003,0.0,0.002,0.001,0.001,0.001,0.003,0.0,0.001,0.001,0.0,0.001,0.002,0.002,0.002,0.0,0.001,0.002,0.001,0.0,0.001,0.001,0.001,0.0,0.003,0.001,0.0,0.0,0.0,0.0,0.001,0.0,0.001,0.0,0.0,0.0,0.001,0.003,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.002,0.0,0.001,0.0,0.0,0.0,0.001,0.001,0.0,0.0,0.0,0.001,0.0,0.0,0.002,0.0,0.001,0.0,0.0,0.0,0.002,0.001,0.001,0.0,0.0,0.002,0.0,0.002,0.0,0.001,0.001,0.001,0.001,0.001,0.002,0.0,0.001,0.001,0.001,0.001,0.001,0.0,0.001,0.004,0.0,0.002,0.003)
plot(mids,counts,type = 'h', xlim = c(-153.69409922015387,-66.06150033215854), ylim=c(0,0.796), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.49966332659852, -67.37598931547848,-68.25231530435843,-69.12864129323837,-70.00496728211833,-70.88129327099828,-71.75761925987824,-72.6339452487582,-73.51027123763815,-74.3865972265181,-75.26292321539805,-76.139249204278,-77.01557519315796,-77.89190118203791,-78.76822717091787,-79.64455315979782,-80.52087914867778,-81.39720513755773,-82.27353112643767,-83.14985711531763,-84.02618310419759,-84.90250909307754,-85.7788350819575,-86.65516107083744,-87.53148705971739,-88.40781304859735,-89.2841390374773,-90.16046502635726,-91.03679101523721,-91.91311700411717,-92.78944299299712,-93.66576898187708,-94.54209497075702,-95.41842095963698,-96.29474694851693,-97.17107293739689,-98.04739892627684,-98.92372491515678,-99.80005090403674,-100.6763768929167,-101.55270288179665,-102.4290288706766,-103.30535485955656,-104.18168084843651,-105.05800683731647,-105.93433282619642,-106.81065881507638,-107.68698480395632,-108.56331079283628,-109.43963678171623,-110.31596277059619,-111.19228875947613,-112.06861474835608,-112.94494073723604,-113.821266726116,-114.69759271499595,-115.5739187038759,-116.45024469275586,-117.32657068163581,-118.20289667051577,-119.07922265939573,-119.95554864827568,-120.83187463715562,-121.70820062603558,-122.58452661491553,-123.46085260379547,-124.33717859267543,-125.21350458155538,-126.08983057043534,-126.9661565593153,-127.84248254819525,-128.7188085370752,-129.59513452595516,-130.47146051483512,-131.34778650371507,-132.22411249259503,-133.10043848147498,-133.97676447035494,-134.8530904592349,-135.72941644811485,-136.6057424369948,-137.48206842587473,-138.35839441475468,-139.23472040363464,-140.1110463925146,-140.98737238139455,-141.8636983702745,-142.74002435915446,-143.6163503480344,-144.49267633691434,-145.3690023257943,-146.24532831467425,-147.1216543035542,-147.99798029243416,-148.87430628131412,-149.75063227019407,-150.62695825907403,-151.50328424795399,-152.37961023683394,-153.2559362257139)
net_rate=c(-1.5160228309849175, -0.09871169732377053,0.01665237687585978,0.020573634443403852,0.020793598627655913,0.02146285609889507,0.02174893617823945,0.022019451601229374,0.0221184306418739,0.022229312620320393,0.02241339788009182,0.022735576737691197,0.022768767253997072,0.022968927540772933,0.02337331171285511,0.02340857257353085,0.023592209388799513,0.02359752788075158,0.02368832523800382,0.02389405022116265,0.0237835063891104,0.023725718278992638,0.023755082356385925,0.023624223465442677,0.023580157407296288,0.023549003957180854,0.023459237316544472,0.02351501559647977,0.023567490110935705,0.023424075654275067,0.023516774075581462,0.02353065849930771,0.02353065849930771,0.02353065849930771,0.02353065849930771,0.023500140768390586,0.02350286672470193,0.023547656468202068,0.023536693460859785,0.02348189035194438,0.02348189035194438,0.02352796280631964,0.023428633465873764,0.02332387607585041,0.02335053875372578,0.02335053875372578,0.023375827454716072,0.023408821323350083,0.023408821323350083,0.023383158534924398,0.023383158534924398,0.023383158534924398,0.023383158534924398,0.023358447322233602,0.023344679620927976,0.023324875115704757,0.023321754616604167,0.023321754616604167,0.023321754616604167,0.023293047466153384,0.023176532507677147,0.023105036288534723,0.023105036288534723,0.023105036288534723,0.023121301915318564,0.02320333487904615,0.023541314889607808,0.023398347347951876,0.023465313194447217,0.023474947564435175,0.023474947564435175,0.023474947564435175,0.023286976430341,0.023286976430341,0.02352281828934062,0.02350342585775328,0.023523589385325238,0.023482862970637376,0.023557837639006877,0.02369480755203695,0.023761129118180506,0.02386697573889159,0.023864628074725638,0.023904568215185242,0.02406264341576317,0.024099848734058214,0.024164893179978237,0.02406453167208534,0.024141250034346983,0.024211749089063823,0.024301159724888003,0.024360647833239733,0.024341764282437943,0.024668392781039508,0.0254917632370446,0.025628575464199395,0.025590012618216824,0.028569825502889636,0.02997615057210201,0.031971856743804226)
net_minHPD=c(-3.4770734159253345, -0.9331301183277867,-0.04707324379406348,-0.046893938470336356,-0.04707324379406348,-0.04707324379406348,-0.04707324379406348,-0.04707324379406348,-0.03947527997577322,-0.03947527997577322,-0.03891702781438641,-0.03720910342192378,-0.03891702781438641,-0.03607453328778997,-0.03720910342192378,-0.03720910342192378,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03720910342192378,-0.03720910342192378,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03607453328778997,-0.03720910342192378,-0.03607453328778997,-0.03720910342192378,-0.03720910342192378,-0.03720910342192378,-0.036598893050362236,-0.036598893050362236,-0.03891702781438641,-0.03720910342192378,-0.03891702781438641,-0.03891702781438641,-0.03891702781438641,-0.03846221325842228,-0.03891702781438641,-0.03891702781438641,-0.03891702781438641,-0.03891702781438641,-0.036598893050362236,-0.036598893050362236,-0.03720910342192378,-0.03891702781438641,-0.03846221325842228,-0.03846221325842228,-0.03891702781438641,-0.04707324379406348,-0.04707324379406348,-0.04707324379406348,-0.03770672427382359,-0.03891702781438641,-0.03891702781438641,-0.03891702781438641,-0.04457234977138834,-0.04707324379406348)
net_maxHPD=c(0.07368434525030922, 0.10409463039197855,0.09738172052973391,0.0873129364606642,0.08415158866850475,0.08209735754146166,0.08179717573840636,0.07978225586142716,0.0873129364606642,0.08514411076136,0.08415158866850475,0.08514411076136,0.08209735754146166,0.08415158866850475,0.08209735754146166,0.08209735754146166,0.08209735754146166,0.08209735754146166,0.08179717573840636,0.08016741416990036,0.08016741416990036,0.08016741416990036,0.07978225586142716,0.07937898756058989,0.07937898756058989,0.07902961563165818,0.07902961563165818,0.07902961563165818,0.07961770344386956,0.07902961563165818,0.07961770344386956,0.07902961563165818,0.07902961563165818,0.07902961563165818,0.07902961563165818,0.07902961563165818,0.07902961563165818,0.07961770344386956,0.07961770344386956,0.07961770344386956,0.07961770344386956,0.07961770344386956,0.07961770344386956,0.07978225586142716,0.07978225586142716,0.07978225586142716,0.07978225586142716,0.07978225586142716,0.07978225586142716,0.07978225586142716,0.07978225586142716,0.07978225586142716,0.07978225586142716,0.07961770344386956,0.07978225586142716,0.07978225586142716,0.07978225586142716,0.07978225586142716,0.07978225586142716,0.07978225586142716,0.07961770344386956,0.07961770344386956,0.07961770344386956,0.07961770344386956,0.07961770344386956,0.07978225586142716,0.08016741416990036,0.08016741416990036,0.08179717573840636,0.08016741416990036,0.08016741416990036,0.08016741416990036,0.08179717573840636,0.08179717573840636,0.08179717573840636,0.08514411076136,0.08415158866850475,0.08415158866850475,0.08415158866850475,0.0873129364606642,0.08514411076136,0.08514411076136,0.08514411076136,0.08514411076136,0.0888869771867057,0.0888869771867057,0.0888869771867057,0.0873129364606642,0.0888869771867057,0.0888869771867057,0.0888869771867057,0.08272567988908508,0.08272567988908508,0.08415158866850475,0.09540360561069575,0.09467459831595207,0.09467459831595207,0.10325540202737049,0.09973548164475862,0.10380600436545957)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-3.824780757517868, 0.11450409343117642), xlim = c(-153.69409922015387,-66.06150033215854), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.49966332659852, -67.37598931547848,-68.25231530435843,-69.12864129323837,-70.00496728211833,-70.88129327099828,-71.75761925987824,-72.6339452487582,-73.51027123763815,-74.3865972265181,-75.26292321539805,-76.139249204278,-77.01557519315796,-77.89190118203791,-78.76822717091787,-79.64455315979782,-80.52087914867778,-81.39720513755773,-82.27353112643767,-83.14985711531763,-84.02618310419759,-84.90250909307754,-85.7788350819575,-86.65516107083744,-87.53148705971739,-88.40781304859735,-89.2841390374773,-90.16046502635726,-91.03679101523721,-91.91311700411717,-92.78944299299712,-93.66576898187708,-94.54209497075702,-95.41842095963698,-96.29474694851693,-97.17107293739689,-98.04739892627684,-98.92372491515678,-99.80005090403674,-100.6763768929167,-101.55270288179665,-102.4290288706766,-103.30535485955656,-104.18168084843651,-105.05800683731647,-105.93433282619642,-106.81065881507638,-107.68698480395632,-108.56331079283628,-109.43963678171623,-110.31596277059619,-111.19228875947613,-112.06861474835608,-112.94494073723604,-113.821266726116,-114.69759271499595,-115.5739187038759,-116.45024469275586,-117.32657068163581,-118.20289667051577,-119.07922265939573,-119.95554864827568,-120.83187463715562,-121.70820062603558,-122.58452661491553,-123.46085260379547,-124.33717859267543,-125.21350458155538,-126.08983057043534,-126.9661565593153,-127.84248254819525,-128.7188085370752,-129.59513452595516,-130.47146051483512,-131.34778650371507,-132.22411249259503,-133.10043848147498,-133.97676447035494,-134.8530904592349,-135.72941644811485,-136.6057424369948,-137.48206842587473,-138.35839441475468,-139.23472040363464,-140.1110463925146,-140.98737238139455,-141.8636983702745,-142.74002435915446,-143.6163503480344,-144.49267633691434,-145.3690023257943,-146.24532831467425,-147.1216543035542,-147.99798029243416,-148.87430628131412,-149.75063227019407,-150.62695825907403,-151.50328424795399,-152.37961023683394,-153.2559362257139)
rate=c(0.6184212867716076, 5.007272294006299,11.8615881499805,12.440211526749854,12.467739279968752,12.53860416641847,12.53860416641847,12.581278426181148,12.581278426181148,12.598854294625056,12.616331950299195,12.672310923038388,12.666929899107778,12.678443756117955,12.692751359974642,12.692751359974642,12.722405460633412,12.719601993795235,12.740670303753541,12.774152304577363,12.774152304577363,12.781161067558523,12.804189637021178,12.814629880844386,12.814629880844386,12.816062292518279,12.818737031614955,12.827909077716598,12.827909077716598,12.824018528357529,12.83928143308681,12.845581154225481,12.845581154225481,12.845581154225481,12.845581154225481,12.840547428643063,12.840547428643063,12.833722128219245,12.833722128219245,12.833722128219245,12.833722128219245,12.841314954758579,12.841314954758579,12.824063733898113,12.824063733898113,12.824063733898113,12.824063733898113,12.829492090527618,12.829492090527618,12.829492090527618,12.829492090527618,12.829492090527618,12.829492090527618,12.827867140466976,12.810373090915979,12.810373090915979,12.813499615251255,12.813499615251255,12.813499615251255,12.808788042681805,12.791849210965653,12.791849210965653,12.791849210965653,12.791849210965653,12.79451133225038,12.79451133225038,12.79451133225038,12.766096540357093,12.766096540357093,12.76766687780614,12.76766687780614,12.76766687780614,12.76766687780614,12.76766687780614,12.778663551380886,12.770421330064254,12.773710518913719,12.773710518913719,12.773710518913719,12.786246410380707,12.775730926653132,12.793030531769608,12.793030531769608,12.799570541920858,12.834359585339566,12.834359585339566,12.842291928176419,12.836329634746068,12.848983084409024,12.848983084409024,12.859439497560397,12.845548623961749,12.84243344040413,12.827796372430235,12.827796372430235,12.814807226638369,12.814807226638369,12.698074015682693,12.698074015682693,12.678369875181314)
minHPD=c(0.6184212867716076, 5.007272294006299,11.8615881499805,12.440211526749854,12.467739279968752,12.53860416641847,12.53860416641847,12.581278426181148,12.581278426181148,12.598854294625056,12.616331950299195,12.672310923038388,12.666929899107778,12.678443756117955,12.692751359974642,12.692751359974642,12.722405460633412,12.719601993795235,12.740670303753541,12.774152304577363,12.774152304577363,12.781161067558523,12.804189637021178,12.814629880844386,12.814629880844386,12.816062292518279,12.818737031614955,12.827909077716598,12.827909077716598,12.824018528357529,12.83928143308681,12.845581154225481,12.845581154225481,12.845581154225481,12.845581154225481,12.840547428643063,12.840547428643063,12.833722128219245,12.833722128219245,12.833722128219245,12.833722128219245,12.841314954758579,12.841314954758579,12.824063733898113,12.824063733898113,12.824063733898113,12.824063733898113,12.829492090527618,12.829492090527618,12.829492090527618,12.829492090527618,12.829492090527618,12.829492090527618,12.827867140466976,12.810373090915979,12.810373090915979,12.813499615251255,12.813499615251255,12.813499615251255,12.808788042681805,12.791849210965653,12.791849210965653,12.791849210965653,12.791849210965653,12.79451133225038,12.79451133225038,12.79451133225038,12.766096540357093,12.766096540357093,12.76766687780614,12.76766687780614,12.76766687780614,12.76766687780614,12.76766687780614,12.778663551380886,12.770421330064254,12.773710518913719,12.773710518913719,12.773710518913719,12.786246410380707,12.775730926653132,12.793030531769608,12.793030531769608,12.799570541920858,12.834359585339566,12.834359585339566,12.842291928176419,12.836329634746068,12.848983084409024,12.848983084409024,12.859439497560397,12.845548623961749,12.84243344040413,12.827796372430235,12.827796372430235,12.814807226638369,12.814807226638369,12.698074015682693,12.698074015682693,12.678369875181314)
maxHPD=c(0.6184212867716076, 5.007272294006299,11.8615881499805,12.440211526749854,12.467739279968752,12.53860416641847,12.53860416641847,12.581278426181148,12.581278426181148,12.598854294625056,12.616331950299195,12.672310923038388,12.666929899107778,12.678443756117955,12.692751359974642,12.692751359974642,12.722405460633412,12.719601993795235,12.740670303753541,12.774152304577363,12.774152304577363,12.781161067558523,12.804189637021178,12.814629880844386,12.814629880844386,12.816062292518279,12.818737031614955,12.827909077716598,12.827909077716598,12.824018528357529,12.83928143308681,12.845581154225481,12.845581154225481,12.845581154225481,12.845581154225481,12.840547428643063,12.840547428643063,12.833722128219245,12.833722128219245,12.833722128219245,12.833722128219245,12.841314954758579,12.841314954758579,12.824063733898113,12.824063733898113,12.824063733898113,12.824063733898113,12.829492090527618,12.829492090527618,12.829492090527618,12.829492090527618,12.829492090527618,12.829492090527618,12.827867140466976,12.810373090915979,12.810373090915979,12.813499615251255,12.813499615251255,12.813499615251255,12.808788042681805,12.791849210965653,12.791849210965653,12.791849210965653,12.791849210965653,12.79451133225038,12.79451133225038,12.79451133225038,12.766096540357093,12.766096540357093,12.76766687780614,12.76766687780614,12.76766687780614,12.76766687780614,12.76766687780614,12.778663551380886,12.770421330064254,12.773710518913719,12.773710518913719,12.773710518913719,12.786246410380707,12.775730926653132,12.793030531769608,12.793030531769608,12.799570541920858,12.834359585339566,12.834359585339566,12.842291928176419,12.836329634746068,12.848983084409024,12.848983084409024,12.859439497560397,12.845548623961749,12.84243344040413,12.827796372430235,12.827796372430235,12.814807226638369,12.814807226638369,12.698074015682693,12.698074015682693,12.678369875181314)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 14.145383447316437), xlim = c(-153.69409922015387,-66.06150033215854), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()