

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.50759717994268, -67.3964238939314,-68.28525060792012,-69.17407732190881,-70.06290403589753,-70.95173074988625,-71.84055746387497,-72.72938417786366,-73.61821089185239,-74.5070376058411,-75.3958643198298,-76.28469103381852,-77.17351774780724,-78.06234446179593,-78.95117117578465,-79.83999788977337,-80.72882460376206,-81.61765131775078,-82.5064780317395,-83.3953047457282,-84.28413145971692,-85.17295817370564,-86.06178488769433,-86.95061160168305,-87.83943831567177,-88.72826502966046,-89.61709174364918,-90.5059184576379,-91.39474517162662,-92.28357188561532,-93.17239859960404,-94.06122531359276,-94.95005202758145,-95.83887874157017,-96.72770545555889,-97.61653216954758,-98.5053588835363,-99.39418559752502,-100.28301231151372,-101.17183902550244,-102.06066573949116,-102.94949245347985,-103.83831916746857,-104.72714588145729,-105.61597259544598,-106.5047993094347,-107.39362602342342,-108.28245273741211,-109.17127945140084,-110.06010616538956,-110.94893287937828,-111.83775959336697,-112.72658630735569,-113.61541302134441,-114.5042397353331,-115.39306644932182,-116.28189316331054,-117.17071987729923,-118.05954659128795,-118.94837330527668,-119.83720001926537,-120.72602673325409,-121.61485344724281,-122.5036801612315,-123.39250687522022,-124.28133358920894,-125.17016030319763,-126.05898701718635,-126.94781373117507,-127.83664044516377,-128.7254671591525,-129.6142938731412,-130.5031205871299,-131.39194730111865,-132.28077401510734,-133.16960072909603,-134.05842744308478,-134.94725415707347,-135.83608087106217,-136.72490758505091,-137.6137342990396,-138.5025610130283,-139.39138772701705,-140.28021444100574,-141.16904115499446,-142.05786786898318,-142.94669458297187,-143.8355212969606,-144.7243480109493,-145.613174724938,-146.50200143892673,-147.39082815291545,-148.27965486690414,-149.16848158089286,-150.05730829488158,-150.94613500887027,-151.834961722859,-152.7237884368477,-153.6126151508364,-154.50144186482513)
rate=c(0.10438098541344878, 0.10438098541344878,0.10438098541344878,0.1042384205710957,0.1042384205710957,0.10412744899766843,0.10412744899766843,0.10412744899766843,0.10412744899766843,0.10412744899766843,0.1042384205710957,0.1042384205710957,0.10438098541344878,0.1044169640127158,0.10444783831122154,0.10444783831122154,0.10444783831122154,0.10444783831122154,0.10444783831122154,0.10444783831122154,0.1044169640127158,0.1044169640127158,0.1044169640127158,0.10438098541344878,0.10438457861764647,0.10438457861764647,0.10443231971762211,0.10443231971762211,0.10444783831122154,0.10444783831122154,0.10444783831122154,0.10444783831122154,0.10444783831122154,0.10444783831122154,0.10444783831122154,0.10444783831122154,0.10443231971762211,0.10443231971762211,0.10443231971762211,0.10443231971762211,0.10443231971762211,0.1042384205710957,0.1042384205710957,0.1042384205710957,0.10412744899766843,0.10404582195511505,0.10404582195511505,0.10403163931459025,0.10403163931459025,0.10403163931459025,0.10403163931459025,0.10403163931459025,0.10403163931459025,0.10403163931459025,0.10403163931459025,0.10403163931459025,0.10403163931459025,0.10403163931459025,0.10408731323628456,0.10412744899766843,0.10412744899766843,0.10412744899766843,0.10412744899766843,0.10412744899766843,0.10412744899766843,0.10412744899766843,0.1042384205710957,0.1042384205710957,0.10438457861764647,0.10438457861764647,0.10438457861764647,0.10438457861764647,0.10438457861764647,0.10438457861764647,0.10438457861764647,0.10438457861764647,0.10438457861764647,0.10438457861764647,0.10438457861764647,0.1042384205710957,0.10412744899766843,0.10412744899766843,0.10412744899766843,0.1042384205710957,0.1042384205710957,0.10438457861764647,0.10438457861764647,0.10447304220173495,0.10447304220173495,0.10447304220173495,0.1044983596237041,0.10453891036737145,0.10458236566716331,0.10463278246752664,0.10464397962187201,0.10481775683962952,0.10498863888768288,0.10499437710882609,0.10499951916803177,0.10518676899366053)
minHPD=c(0.06741143578769995, 0.06741143578769995,0.06741143578769995,0.0672971219581517,0.0672971219581517,0.0672971219581517,0.0672971219581517,0.0672971219581517,0.0672971219581517,0.0672971219581517,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06727757793760124,0.06727757793760124,0.06727757793760124,0.06727757793760124,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.06989703326678037,0.07001847525665286,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07011866949874555,0.07001847525665286,0.07001847525665286,0.07001847525665286,0.07001847525665286,0.06727757793760124,0.06727757793760124,0.06727757793760124,0.06727757793760124,0.06654373312768946,0.06654373312768946,0.06727757793760124,0.06727757793760124,0.06599585937131551,0.06654373312768946,0.06599585937131551,0.06599585937131551,0.06599585937131551,0.06277472280035351,0.06654373312768946,0.06277472280035351,0.03669804837630533)
maxHPD=c(0.14010480815223333, 0.14010480815223333,0.14010480815223333,0.13978685104162966,0.13978685104162966,0.13978685104162966,0.13978685104162966,0.13978685104162966,0.13978685104162966,0.13978685104162966,0.1418316549300972,0.1418316549300972,0.14136105624187348,0.14136105624187348,0.1411468415185716,0.1411468415185716,0.1411468415185716,0.1411468415185716,0.1411468415185716,0.1411468415185716,0.14101844029333335,0.14101844029333335,0.14101844029333335,0.14101844029333335,0.14101844029333335,0.14101844029333335,0.14101844029333335,0.14101844029333335,0.1404439756372803,0.1404439756372803,0.1404439756372803,0.1404439756372803,0.14101844029333335,0.14101844029333335,0.14101844029333335,0.1404439756372803,0.1404439756372803,0.14101844029333335,0.14101844029333335,0.14101844029333335,0.14101844029333335,0.13819826785261843,0.13819826785261843,0.13819826785261843,0.13819826785261843,0.1411468415185716,0.14136105624187348,0.1418316549300972,0.1418316549300972,0.1418316549300972,0.1418316549300972,0.1418316549300972,0.1411468415185716,0.1411468415185716,0.1411468415185716,0.1411468415185716,0.1411468415185716,0.1404439756372803,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.1404439756372803,0.1418316549300972,0.1418316549300972,0.13978685104162966,0.13978685104162966,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14010480815223333,0.14136105624187348,0.1418316549300972,0.1418316549300972,0.1436019067521436,0.14513235325222662,0.1465014009133103,0.15039816021786886,0.15253246481771926,0.1582061781472305,0.1582061781472305,0.16350021905274695)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.17985024095802166), xlim = c(-154.94585522181947,-66.06318382294833), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.51208620375071, -67.40989096535547,-68.30769572696023,-69.205500488565,-70.10330525016975,-71.0011100117745,-71.89891477337926,-72.79671953498402,-73.69452429658878,-74.59232905819354,-75.4901338197983,-76.38793858140306,-77.28574334300782,-78.18354810461258,-79.08135286621733,-79.97915762782209,-80.87696238942685,-81.77476715103161,-82.67257191263637,-83.57037667424113,-84.46818143584589,-85.36598619745065,-86.26379095905541,-87.16159572066017,-88.05940048226493,-88.95720524386968,-89.85501000547444,-90.7528147670792,-91.65061952868396,-92.54842429028872,-93.44622905189348,-94.34403381349824,-95.241838575103,-96.13964333670775,-97.03744809831251,-97.93525285991727,-98.83305762152203,-99.73086238312679,-100.62866714473155,-101.52647190633631,-102.42427666794107,-103.32208142954583,-104.2198861911506,-105.11769095275535,-106.01549571436011,-106.91330047596487,-107.81110523756962,-108.70890999917438,-109.60671476077914,-110.5045195223839,-111.40232428398866,-112.30012904559341,-113.19793380719817,-114.09573856880293,-114.99354333040769,-115.89134809201245,-116.78915285361721,-117.68695761522197,-118.58476237682673,-119.48256713843149,-120.38037190003625,-121.27817666164101,-122.17598142324577,-123.07378618485053,-123.9715909464553,-124.86939570806005,-125.7672004696648,-126.66500523126956,-127.5628099928743,-128.46061475447908,-129.3584195160838,-130.2562242776886,-131.15402903929333,-132.05183380089812,-132.94963856250286,-133.84744332410764,-134.74524808571238,-135.64305284731716,-136.5408576089219,-137.43866237052669,-138.33646713213142,-139.2342718937362,-140.13207665534094,-141.02988141694567,-141.92768617855046,-142.8254909401552,-143.72329570175998,-144.6211004633647,-145.5189052249695,-146.41670998657423,-147.31451474817902,-148.21231950978375,-149.11012427138854,-150.00792903299327,-150.90573379459806,-151.8035385562028,-152.70134331780758,-153.59914807941232,-154.4969528410171)
counts=c(0.0, 0.0,0.001,0.0,0.001,0.0,0.0,0.001,0.0,0.001,0.003,0.001,0.001,0.002,0.001,0.0,0.0,0.0,0.001,0.001,0.0,0.0,0.001,0.002,0.0,0.001,0.0,0.001,0.001,0.0,0.001,0.0,0.0,0.0,0.003,0.002,0.0,0.001,0.0,0.0,0.002,0.0,0.0,0.003,0.001,0.001,0.0,0.0,0.0,0.0,0.001,0.002,0.001,0.0,0.0,0.001,0.004,0.002,0.002,0.0,0.0,0.001,0.0,0.0,0.0,0.001,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.002,0.003,0.003,0.002,0.0,0.0,0.002,0.001,0.002,0.003,0.005,0.004,0.002,0.005,0.003,0.005,0.005,0.003,0.005,0.009,0.011)
plot(mids,counts,type = 'h', xlim = c(-154.94585522181947,-66.06318382294833), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.033800964859661074
bf6 = 0.20539984341627668
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.50759717994268, -67.3964238939314,-68.28525060792012,-69.17407732190881,-70.06290403589753,-70.95173074988625,-71.84055746387497,-72.72938417786366,-73.61821089185239,-74.5070376058411,-75.3958643198298,-76.28469103381852,-77.17351774780724,-78.06234446179593,-78.95117117578465,-79.83999788977337,-80.72882460376206,-81.61765131775078,-82.5064780317395,-83.3953047457282,-84.28413145971692,-85.17295817370564,-86.06178488769433,-86.95061160168305,-87.83943831567177,-88.72826502966046,-89.61709174364918,-90.5059184576379,-91.39474517162662,-92.28357188561532,-93.17239859960404,-94.06122531359276,-94.95005202758145,-95.83887874157017,-96.72770545555889,-97.61653216954758,-98.5053588835363,-99.39418559752502,-100.28301231151372,-101.17183902550244,-102.06066573949116,-102.94949245347985,-103.83831916746857,-104.72714588145729,-105.61597259544598,-106.5047993094347,-107.39362602342342,-108.28245273741211,-109.17127945140084,-110.06010616538956,-110.94893287937828,-111.83775959336697,-112.72658630735569,-113.61541302134441,-114.5042397353331,-115.39306644932182,-116.28189316331054,-117.17071987729923,-118.05954659128795,-118.94837330527668,-119.83720001926537,-120.72602673325409,-121.61485344724281,-122.5036801612315,-123.39250687522022,-124.28133358920894,-125.17016030319763,-126.05898701718635,-126.94781373117507,-127.83664044516377,-128.7254671591525,-129.6142938731412,-130.5031205871299,-131.39194730111865,-132.28077401510734,-133.16960072909603,-134.05842744308478,-134.94725415707347,-135.83608087106217,-136.72490758505091,-137.6137342990396,-138.5025610130283,-139.39138772701705,-140.28021444100574,-141.16904115499446,-142.05786786898318,-142.94669458297187,-143.8355212969606,-144.7243480109493,-145.613174724938,-146.50200143892673,-147.39082815291545,-148.27965486690414,-149.16848158089286,-150.05730829488158,-150.94613500887027,-151.834961722859,-152.7237884368477,-153.6126151508364,-154.50144186482513)
rate=c(2.67831653535325, 0.08198928174720631,0.08188589395309176,0.08188589395309176,0.08188589395309176,0.08188589395309176,0.08188589395309176,0.08188589395309176,0.08192666919946455,0.08184555494127319,0.08184555494127319,0.08184555494127319,0.08184555494127319,0.08184555494127319,0.08184555494127319,0.08184555494127319,0.08184555494127319,0.08184555494127319,0.08184555494127319,0.08184555494127319,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08178051945731282,0.08178051945731282,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08168547355758152,0.08178051945731282,0.08178051945731282,0.08178051945731282,0.08152678990225438,0.08142210947395975,0.08142210947395975,0.08142210947395975,0.08134363501029773,0.08134363501029773,0.0811975031310011,0.08114505142251532,0.08114505142251532,0.08105087033426378,0.08105087033426378,0.08105087033426378,0.08105087033426378,0.08105087033426378,0.08105087033426378,0.0810358243006333,0.08102411385877728,0.08096899943665359,0.08096899943665359,0.08096899943665359,0.08088228654372653,0.08088228654372653,0.08096899943665359,0.08082358612407753,0.08082358612407753,0.08088228654372653,0.08088228654372653,0.08088228654372653,0.08088228654372653,0.08096899943665359,0.08088228654372653,0.08088228654372653,0.08088228654372653)
minHPD=c(0.58719565406651, 0.04916721690632865,0.05022671512124817,0.05022671512124817,0.05036821412733579,0.05036821412733579,0.05036821412733579,0.05036821412733579,0.04872584619263059,0.051346084102843366,0.051346084102843366,0.051346084102843366,0.051346084102843366,0.051346084102843366,0.051346084102843366,0.051346084102843366,0.051700259455978115,0.051700259455978115,0.051700259455978115,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.051868970753533535,0.05206413522873126,0.05206413522873126,0.05206413522873126,0.05206413522873126,0.05206413522873126,0.05206413522873126,0.05206413522873126,0.05206413522873126,0.05206413522873126,0.051700259455978115,0.051700259455978115,0.051700259455978115,0.051346084102843366,0.051346084102843366,0.05092277657746093,0.05092277657746093,0.05092277657746093,0.05092277657746093,0.05092277657746093,0.05092277657746093,0.05092277657746093,0.05092277657746093,0.05092277657746093,0.05092277657746093,0.05092277657746093,0.05092277657746093,0.05092277657746093,0.05092277657746093,0.05055373765135132,0.05055373765135132,0.05055373765135132,0.05036821412733579,0.05022671512124817,0.05022671512124817,0.04966626487916336,0.04966626487916336,0.04966626487916336,0.04966626487916336,0.04966626487916336,0.04966626487916336,0.04966626487916336,0.04966626487916336,0.04966626487916336,0.049468277199132014,0.04916721690632865,0.04916721690632865,0.04916721690632865,0.04916721690632865,0.04916721690632865,0.04916721690632865,0.04872584619263059,0.04872584619263059,0.04819364107426154,0.04722954892114793,0.04722954892114793,0.04916721690632865,0.04872584619263059,0.04872584619263059,0.04872584619263059,0.04819364107426154)
maxHPD=c(5.714448812033849, 0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11226561794335772,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11409470205816556,0.11409470205816556,0.11409470205816556,0.11409470205816556,0.11409470205816556,0.11409470205816556,0.11409470205816556,0.11409470205816556,0.11420299824966788,0.11420299824966788,0.11409470205816556,0.11409470205816556,0.11409470205816556,0.11409470205816556,0.11409470205816556,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11420299824966788,0.11482892722239929,0.11482892722239929,0.11785716406540207,0.11834785424924733,0.11834785424924733,0.11834785424924733,0.11834785424924733)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 6.2858936932372345), xlim = c(-154.94585522181947,-66.06318382294833), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.51208620375071, -67.40989096535547,-68.30769572696023,-69.205500488565,-70.10330525016975,-71.0011100117745,-71.89891477337926,-72.79671953498402,-73.69452429658878,-74.59232905819354,-75.4901338197983,-76.38793858140306,-77.28574334300782,-78.18354810461258,-79.08135286621733,-79.97915762782209,-80.87696238942685,-81.77476715103161,-82.67257191263637,-83.57037667424113,-84.46818143584589,-85.36598619745065,-86.26379095905541,-87.16159572066017,-88.05940048226493,-88.95720524386968,-89.85501000547444,-90.7528147670792,-91.65061952868396,-92.54842429028872,-93.44622905189348,-94.34403381349824,-95.241838575103,-96.13964333670775,-97.03744809831251,-97.93525285991727,-98.83305762152203,-99.73086238312679,-100.62866714473155,-101.52647190633631,-102.42427666794107,-103.32208142954583,-104.2198861911506,-105.11769095275535,-106.01549571436011,-106.91330047596487,-107.81110523756962,-108.70890999917438,-109.60671476077914,-110.5045195223839,-111.40232428398866,-112.30012904559341,-113.19793380719817,-114.09573856880293,-114.99354333040769,-115.89134809201245,-116.78915285361721,-117.68695761522197,-118.58476237682673,-119.48256713843149,-120.38037190003625,-121.27817666164101,-122.17598142324577,-123.07378618485053,-123.9715909464553,-124.86939570806005,-125.7672004696648,-126.66500523126956,-127.5628099928743,-128.46061475447908,-129.3584195160838,-130.2562242776886,-131.15402903929333,-132.05183380089812,-132.94963856250286,-133.84744332410764,-134.74524808571238,-135.64305284731716,-136.5408576089219,-137.43866237052669,-138.33646713213142,-139.2342718937362,-140.13207665534094,-141.02988141694567,-141.92768617855046,-142.8254909401552,-143.72329570175998,-144.6211004633647,-145.5189052249695,-146.41670998657423,-147.31451474817902,-148.21231950978375,-149.11012427138854,-150.00792903299327,-150.90573379459806,-151.8035385562028,-152.70134331780758,-153.59914807941232,-154.4969528410171)
counts=c(0.99, 0.005,0.0,0.001,0.0,0.002,0.0,0.001,0.002,0.0,0.0,0.001,0.0,0.0,0.0,0.001,0.0,0.0,0.001,0.001,0.0,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.002,0.0,0.001,0.0,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.001,0.0,0.0,0.003,0.001,0.001,0.0,0.002,0.001,0.003,0.001,0.002,0.0,0.002,0.0,0.0,0.0,0.0,0.001,0.001,0.001,0.0,0.0,0.001,0.0,0.0,0.003,0.0,0.001,0.002,0.0,0.002,0.003,0.001,0.0,0.001,0.003)
plot(mids,counts,type = 'h', xlim = c(-154.94585522181947,-66.06318382294833), ylim=c(0,0.99), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.50759717994268, -67.3964238939314,-68.28525060792012,-69.17407732190881,-70.06290403589753,-70.95173074988625,-71.84055746387497,-72.72938417786366,-73.61821089185239,-74.5070376058411,-75.3958643198298,-76.28469103381852,-77.17351774780724,-78.06234446179593,-78.95117117578465,-79.83999788977337,-80.72882460376206,-81.61765131775078,-82.5064780317395,-83.3953047457282,-84.28413145971692,-85.17295817370564,-86.06178488769433,-86.95061160168305,-87.83943831567177,-88.72826502966046,-89.61709174364918,-90.5059184576379,-91.39474517162662,-92.28357188561532,-93.17239859960404,-94.06122531359276,-94.95005202758145,-95.83887874157017,-96.72770545555889,-97.61653216954758,-98.5053588835363,-99.39418559752502,-100.28301231151372,-101.17183902550244,-102.06066573949116,-102.94949245347985,-103.83831916746857,-104.72714588145729,-105.61597259544598,-106.5047993094347,-107.39362602342342,-108.28245273741211,-109.17127945140084,-110.06010616538956,-110.94893287937828,-111.83775959336697,-112.72658630735569,-113.61541302134441,-114.5042397353331,-115.39306644932182,-116.28189316331054,-117.17071987729923,-118.05954659128795,-118.94837330527668,-119.83720001926537,-120.72602673325409,-121.61485344724281,-122.5036801612315,-123.39250687522022,-124.28133358920894,-125.17016030319763,-126.05898701718635,-126.94781373117507,-127.83664044516377,-128.7254671591525,-129.6142938731412,-130.5031205871299,-131.39194730111865,-132.28077401510734,-133.16960072909603,-134.05842744308478,-134.94725415707347,-135.83608087106217,-136.72490758505091,-137.6137342990396,-138.5025610130283,-139.39138772701705,-140.28021444100574,-141.16904115499446,-142.05786786898318,-142.94669458297187,-143.8355212969606,-144.7243480109493,-145.613174724938,-146.50200143892673,-147.39082815291545,-148.27965486690414,-149.16848158089286,-150.05730829488158,-150.94613500887027,-151.834961722859,-152.7237884368477,-153.6126151508364,-154.50144186482513)
net_rate=c(-2.818182135371911, 0.018559805220003927,0.022971506625093376,0.022891346756156238,0.023178600612467966,0.023155484368062793,0.023182834275624724,0.023182834275624724,0.023144266336905826,0.023284969085497136,0.023344195615734645,0.02330939879615606,0.02323444389669793,0.023325057056517495,0.023422703210781933,0.02341098797761704,0.02346305619368151,0.02346305619368151,0.02346305619368151,0.023482897713370966,0.023434677074804892,0.023434677074804892,0.023451660655454405,0.023428938294773608,0.02343979096087822,0.02343979096087822,0.02346457794221965,0.02346457794221965,0.02351946036684167,0.02351946036684167,0.02350014625937309,0.02350014625937309,0.023471587479902994,0.023471587479902994,0.023471587479902994,0.02341267252221092,0.02339401025550132,0.023467307298190618,0.023467307298190618,0.02343805393716802,0.02348783440247705,0.023426230534289577,0.023426230534289577,0.023426230534289577,0.023234589652931917,0.02306670907633014,0.022977688869150154,0.02285664400831922,0.02285664400831922,0.0226142100918878,0.0226142100918878,0.0226142100918878,0.022434076791556266,0.022419656666864598,0.022470965346480888,0.022470965346480888,0.022470965346480888,0.02255741201185803,0.02285787774645863,0.022984903939035718,0.022976158219718622,0.022976158219718622,0.022976158219718622,0.022971945571599484,0.02293714543502377,0.02293714543502377,0.023013801033810448,0.023402926406979108,0.023614699262464567,0.023614699262464567,0.023614699262464567,0.023707683857172302,0.023775457529942104,0.023901525330732445,0.02400954383816363,0.02400954383816363,0.024068537219866102,0.024068537219866102,0.024068537219866102,0.024059689213407367,0.023992198345028363,0.0241883917832373,0.024278838728717653,0.024523962038552057,0.024595762569241786,0.02474008906534795,0.02474008906534795,0.025096933895840404,0.025096933895840404,0.025882445723297266,0.02570813040046638,0.026289259606635463,0.026518484585965795,0.02736450661730575,0.027869239084780405,0.029793572055637516,0.030378204860873833,0.030999356983916402,0.033232848884285134,0.038917676694249476)
net_minHPD=c(-5.601901834834448, -0.025343774960485843,-0.021553690678771692,-0.021553690678771692,-0.027403442406798706,-0.027403442406798706,-0.027166035251848783,-0.027166035251848783,-0.027166035251848783,-0.02663311377338698,-0.02663311377338698,-0.02524719438119552,-0.02524719438119552,-0.026169698810690187,-0.02524719438119552,-0.02524719438119552,-0.02524719438119552,-0.02524719438119552,-0.02524719438119552,-0.02524719438119552,-0.02524719438119552,-0.02524719438119552,-0.022476847186587642,-0.022476847186587642,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.022476847186587642,-0.022476847186587642,-0.022476847186587642,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.022476847186587642,-0.02332550263015594,-0.023796503385387316,-0.023796503385387316,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.024391351704822137,-0.024391351704822137,-0.024391351704822137,-0.024391351704822137,-0.024391351704822137,-0.023796503385387316,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.021553690678771692,-0.022476847186587642,-0.021553690678771692,-0.020233793537137876,-0.020233793537137876,-0.020233793537137876,-0.020233793537137876,-0.020233793537137876,-0.020233793537137876,-0.021553690678771692,-0.021553690678771692,-0.023796503385387316,-0.02454559480638066,-0.024793797919817694,-0.02524719438119552,-0.02524719438119552,-0.02524719438119552,-0.02524719438119552,-0.027403442406798706,-0.032419342856382184,-0.035968576545568426,-0.027403442406798706,-0.032419342856382184,-0.032419342856382184,-0.035968576545568426,-0.040417316718009036,-0.040417316718009036,-0.0460593566841724,-0.0460593566841724)
net_maxHPD=c(-0.4455273239026605, 0.07168784210213992,0.07222902603018468,0.07186471226891349,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06551080377266284,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.0716379428626246,0.0716379428626246,0.0716379428626246,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06881726560542978,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06863451086289696,0.06870732690276661,0.06870732690276661,0.06870732690276661,0.06881726560542978,0.06881726560542978,0.06881726560542978,0.07168784210213992,0.07168784210213992,0.07168784210213992,0.07168784210213992,0.07168784210213992,0.07168784210213992,0.07083800645771911,0.0731136866786337,0.07168784210213992,0.07168784210213992,0.07168784210213992,0.07168784210213992,0.07168784210213992,0.0731136866786337,0.0731136866786337,0.0731136866786337,0.0731136866786337,0.07301185105098534,0.08419076306673055,0.08419076306673055,0.08575425926910271,0.09077771075811694,0.0946832330672313,0.09946010610715292,0.10447618702680503,0.1405394606259807)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-6.162092018317892, 0.15459340668857877), xlim = c(-154.94585522181947,-66.06318382294833), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.50759717994268, -67.3964238939314,-68.28525060792012,-69.17407732190881,-70.06290403589753,-70.95173074988625,-71.84055746387497,-72.72938417786366,-73.61821089185239,-74.5070376058411,-75.3958643198298,-76.28469103381852,-77.17351774780724,-78.06234446179593,-78.95117117578465,-79.83999788977337,-80.72882460376206,-81.61765131775078,-82.5064780317395,-83.3953047457282,-84.28413145971692,-85.17295817370564,-86.06178488769433,-86.95061160168305,-87.83943831567177,-88.72826502966046,-89.61709174364918,-90.5059184576379,-91.39474517162662,-92.28357188561532,-93.17239859960404,-94.06122531359276,-94.95005202758145,-95.83887874157017,-96.72770545555889,-97.61653216954758,-98.5053588835363,-99.39418559752502,-100.28301231151372,-101.17183902550244,-102.06066573949116,-102.94949245347985,-103.83831916746857,-104.72714588145729,-105.61597259544598,-106.5047993094347,-107.39362602342342,-108.28245273741211,-109.17127945140084,-110.06010616538956,-110.94893287937828,-111.83775959336697,-112.72658630735569,-113.61541302134441,-114.5042397353331,-115.39306644932182,-116.28189316331054,-117.17071987729923,-118.05954659128795,-118.94837330527668,-119.83720001926537,-120.72602673325409,-121.61485344724281,-122.5036801612315,-123.39250687522022,-124.28133358920894,-125.17016030319763,-126.05898701718635,-126.94781373117507,-127.83664044516377,-128.7254671591525,-129.6142938731412,-130.5031205871299,-131.39194730111865,-132.28077401510734,-133.16960072909603,-134.05842744308478,-134.94725415707347,-135.83608087106217,-136.72490758505091,-137.6137342990396,-138.5025610130283,-139.39138772701705,-140.28021444100574,-141.16904115499446,-142.05786786898318,-142.94669458297187,-143.8355212969606,-144.7243480109493,-145.613174724938,-146.50200143892673,-147.39082815291545,-148.27965486690414,-149.16848158089286,-150.05730829488158,-150.94613500887027,-151.834961722859,-152.7237884368477,-153.6126151508364,-154.50144186482513)
rate=c(0.34199098174581194, 11.453209251889174,12.06271583871952,12.06271583871952,12.104659229106986,12.104659229106986,12.108667940589676,12.108667940589676,12.102454094077261,12.123097893816805,12.123097893816805,12.123097893816805,12.12206596376978,12.12206596376978,12.12206596376978,12.12206596376978,12.129721933123559,12.129721933123559,12.129721933123559,12.132641921734374,12.133665296944526,12.133665296944526,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.107857164372138,12.107857164372138,12.107857164372138,12.096205198301073,12.096205198301073,12.103717253215107,12.103717253215107,12.103717253215107,12.103717253215107,12.103717253215107,12.103717253215107,12.101047011501679,12.101047011501679,12.101047011501679,12.101047011501679,12.095953186814528,12.095953186814528,12.095953186814528,12.153156176355344,12.17998044807786,12.17998044807786,12.17998044807786,12.193790532196969,12.203876034647754,12.222680822367845,12.238839465190186,12.238839465190186,12.24768242084366,12.24768242084366,12.24768242084366,12.24768242084366,12.24768242084366,12.24768242084366,12.261265026787479,12.269815681994308,12.280634666649343,12.280634666649343,12.280634666649343,12.28341518717142,12.28341518717142,12.274399406301667,12.294948367336751,12.294948367336751,12.281301079279634,12.251661359107526,12.251661359107526,12.220317484267172,12.164427976932275,12.166161696325474,12.166161696325474,12.096745932784442)
minHPD=c(0.34199098174581194, 11.453209251889174,12.06271583871952,12.06271583871952,12.104659229106986,12.104659229106986,12.108667940589676,12.108667940589676,12.102454094077261,12.123097893816805,12.123097893816805,12.123097893816805,12.12206596376978,12.12206596376978,12.12206596376978,12.12206596376978,12.129721933123559,12.129721933123559,12.129721933123559,12.132641921734374,12.133665296944526,12.133665296944526,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.107857164372138,12.107857164372138,12.107857164372138,12.096205198301073,12.096205198301073,12.103717253215107,12.103717253215107,12.103717253215107,12.103717253215107,12.103717253215107,12.103717253215107,12.101047011501679,12.101047011501679,12.101047011501679,12.101047011501679,12.095953186814528,12.095953186814528,12.095953186814528,12.153156176355344,12.17998044807786,12.17998044807786,12.17998044807786,12.193790532196969,12.203876034647754,12.222680822367845,12.238839465190186,12.238839465190186,12.24768242084366,12.24768242084366,12.24768242084366,12.24768242084366,12.24768242084366,12.24768242084366,12.261265026787479,12.269815681994308,12.280634666649343,12.280634666649343,12.280634666649343,12.28341518717142,12.28341518717142,12.274399406301667,12.294948367336751,12.294948367336751,12.281301079279634,12.251661359107526,12.251661359107526,12.220317484267172,12.164427976932275,12.166161696325474,12.166161696325474,12.096745932784442)
maxHPD=c(0.34199098174581194, 11.453209251889174,12.06271583871952,12.06271583871952,12.104659229106986,12.104659229106986,12.108667940589676,12.108667940589676,12.102454094077261,12.123097893816805,12.123097893816805,12.123097893816805,12.12206596376978,12.12206596376978,12.12206596376978,12.12206596376978,12.129721933123559,12.129721933123559,12.129721933123559,12.132641921734374,12.133665296944526,12.133665296944526,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.136166234137953,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.143502658434786,12.107857164372138,12.107857164372138,12.107857164372138,12.096205198301073,12.096205198301073,12.103717253215107,12.103717253215107,12.103717253215107,12.103717253215107,12.103717253215107,12.103717253215107,12.101047011501679,12.101047011501679,12.101047011501679,12.101047011501679,12.095953186814528,12.095953186814528,12.095953186814528,12.153156176355344,12.17998044807786,12.17998044807786,12.17998044807786,12.193790532196969,12.203876034647754,12.222680822367845,12.238839465190186,12.238839465190186,12.24768242084366,12.24768242084366,12.24768242084366,12.24768242084366,12.24768242084366,12.24768242084366,12.261265026787479,12.269815681994308,12.280634666649343,12.280634666649343,12.280634666649343,12.28341518717142,12.28341518717142,12.274399406301667,12.294948367336751,12.294948367336751,12.281301079279634,12.251661359107526,12.251661359107526,12.220317484267172,12.164427976932275,12.166161696325474,12.166161696325474,12.096745932784442)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 13.524443204070428), xlim = c(-154.94585522181947,-66.06318382294833), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()