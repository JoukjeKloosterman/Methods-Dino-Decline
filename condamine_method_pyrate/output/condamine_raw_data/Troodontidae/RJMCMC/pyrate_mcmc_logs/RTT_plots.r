

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.49518397567535, -67.37474930255885,-68.25431462944235,-69.13387995632584,-70.01344528320935,-70.89301061009284,-71.77257593697634,-72.65214126385985,-73.53170659074334,-74.41127191762683,-75.29083724451034,-76.17040257139384,-77.04996789827733,-77.92953322516084,-78.80909855204433,-79.68866387892783,-80.56822920581133,-81.44779453269483,-82.32735985957832,-83.20692518646183,-84.08649051334532,-84.96605584022882,-85.84562116711231,-86.72518649399582,-87.60475182087932,-88.48431714776282,-89.36388247464632,-90.24344780152981,-91.1230131284133,-92.00257845529681,-92.88214378218031,-93.76170910906382,-94.64127443594731,-95.5208397628308,-96.4004050897143,-97.2799704165978,-98.1595357434813,-99.03910107036481,-99.9186663972483,-100.7982317241318,-101.67779705101529,-102.5573623778988,-103.43692770478229,-104.3164930316658,-105.1960583585493,-106.07562368543279,-106.95518901231628,-107.83475433919979,-108.71431966608328,-109.59388499296679,-110.47345031985029,-111.35301564673378,-112.23258097361727,-113.11214630050077,-113.99171162738428,-114.87127695426778,-115.75084228115128,-116.63040760803477,-117.50997293491827,-118.38953826180176,-119.26910358868527,-120.14866891556878,-121.02823424245227,-121.90779956933576,-122.78736489621926,-123.66693022310275,-124.54649554998626,-125.42606087686977,-126.30562620375326,-127.18519153063676,-128.06475685752025,-128.94432218440375,-129.82388751128724,-130.70345283817073,-131.58301816505426,-132.46258349193775,-133.34214881882124,-134.22171414570477,-135.10127947258826,-135.98084479947175,-136.86041012635525,-137.73997545323874,-138.61954078012224,-139.49910610700573,-140.37867143388922,-141.25823676077272,-142.13780208765624,-143.01736741453973,-143.89693274142323,-144.77649806830675,-145.65606339519024,-146.53562872207374,-147.41519404895723,-148.29475937584073,-149.17432470272422,-150.05389002960771,-150.9334553564912,-151.8130206833747,-152.6925860102582,-153.57215133714172)
rate=c(0.13332832366882247, 0.13328633426315073,0.13306946659393615,0.13320171865301,0.13306946659393615,0.1329661551598743,0.13292504232372643,0.13292504232372643,0.1329661551598743,0.13306946659393615,0.13328633426315073,0.13328633426315073,0.13328633426315073,0.13328633426315073,0.13320171865301,0.13320171865301,0.13306946659393615,0.13306946659393615,0.13306946659393615,0.13306946659393615,0.13306946659393615,0.13328633426315073,0.13328633426315073,0.13328633426315073,0.13306946659393615,0.13306946659393615,0.13291759659193253,0.13288853605133727,0.13288853605133727,0.13285152800263722,0.13285152800263722,0.13285152800263722,0.13288853605133727,0.13288853605133727,0.13288853605133727,0.13288853605133727,0.13283337788740196,0.13283337788740196,0.13261710344451202,0.1325252459636464,0.13248925377237425,0.13248925377237425,0.13243836091234418,0.13239625154507115,0.13239625154507115,0.13233944089951777,0.13239625154507115,0.13239625154507115,0.13233944089951777,0.13233944089951777,0.1322660046058604,0.1321139977037123,0.1321139977037123,0.13233944089951777,0.13239625154507115,0.13248925377237425,0.1325252459636464,0.1325252459636464,0.13275843628844664,0.13285152800263722,0.13291759659193253,0.13347024199909652,0.13372395445143442,0.13447214006958796,0.1368946369203346,0.1406185770995927,0.14207102845822578,0.14247554232132614,0.14321051045512423,0.14342460441331129,0.14358884666838728,0.14367568742514747,0.14425509829399386,0.14467999611960783,0.14531768677129198,0.1462717055539538,0.15424894451335064,0.165185269900731,0.22418847579193074,0.3472213013069702,0.4280042221005091,0.5072941714470277,0.5943860028388004,0.6773649121857306,0.7286056052515013,0.7885270875589665,0.8818850782713556,0.9526440418083798,1.006438683417576,1.0336990649381694,1.0652514045191261,1.1174162472001117,1.1678256472164117,1.1918443621669654,1.2227476960207788,1.2242761526210146,1.2242761526210146,1.2212175066583235,1.2242761526210146,1.2351504395834028)
minHPD=c(0.07541512728450497, 0.07578859753397012,0.07606683872134197,0.07578859753397012,0.07578859753397012,0.07578859753397012,0.07541512728450497,0.07541512728450497,0.07541512728450497,0.07541512728450497,0.07541512728450497,0.07541512728450497,0.07541512728450497,0.07578859753397012,0.07541512728450497,0.07541512728450497,0.07541512728450497,0.07541512728450497,0.07541512728450497,0.07541512728450497,0.07541512728450497,0.07541512728450497,0.07541512728450497,0.07541512728450497,0.07461954924399809,0.07461954924399809,0.07220141112685599,0.07220141112685599,0.07220141112685599,0.07220141112685599,0.07220141112685599,0.07606683872134197,0.07606683872134197,0.07606683872134197,0.07606683872134197,0.07606683872134197,0.07220141112685599,0.07220141112685599,0.07541512728450497,0.07541512728450497,0.07541512728450497,0.07541512728450497,0.07461954924399809,0.07220141112685599,0.07168361525946523,0.07168361525946523,0.07168361525946523,0.07168361525946523,0.07168361525946523,0.07168361525946523,0.07168361525946523,0.06623040882741167,0.07220141112685599,0.07220141112685599,0.07168361525946523,0.07220141112685599,0.07220141112685599,0.07168361525946523,0.067375958709076,0.05796716837075055,0.05796716837075055,0.029673334389583653,0.018488179156897464,0.0016416771277696922,0.0016562902423305419,0.07220141112685599,0.07461954924399809,0.07541512728450497,0.0796728382345899,0.07541512728450497,0.07541512728450497,0.07220141112685599,0.07220141112685599,0.07461954924399809,0.07461954924399809,0.07220141112685599,0.07461954924399809,0.07461954924399809,0.07461954924399809,0.08226165019597888,0.07198463458229136,0.07198463458229136,0.07198463458229136,0.07198463458229136,0.07198463458229136,0.07198463458229136,0.07198463458229136,0.09275020448907172,0.09275020448907172,0.09920652911845401,0.09631708216925747,0.09631708216925747,0.09275020448907172,0.09275020448907172,0.09275020448907172,0.09275020448907172,0.09275020448907172,0.09275020448907172,0.09275020448907172,0.09275020448907172)
maxHPD=c(0.18745586212233495, 0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.18745586212233495,0.1879307643588746,0.1879307643588746,0.1879307643588746,0.1883537693412882,0.1883537693412882,0.1879307643588746,0.1883537693412882,0.1883537693412882,0.1883537693412882,0.1883537693412882,0.19295274105338767,0.19295274105338767,0.19295274105338767,0.19295274105338767,0.19295274105338767,0.18985365424848777,0.18985365424848777,0.19426227828035106,0.19426227828035106,0.19503970130261292,0.19503970130261292,0.19503970130261292,0.19381253630412856,0.19426227828035106,0.19503970130261292,0.19793004798822691,0.19793004798822691,0.19914845971192613,0.19914845971192613,0.20119151387739603,0.19914845971192613,0.2057678230509186,0.20676261648984512,0.20676261648984512,0.20910676530528066,0.20931001817186975,0.20931001817186975,0.21142753109687537,0.20931001817186975,0.21672688063548032,0.20931001817186975,0.20931001817186975,0.20910676530528066,0.3013332051620055,0.41194611163126127,0.4269365785220899,0.4269365785220899,0.4302019592172704,0.42973268117221136,0.42973268117221136,0.4269365785220899,0.43783694187327127,0.44876398156278285,0.46513809343673423,0.5127002489578495,1.1525628312610752,1.7389856052828006,2.4198446299931256,2.8765239573310164,2.937615378357635,3.0935107437232494,3.4337995620841197,3.5083427926210873,3.5083427926210873,3.5725512539319526,3.5970150044719515,3.6388351094000653,3.7050659636218612,3.74246525864239,3.74246525864239,3.74246525864239,3.7897059340309642,3.804758058825905,3.825509824640276,3.839327872117741,3.839327872117741,3.839327872117741,3.839327872117741,3.839327872117741)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 4.223260659329515), xlim = c(-154.01193400058347,-66.0554013122336), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.49962622480102, -67.38807604993588,-68.27652587507072,-69.16497570020556,-70.05342552534042,-70.94187535047526,-71.83032517561011,-72.71877500074496,-73.6072248258798,-74.49567465101465,-75.3841244761495,-76.27257430128435,-77.16102412641919,-78.04947395155403,-78.93792377668889,-79.82637360182373,-80.71482342695857,-81.60327325209343,-82.49172307722827,-83.38017290236311,-84.26862272749797,-85.15707255263281,-86.04552237776767,-86.93397220290251,-87.82242202803735,-88.71087185317221,-89.59932167830705,-90.4877715034419,-91.37622132857675,-92.26467115371159,-93.15312097884643,-94.04157080398129,-94.93002062911614,-95.81847045425098,-96.70692027938583,-97.59537010452067,-98.48381992965552,-99.37226975479037,-100.26071957992522,-101.14916940506006,-102.0376192301949,-102.92606905532976,-103.8145188804646,-104.70296870559946,-105.5914185307343,-106.47986835586914,-107.36831818100399,-108.25676800613884,-109.1452178312737,-110.03366765640854,-110.92211748154338,-111.81056730667822,-112.69901713181308,-113.58746695694792,-114.47591678208278,-115.36436660721762,-116.25281643235246,-117.14126625748732,-118.02971608262216,-118.91816590775701,-119.80661573289186,-120.6950655580267,-121.58351538316154,-122.4719652082964,-123.36041503343125,-124.2488648585661,-125.13731468370094,-126.02576450883578,-126.91421433397063,-127.80266415910549,-128.69111398424033,-129.57956380937517,-130.46801363451002,-131.35646345964486,-132.2449132847797,-133.13336310991454,-134.0218129350494,-134.91026276018425,-135.79871258531912,-136.68716241045396,-137.5756122355888,-138.46406206072365,-139.3525118858585,-140.24096171099333,-141.12941153612817,-142.01786136126302,-142.9063111863979,-143.79476101153273,-144.68321083666757,-145.57166066180244,-146.46011048693728,-147.34856031207212,-148.23701013720697,-149.1254599623418,-150.01390978747665,-150.9023596126115,-151.79080943774633,-152.6792592628812,-153.56770908801604)
counts=c(0.002, 0.002,0.001,0.001,0.001,0.003,0.0,0.002,0.001,0.002,0.004,0.0,0.002,0.003,0.001,0.002,0.001,0.0,0.0,0.0,0.002,0.0,0.001,0.004,0.0,0.006,0.003,0.002,0.002,0.001,0.001,0.002,0.0,0.0,0.001,0.003,0.001,0.004,0.0,0.001,0.001,0.002,0.004,0.0,0.004,0.003,0.001,0.001,0.001,0.003,0.001,0.002,0.003,0.002,0.003,0.001,0.002,0.007,0.002,0.005,0.008,0.015,0.032,0.046,0.035,0.014,0.006,0.006,0.006,0.002,0.008,0.009,0.014,0.016,0.061,0.106,0.126,0.083,0.06,0.04,0.037,0.028,0.025,0.018,0.028,0.022,0.025,0.019,0.019,0.019,0.024,0.021,0.019,0.009,0.007,0.004,0.009,0.008,0.001)
plot(mids,counts,type = 'h', xlim = c(-154.01193400058347,-66.0554013122336), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03403050497466713
bf6 = 0.20654558894910197
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.49518397567535, -67.37474930255885,-68.25431462944235,-69.13387995632584,-70.01344528320935,-70.89301061009284,-71.77257593697634,-72.65214126385985,-73.53170659074334,-74.41127191762683,-75.29083724451034,-76.17040257139384,-77.04996789827733,-77.92953322516084,-78.80909855204433,-79.68866387892783,-80.56822920581133,-81.44779453269483,-82.32735985957832,-83.20692518646183,-84.08649051334532,-84.96605584022882,-85.84562116711231,-86.72518649399582,-87.60475182087932,-88.48431714776282,-89.36388247464632,-90.24344780152981,-91.1230131284133,-92.00257845529681,-92.88214378218031,-93.76170910906382,-94.64127443594731,-95.5208397628308,-96.4004050897143,-97.2799704165978,-98.1595357434813,-99.03910107036481,-99.9186663972483,-100.7982317241318,-101.67779705101529,-102.5573623778988,-103.43692770478229,-104.3164930316658,-105.1960583585493,-106.07562368543279,-106.95518901231628,-107.83475433919979,-108.71431966608328,-109.59388499296679,-110.47345031985029,-111.35301564673378,-112.23258097361727,-113.11214630050077,-113.99171162738428,-114.87127695426778,-115.75084228115128,-116.63040760803477,-117.50997293491827,-118.38953826180176,-119.26910358868527,-120.14866891556878,-121.02823424245227,-121.90779956933576,-122.78736489621926,-123.66693022310275,-124.54649554998626,-125.42606087686977,-126.30562620375326,-127.18519153063676,-128.06475685752025,-128.94432218440375,-129.82388751128724,-130.70345283817073,-131.58301816505426,-132.46258349193775,-133.34214881882124,-134.22171414570477,-135.10127947258826,-135.98084479947175,-136.86041012635525,-137.73997545323874,-138.61954078012224,-139.49910610700573,-140.37867143388922,-141.25823676077272,-142.13780208765624,-143.01736741453973,-143.89693274142323,-144.77649806830675,-145.65606339519024,-146.53562872207374,-147.41519404895723,-148.29475937584073,-149.17432470272422,-150.05389002960771,-150.9334553564912,-151.8130206833747,-152.6925860102582,-153.57215133714172)
rate=c(0.19125089097462272, 0.14859503186217116,0.1414633344988725,0.1398131099790633,0.13843504015642455,0.13798409270075251,0.13792646402284187,0.13781011485802194,0.13751491187733278,0.13754269553774195,0.13720734692964937,0.13590984814444795,0.13449970518592533,0.1334404997744187,0.13249759214401866,0.1321372939043554,0.13206536616070524,0.13202142331550332,0.1311082660849719,0.13086344953812235,0.13079718921867467,0.13079718921867467,0.13071849914029537,0.13071849914029537,0.13067344145733786,0.13067344145733786,0.13060880615631804,0.1304145165523571,0.13031623197083253,0.13031623197083253,0.1304145165523571,0.1304145165523571,0.1304145165523571,0.13045292649369827,0.13045292649369827,0.13060880615631804,0.13067344145733786,0.13067344145733786,0.13060880615631804,0.13060880615631804,0.13060880615631804,0.13060880615631804,0.13060880615631804,0.13060880615631804,0.13060880615631804,0.13067344145733786,0.13067344145733786,0.13067344145733786,0.13060880615631804,0.13071849914029537,0.13071849914029537,0.13079718921867467,0.13086344953812235,0.13094977369571037,0.13094977369571037,0.13094977369571037,0.13102143485879858,0.1311082660849719,0.13202142331550332,0.1321372939043554,0.13246274429542093,0.13332316867245947,0.13409500718161138,0.13469037018880695,0.13555418235040884,0.13574353709511894,0.13590984814444795,0.13574353709511894,0.13574353709511894,0.13574353709511894,0.13590984814444795,0.13600729664016697,0.13625618910810677,0.13625618910810677,0.1363318827580867,0.1363318827580867,0.13637704645363102,0.13637704645363102,0.1365802765926205,0.13771173963523303,0.1398131099790633,0.1420390055611558,0.1448469170314597,0.14946596442636173,0.15362002611710468,0.16001732817585568,0.16654679673751682,0.17875647590681162,0.1976430615652681,0.2929553295674877,0.6170700865426735,0.8253862076141274,0.9890550887485822,1.1145663288906071,1.1891819458510544,1.2149056540319985,1.2190310010940921,1.2292383967938363,1.2416281060724865,1.246353064778555)
minHPD=c(0.06326835076418973, 0.06326835076418973,0.06326835076418973,0.06326835076418973,0.0745970998811805,0.06057624027423799,0.06057624027423799,0.06326835076418973,0.06857387974208255,0.06857387974208255,0.06774448975767867,0.06774448975767867,0.06774448975767867,0.06626724197666768,0.06774448975767867,0.06857387974208255,0.06883604595380263,0.06857387974208255,0.06857387974208255,0.06883604595380263,0.06857387974208255,0.06857387974208255,0.06857387974208255,0.06857387974208255,0.06857387974208255,0.06857387974208255,0.06883604595380263,0.06857387974208255,0.06883604595380263,0.06883604595380263,0.06883604595380263,0.06883604595380263,0.06883604595380263,0.06883604595380263,0.06883604595380263,0.06883604595380263,0.06883604595380263,0.06883604595380263,0.06857387974208255,0.06857387974208255,0.06857387974208255,0.06883604595380263,0.06857387974208255,0.06857387974208255,0.06857387974208255,0.06857387974208255,0.06857387974208255,0.06774448975767867,0.06774448975767867,0.06857387974208255,0.06857387974208255,0.06857387974208255,0.06774448975767867,0.06774448975767867,0.06774448975767867,0.06857387974208255,0.06857387974208255,0.06626724197666768,0.0669049980354835,0.0669049980354835,0.06326835076418973,0.06326835076418973,0.06883604595380263,0.06857387974208255,0.06774448975767867,0.06626724197666768,0.06774448975767867,0.06626724197666768,0.06626724197666768,0.06626724197666768,0.06626724197666768,0.06369411952402143,0.06626724197666768,0.06626724197666768,0.06626724197666768,0.06626724197666768,0.06626724197666768,0.07066733323170539,0.06774448975767867,0.06626724197666768,0.03186879818005016,0.041042523959118955,0.03186879818005016,0.03186879818005016,0.03186879818005016,0.03186879818005016,0.03186879818005016,0.06774448975767867,0.041042523959118955,0.041042523959118955,0.041042523959118955,0.06857387974208255,0.06883604595380263,0.07066733323170539,0.07994576749770212,0.07066733323170539,0.07994576749770212,0.07994576749770212,0.07994576749770212,0.07994576749770212)
maxHPD=c(2.3184978637686275, 0.8968316471769521,0.4028840643192912,0.3326618687906075,0.294176615116098,0.26647920424873556,0.25978809859671015,0.2591430197883641,0.2591430197883641,0.25978809859671015,0.251301268209315,0.22254970676163588,0.2117905229468976,0.19904470160229282,0.19749666454428655,0.19686813880092432,0.19686813880092432,0.19620718133284457,0.19620718133284457,0.19686813880092432,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19539874226170836,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19620718133284457,0.19686813880092432,0.19686813880092432,0.19686813880092432,0.19686813880092432,0.19686813880092432,0.19749666454428655,0.19749666454428655,0.19749666454428655,0.19749666454428655,0.19904470160229282,0.19904470160229282,0.19749666454428655,0.19749666454428655,0.19749666454428655,0.19904470160229282,0.19904470160229282,0.19904470160229282,0.19904470160229282,0.19904470160229282,0.19749666454428655,0.201627335273743,0.2117905229468976,0.2117905229468976,0.22358964343168086,0.22358964343168086,0.22358964343168086,0.22358964343168086,0.22358964343168086,0.22358964343168086,0.22358964343168086,0.22358964343168086,0.23351122675334604,0.23351122675334604,0.23351122675334604,0.23821372161977244,0.25568939047163564,0.2660920946849898,0.273482483733918,0.4053364651770308,1.1798083892661113,1.9960569127254708,2.2647916239346495,2.5376732965011985,2.933942808310793,3.1829776385832615,3.3164163480725577,3.3934330464163955,3.5130702412350643,3.6843522614322026,3.823410623055917,3.980150172203457,3.980150172203457,4.1308381318592975,4.213774019451087,4.199616899117848,4.199616899117848,4.199616899117848,4.199616899117848,4.199616899117848)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 4.635151421396196), xlim = c(-154.01193400058347,-66.0554013122336), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.49962622480102, -67.38807604993588,-68.27652587507072,-69.16497570020556,-70.05342552534042,-70.94187535047526,-71.83032517561011,-72.71877500074496,-73.6072248258798,-74.49567465101465,-75.3841244761495,-76.27257430128435,-77.16102412641919,-78.04947395155403,-78.93792377668889,-79.82637360182373,-80.71482342695857,-81.60327325209343,-82.49172307722827,-83.38017290236311,-84.26862272749797,-85.15707255263281,-86.04552237776767,-86.93397220290251,-87.82242202803735,-88.71087185317221,-89.59932167830705,-90.4877715034419,-91.37622132857675,-92.26467115371159,-93.15312097884643,-94.04157080398129,-94.93002062911614,-95.81847045425098,-96.70692027938583,-97.59537010452067,-98.48381992965552,-99.37226975479037,-100.26071957992522,-101.14916940506006,-102.0376192301949,-102.92606905532976,-103.8145188804646,-104.70296870559946,-105.5914185307343,-106.47986835586914,-107.36831818100399,-108.25676800613884,-109.1452178312737,-110.03366765640854,-110.92211748154338,-111.81056730667822,-112.69901713181308,-113.58746695694792,-114.47591678208278,-115.36436660721762,-116.25281643235246,-117.14126625748732,-118.02971608262216,-118.91816590775701,-119.80661573289186,-120.6950655580267,-121.58351538316154,-122.4719652082964,-123.36041503343125,-124.2488648585661,-125.13731468370094,-126.02576450883578,-126.91421433397063,-127.80266415910549,-128.69111398424033,-129.57956380937517,-130.46801363451002,-131.35646345964486,-132.2449132847797,-133.13336310991454,-134.0218129350494,-134.91026276018425,-135.79871258531912,-136.68716241045396,-137.5756122355888,-138.46406206072365,-139.3525118858585,-140.24096171099333,-141.12941153612817,-142.01786136126302,-142.9063111863979,-143.79476101153273,-144.68321083666757,-145.57166066180244,-146.46011048693728,-147.34856031207212,-148.23701013720697,-149.1254599623418,-150.01390978747665,-150.9023596126115,-151.79080943774633,-152.6792592628812,-153.56770908801604)
counts=c(0.26, 0.082,0.021,0.025,0.009,0.003,0.003,0.006,0.001,0.011,0.026,0.015,0.018,0.009,0.008,0.0,0.002,0.005,0.002,0.001,0.001,0.001,0.0,0.001,0.0,0.002,0.001,0.003,0.0,0.001,0.001,0.0,0.001,0.002,0.0,0.002,0.001,0.001,0.0,0.0,0.004,0.001,0.0,0.001,0.002,0.0,0.002,0.001,0.003,0.001,0.004,0.001,0.001,0.001,0.002,0.005,0.002,0.003,0.002,0.012,0.005,0.012,0.012,0.008,0.001,0.003,0.0,0.0,0.001,0.001,0.003,0.001,0.002,0.003,0.003,0.002,0.01,0.021,0.037,0.04,0.047,0.056,0.051,0.05,0.048,0.049,0.043,0.04,0.063,0.053,0.056,0.043,0.039,0.015,0.01,0.01,0.007,0.009,0.0)
plot(mids,counts,type = 'h', xlim = c(-154.01193400058347,-66.0554013122336), ylim=c(0,0.26), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.49518397567535, -67.37474930255885,-68.25431462944235,-69.13387995632584,-70.01344528320935,-70.89301061009284,-71.77257593697634,-72.65214126385985,-73.53170659074334,-74.41127191762683,-75.29083724451034,-76.17040257139384,-77.04996789827733,-77.92953322516084,-78.80909855204433,-79.68866387892783,-80.56822920581133,-81.44779453269483,-82.32735985957832,-83.20692518646183,-84.08649051334532,-84.96605584022882,-85.84562116711231,-86.72518649399582,-87.60475182087932,-88.48431714776282,-89.36388247464632,-90.24344780152981,-91.1230131284133,-92.00257845529681,-92.88214378218031,-93.76170910906382,-94.64127443594731,-95.5208397628308,-96.4004050897143,-97.2799704165978,-98.1595357434813,-99.03910107036481,-99.9186663972483,-100.7982317241318,-101.67779705101529,-102.5573623778988,-103.43692770478229,-104.3164930316658,-105.1960583585493,-106.07562368543279,-106.95518901231628,-107.83475433919979,-108.71431966608328,-109.59388499296679,-110.47345031985029,-111.35301564673378,-112.23258097361727,-113.11214630050077,-113.99171162738428,-114.87127695426778,-115.75084228115128,-116.63040760803477,-117.50997293491827,-118.38953826180176,-119.26910358868527,-120.14866891556878,-121.02823424245227,-121.90779956933576,-122.78736489621926,-123.66693022310275,-124.54649554998626,-125.42606087686977,-126.30562620375326,-127.18519153063676,-128.06475685752025,-128.94432218440375,-129.82388751128724,-130.70345283817073,-131.58301816505426,-132.46258349193775,-133.34214881882124,-134.22171414570477,-135.10127947258826,-135.98084479947175,-136.86041012635525,-137.73997545323874,-138.61954078012224,-139.49910610700573,-140.37867143388922,-141.25823676077272,-142.13780208765624,-143.01736741453973,-143.89693274142323,-144.77649806830675,-145.65606339519024,-146.53562872207374,-147.41519404895723,-148.29475937584073,-149.17432470272422,-150.05389002960771,-150.9334553564912,-151.8130206833747,-152.6925860102582,-153.57215133714172)
net_rate=c(-0.5108764369535137, -0.1136245640376924,-0.03862130729939201,-0.027719140811063844,-0.017368326950172527,-0.015807976382147298,-0.015103547806515696,-0.01469537699939945,-0.013912630992768918,-0.014424298116059315,-0.013225398687681694,-0.007474347248444378,-0.004679223557213249,-0.0009092297278385017,8.11142068912781e-05,0.0010070448101548225,0.0011691403778525799,0.00127908449980491,0.001378388748658908,0.0016151766752433962,0.0018933105549977553,0.0024184130142838886,0.0026592976095035675,0.0026592976095035675,0.001879466677125205,0.001879466677125205,0.0015518945175141293,0.0014768256189438217,0.001477324160598989,0.0011713398991797365,0.0010915084184646223,0.0009897112335522475,0.001068075438356208,0.0010561218966737655,0.0010785527486653072,0.0010387128511322526,0.0006591584051296897,0.0006008627585868059,0.0003905299635025335,0.00035053361827648485,0.00016150803471925927,0.0003105279796518265,0.0002527411498283411,0.00015588294874753446,-6.366480090549559e-05,-0.0003608446890039423,-0.0003064587422085732,-0.0003658889899407307,-0.00042069009608189275,-0.0006129290072201024,-0.0008094417676908998,-0.0012000563231572858,-0.0014871626665543519,-0.001531873396788885,-0.0014203631164824526,-0.001323093114922007,-0.0014264553926884704,-0.0016098751511716544,-0.0017242356748950788,-0.0011119896504608094,-0.0013394246766383244,-0.0015844412282218514,-0.0021151211675702686,-8.358143695082976e-06,0.007877931745000413,0.022724439491404683,0.030931192723818845,0.031652605461270446,0.032733881399059445,0.03388254808043908,0.034277938577137616,0.03468384825908185,0.03804430400015104,0.03987891873371228,0.044700397342767324,0.06033024974261844,0.14864568033606435,0.2791509550417696,0.5152334708904912,0.6164592482584194,0.6338370504161007,0.6335279491134992,0.6028616360669976,0.5469546713261285,0.48386298776103503,0.4398207701521572,0.4015734108624867,0.3587335004162167,0.3226228234652278,0.2787949075696856,0.2049707777147164,0.14131161229112055,0.09858915627458884,0.05368034392822384,0.016673724287094637,0.012221240788657215,0.011474334997314648,0.004797139641056816,0.0032038561240071216,0.005006288729230129)
net_minHPD=c(-2.169796120568096, -0.7935714555611988,-0.26462863971962114,-0.2228220446282107,-0.15921929827016126,-0.15208200349841217,-0.15289552491104264,-0.1428456982486272,-0.1402012534263332,-0.1398702922034849,-0.13093352154062135,-0.10782263157244501,-0.0960693293066488,-0.08831003832566034,-0.07732041401489514,-0.07676011314860526,-0.07998621288151081,-0.07998621288151081,-0.07998621288151081,-0.07732041401489514,-0.07732041401489514,-0.07732041401489514,-0.07732041401489514,-0.07732041401489514,-0.07732041401489514,-0.07732041401489514,-0.07998621288151081,-0.07998621288151081,-0.07998621288151081,-0.07998621288151081,-0.07998621288151081,-0.084637790098152,-0.08524680538168945,-0.08524680538168945,-0.08524680538168945,-0.08524680538168945,-0.08667666079013288,-0.08667666079013288,-0.08111937679169076,-0.08111937679169076,-0.08793905866149838,-0.09367612007176371,-0.0960693293066488,-0.0960693293066488,-0.0960693293066488,-0.09798219300842445,-0.10148548128927583,-0.10148548128927583,-0.10148548128927583,-0.10148548128927583,-0.0960693293066488,-0.0960693293066488,-0.0960693293066488,-0.0960693293066488,-0.09798219300842445,-0.10148548128927583,-0.10148548128927583,-0.10204983172742456,-0.10148548128927583,-0.10204983172742456,-0.12262608372011621,-0.12515705891441553,-0.13488832867809372,-0.16688556556653578,-0.15662250865934257,-0.14417297493509143,-0.10066147405679773,-0.10066147405679773,-0.10184568978228664,-0.1054558006303023,-0.1054558006303023,-0.10782263157244501,-0.15662250865934257,-0.10782263157244501,-0.15246072893238094,-0.17682110603509069,-0.24324330940555944,-0.1949896060852257,-0.29294880763970366,-0.6364088032082704,-0.6364088032082704,-1.0277141930773162,-1.9072127826413978,-2.0911852154891393,-2.0911852154891393,-2.4130162433790274,-2.56187444208126,-2.8496331742220278,-3.0182075911450217,-3.2419178150166936,-3.2419178150166936,-3.2419178150166936,-3.264217401623708,-3.105570424583072,-3.264217401623708,-3.2375446074615755,-3.2375446074615755,-3.2375446074615755,-3.264217401623708,-3.2375446074615755)
net_maxHPD=c(0.10266406519591016, 0.09436990039138596,0.11555079890691368,0.08524261442612595,0.08363687393080776,0.08363687393080776,0.0797340944729832,0.08524261442612595,0.08524261442612595,0.08653625820938211,0.08653625820938211,0.08489310295242469,0.08448854112493917,0.07731091559278326,0.08653625820938211,0.08489310295242469,0.0797340944729832,0.07823708056378731,0.07823708056378731,0.0797340944729832,0.07823708056378731,0.07823708056378731,0.07823708056378731,0.07823708056378731,0.0797340944729832,0.0797340944729832,0.07731091559278326,0.0797340944729832,0.0797340944729832,0.0797340944729832,0.0797340944729832,0.07578869350635054,0.07578869350635054,0.07578869350635054,0.07578869350635054,0.07578869350635054,0.07578869350635054,0.07578869350635054,0.08653625820938211,0.08653625820938211,0.08053952513428068,0.07578869350635054,0.07477932591943946,0.07578869350635054,0.07731091559278326,0.07731091559278326,0.07578869350635054,0.07578869350635054,0.07578869350635054,0.07578869350635054,0.08489310295242469,0.0859612674359188,0.0859612674359188,0.0877229884254846,0.0877229884254846,0.08524261442612595,0.08524261442612595,0.0859612674359188,0.09145110114688024,0.09504308196107618,0.0859612674359188,0.08653625820938211,0.10266406519591016,0.10266406519591016,0.19254448454598683,0.2894650388477555,0.34040223685551063,0.34040223685551063,0.3368674961377749,0.34040223685551063,0.34040223685551063,0.34467864528584075,0.3190213034237812,0.3723864579101486,0.3565710078173178,0.40163337318151215,1.0571440289144245,1.7120243805565842,2.4890567918931685,3.070985037462817,3.666814242476084,4.07223628292106,3.5281705657023545,3.6811345742690436,3.8099120734131757,3.8099120734131757,3.7877414213496055,3.7525243769309644,3.6811345742690436,3.601488522697031,3.644915330573232,3.6332963019514155,3.4309371963801776,3.644915330573232,3.4309371963801776,3.4309371963801776,3.4309371963801776,3.419189131832098,3.321163058049964,3.419189131832098)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-3.5906391417860792, 4.479459911213167), xlim = c(-154.01193400058347,-66.0554013122336), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.49518397567535, -67.37474930255885,-68.25431462944235,-69.13387995632584,-70.01344528320935,-70.89301061009284,-71.77257593697634,-72.65214126385985,-73.53170659074334,-74.41127191762683,-75.29083724451034,-76.17040257139384,-77.04996789827733,-77.92953322516084,-78.80909855204433,-79.68866387892783,-80.56822920581133,-81.44779453269483,-82.32735985957832,-83.20692518646183,-84.08649051334532,-84.96605584022882,-85.84562116711231,-86.72518649399582,-87.60475182087932,-88.48431714776282,-89.36388247464632,-90.24344780152981,-91.1230131284133,-92.00257845529681,-92.88214378218031,-93.76170910906382,-94.64127443594731,-95.5208397628308,-96.4004050897143,-97.2799704165978,-98.1595357434813,-99.03910107036481,-99.9186663972483,-100.7982317241318,-101.67779705101529,-102.5573623778988,-103.43692770478229,-104.3164930316658,-105.1960583585493,-106.07562368543279,-106.95518901231628,-107.83475433919979,-108.71431966608328,-109.59388499296679,-110.47345031985029,-111.35301564673378,-112.23258097361727,-113.11214630050077,-113.99171162738428,-114.87127695426778,-115.75084228115128,-116.63040760803477,-117.50997293491827,-118.38953826180176,-119.26910358868527,-120.14866891556878,-121.02823424245227,-121.90779956933576,-122.78736489621926,-123.66693022310275,-124.54649554998626,-125.42606087686977,-126.30562620375326,-127.18519153063676,-128.06475685752025,-128.94432218440375,-129.82388751128724,-130.70345283817073,-131.58301816505426,-132.46258349193775,-133.34214881882124,-134.22171414570477,-135.10127947258826,-135.98084479947175,-136.86041012635525,-137.73997545323874,-138.61954078012224,-139.49910610700573,-140.37867143388922,-141.25823676077272,-142.13780208765624,-143.01736741453973,-143.89693274142323,-144.77649806830675,-145.65606339519024,-146.53562872207374,-147.41519404895723,-148.29475937584073,-149.17432470272422,-150.05389002960771,-150.9334553564912,-151.8130206833747,-152.6925860102582,-153.57215133714172)
rate=c(1.5491369006854427, 4.029782196375805,5.7855845753488895,6.172770163878488,6.597194906713919,6.667407502706836,6.702942180642416,6.721331375763611,6.75399391858806,6.727116505297781,6.77755065429132,7.0482634520835195,7.1899102061237,7.396066083708078,7.457200634694609,7.509049497235702,7.516426595982061,7.522209671992065,7.527832868152353,7.541275190701088,7.557126142832058,7.557126142832058,7.570908188302337,7.570908188302337,7.57403617697032,7.57403617697032,7.580550316953143,7.589372497303592,7.589401212701107,7.589401212701107,7.587761261777234,7.587872945844017,7.587872945844017,7.587184773348037,7.588476233494566,7.586182747504839,7.581659121793642,7.579651387226853,7.588543731163818,7.588543731163818,7.588543731163818,7.5971349083950255,7.6023713856786195,7.6023713856786195,7.6023713856786195,7.590709634261104,7.591304656091218,7.587340806467459,7.590729519712289,7.579669012182509,7.58111459323014,7.572269787871445,7.562748128588469,7.5451088369245465,7.5451088369245465,7.5410867609505345,7.526286797311495,7.509816199670446,7.4736989355308605,7.46432696303857,7.398427765333737,7.312904349517791,7.192078998569922,7.084349091999445,6.965206101087066,6.942098591064572,6.937290151586263,6.943743376677225,6.943743376677225,6.943743376677225,6.941190028547434,6.9277014336178775,6.898373924618484,6.898373924618484,6.881197048987394,6.859339369528738,6.784319198154783,6.73451065623251,6.173031120322296,4.96515063913426,3.5163739944063113,2.8154002838998564,2.2903485587901824,1.8622463871257648,1.5905373133779606,1.394504118686541,1.2550726497549092,1.1425258972007502,1.0435425217552357,0.9702617335100496,0.8821386565856604,0.814136600041463,0.7634478590328716,0.7190376601176784,0.6887447784200922,0.6832035318234787,0.6807616162735167,0.6783733304210133,0.6743379673699775,0.6708988197509018)
minHPD=c(1.5491369006854427, 4.029782196375805,5.7855845753488895,6.172770163878488,6.597194906713919,6.667407502706836,6.702942180642416,6.721331375763611,6.75399391858806,6.727116505297781,6.77755065429132,7.0482634520835195,7.1899102061237,7.396066083708078,7.457200634694609,7.509049497235702,7.516426595982061,7.522209671992065,7.527832868152353,7.541275190701088,7.557126142832058,7.557126142832058,7.570908188302337,7.570908188302337,7.57403617697032,7.57403617697032,7.580550316953143,7.589372497303592,7.589401212701107,7.589401212701107,7.587761261777234,7.587872945844017,7.587872945844017,7.587184773348037,7.588476233494566,7.586182747504839,7.581659121793642,7.579651387226853,7.588543731163818,7.588543731163818,7.588543731163818,7.5971349083950255,7.6023713856786195,7.6023713856786195,7.6023713856786195,7.590709634261104,7.591304656091218,7.587340806467459,7.590729519712289,7.579669012182509,7.58111459323014,7.572269787871445,7.562748128588469,7.5451088369245465,7.5451088369245465,7.5410867609505345,7.526286797311495,7.509816199670446,7.4736989355308605,7.46432696303857,7.398427765333737,7.312904349517791,7.192078998569922,7.084349091999445,6.965206101087066,6.942098591064572,6.937290151586263,6.943743376677225,6.943743376677225,6.943743376677225,6.941190028547434,6.9277014336178775,6.898373924618484,6.898373924618484,6.881197048987394,6.859339369528738,6.784319198154783,6.73451065623251,6.173031120322296,4.96515063913426,3.5163739944063113,2.8154002838998564,2.2903485587901824,1.8622463871257648,1.5905373133779606,1.394504118686541,1.2550726497549092,1.1425258972007502,1.0435425217552357,0.9702617335100496,0.8821386565856604,0.814136600041463,0.7634478590328716,0.7190376601176784,0.6887447784200922,0.6832035318234787,0.6807616162735167,0.6783733304210133,0.6743379673699775,0.6708988197509018)
maxHPD=c(1.5491369006854427, 4.029782196375805,5.7855845753488895,6.172770163878488,6.597194906713919,6.667407502706836,6.702942180642416,6.721331375763611,6.75399391858806,6.727116505297781,6.77755065429132,7.0482634520835195,7.1899102061237,7.396066083708078,7.457200634694609,7.509049497235702,7.516426595982061,7.522209671992065,7.527832868152353,7.541275190701088,7.557126142832058,7.557126142832058,7.570908188302337,7.570908188302337,7.57403617697032,7.57403617697032,7.580550316953143,7.589372497303592,7.589401212701107,7.589401212701107,7.587761261777234,7.587872945844017,7.587872945844017,7.587184773348037,7.588476233494566,7.586182747504839,7.581659121793642,7.579651387226853,7.588543731163818,7.588543731163818,7.588543731163818,7.5971349083950255,7.6023713856786195,7.6023713856786195,7.6023713856786195,7.590709634261104,7.591304656091218,7.587340806467459,7.590729519712289,7.579669012182509,7.58111459323014,7.572269787871445,7.562748128588469,7.5451088369245465,7.5451088369245465,7.5410867609505345,7.526286797311495,7.509816199670446,7.4736989355308605,7.46432696303857,7.398427765333737,7.312904349517791,7.192078998569922,7.084349091999445,6.965206101087066,6.942098591064572,6.937290151586263,6.943743376677225,6.943743376677225,6.943743376677225,6.941190028547434,6.9277014336178775,6.898373924618484,6.898373924618484,6.881197048987394,6.859339369528738,6.784319198154783,6.73451065623251,6.173031120322296,4.96515063913426,3.5163739944063113,2.8154002838998564,2.2903485587901824,1.8622463871257648,1.5905373133779606,1.394504118686541,1.2550726497549092,1.1425258972007502,1.0435425217552357,0.9702617335100496,0.8821386565856604,0.814136600041463,0.7634478590328716,0.7190376601176784,0.6887447784200922,0.6832035318234787,0.6807616162735167,0.6783733304210133,0.6743379673699775,0.6708988197509018)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 8.362608524246482), xlim = c(-154.01193400058347,-66.0554013122336), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()