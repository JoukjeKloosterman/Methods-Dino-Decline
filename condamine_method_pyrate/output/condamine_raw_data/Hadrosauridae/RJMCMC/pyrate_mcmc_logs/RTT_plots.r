

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.2972378147428, -66.76077867423257,-67.22431953372237,-67.68786039321216,-68.15140125270193,-68.61494211219173,-69.0784829716815,-69.54202383117129,-70.00556469066106,-70.46910555015086,-70.93264640964065,-71.39618726913042,-71.85972812862022,-72.32326898810999,-72.78680984759978,-73.25035070708955,-73.71389156657935,-74.17743242606912,-74.64097328555891,-75.10451414504871,-75.56805500453848,-76.03159586402828,-76.49513672351804,-76.95867758300784,-77.42221844249761,-77.8857593019874,-78.3493001614772,-78.81284102096697,-79.27638188045677,-79.73992273994654,-80.20346359943633,-80.6670044589261,-81.1305453184159,-81.5940861779057,-82.05762703739546,-82.52116789688526,-82.98470875637503,-83.44824961586482,-83.9117904753546,-84.37533133484439,-84.83887219433419,-85.30241305382395,-85.76595391331375,-86.22949477280352,-86.69303563229332,-87.15657649178308,-87.62011735127288,-88.08365821076268,-88.54719907025245,-89.01073992974224,-89.47428078923201,-89.93782164872181,-90.40136250821158,-90.86490336770137,-91.32844422719117,-91.79198508668094,-92.25552594617074,-92.7190668056605,-93.1826076651503,-93.64614852464007,-94.10968938412987,-94.57323024361966,-95.03677110310943,-95.50031196259923,-95.963852822089,-96.42739368157879,-96.89093454106856,-97.35447540055836,-97.81801626004815,-98.28155711953792,-98.74509797902772,-99.20863883851749,-99.67217969800728,-100.13572055749705,-100.59926141698685,-101.06280227647662,-101.52634313596641,-101.98988399545621,-102.45342485494598,-102.91696571443578,-103.38050657392554,-103.84404743341534,-104.30758829290511,-104.7711291523949,-105.2346700118847,-105.69821087137447,-106.16175173086427,-106.62529259035404,-107.08883344984383,-107.5523743093336,-108.0159151688234,-108.4794560283132,-108.94299688780296,-109.40653774729276,-109.87007860678253,-110.33361946627232,-110.79716032576209,-111.26070118525189,-111.72424204474169,-112.18778290423145)
rate=c(0.3465741726997313, 0.3469812674651627,0.3465741726997313,0.3465741726997313,0.3465741726997313,0.34629771761374784,0.3451856724165699,0.32539933567666224,0.2757595945636867,0.16502462694217152,0.06599845851797508,0.06313421922739301,0.06106245750281902,0.059736236017327804,0.05937029461780705,0.05923440622136379,0.059183619791752906,0.059183619791752906,0.059183619791752906,0.059183619791752906,0.059183619791752906,0.059183619791752906,0.059183619791752906,0.059183619791752906,0.059183619791752906,0.059198889100793205,0.05931332566552943,0.05946658047406586,0.05958163777958255,0.0596765248955113,0.05966370110269176,0.0596765248955113,0.0596765248955113,0.0596765248955113,0.059714936022178325,0.05974020325913827,0.05980576518551532,0.06502360822027381,0.4179210034471642,0.629740312777133,0.6532461368944441,0.6548703025949233,0.6369966021338387,0.5361528359944356,0.1214629861136769,0.099323386803797,0.09021895427904326,0.08721431023451856,0.08626052275319365,0.08599291708258952,0.08599291708258952,0.08557974774621108,0.08527467324919677,0.08527467324919677,0.08527467324919677,0.08527467324919677,0.08527467324919677,0.08527467324919677,0.08541202585305388,0.08527467324919677,0.08520944528683366,0.08520944528683366,0.08527467324919677,0.08541202585305388,0.08541202585305388,0.08527467324919677,0.08541202585305388,0.08557974774621108,0.08557974774621108,0.08557974774621108,0.08557974774621108,0.08557974774621108,0.08569271416607163,0.08569271416607163,0.08579667835474769,0.08579667835474769,0.08579667835474769,0.08594970864954335,0.08594970864954335,0.08594970864954335,0.08594970864954335,0.08602123285510457,0.08602123285510457,0.08608028569608209,0.08621081891312368,0.0866065329496456,0.0866065329496456,0.08666701437593943,0.08687384513979965,0.0870365493915689,0.08728344066171198,0.08771867318798068,0.08833204149420992,0.08926117147703588,0.08960962978197136,0.08992395459722076,0.0900987674240647,0.09067780170883546,0.0912525061178749,0.09135425591752577)
minHPD=c(0.17469011831857792, 0.17867748728045502,0.2088526954427089,0.18155430216051188,0.18155430216051188,0.17867748728045502,0.17469011831857792,0.04950589669690698,0.0315895690055871,0.031478944943673016,0.026633814876113264,0.028548177235192308,0.02336079465710037,0.029818898699142782,0.031478944943673016,0.029818898699142782,0.031478944943673016,0.031478944943673016,0.031478944943673016,0.031478944943673016,0.031478944943673016,0.031478944943673016,0.031478944943673016,0.031478944943673016,0.031478944943673016,0.031478944943673016,0.031478944943673016,0.029818898699142782,0.029818898699142782,0.0315895690055871,0.0315895690055871,0.031478944943673016,0.031478944943673016,0.031478944943673016,0.029818898699142782,0.029818898699142782,0.029818898699142782,0.02336079465710037,0.02983112541190051,0.042871218492856994,0.06356480973691253,0.08765888613684174,0.0578306488945549,0.03386245110113961,0.026668761484792882,0.026333679584373437,0.014654949487110729,0.009397467424087586,0.02212034161661284,0.014654949487110729,0.014654949487110729,0.02537067755102639,0.02582102694181095,0.0282206442293303,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02912105795045361,0.02757695222640478,0.02582102694181095,0.02582102694181095,0.023580578945770057,0.023580578945770057,0.021241718556796567,0.021241718556796567,0.021241718556796567,0.02537067755102639,0.02537067755102639,0.022578012345096994,0.02212034161661284,0.021241718556796567,0.02212034161661284,0.015694405588201496)
maxHPD=c(0.5736207788516079, 0.5736207788516079,0.6026590739181226,0.5736207788516079,0.5736207788516079,0.5736207788516079,0.5957725220689182,0.5200847334614993,0.4673709787502297,0.4354836854312929,0.3373266641364593,0.27604089810105753,0.17867748728045502,0.1037356794878292,0.10002524068031331,0.0958254816662393,0.0958254816662393,0.0958254816662393,0.0958254816662393,0.0958254816662393,0.0958254816662393,0.0958254816662393,0.0958254816662393,0.0958254816662393,0.0958254816662393,0.09664842275462487,0.09664842275462487,0.0958254816662393,0.09664842275462487,0.10002524068031331,0.10002524068031331,0.10002524068031331,0.10002524068031331,0.10002524068031331,0.09972846628058199,0.1036026809444585,0.11216830819240271,0.5514477733556977,0.8858616000190784,1.0759046576462505,1.1452184330348092,1.1664896156298077,1.1392410197353378,1.0506587265537928,0.7739715157959284,0.6582912746777482,0.485323203872267,0.22108482492104925,0.2024905660744816,0.18182234330672375,0.17963851141074827,0.17963851141074827,0.1784349528871051,0.17963851141074827,0.17963851141074827,0.17963851141074827,0.17963851141074827,0.17963851141074827,0.17963851141074827,0.1793123222778577,0.1784349528871051,0.1780168407475873,0.1780168407475873,0.1780168407475873,0.1780168407475873,0.1780168407475873,0.17826869590483727,0.17826869590483727,0.17826869590483727,0.17826869590483727,0.17826869590483727,0.17826869590483727,0.17826869590483727,0.17826869590483727,0.17826869590483727,0.17826869590483727,0.1780168407475873,0.1780168407475873,0.1780168407475873,0.1780168407475873,0.1780168407475873,0.17826869590483727,0.1784349528871051,0.1793123222778577,0.17963851141074827,0.17963851141074827,0.1784349528871051,0.17963851141074827,0.17963851141074827,0.17963851141074827,0.18182234330672375,0.19227736417741792,0.2008465862920603,0.20913607244459387,0.2104464518390977,0.2104464518390977,0.21930443093856303,0.24235130250361367,0.291312940207194,0.2928089168873401)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.2831385771927886), xlim = c(-112.41955333397635,-66.0654673849979), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.29957893019477, -66.76780202058848,-67.23602511098221,-67.70424820137592,-68.17247129176965,-68.64069438216336,-69.1089174725571,-69.5771405629508,-70.04536365334454,-70.51358674373824,-70.98180983413198,-71.45003292452571,-71.91825601491942,-72.38647910531316,-72.85470219570686,-73.3229252861006,-73.7911483764943,-74.25937146688804,-74.72759455728175,-75.19581764767548,-75.66404073806919,-76.13226382846292,-76.60048691885663,-77.06871000925037,-77.53693309964407,-78.00515619003781,-78.47337928043152,-78.94160237082525,-79.40982546121896,-79.8780485516127,-80.34627164200643,-80.81449473240014,-81.28271782279387,-81.75094091318758,-82.21916400358131,-82.68738709397502,-83.15561018436875,-83.62383327476246,-84.0920563651562,-84.5602794555499,-85.02850254594364,-85.49672563633735,-85.96494872673108,-86.43317181712479,-86.90139490751852,-87.36961799791223,-87.83784108830596,-88.30606417869967,-88.7742872690934,-89.24251035948711,-89.71073344988085,-90.17895654027458,-90.64717963066829,-91.11540272106203,-91.58362581145573,-92.05184890184947,-92.52007199224317,-92.98829508263691,-93.45651817303062,-93.92474126342435,-94.39296435381806,-94.8611874442118,-95.3294105346055,-95.79763362499924,-96.26585671539294,-96.73407980578668,-97.20230289618038,-97.67052598657412,-98.13874907696783,-98.60697216736156,-99.07519525775527,-99.543418348149,-100.01164143854271,-100.47986452893645,-100.94808761933018,-101.41631070972389,-101.88453380011762,-102.35275689051133,-102.82097998090507,-103.28920307129877,-103.7574261616925,-104.22564925208621,-104.69387234247995,-105.16209543287366,-105.63031852326739,-106.0985416136611,-106.56676470405483,-107.03498779444854,-107.50321088484228,-107.97143397523598,-108.43965706562972,-108.90788015602342,-109.37610324641716,-109.8443263368109,-110.3125494272046,-110.78077251759834,-111.24899560799204,-111.71721869838578,-112.18544178877949)
counts=c(0.004, 0.006,0.001,0.002,0.003,0.013,0.133,0.195,0.162,0.308,0.088,0.05,0.031,0.012,0.003,0.004,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.002,0.002,0.006,0.001,0.002,0.002,0.002,0.0,0.0,0.006,0.006,0.031,0.22,0.517,0.142,0.037,0.022,0.09,0.307,0.246,0.142,0.078,0.034,0.012,0.005,0.008,0.009,0.001,0.001,0.001,0.0,0.001,0.0,0.002,0.001,0.003,0.002,0.0,0.001,0.002,0.002,0.001,0.002,0.0,0.0,0.0,0.001,0.0,0.001,0.0,0.002,0.002,0.0,0.001,0.0,0.002,0.001,0.0,0.004,0.005,0.002,0.003,0.002,0.003,0.005,0.007,0.009,0.007,0.004,0.005,0.007,0.01,0.01,0.004,0.008)
plot(mids,counts,type = 'h', xlim = c(-112.41955333397635,-66.0654673849979), ylim=c(0,0.517), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.031431271874509864
bf6 = 0.19340798285331662
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.2972378147428, -66.76077867423257,-67.22431953372237,-67.68786039321216,-68.15140125270193,-68.61494211219173,-69.0784829716815,-69.54202383117129,-70.00556469066106,-70.46910555015086,-70.93264640964065,-71.39618726913042,-71.85972812862022,-72.32326898810999,-72.78680984759978,-73.25035070708955,-73.71389156657935,-74.17743242606912,-74.64097328555891,-75.10451414504871,-75.56805500453848,-76.03159586402828,-76.49513672351804,-76.95867758300784,-77.42221844249761,-77.8857593019874,-78.3493001614772,-78.81284102096697,-79.27638188045677,-79.73992273994654,-80.20346359943633,-80.6670044589261,-81.1305453184159,-81.5940861779057,-82.05762703739546,-82.52116789688526,-82.98470875637503,-83.44824961586482,-83.9117904753546,-84.37533133484439,-84.83887219433419,-85.30241305382395,-85.76595391331375,-86.22949477280352,-86.69303563229332,-87.15657649178308,-87.62011735127288,-88.08365821076268,-88.54719907025245,-89.01073992974224,-89.47428078923201,-89.93782164872181,-90.40136250821158,-90.86490336770137,-91.32844422719117,-91.79198508668094,-92.25552594617074,-92.7190668056605,-93.1826076651503,-93.64614852464007,-94.10968938412987,-94.57323024361966,-95.03677110310943,-95.50031196259923,-95.963852822089,-96.42739368157879,-96.89093454106856,-97.35447540055836,-97.81801626004815,-98.28155711953792,-98.74509797902772,-99.20863883851749,-99.67217969800728,-100.13572055749705,-100.59926141698685,-101.06280227647662,-101.52634313596641,-101.98988399545621,-102.45342485494598,-102.91696571443578,-103.38050657392554,-103.84404743341534,-104.30758829290511,-104.7711291523949,-105.2346700118847,-105.69821087137447,-106.16175173086427,-106.62529259035404,-107.08883344984383,-107.5523743093336,-108.0159151688234,-108.4794560283132,-108.94299688780296,-109.40653774729276,-109.87007860678253,-110.33361946627232,-110.79716032576209,-111.26070118525189,-111.72424204474169,-112.18778290423145)
rate=c(2.83966194961158, 0.47543124378875523,0.4444164778102323,0.44188157675927864,0.4406454575343195,0.44023330455169885,0.44023330455169885,0.44023330455169885,0.44023330455169885,0.43991168794508073,0.426694833302081,0.2967838492630513,0.05973233877524941,0.05819008784226773,0.05805634880854504,0.058004028518217496,0.058004028518217496,0.058004028518217496,0.058004028518217496,0.058004028518217496,0.058004028518217496,0.058004028518217496,0.058004028518217496,0.058004028518217496,0.058004028518217496,0.05805634880854504,0.05805634880854504,0.058004028518217496,0.05794496838609814,0.05794496838609814,0.05792510140854257,0.05792510140854257,0.05792510140854257,0.05792510140854257,0.05792510140854257,0.05790978206127834,0.05790978206127834,0.05792510140854257,0.05790978206127834,0.05790978206127834,0.057881763285193344,0.057881763285193344,0.0578657679733678,0.0578657679733678,0.057757474137282425,0.05772359564385554,0.05764677893809278,0.05756823959891871,0.05748289682052393,0.057370122511243786,0.05718127698662219,0.057030464783446894,0.05699315985598359,0.056852733540279955,0.05683930312648103,0.05683930312648103,0.05683930312648103,0.05681821087983517,0.05667540118731573,0.056403072532648146,0.056353078523689815,0.0562510089557963,0.0562312931915568,0.0562312931915568,0.05616835266618149,0.05616835266618149,0.05610513950487746,0.05610513950487746,0.05610513950487746,0.056088974808013406,0.05605981723958362,0.05605981723958362,0.055976832912683086,0.055851199663764506,0.055976832912683086,0.055976832912683086,0.055976832912683086,0.055851199663764506,0.05569988559551235,0.055671897217580486,0.055671897217580486,0.055671897217580486,0.05565209729396059,0.05565209729396059,0.05565209729396059,0.05565209729396059,0.05562881040566229,0.05562881040566229,0.05562881040566229,0.05562881040566229,0.05562881040566229,0.05562881040566229,0.05562881040566229,0.05562881040566229,0.05565209729396059,0.055671897217580486,0.05569988559551235,0.055748006519718556,0.055851199663764506,0.056088974808013406)
minHPD=c(0.4594972078534944, 0.23069335034722613,0.252278158574056,0.252278158574056,0.252278158574056,0.252278158574056,0.252278158574056,0.252278158574056,0.252278158574056,0.252278158574056,0.045531470707068596,0.03463351421660554,0.03132066772592445,0.03372470312645068,0.03435236814858042,0.03372470312645068,0.03372470312645068,0.03605723482093021,0.03605723482093021,0.03605723482093021,0.03605723482093021,0.03605723482093021,0.03605723482093021,0.03605723482093021,0.03605723482093021,0.03605723482093021,0.03605723482093021,0.03372470312645068,0.03372470312645068,0.03372470312645068,0.033798309164626734,0.033798309164626734,0.033798309164626734,0.033798309164626734,0.033798309164626734,0.033798309164626734,0.03372470312645068,0.036189177658896135,0.03421271257248746,0.03421271257248746,0.03421271257248746,0.03421271257248746,0.034614679558808606,0.034614679558808606,0.03421271257248746,0.03421271257248746,0.03372470312645068,0.03372470312645068,0.03421271257248746,0.03372470312645068,0.03372470312645068,0.03372470312645068,0.0270074998760801,0.013340657566663323,0.012660978712768018,0.012660978712768018,0.012660978712768018,0.012419018378370757,0.012419018378370757,0.009619412115583849,0.010210552918491196,0.009827183625473496,0.009827183625473496,0.009619412115583849,0.009619412115583849,0.009827183625473496,0.009827183625473496,0.009827183625473496,0.009827183625473496,0.009827183625473496,0.009827183625473496,0.009827183625473496,0.009827183625473496,0.009177735111898183,0.009177735111898183,0.009177735111898183,0.009177735111898183,0.009177735111898183,0.009177735111898183,0.009177735111898183,0.009177735111898183,0.009177735111898183,0.009177735111898183,0.009177735111898183,0.009177735111898183,0.009177735111898183,0.009177735111898183,0.008868328486178651,0.008868328486178651,0.009177735111898183,0.009177735111898183,0.009177735111898183,0.009177735111898183,0.009177735111898183,0.008868328486178651,0.00010886478629846542,0.00010886478629846542,0.00010886478629846542,0.00010886478629846542,0.00010886478629846542)
maxHPD=c(5.801463826513402, 2.262367889387482,0.714589545673322,0.6699669683267555,0.6581941901704879,0.6448662981856583,0.6448662981856583,0.646047295209469,0.646047295209469,0.6544153809399343,0.6160593456474307,0.5530045034305954,0.36797043283444847,0.08826209922238629,0.08712684567526673,0.08605305472770582,0.0858255781554549,0.08766884233332635,0.08766884233332635,0.08766884233332635,0.08766884233332635,0.08766884233332635,0.08766884233332635,0.08766884233332635,0.08766884233332635,0.08766884233332635,0.08766884233332635,0.08503854511923538,0.08489930207249864,0.08489930207249864,0.08489930207249864,0.08489930207249864,0.08489930207249864,0.08489930207249864,0.08489930207249864,0.08489930207249864,0.08489930207249864,0.08826209922238629,0.08634773495083924,0.08634773495083924,0.08658000063470116,0.08658000063470116,0.08712684567526673,0.08712684567526673,0.08703694790694934,0.08738298432689443,0.08766884233332635,0.08875000279652866,0.09073710384505994,0.09080829655370909,0.09582575783175615,0.10255652139457727,0.09964336191989949,0.09073710384505994,0.09080829655370909,0.09080829655370909,0.09080829655370909,0.09080829655370909,0.09080829655370909,0.08894652690720983,0.090345580639034,0.090345580639034,0.090345580639034,0.090345580639034,0.090345580639034,0.09080829655370909,0.09080829655370909,0.09080829655370909,0.09080829655370909,0.09080829655370909,0.09080829655370909,0.09080829655370909,0.09080829655370909,0.090345580639034,0.090345580639034,0.090345580639034,0.090345580639034,0.090345580639034,0.090345580639034,0.090345580639034,0.090345580639034,0.090345580639034,0.090345580639034,0.090345580639034,0.090345580639034,0.090345580639034,0.090345580639034,0.090345580639034,0.090345580639034,0.09080829655370909,0.09080829655370909,0.09080829655370909,0.09080829655370909,0.09080829655370909,0.09080829655370909,0.082391064757348,0.08304965400971827,0.0831376709316344,0.08396208118641113,0.08446298001894129)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 6.381610209164743), xlim = c(-112.41955333397635,-66.0654673849979), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.29957893019477, -66.76780202058848,-67.23602511098221,-67.70424820137592,-68.17247129176965,-68.64069438216336,-69.1089174725571,-69.5771405629508,-70.04536365334454,-70.51358674373824,-70.98180983413198,-71.45003292452571,-71.91825601491942,-72.38647910531316,-72.85470219570686,-73.3229252861006,-73.7911483764943,-74.25937146688804,-74.72759455728175,-75.19581764767548,-75.66404073806919,-76.13226382846292,-76.60048691885663,-77.06871000925037,-77.53693309964407,-78.00515619003781,-78.47337928043152,-78.94160237082525,-79.40982546121896,-79.8780485516127,-80.34627164200643,-80.81449473240014,-81.28271782279387,-81.75094091318758,-82.21916400358131,-82.68738709397502,-83.15561018436875,-83.62383327476246,-84.0920563651562,-84.5602794555499,-85.02850254594364,-85.49672563633735,-85.96494872673108,-86.43317181712479,-86.90139490751852,-87.36961799791223,-87.83784108830596,-88.30606417869967,-88.7742872690934,-89.24251035948711,-89.71073344988085,-90.17895654027458,-90.64717963066829,-91.11540272106203,-91.58362581145573,-92.05184890184947,-92.52007199224317,-92.98829508263691,-93.45651817303062,-93.92474126342435,-94.39296435381806,-94.8611874442118,-95.3294105346055,-95.79763362499924,-96.26585671539294,-96.73407980578668,-97.20230289618038,-97.67052598657412,-98.13874907696783,-98.60697216736156,-99.07519525775527,-99.543418348149,-100.01164143854271,-100.47986452893645,-100.94808761933018,-101.41631070972389,-101.88453380011762,-102.35275689051133,-102.82097998090507,-103.28920307129877,-103.7574261616925,-104.22564925208621,-104.69387234247995,-105.16209543287366,-105.63031852326739,-106.0985416136611,-106.56676470405483,-107.03498779444854,-107.50321088484228,-107.97143397523598,-108.43965706562972,-108.90788015602342,-109.37610324641716,-109.8443263368109,-110.3125494272046,-110.78077251759834,-111.24899560799204,-111.71721869838578,-112.18544178877949)
counts=c(0.763, 0.152,0.015,0.011,0.006,0.0,0.001,0.0,0.003,0.095,0.427,0.404,0.066,0.005,0.003,0.001,0.002,0.0,0.0,0.001,0.0,0.0,0.0,0.0,0.001,0.0,0.001,0.001,0.0,0.001,0.0,0.0,0.0,0.0,0.001,0.001,0.002,0.001,0.0,0.001,0.001,0.002,0.002,0.001,0.004,0.005,0.004,0.005,0.008,0.008,0.007,0.006,0.004,0.003,0.002,0.004,0.001,0.004,0.005,0.002,0.004,0.0,0.002,0.001,0.002,0.001,0.0,0.002,0.0,0.002,0.003,0.002,0.001,0.001,0.0,0.001,0.002,0.0,0.001,0.002,0.001,0.0,0.0,0.001,0.001,0.0,0.001,0.001,0.0,0.0,0.0,0.0,0.001,0.001,0.003,0.002,0.004,0.003,0.001)
plot(mids,counts,type = 'h', xlim = c(-112.41955333397635,-66.0654673849979), ylim=c(0,0.763), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.2972378147428, -66.76077867423257,-67.22431953372237,-67.68786039321216,-68.15140125270193,-68.61494211219173,-69.0784829716815,-69.54202383117129,-70.00556469066106,-70.46910555015086,-70.93264640964065,-71.39618726913042,-71.85972812862022,-72.32326898810999,-72.78680984759978,-73.25035070708955,-73.71389156657935,-74.17743242606912,-74.64097328555891,-75.10451414504871,-75.56805500453848,-76.03159586402828,-76.49513672351804,-76.95867758300784,-77.42221844249761,-77.8857593019874,-78.3493001614772,-78.81284102096697,-79.27638188045677,-79.73992273994654,-80.20346359943633,-80.6670044589261,-81.1305453184159,-81.5940861779057,-82.05762703739546,-82.52116789688526,-82.98470875637503,-83.44824961586482,-83.9117904753546,-84.37533133484439,-84.83887219433419,-85.30241305382395,-85.76595391331375,-86.22949477280352,-86.69303563229332,-87.15657649178308,-87.62011735127288,-88.08365821076268,-88.54719907025245,-89.01073992974224,-89.47428078923201,-89.93782164872181,-90.40136250821158,-90.86490336770137,-91.32844422719117,-91.79198508668094,-92.25552594617074,-92.7190668056605,-93.1826076651503,-93.64614852464007,-94.10968938412987,-94.57323024361966,-95.03677110310943,-95.50031196259923,-95.963852822089,-96.42739368157879,-96.89093454106856,-97.35447540055836,-97.81801626004815,-98.28155711953792,-98.74509797902772,-99.20863883851749,-99.67217969800728,-100.13572055749705,-100.59926141698685,-101.06280227647662,-101.52634313596641,-101.98988399545621,-102.45342485494598,-102.91696571443578,-103.38050657392554,-103.84404743341534,-104.30758829290511,-104.7711291523949,-105.2346700118847,-105.69821087137447,-106.16175173086427,-106.62529259035404,-107.08883344984383,-107.5523743093336,-108.0159151688234,-108.4794560283132,-108.94299688780296,-109.40653774729276,-109.87007860678253,-110.33361946627232,-110.79716032576209,-111.26070118525189,-111.72424204474169,-112.18778290423145)
net_rate=c(-2.625051547606326, -0.35916516374687524,-0.10712748619931563,-0.09736978293741906,-0.09345404014051678,-0.09171933438025076,-0.09462432275434951,-0.1402764039923109,-0.20470353130079708,-0.25133658265878106,-0.3124575300014808,-0.17214237830374488,-0.017125542380764483,0.0009090449644812619,0.001602183404381651,0.0018890037039919667,0.0013881995345127387,0.001605034151591246,0.001605034151591246,0.001605034151591246,0.001610284368257353,0.001610284368257353,0.001610284368257353,0.001610284368257353,0.001610284368257353,0.00165902303533264,0.0018346629903935895,0.002328068347120477,0.002561255543547847,0.0027704541601272603,0.002782751898125459,0.002847733812202563,0.002847733812202563,0.002847733812202563,0.003297790241524968,0.004084634442865761,0.007073142350439928,0.0678603261813412,0.3267267307374794,0.5522150039274688,0.6042181082718439,0.6097600734212734,0.5768168188214254,0.4454512022242365,0.21599857020121616,0.12289285933855298,0.07396018336494738,0.04874856100694491,0.039812061157049564,0.03702100252163436,0.03700772504078807,0.03562101153404907,0.03506643006682523,0.03498214737646629,0.03479263568918724,0.03478777988265989,0.034856823746106276,0.035044419539081315,0.03554188715837431,0.03562290413706935,0.03558620337926387,0.035390855725638486,0.035465890843094115,0.035597963919806616,0.03562619954457526,0.03563072768857832,0.03593085849036023,0.035990166830892116,0.035981820138175954,0.036098940054235126,0.03613341389924291,0.03607122289464994,0.03612245927617131,0.036145072690742464,0.03613150129117881,0.03615437206685209,0.036088902536133574,0.03619073949304927,0.03627368151257577,0.036343094033638695,0.036343094033638695,0.03673347194093769,0.03688624709942022,0.037089516301393524,0.03770407812866444,0.03868110201584282,0.03895421801802422,0.039272708161436944,0.03965566161336557,0.03982051716171407,0.04141327368589268,0.04298494463762003,0.04523439295768779,0.04943892648316168,0.05171661000533162,0.052957371044126365,0.05519830260740321,0.06102081750803462,0.06923270518615035,0.07153101675012583)
net_minHPD=c(-5.358596517417256, -1.9568504462976355,-0.4198201692223249,-0.3916223631053808,-0.36911071813799184,-0.3506063601599988,-0.36911071813799184,-0.44578680126214165,-0.5409054888560221,-0.5613877955386922,-0.5809554345110282,-0.6033793490986512,-0.3983228245171283,-0.05183448395774653,-0.047494043364593674,-0.047873320287693207,-0.04620195639230669,-0.04583781191065532,-0.04583781191065532,-0.04583781191065532,-0.04583781191065532,-0.04583781191065532,-0.04583781191065532,-0.04583781191065532,-0.04583781191065532,-0.04620195639230669,-0.04656147644817901,-0.047494043364593674,-0.047494043364593674,-0.04620195639230669,-0.04620195639230669,-0.04620195639230669,-0.04620195639230669,-0.04620195639230669,-0.047494043364593674,-0.047873320287693207,-0.047873320287693207,-0.05592050130536681,-0.047494043364593674,-0.02522731909798106,0.0015416391143987934,0.011901790493022604,-0.006005356089799491,-0.03608064060198741,-0.057696091780181986,-0.06341342649682938,-0.06341342649682938,-0.06341342649682938,-0.052898278049223105,-0.045037388147927036,-0.04293959292333528,-0.045037388147927036,-0.04656495488766547,-0.04602534487501906,-0.04656495488766547,-0.04656495488766547,-0.04602534487501906,-0.04656495488766547,-0.04602534487501906,-0.04602534487501906,-0.04602534487501906,-0.043595355511549194,-0.043595355511549194,-0.043595355511549194,-0.043595355511549194,-0.043595355511549194,-0.04602534487501906,-0.04602534487501906,-0.04602534487501906,-0.04602534487501906,-0.04602534487501906,-0.04656495488766547,-0.04656495488766547,-0.04656495488766547,-0.04656495488766547,-0.04656495488766547,-0.04602534487501906,-0.04602534487501906,-0.04656495488766547,-0.04656495488766547,-0.04656495488766547,-0.043595355511549194,-0.043595355511549194,-0.043595355511549194,-0.04656495488766547,-0.04656495488766547,-0.04656495488766547,-0.04210580075257367,-0.042533012159057415,-0.042533012159057415,-0.04602534487501906,-0.052898278049223105,-0.043595355511549194,-0.052898278049223105,-0.05767033244038064,-0.05767033244038064,-0.05767033244038064,-0.0625265430331823,-0.0625265430331823,-0.0625265430331823)
net_maxHPD=c(-0.09262447170175037, 0.27436892957941705,0.17392325336159714,0.17392325336159714,0.18433101771579907,0.18859375420340885,0.17392325336159714,0.16947068921962588,0.1093170236050851,0.07867420709345818,0.02496857184768278,0.060116174279314115,0.12940736053720928,0.05747943005668467,0.04939528779401278,0.044445311949719984,0.044445311949719984,0.044445311949719984,0.044445311949719984,0.044445311949719984,0.044445311949719984,0.044445311949719984,0.044445311949719984,0.044445311949719984,0.044445311949719984,0.044445311949719984,0.044445311949719984,0.04541564602614286,0.04694572634709698,0.04939528779401278,0.04939528779401278,0.04981238018258418,0.04981238018258418,0.04981238018258418,0.04939528779401278,0.05231538784864285,0.060116174279314115,0.4923215314057988,0.8322538955774171,1.026291966130417,1.0891225491690046,1.0891225491690046,1.0756035866959734,0.9878455567879908,0.7024184162411788,0.5903811467860529,0.4271688653134858,0.1767537827895437,0.14542800326579783,0.14503569383079065,0.14542800326579783,0.1349553950331816,0.1296098933768881,0.1296098933768881,0.12787632505334212,0.12787632505334212,0.1296098933768881,0.12787632505334212,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1296098933768881,0.1339840340098864,0.1349553950331816,0.13562615935495476,0.1339840340098864,0.1349553950331816,0.13562615935495476,0.14503569383079065,0.14503569383079065,0.14503569383079065,0.14503569383079065,0.14503569383079065,0.16214365107393308,0.16214365107393308,0.16643934950946115,0.1746792366934911,0.18964481250301224,0.23111306219185726,0.30716973734840913,0.3316317012395357)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-5.894456169158982, 1.1980348040859052), xlim = c(-112.41955333397635,-66.0654673849979), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.2972378147428, -66.76077867423257,-67.22431953372237,-67.68786039321216,-68.15140125270193,-68.61494211219173,-69.0784829716815,-69.54202383117129,-70.00556469066106,-70.46910555015086,-70.93264640964065,-71.39618726913042,-71.85972812862022,-72.32326898810999,-72.78680984759978,-73.25035070708955,-73.71389156657935,-74.17743242606912,-74.64097328555891,-75.10451414504871,-75.56805500453848,-76.03159586402828,-76.49513672351804,-76.95867758300784,-77.42221844249761,-77.8857593019874,-78.3493001614772,-78.81284102096697,-79.27638188045677,-79.73992273994654,-80.20346359943633,-80.6670044589261,-81.1305453184159,-81.5940861779057,-82.05762703739546,-82.52116789688526,-82.98470875637503,-83.44824961586482,-83.9117904753546,-84.37533133484439,-84.83887219433419,-85.30241305382395,-85.76595391331375,-86.22949477280352,-86.69303563229332,-87.15657649178308,-87.62011735127288,-88.08365821076268,-88.54719907025245,-89.01073992974224,-89.47428078923201,-89.93782164872181,-90.40136250821158,-90.86490336770137,-91.32844422719117,-91.79198508668094,-92.25552594617074,-92.7190668056605,-93.1826076651503,-93.64614852464007,-94.10968938412987,-94.57323024361966,-95.03677110310943,-95.50031196259923,-95.963852822089,-96.42739368157879,-96.89093454106856,-97.35447540055836,-97.81801626004815,-98.28155711953792,-98.74509797902772,-99.20863883851749,-99.67217969800728,-100.13572055749705,-100.59926141698685,-101.06280227647662,-101.52634313596641,-101.98988399545621,-102.45342485494598,-102.91696571443578,-103.38050657392554,-103.84404743341534,-104.30758829290511,-104.7711291523949,-105.2346700118847,-105.69821087137447,-106.16175173086427,-106.62529259035404,-107.08883344984383,-107.5523743093336,-108.0159151688234,-108.4794560283132,-108.94299688780296,-109.40653774729276,-109.87007860678253,-110.33361946627232,-110.79716032576209,-111.26070118525189,-111.72424204474169,-112.18778290423145)
rate=c(0.33494143343419563, 1.3883668748009688,2.140093410341566,2.1866829585891088,2.205490736501272,2.2169000802068086,2.2169000802068086,2.2178293511084664,2.2178293511084664,2.2213544127062446,2.3815192489794854,3.890092450454591,11.114213172638191,15.691348522259883,16.478738743463673,16.73992553793705,16.726466091360685,16.787351749128096,16.787351749128096,16.787351749128096,16.78883147029486,16.78883147029486,16.78883147029486,16.78883147029486,16.78883147029486,16.78239587588991,16.78239587588991,16.805784925844378,16.81642666304799,16.81642666304799,16.82943133762371,16.82943133762371,16.82943133762371,16.82943133762371,16.82943133762371,16.839340391928545,16.82694684759716,16.815264024614,16.827265631776438,16.827265631776438,16.841006276895595,16.841006276895595,16.847797589271792,16.847797589271792,16.90345258476843,16.926697917830413,17.035999695000513,17.105016280278797,17.193947048995025,17.25805291870269,17.407453899912486,17.547982298427282,17.629892030555823,17.767433250709086,17.82015799016995,17.818616123230864,17.84056476523813,17.88340537782464,17.930456969664075,18.01069154347669,18.071331592132363,18.123823777544334,18.13091105513966,18.145899728762235,18.15520174273872,18.171338903008255,18.199246683694472,18.199246683694472,18.199246683694472,18.238121133911587,18.249595350935245,18.22890625930499,18.23288655201814,18.240407214597017,18.23092638966489,18.238531044178387,18.238531044178387,18.247717907929815,18.275377739197808,18.290369697883087,18.290369697883087,18.28913357479329,18.29769854644644,18.29769854644644,18.29769854644644,18.307163283166,18.31346324564019,18.25442394831587,18.25442394831587,18.260157006357726,18.260157006357726,18.260157006357726,18.260157006357726,18.260157006357726,18.18915449188315,18.12266623119199,17.72656243151891,17.609740045630296,17.42984951187092,17.17984898197102)
minHPD=c(0.33494143343419563, 1.3883668748009688,2.140093410341566,2.1866829585891088,2.205490736501272,2.2169000802068086,2.2169000802068086,2.2178293511084664,2.2178293511084664,2.2213544127062446,2.3815192489794854,3.890092450454591,11.114213172638191,15.691348522259883,16.478738743463673,16.73992553793705,16.726466091360685,16.787351749128096,16.787351749128096,16.787351749128096,16.78883147029486,16.78883147029486,16.78883147029486,16.78883147029486,16.78883147029486,16.78239587588991,16.78239587588991,16.805784925844378,16.81642666304799,16.81642666304799,16.82943133762371,16.82943133762371,16.82943133762371,16.82943133762371,16.82943133762371,16.839340391928545,16.82694684759716,16.815264024614,16.827265631776438,16.827265631776438,16.841006276895595,16.841006276895595,16.847797589271792,16.847797589271792,16.90345258476843,16.926697917830413,17.035999695000513,17.105016280278797,17.193947048995025,17.25805291870269,17.407453899912486,17.547982298427282,17.629892030555823,17.767433250709086,17.82015799016995,17.818616123230864,17.84056476523813,17.88340537782464,17.930456969664075,18.01069154347669,18.071331592132363,18.123823777544334,18.13091105513966,18.145899728762235,18.15520174273872,18.171338903008255,18.199246683694472,18.199246683694472,18.199246683694472,18.238121133911587,18.249595350935245,18.22890625930499,18.23288655201814,18.240407214597017,18.23092638966489,18.238531044178387,18.238531044178387,18.247717907929815,18.275377739197808,18.290369697883087,18.290369697883087,18.28913357479329,18.29769854644644,18.29769854644644,18.29769854644644,18.307163283166,18.31346324564019,18.25442394831587,18.25442394831587,18.260157006357726,18.260157006357726,18.260157006357726,18.260157006357726,18.260157006357726,18.18915449188315,18.12266623119199,17.72656243151891,17.609740045630296,17.42984951187092,17.17984898197102)
maxHPD=c(0.33494143343419563, 1.3883668748009688,2.140093410341566,2.1866829585891088,2.205490736501272,2.2169000802068086,2.2169000802068086,2.2178293511084664,2.2178293511084664,2.2213544127062446,2.3815192489794854,3.890092450454591,11.114213172638191,15.691348522259883,16.478738743463673,16.73992553793705,16.726466091360685,16.787351749128096,16.787351749128096,16.787351749128096,16.78883147029486,16.78883147029486,16.78883147029486,16.78883147029486,16.78883147029486,16.78239587588991,16.78239587588991,16.805784925844378,16.81642666304799,16.81642666304799,16.82943133762371,16.82943133762371,16.82943133762371,16.82943133762371,16.82943133762371,16.839340391928545,16.82694684759716,16.815264024614,16.827265631776438,16.827265631776438,16.841006276895595,16.841006276895595,16.847797589271792,16.847797589271792,16.90345258476843,16.926697917830413,17.035999695000513,17.105016280278797,17.193947048995025,17.25805291870269,17.407453899912486,17.547982298427282,17.629892030555823,17.767433250709086,17.82015799016995,17.818616123230864,17.84056476523813,17.88340537782464,17.930456969664075,18.01069154347669,18.071331592132363,18.123823777544334,18.13091105513966,18.145899728762235,18.15520174273872,18.171338903008255,18.199246683694472,18.199246683694472,18.199246683694472,18.238121133911587,18.249595350935245,18.22890625930499,18.23288655201814,18.240407214597017,18.23092638966489,18.238531044178387,18.238531044178387,18.247717907929815,18.275377739197808,18.290369697883087,18.290369697883087,18.28913357479329,18.29769854644644,18.29769854644644,18.29769854644644,18.307163283166,18.31346324564019,18.25442394831587,18.25442394831587,18.260157006357726,18.260157006357726,18.260157006357726,18.260157006357726,18.260157006357726,18.18915449188315,18.12266623119199,17.72656243151891,17.609740045630296,17.42984951187092,17.17984898197102)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 20.14480957020421), xlim = c(-112.41955333397635,-66.0654673849979), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()