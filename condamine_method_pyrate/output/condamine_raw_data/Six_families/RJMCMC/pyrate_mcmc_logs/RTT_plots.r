

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.36080806848241, -67.2353840670455,-68.1099600656086,-68.9845360641717,-69.85911206273481,-70.7336880612979,-71.608264059861,-72.4828400584241,-73.3574160569872,-74.2319920555503,-75.1065680541134,-75.9811440526765,-76.85572005123959,-77.73029604980269,-78.60487204836579,-79.4794480469289,-80.35402404549198,-81.22860004405509,-82.10317604261819,-82.97775204118128,-83.85232803974438,-84.72690403830748,-85.60148003687058,-86.47605603543367,-87.35063203399677,-88.22520803255988,-89.09978403112297,-89.97436002968607,-90.84893602824917,-91.72351202681227,-92.59808802537536,-93.47266402393846,-94.34724002250157,-95.22181602106465,-96.09639201962776,-96.97096801819086,-97.84554401675396,-98.72012001531706,-99.59469601388015,-100.46927201244326,-101.34384801100634,-102.21842400956945,-103.09300000813255,-103.96757600669565,-104.84215200525875,-105.71672800382184,-106.59130400238494,-107.46588000094803,-108.34045599951114,-109.21503199807424,-110.08960799663734,-110.96418399520044,-111.83875999376353,-112.71333599232663,-113.58791199088972,-114.46248798945282,-115.33706398801593,-116.21163998657903,-117.08621598514213,-117.96079198370522,-118.83536798226832,-119.70994398083141,-120.58451997939451,-121.45909597795762,-122.33367197652072,-123.20824797508382,-124.08282397364691,-124.95739997221001,-125.8319759707731,-126.7065519693362,-127.5811279678993,-128.4557039664624,-129.3302799650255,-130.20485596358859,-131.0794319621517,-131.9540079607148,-132.8285839592779,-133.703159957841,-134.5777359564041,-135.4523119549672,-136.3268879535303,-137.2014639520934,-138.0760399506565,-138.95061594921958,-139.82519194778268,-140.6997679463458,-141.5743439449089,-142.44891994347196,-143.32349594203507,-144.19807194059817,-145.07264793916127,-145.94722393772437,-146.82179993628748,-147.69637593485058,-148.57095193341368,-149.44552793197678,-150.3201039305399,-151.19467992910296,-152.06925592766606,-152.94383192622917)
rate=c(0.10980033446418533, 0.10989742780953643,0.10980033446418533,0.10980033446418533,0.10899878522802017,0.10686714290672777,0.09864537668079967,0.09751925111601814,0.09749167051528532,0.09747205242564311,0.09747205242564311,0.09747205242564311,0.09747205242564311,0.09747718596988317,0.09747718596988317,0.09747718596988317,0.09744853536497461,0.09744853536497461,0.09744853536497461,0.09744853536497461,0.09747205242564311,0.10718499421069685,0.9024111257881282,0.118551219054567,0.1007677398918361,0.10066154919171016,0.10063158568900436,0.10072159924812535,0.10072159924812535,0.10072159924812535,0.10075973623121856,0.10110251057702803,0.10110251057702803,0.10110251057702803,0.10110251057702803,0.10109515245115994,0.10109515245115994,0.10097545574681124,0.10097545574681124,0.10097545574681124,0.10097545574681124,0.10097545574681124,0.10097545574681124,0.10097545574681124,0.10097545574681124,0.10097545574681124,0.10097545574681124,0.10097545574681124,0.10096828779707356,0.10096828779707356,0.10096828779707356,0.10096828779707356,0.10087628456739708,0.10087986719979057,0.10096828779707356,0.10096828779707356,0.10097545574681124,0.10097545574681124,0.10097545574681124,0.10109515245115994,0.10139125352723091,0.10199087751536323,0.10208943854091805,0.10215173378960538,0.10240963320854812,0.10299616671925908,0.10326140269576135,0.10400263985937427,0.10427420518807726,0.10457163062704988,0.10484664664465623,0.10523138919754152,0.10551821839902914,0.10591082470783972,0.10604342738594583,0.10634608019253639,0.10634608019253639,0.10643504805128093,0.10654906657741725,0.10665673836409953,0.1069632676812868,0.10699264237037462,0.10717174849746106,0.10745222384439594,0.10796284413431305,0.10830295665400871,0.10844393079701306,0.10870779835381739,0.10874553772872159,0.10883288930424467,0.10905559266393061,0.1097510695494735,0.11040358702771486,0.11091822502915676,0.11147901732937546,0.11187242010517348,0.11220387403750723,0.11301675828386172,0.1139186342653373,0.11636916767176486)
minHPD=c(0.08024482272219693, 0.0814495345474892,0.08193523103928764,0.08193523103928764,0.0814495345474892,0.07452778596539061,0.06689264887284924,0.07006223111543515,0.07052088663051673,0.0707061179414974,0.0707061179414974,0.0707061179414974,0.0707061179414974,0.07075554878103119,0.07075554878103119,0.07075554878103119,0.07118364580158296,0.07118364580158296,0.07118364580158296,0.07118364580158296,0.07006223111543515,0.06227046597186986,0.4692010128745808,0.05025756210614762,0.05902009441143957,0.05902009441143957,0.0641607764256152,0.06589207041522759,0.06589207041522759,0.06589207041522759,0.06589207041522759,0.06747657779767713,0.06832891723792665,0.06832891723792665,0.06832891723792665,0.06832891723792665,0.06832891723792665,0.06941252714321669,0.06941252714321669,0.06869071844388518,0.06869071844388518,0.06869071844388518,0.06869071844388518,0.06869071844388518,0.06869071844388518,0.06869071844388518,0.06832891723792665,0.06869071844388518,0.06869071844388518,0.06869071844388518,0.06869071844388518,0.06832891723792665,0.06747657779767713,0.06832891723792665,0.06941252714321669,0.06941252714321669,0.06832891723792665,0.06832891723792665,0.06747657779767713,0.06747657779767713,0.06747657779767713,0.06943695720598726,0.06943695720598726,0.06943695720598726,0.06869071844388518,0.06747657779767713,0.06832891723792665,0.06747657779767713,0.06943695720598726,0.06832891723792665,0.06832891723792665,0.06973629961465881,0.07092641795858053,0.06747657779767713,0.06747657779767713,0.07092641795858053,0.070964633795359,0.070964633795359,0.070964633795359,0.06973629961465881,0.07092641795858053,0.06973629961465881,0.06832891723792665,0.07092641795858053,0.07092641795858053,0.06832891723792665,0.06973629961465881,0.06747657779767713,0.06747657779767713,0.07092641795858053,0.07092641795858053,0.06747657779767713,0.06747657779767713,0.06747657779767713,0.06747657779767713,0.06338982200212338,0.06747657779767713,0.06832891723792665,0.06338982200212338,0.06338982200212338)
maxHPD=c(0.21698231535768792, 0.21698231535768792,0.21698231535768792,0.21698231535768792,0.21698231535768792,0.2138997877327701,0.12881601881968519,0.1230055088851123,0.12305934847061577,0.12310220218782748,0.12310220218782748,0.12310220218782748,0.12310220218782748,0.12310220218782748,0.12310220218782748,0.12310220218782748,0.12305934847061577,0.12305934847061577,0.12305934847061577,0.12305934847061577,0.12305934847061577,0.9362181383747472,1.442053064910102,1.163327972715008,0.14177015940550633,0.13909122927005996,0.1422515147120397,0.1422515147120397,0.14177015940550633,0.14177015940550633,0.14166425001288166,0.13696600130693218,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.1375101775083444,0.13909122927005996,0.13972995584578912,0.13972995584578912,0.13909122927005996,0.13909122927005996,0.13857659017951054,0.13881463535080726,0.13909122927005996,0.1422515147120397,0.1422515147120397,0.14314606512226433,0.14374504724383522,0.14657523913286047,0.1491656381981701,0.15219456345110682,0.15511786137667885,0.15828971260992425,0.16474344622988707,0.1778304478522226,0.1801447297223759,0.1817593252228264,0.18459076213002684,0.19013513616048444,0.19060496159297796,0.19060496159297796,0.19060496159297796,0.19060496159297796,0.1930145085528613,0.19344568216052807,0.19862955919958916,0.20615135389521444,0.21288953528391982,0.21714130074510757,0.22266199532191108,0.22808826344355415,0.23338979127793552,0.23901359396962935,0.2435334050585781,0.2696717540830736,0.29294427484535096,0.315742311379573,0.328276714711389,0.3467980588509969,0.374538523363615,0.4191398995185635,0.4798872416420002,0.9515993470981118)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.5862583714011123), xlim = c(-153.38111992551072,-65.92352006920086), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.3652251189802, -67.2486352185389,-68.13204531809757,-69.01545541765626,-69.89886551721494,-70.78227561677363,-71.66568571633232,-72.54909581589101,-73.43250591544968,-74.31591601500837,-75.19932611456706,-76.08273621412575,-76.96614631368443,-77.84955641324312,-78.7329665128018,-79.61637661236048,-80.49978671191917,-81.38319681147786,-82.26660691103653,-83.15001701059522,-84.03342711015391,-84.9168372097126,-85.80024730927128,-86.68365740882997,-87.56706750838866,-88.45047760794733,-89.33388770750602,-90.21729780706471,-91.1007079066234,-91.98411800618207,-92.86752810574076,-93.75093820529945,-94.63434830485814,-95.51775840441682,-96.40116850397551,-97.2845786035342,-98.16798870309289,-99.05139880265156,-99.93480890221025,-100.81821900176894,-101.70162910132761,-102.5850392008863,-103.46844930044499,-104.35185940000368,-105.23526949956236,-106.11867959912105,-107.00208969867974,-107.88549979823843,-108.7689098977971,-109.65231999735579,-110.53573009691448,-111.41914019647315,-112.30255029603184,-113.18596039559053,-114.06937049514922,-114.9527805947079,-115.83619069426659,-116.71960079382528,-117.60301089338397,-118.48642099294264,-119.36983109250133,-120.25324119206002,-121.13665129161869,-122.02006139117738,-122.90347149073607,-123.78688159029475,-124.67029168985344,-125.55370178941213,-126.43711188897082,-127.3205219885295,-128.2039320880882,-129.08734218764687,-129.97075228720558,-130.85416238676424,-131.73757248632296,-132.62098258588162,-133.50439268544028,-134.387802784999,-135.27121288455766,-136.15462298411637,-137.03803308367503,-137.92144318323375,-138.8048532827924,-139.68826338235112,-140.57167348190978,-141.4550835814685,-142.33849368102716,-143.22190378058582,-144.10531388014454,-144.9887239797032,-145.8721340792619,-146.75554417882057,-147.6389542783793,-148.52236437793795,-149.40577447749666,-150.28918457705532,-151.17259467661404,-152.0560047761727,-152.93941487573136)
counts=c(0.002, 0.002,0.001,0.025,0.064,0.198,0.029,0.003,0.003,0.0,0.0,0.001,0.0,0.0,0.0,0.005,0.0,0.0,0.001,0.014,0.497,0.496,0.839,0.152,0.004,0.002,0.002,0.001,0.0,0.004,0.016,0.0,0.0,0.002,0.001,0.001,0.003,0.002,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.001,0.002,0.001,0.0,0.0,0.001,0.004,0.001,0.001,0.001,0.001,0.002,0.001,0.011,0.013,0.004,0.004,0.006,0.01,0.005,0.005,0.016,0.004,0.009,0.012,0.006,0.006,0.007,0.004,0.001,0.003,0.003,0.005,0.006,0.001,0.003,0.01,0.009,0.008,0.004,0.006,0.004,0.002,0.007,0.011,0.018,0.013,0.018,0.007,0.009,0.011,0.027,0.055,0.031)
plot(mids,counts,type = 'h', xlim = c(-153.38111992551072,-65.92352006920086), ylim=c(0,0.839), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03384026446261839
bf6 = 0.20559620275026402
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.36080806848241, -67.2353840670455,-68.1099600656086,-68.9845360641717,-69.85911206273481,-70.7336880612979,-71.608264059861,-72.4828400584241,-73.3574160569872,-74.2319920555503,-75.1065680541134,-75.9811440526765,-76.85572005123959,-77.73029604980269,-78.60487204836579,-79.4794480469289,-80.35402404549198,-81.22860004405509,-82.10317604261819,-82.97775204118128,-83.85232803974438,-84.72690403830748,-85.60148003687058,-86.47605603543367,-87.35063203399677,-88.22520803255988,-89.09978403112297,-89.97436002968607,-90.84893602824917,-91.72351202681227,-92.59808802537536,-93.47266402393846,-94.34724002250157,-95.22181602106465,-96.09639201962776,-96.97096801819086,-97.84554401675396,-98.72012001531706,-99.59469601388015,-100.46927201244326,-101.34384801100634,-102.21842400956945,-103.09300000813255,-103.96757600669565,-104.84215200525875,-105.71672800382184,-106.59130400238494,-107.46588000094803,-108.34045599951114,-109.21503199807424,-110.08960799663734,-110.96418399520044,-111.83875999376353,-112.71333599232663,-113.58791199088972,-114.46248798945282,-115.33706398801593,-116.21163998657903,-117.08621598514213,-117.96079198370522,-118.83536798226832,-119.70994398083141,-120.58451997939451,-121.45909597795762,-122.33367197652072,-123.20824797508382,-124.08282397364691,-124.95739997221001,-125.8319759707731,-126.7065519693362,-127.5811279678993,-128.4557039664624,-129.3302799650255,-130.20485596358859,-131.0794319621517,-131.9540079607148,-132.8285839592779,-133.703159957841,-134.5777359564041,-135.4523119549672,-136.3268879535303,-137.2014639520934,-138.0760399506565,-138.95061594921958,-139.82519194778268,-140.6997679463458,-141.5743439449089,-142.44891994347196,-143.32349594203507,-144.19807194059817,-145.07264793916127,-145.94722393772437,-146.82179993628748,-147.69637593485058,-148.57095193341368,-149.44552793197678,-150.3201039305399,-151.19467992910296,-152.06925592766606,-152.94383192622917)
rate=c(6.0590208226783755, 0.23697029258631064,0.23569929127127132,0.2359212379887196,0.2359212379887196,0.23569929127127132,0.23569929127127132,0.23526391868583668,0.20643070178521963,0.07451348217660494,0.07359543025650964,0.07355189248431723,0.07351903751572866,0.07351808374500551,0.07346960617041493,0.07346960617041493,0.07346960617041493,0.07346960617041493,0.07346960617041493,0.07346960617041493,0.07343787361650816,0.07343787361650816,0.07343787361650816,0.07343787361650816,0.07343787361650816,0.07346960617041493,0.07346960617041493,0.07346960617041493,0.07346960617041493,0.07346960617041493,0.07346960617041493,0.07346960617041493,0.07346960617041493,0.07351702076561513,0.07351702076561513,0.07351702076561513,0.07351808374500551,0.07351808374500551,0.07351808374500551,0.07351808374500551,0.07351808374500551,0.07349778524245457,0.07349778524245457,0.07349778524245457,0.07349778524245457,0.07349778524245457,0.07349778524245457,0.07349778524245457,0.07351808374500551,0.07351808374500551,0.07351808374500551,0.07358910654076323,0.07360407438494322,0.07360407438494322,0.07360407438494322,0.07361569297982995,0.0736185777254962,0.07362378841395628,0.0736411479492428,0.07367033000282563,0.07367570361093573,0.07367570361093573,0.07367570361093573,0.07368530745720386,0.07368530745720386,0.07369711571326495,0.07368530745720386,0.07369711571326495,0.07369711571326495,0.07368530745720386,0.07368530745720386,0.07368530745720386,0.07367570361093573,0.07367033000282563,0.07367033000282563,0.07367033000282563,0.07366017765560115,0.07366017765560115,0.07366017765560115,0.07366017765560115,0.07366017765560115,0.07366017765560115,0.07366017765560115,0.0736411479492428,0.0736411479492428,0.07362378841395628,0.07362378841395628,0.07362378841395628,0.07362378841395628,0.0736411479492428,0.0736411479492428,0.0736411479492428,0.07367570361093573,0.07367570361093573,0.07367033000282563,0.07367033000282563,0.07367570361093573,0.07372419082198835,0.07379478121655307,0.0738431646182231)
minHPD=c(2.6197832478318532, 0.17589823544294175,0.17799696994602116,0.17530676384792665,0.17530676384792665,0.17530676384792665,0.1782516164588858,0.17589823544294175,0.05954936735077683,0.05153338032630057,0.05817698843063397,0.058497369057213006,0.05770941267935393,0.058421979196833305,0.05817698843063397,0.05817698843063397,0.05817698843063397,0.05817698843063397,0.05817698843063397,0.05817698843063397,0.058421979196833305,0.058421979196833305,0.058421979196833305,0.05817698843063397,0.05817698843063397,0.05817698843063397,0.05817698843063397,0.05817698843063397,0.05817698843063397,0.05817698843063397,0.05817698843063397,0.05817698843063397,0.05817698843063397,0.058421979196833305,0.058421979196833305,0.058421979196833305,0.05770941267935393,0.05770941267935393,0.05770941267935393,0.05770941267935393,0.05770941267935393,0.058497369057213006,0.058497369057213006,0.058497369057213006,0.058497369057213006,0.058497369057213006,0.058497369057213006,0.058497369057213006,0.058497369057213006,0.058497369057213006,0.058497369057213006,0.058421979196833305,0.058421979196833305,0.058421979196833305,0.058421979196833305,0.058421979196833305,0.05817698843063397,0.05770941267935393,0.05770941267935393,0.058497369057213006,0.058497369057213006,0.058497369057213006,0.058421979196833305,0.058497369057213006,0.058497369057213006,0.058497369057213006,0.058497369057213006,0.058497369057213006,0.058497369057213006,0.058421979196833305,0.058421979196833305,0.058421979196833305,0.058421979196833305,0.058421979196833305,0.058421979196833305,0.058421979196833305,0.05817698843063397,0.05817698843063397,0.05777378241308738,0.05777378241308738,0.05777378241308738,0.05770941267935393,0.05770941267935393,0.05770941267935393,0.05770941267935393,0.05770941267935393,0.05770941267935393,0.05770941267935393,0.05770941267935393,0.05719177810011404,0.05719177810011404,0.05719177810011404,0.0568612357172511,0.0568612357172511,0.0568612357172511,0.0568612357172511,0.05588417093137388,0.055977268160323834,0.05602313220738354,0.05588417093137388)
maxHPD=c(11.055156014720305, 0.3011561844716035,0.3011561844716035,0.2973456177130916,0.2973456177130916,0.2973456177130916,0.3011561844716035,0.3011561844716035,0.2690266206719275,0.21098685391850924,0.08904278390512944,0.08875163879313426,0.08788275776881944,0.08838796818685263,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08797730408618483,0.08838796818685263,0.08838796818685263,0.08838796818685263,0.08788275776881944,0.08788275776881944,0.08788275776881944,0.08788275776881944,0.08788275776881944,0.08875163879313426,0.08875163879313426,0.08875163879313426,0.08875163879313426,0.08875163879313426,0.08875163879313426,0.08875163879313426,0.08875163879313426,0.08875163879313426,0.08875163879313426,0.08894930010608977,0.08894930010608977,0.08894930010608977,0.08894930010608977,0.08904278390512944,0.08904278390512944,0.08894930010608977,0.08904278390512944,0.09014970295061947,0.09018662464989266,0.09018662464989266,0.09018662464989266,0.090356754860318,0.090356754860318,0.0903630318243063,0.090356754860318,0.0903630318243063,0.0903630318243063,0.0903630318243063,0.0903630318243063,0.0903630318243063,0.09050994510657132,0.09050994510657132,0.09050994510657132,0.09050994510657132,0.09050994510657132,0.09050994510657132,0.0903630318243063,0.0903630318243063,0.0903630318243063,0.0903630318243063,0.0903630318243063,0.0903630318243063,0.0903630318243063,0.0903630318243063,0.0903630318243063,0.09050994510657132,0.09050994510657132,0.0903630318243063,0.0903630318243063,0.0903630318243063,0.09050994510657132,0.09050994510657132,0.09110000472574005,0.09110000472574005,0.09088798277171575,0.09191727855966357,0.09353785564286637,0.09655634910166273)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 12.160671616192337), xlim = c(-153.38111992551072,-65.92352006920086), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.3652251189802, -67.2486352185389,-68.13204531809757,-69.01545541765626,-69.89886551721494,-70.78227561677363,-71.66568571633232,-72.54909581589101,-73.43250591544968,-74.31591601500837,-75.19932611456706,-76.08273621412575,-76.96614631368443,-77.84955641324312,-78.7329665128018,-79.61637661236048,-80.49978671191917,-81.38319681147786,-82.26660691103653,-83.15001701059522,-84.03342711015391,-84.9168372097126,-85.80024730927128,-86.68365740882997,-87.56706750838866,-88.45047760794733,-89.33388770750602,-90.21729780706471,-91.1007079066234,-91.98411800618207,-92.86752810574076,-93.75093820529945,-94.63434830485814,-95.51775840441682,-96.40116850397551,-97.2845786035342,-98.16798870309289,-99.05139880265156,-99.93480890221025,-100.81821900176894,-101.70162910132761,-102.5850392008863,-103.46844930044499,-104.35185940000368,-105.23526949956236,-106.11867959912105,-107.00208969867974,-107.88549979823843,-108.7689098977971,-109.65231999735579,-110.53573009691448,-111.41914019647315,-112.30255029603184,-113.18596039559053,-114.06937049514922,-114.9527805947079,-115.83619069426659,-116.71960079382528,-117.60301089338397,-118.48642099294264,-119.36983109250133,-120.25324119206002,-121.13665129161869,-122.02006139117738,-122.90347149073607,-123.78688159029475,-124.67029168985344,-125.55370178941213,-126.43711188897082,-127.3205219885295,-128.2039320880882,-129.08734218764687,-129.97075228720558,-130.85416238676424,-131.73757248632296,-132.62098258588162,-133.50439268544028,-134.387802784999,-135.27121288455766,-136.15462298411637,-137.03803308367503,-137.92144318323375,-138.8048532827924,-139.68826338235112,-140.57167348190978,-141.4550835814685,-142.33849368102716,-143.22190378058582,-144.10531388014454,-144.9887239797032,-145.8721340792619,-146.75554417882057,-147.6389542783793,-148.52236437793795,-149.40577447749666,-150.28918457705532,-151.17259467661404,-152.0560047761727,-152.93941487573136)
counts=c(0.991, 0.009,0.003,0.0,0.001,0.001,0.013,0.413,0.492,0.078,0.003,0.001,0.001,0.004,0.0,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.001,0.0,0.001,0.0,0.0,0.0,0.0,0.0,0.0,0.001,0.001,0.0,0.0,0.001,0.0,0.0,0.0,0.001,0.002,0.0,0.0,0.0,0.0,0.0,0.001,0.001,0.0,0.002,0.002,0.0,0.0,0.0,0.003,0.002,0.002,0.002,0.0,0.001,0.0,0.002,0.001,0.002,0.001,0.001,0.0,0.0,0.001,0.0,0.001,0.001,0.0,0.0,0.001,0.0,0.001,0.0,0.0,0.001,0.0,0.001,0.0,0.001,0.001,0.0,0.001,0.002,0.0,0.0,0.003,0.0,0.003,0.001,0.004,0.002,0.004,0.01,0.003)
plot(mids,counts,type = 'h', xlim = c(-153.38111992551072,-65.92352006920086), ylim=c(0,0.991), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.36080806848241, -67.2353840670455,-68.1099600656086,-68.9845360641717,-69.85911206273481,-70.7336880612979,-71.608264059861,-72.4828400584241,-73.3574160569872,-74.2319920555503,-75.1065680541134,-75.9811440526765,-76.85572005123959,-77.73029604980269,-78.60487204836579,-79.4794480469289,-80.35402404549198,-81.22860004405509,-82.10317604261819,-82.97775204118128,-83.85232803974438,-84.72690403830748,-85.60148003687058,-86.47605603543367,-87.35063203399677,-88.22520803255988,-89.09978403112297,-89.97436002968607,-90.84893602824917,-91.72351202681227,-92.59808802537536,-93.47266402393846,-94.34724002250157,-95.22181602106465,-96.09639201962776,-96.97096801819086,-97.84554401675396,-98.72012001531706,-99.59469601388015,-100.46927201244326,-101.34384801100634,-102.21842400956945,-103.09300000813255,-103.96757600669565,-104.84215200525875,-105.71672800382184,-106.59130400238494,-107.46588000094803,-108.34045599951114,-109.21503199807424,-110.08960799663734,-110.96418399520044,-111.83875999376353,-112.71333599232663,-113.58791199088972,-114.46248798945282,-115.33706398801593,-116.21163998657903,-117.08621598514213,-117.96079198370522,-118.83536798226832,-119.70994398083141,-120.58451997939451,-121.45909597795762,-122.33367197652072,-123.20824797508382,-124.08282397364691,-124.95739997221001,-125.8319759707731,-126.7065519693362,-127.5811279678993,-128.4557039664624,-129.3302799650255,-130.20485596358859,-131.0794319621517,-131.9540079607148,-132.8285839592779,-133.703159957841,-134.5777359564041,-135.4523119549672,-136.3268879535303,-137.2014639520934,-138.0760399506565,-138.95061594921958,-139.82519194778268,-140.6997679463458,-141.5743439449089,-142.44891994347196,-143.32349594203507,-144.19807194059817,-145.07264793916127,-145.94722393772437,-146.82179993628748,-147.69637593485058,-148.57095193341368,-149.44552793197678,-150.3201039305399,-151.19467992910296,-152.06925592766606,-152.94383192622917)
net_rate=c(-6.111829524053574, -0.10922231112472518,-0.10595883293354776,-0.10613038084568056,-0.10850293960649099,-0.11468670446787335,-0.1360453000476975,-0.13725054527824657,-0.07486354177496479,0.010199044477418224,0.02385911183461363,0.024150290566813,0.024171634759532677,0.02433468506220169,0.024459169480065608,0.024459169480065608,0.024403311152313725,0.024403311152313725,0.024403311152313725,0.024403311152313725,0.025950235515007337,0.22849383616583524,0.8490772975868427,0.32106693210042514,0.029938220888971374,0.02806577232179609,0.027152189289563283,0.027296433343616543,0.02725222482762171,0.02725222482762171,0.027321959523619172,0.0295076593081685,0.029558489837978322,0.029507388359941277,0.029507388359941277,0.029348217031296083,0.029307953422630137,0.02870206326024486,0.02870206326024486,0.028663434912057473,0.02865015356158624,0.02869777995233141,0.02869777995233141,0.028683278875184758,0.028683278875184758,0.028683278875184758,0.028634721893245344,0.0285824007182292,0.028505820919343724,0.028505820919343724,0.028505820919343724,0.028282675895833036,0.027958570068037848,0.028003023712381992,0.02820808328586852,0.028176086598965002,0.028256959015003164,0.028139252524197998,0.028064406102655582,0.028304792724280638,0.029396096357821123,0.030588484592034188,0.0308217353231228,0.031033658456129824,0.03189896539888516,0.0324796558468145,0.03295504222971226,0.03401116054427687,0.03475977304359751,0.03557559912316672,0.036597038426534605,0.038014294369879804,0.03882719478661608,0.03947845546360544,0.039728308283159465,0.04021630202603544,0.04025844244824673,0.04042366548995984,0.04055047191469414,0.04104104688006387,0.04131645772600037,0.04179861835002549,0.042666047807370065,0.04432206009158883,0.04628809190611826,0.04718357358078824,0.047965870017979896,0.050323242029885036,0.05082425822686974,0.05107858898393394,0.052891982422117,0.056055889368725645,0.05984729318641084,0.06637705546018942,0.07056496213364402,0.0730452907886368,0.07492046211672095,0.07886781657748478,0.09812444257250105,0.17835730878050443)
net_minHPD=c(-10.922351678485253, -0.19189018993648924,-0.18879332085210793,-0.19189018993648924,-0.19430708837673866,-0.19562200163767002,-0.2181839584489519,-0.20822198535517306,-0.18117155306845567,-0.12083998795986867,-0.0074901334390463925,-0.006609114282224035,-0.006609114282224035,-0.006562703213902038,-0.006053412299974706,-0.006053412299974706,-0.005428095673033595,-0.005428095673033595,-0.005428095673033595,-0.005428095673033595,-0.0074235607162721345,-0.021031026820808152,0.3985062751242961,-0.02188375531079738,-0.01622328132139024,-0.012393190574583088,-0.012393190574583088,-0.012961833897963612,-0.012393190574583088,-0.012393190574583088,-0.012393190574583088,-0.012393190574583088,-0.012393190574583088,-0.012393190574583088,-0.012393190574583088,-0.012393190574583088,-0.012393190574583088,-0.012129698468479486,-0.012129698468479486,-0.012312195926026712,-0.012312195926026712,-0.007533261719472169,-0.007533261719472169,-0.007533261719472169,-0.007533261719472169,-0.007533261719472169,-0.00815887903676342,-0.007533261719472169,-0.012393190574583088,-0.012393190574583088,-0.012393190574583088,-0.012961833897963612,-0.00815887903676342,-0.00815887903676342,-0.00815887903676342,-0.00815887903676342,-0.009267822838345721,-0.014293584313443922,-0.012393190574583088,-0.012961833897963612,-0.008402068624172448,-0.008402068624172448,-0.007533261719472169,-0.007533261719472169,-0.008402068624172448,-0.00954690448279051,-0.012312195926026712,-0.012726813249092611,-0.014293584313443922,-0.006775777816645193,-0.006315819302983736,-0.006775777816645193,-0.012312195926026712,-0.012726813249092611,-0.006775777816645193,-0.006315819302983736,-0.006315819302983736,-0.006315819302983736,-0.006315819302983736,-0.012726813249092611,-0.006315819302983736,-0.00815887903676342,-0.006315819302983736,-0.00815887903676342,-0.00815887903676342,-0.012726813249092611,-0.006775777816645193,-0.006775777816645193,-0.006775777816645193,-0.00815887903676342,-0.012726813249092611,-0.012726813249092611,-0.016235847752867585,-0.016235847752867585,-0.01908179079093697,-0.02843717950582858,-0.016235847752867585,-0.016235847752867585,-0.033191668470265445,-0.07549645456591067)
net_maxHPD=c(-2.52230730243535, 0.005994082586682492,0.0024499735496558706,0.00027529441565427026,-0.0024200085539449467,-0.000249343302831162,-0.06847487004639324,-0.06527822224035687,0.04601263766539497,0.05774398810055145,0.05438718972286689,0.05438718972286689,0.05438718972286689,0.05439559585499745,0.05439559585499745,0.05439559585499745,0.05439559585499745,0.05439559585499745,0.05439559585499745,0.05439559585499745,0.05434907014358347,0.8543290091183985,1.3779802935699854,1.0965784639117029,0.0747992129563984,0.0747992129563984,0.07299179358612393,0.071949991306045,0.071949991306045,0.071949991306045,0.071949991306045,0.06721076771802728,0.0668162096382199,0.0668162096382199,0.0668162096382199,0.0668162096382199,0.0668162096382199,0.0668162096382199,0.0668162096382199,0.0668162096382199,0.0668162096382199,0.07153741390774562,0.07153741390774562,0.07153741390774562,0.07153741390774562,0.07153741390774562,0.07128973537175656,0.07153741390774562,0.06721076771802728,0.06721076771802728,0.06721076771802728,0.0668162096382199,0.07299179358612393,0.07299179358612393,0.07299179358612393,0.07299179358612393,0.07299179358612393,0.0678622753901721,0.07027326809171949,0.07037169444004904,0.0747992129563984,0.07518514803129524,0.07590669848429485,0.07544040777563646,0.0764065380002365,0.0764065380002365,0.07544040777563646,0.0802418063972018,0.08119830763631843,0.09524015040248741,0.09945437080317764,0.10466229987993847,0.10466229987993847,0.10930788845431032,0.11842689749891255,0.12365471958142042,0.12391613248362109,0.12391613248362109,0.12391613248362109,0.11842689749891255,0.12530971200142116,0.12530971200142116,0.1326906709687255,0.13616572652235043,0.14313955046088533,0.14313955046088533,0.1562597308975648,0.1659170940284629,0.168169735282047,0.1699731767897047,0.1699731767897047,0.1969750683784175,0.23036998921201776,0.25563657950833973,0.27520966166589256,0.286818267860889,0.3406997830492734,0.3768125509921989,0.4878221713980512,1.1145558508200457)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-12.01458684633378, 1.5157783229269841), xlim = c(-153.38111992551072,-65.92352006920086), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.36080806848241, -67.2353840670455,-68.1099600656086,-68.9845360641717,-69.85911206273481,-70.7336880612979,-71.608264059861,-72.4828400584241,-73.3574160569872,-74.2319920555503,-75.1065680541134,-75.9811440526765,-76.85572005123959,-77.73029604980269,-78.60487204836579,-79.4794480469289,-80.35402404549198,-81.22860004405509,-82.10317604261819,-82.97775204118128,-83.85232803974438,-84.72690403830748,-85.60148003687058,-86.47605603543367,-87.35063203399677,-88.22520803255988,-89.09978403112297,-89.97436002968607,-90.84893602824917,-91.72351202681227,-92.59808802537536,-93.47266402393846,-94.34724002250157,-95.22181602106465,-96.09639201962776,-96.97096801819086,-97.84554401675396,-98.72012001531706,-99.59469601388015,-100.46927201244326,-101.34384801100634,-102.21842400956945,-103.09300000813255,-103.96757600669565,-104.84215200525875,-105.71672800382184,-106.59130400238494,-107.46588000094803,-108.34045599951114,-109.21503199807424,-110.08960799663734,-110.96418399520044,-111.83875999376353,-112.71333599232663,-113.58791199088972,-114.46248798945282,-115.33706398801593,-116.21163998657903,-117.08621598514213,-117.96079198370522,-118.83536798226832,-119.70994398083141,-120.58451997939451,-121.45909597795762,-122.33367197652072,-123.20824797508382,-124.08282397364691,-124.95739997221001,-125.8319759707731,-126.7065519693362,-127.5811279678993,-128.4557039664624,-129.3302799650255,-130.20485596358859,-131.0794319621517,-131.9540079607148,-132.8285839592779,-133.703159957841,-134.5777359564041,-135.4523119549672,-136.3268879535303,-137.2014639520934,-138.0760399506565,-138.95061594921958,-139.82519194778268,-140.6997679463458,-141.5743439449089,-142.44891994347196,-143.32349594203507,-144.19807194059817,-145.07264793916127,-145.94722393772437,-146.82179993628748,-147.69637593485058,-148.57095193341368,-149.44552793197678,-150.3201039305399,-151.19467992910296,-152.06925592766606,-152.94383192622917)
rate=c(0.16018349080215594, 4.156887535308029,4.218161980813466,4.2150798857293985,4.2150798857293985,4.216398807227056,4.219025458398604,4.247512987291468,5.780862139402245,11.385802861715698,13.482792883650612,13.535933639886625,13.539845485067596,13.561120884987822,13.584052779765782,13.584052779765782,13.584052779765782,13.584052779765782,13.584052779765782,13.584052779765782,13.587591118012543,13.587591118012543,13.587591118012543,13.585873675573483,13.585873675573483,13.583364458207981,13.583364458207981,13.583364458207981,13.583364458207981,13.583364458207981,13.583364458207981,13.583364458207981,13.583364458207981,13.573942377578238,13.573942377578238,13.573942377578238,13.566527783052933,13.566527783052933,13.566527783052933,13.566527783052933,13.56408378188389,13.57285195764015,13.57285195764015,13.57285195764015,13.57285195764015,13.57285195764015,13.57285195764015,13.57285195764015,13.562713227190613,13.562713227190613,13.562713227190613,13.53270206690015,13.530558077244821,13.530558077244821,13.530558077244821,13.52470278668175,13.515676107842019,13.493030307294383,13.484389631327675,13.456903321303844,13.437325134869084,13.437325134869084,13.429580827582877,13.419666974260121,13.419666974260121,13.396209392463055,13.414337418230684,13.405900782770999,13.405900782770999,13.415187937820859,13.415187937820859,13.415187937820859,13.422569517876717,13.424646297877509,13.424646297877509,13.424646297877509,13.434923387839431,13.434923387839431,13.429823126247076,13.429823126247076,13.429823126247076,13.426663083677056,13.426663083677056,13.447226694905725,13.447226694905725,13.448768543627272,13.448768543627272,13.424471498494292,13.424471498494292,13.404202604674007,13.404202604674007,13.404202604674007,13.3154231952816,13.3154231952816,13.321418787720306,13.319507859871473,13.165268031314914,12.951034502580347,12.698508455603625,11.933234389831822)
minHPD=c(0.16018349080215594, 4.156887535308029,4.218161980813466,4.2150798857293985,4.2150798857293985,4.216398807227056,4.219025458398604,4.247512987291468,5.780862139402245,11.385802861715698,13.482792883650612,13.535933639886625,13.539845485067596,13.561120884987822,13.584052779765782,13.584052779765782,13.584052779765782,13.584052779765782,13.584052779765782,13.584052779765782,13.587591118012543,13.587591118012543,13.587591118012543,13.585873675573483,13.585873675573483,13.583364458207981,13.583364458207981,13.583364458207981,13.583364458207981,13.583364458207981,13.583364458207981,13.583364458207981,13.583364458207981,13.573942377578238,13.573942377578238,13.573942377578238,13.566527783052933,13.566527783052933,13.566527783052933,13.566527783052933,13.56408378188389,13.57285195764015,13.57285195764015,13.57285195764015,13.57285195764015,13.57285195764015,13.57285195764015,13.57285195764015,13.562713227190613,13.562713227190613,13.562713227190613,13.53270206690015,13.530558077244821,13.530558077244821,13.530558077244821,13.52470278668175,13.515676107842019,13.493030307294383,13.484389631327675,13.456903321303844,13.437325134869084,13.437325134869084,13.429580827582877,13.419666974260121,13.419666974260121,13.396209392463055,13.414337418230684,13.405900782770999,13.405900782770999,13.415187937820859,13.415187937820859,13.415187937820859,13.422569517876717,13.424646297877509,13.424646297877509,13.424646297877509,13.434923387839431,13.434923387839431,13.429823126247076,13.429823126247076,13.429823126247076,13.426663083677056,13.426663083677056,13.447226694905725,13.447226694905725,13.448768543627272,13.448768543627272,13.424471498494292,13.424471498494292,13.404202604674007,13.404202604674007,13.404202604674007,13.3154231952816,13.3154231952816,13.321418787720306,13.319507859871473,13.165268031314914,12.951034502580347,12.698508455603625,11.933234389831822)
maxHPD=c(0.16018349080215594, 4.156887535308029,4.218161980813466,4.2150798857293985,4.2150798857293985,4.216398807227056,4.219025458398604,4.247512987291468,5.780862139402245,11.385802861715698,13.482792883650612,13.535933639886625,13.539845485067596,13.561120884987822,13.584052779765782,13.584052779765782,13.584052779765782,13.584052779765782,13.584052779765782,13.584052779765782,13.587591118012543,13.587591118012543,13.587591118012543,13.585873675573483,13.585873675573483,13.583364458207981,13.583364458207981,13.583364458207981,13.583364458207981,13.583364458207981,13.583364458207981,13.583364458207981,13.583364458207981,13.573942377578238,13.573942377578238,13.573942377578238,13.566527783052933,13.566527783052933,13.566527783052933,13.566527783052933,13.56408378188389,13.57285195764015,13.57285195764015,13.57285195764015,13.57285195764015,13.57285195764015,13.57285195764015,13.57285195764015,13.562713227190613,13.562713227190613,13.562713227190613,13.53270206690015,13.530558077244821,13.530558077244821,13.530558077244821,13.52470278668175,13.515676107842019,13.493030307294383,13.484389631327675,13.456903321303844,13.437325134869084,13.437325134869084,13.429580827582877,13.419666974260121,13.419666974260121,13.396209392463055,13.414337418230684,13.405900782770999,13.405900782770999,13.415187937820859,13.415187937820859,13.415187937820859,13.422569517876717,13.424646297877509,13.424646297877509,13.424646297877509,13.434923387839431,13.434923387839431,13.429823126247076,13.429823126247076,13.429823126247076,13.426663083677056,13.426663083677056,13.447226694905725,13.447226694905725,13.448768543627272,13.448768543627272,13.424471498494292,13.424471498494292,13.404202604674007,13.404202604674007,13.404202604674007,13.3154231952816,13.3154231952816,13.321418787720306,13.319507859871473,13.165268031314914,12.951034502580347,12.698508455603625,11.933234389831822)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 14.946350229813799), xlim = c(-153.38111992551072,-65.92352006920086), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()