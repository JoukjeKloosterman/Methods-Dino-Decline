

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.69068395110855, -67.3278830020976,-67.96508205308663,-68.60228110407567,-69.23948015506468,-69.87667920605372,-70.51387825704276,-71.1510773080318,-71.78827635902081,-72.42547541000985,-73.06267446099889,-73.6998735119879,-74.33707256297694,-74.97427161396598,-75.61147066495502,-76.24866971594403,-76.88586876693307,-77.52306781792211,-78.16026686891112,-78.79746591990016,-79.4346649708892,-80.07186402187824,-80.70906307286725,-81.34626212385629,-81.98346117484533,-82.62066022583437,-83.25785927682338,-83.89505832781242,-84.53225737880146,-85.16945642979047,-85.80665548077951,-86.44385453176855,-87.08105358275759,-87.7182526337466,-88.35545168473564,-88.99265073572468,-89.62984978671369,-90.26704883770273,-90.90424788869177,-91.54144693968081,-92.17864599066982,-92.81584504165886,-93.4530440926479,-94.09024314363691,-94.72744219462595,-95.36464124561499,-96.00184029660403,-96.63903934759304,-97.27623839858208,-97.91343744957112,-98.55063650056016,-99.18783555154917,-99.82503460253821,-100.46223365352725,-101.09943270451626,-101.7366317555053,-102.37383080649434,-103.01102985748338,-103.64822890847239,-104.28542795946143,-104.92262701045047,-105.55982606143948,-106.19702511242852,-106.83422416341756,-107.4714232144066,-108.10862226539561,-108.74582131638465,-109.38302036737369,-110.0202194183627,-110.65741846935174,-111.29461752034078,-111.93181657132982,-112.56901562231883,-113.20621467330787,-113.84341372429691,-114.48061277528592,-115.11781182627496,-115.755010877264,-116.39220992825304,-117.02940897924205,-117.66660803023109,-118.30380708122013,-118.94100613220917,-119.57820518319818,-120.21540423418722,-120.85260328517626,-121.48980233616527,-122.12700138715431,-122.76420043814335,-123.40139948913239,-124.0385985401214,-124.67579759111044,-125.31299664209948,-125.95019569308849,-126.58739474407753,-127.22459379506657,-127.86179284605561,-128.49899189704462,-129.13619094803366,-129.7733899990227)
rate=c(0.08295079354006346, 0.08318184545223571,0.08318184545223571,0.08318184545223571,0.08318184545223571,0.08318184545223571,0.08318184545223571,0.08379489929508882,0.08419804692083131,0.08455135754289099,0.08560687810978768,0.08610423696095397,0.08753596174449321,0.09199062995092873,0.10149457826905459,0.1165070832482186,0.12809466865786107,0.13034991123120188,0.13061389079100783,0.13069486075107248,0.13069486075107248,0.13069486075107248,0.13094920817051325,0.13119844727412538,0.13119844727412538,0.1315882818591267,0.13170214305833852,0.13170214305833852,0.13170214305833852,0.13134066768337888,0.13119844727412538,0.13094920817051325,0.13094920817051325,0.13094920817051325,0.1307849733188703,0.13069486075107248,0.13069486075107248,0.13069486075107248,0.13069486075107248,0.13069486075107248,0.13069486075107248,0.13069486075107248,0.13061389079100783,0.13069486075107248,0.13069486075107248,0.13069486075107248,0.1307849733188703,0.1307849733188703,0.13082127865552837,0.13082127865552837,0.13082127865552837,0.13082127865552837,0.13083740280378237,0.13083740280378237,0.13082127865552837,0.1307849733188703,0.1307849733188703,0.1307849733188703,0.1307849733188703,0.1307849733188703,0.1307849733188703,0.13061389079100783,0.13061389079100783,0.13061389079100783,0.13061389079100783,0.13061389079100783,0.13061389079100783,0.13069486075107248,0.13069486075107248,0.13069486075107248,0.13069486075107248,0.1307849733188703,0.1307849733188703,0.1307849733188703,0.13069486075107248,0.13069486075107248,0.13069486075107248,0.13083740280378237,0.13083740280378237,0.13111804986510864,0.1311856594656564,0.13119844727412538,0.1315882818591267,0.1322692929916809,0.13281755019086117,0.13352907995465899,0.13405480184244795,0.13589128746574392,0.13690213983804653,0.1379423527011519,0.13886272026237587,0.1393696020205376,0.1398919999336634,0.14125083006821715,0.14201168308727655,0.1427688842750976,0.14378693364901934,0.14453422246638767,0.14488988483630333,0.14594379021758946)
minHPD=c(0.0006730817370319144, 0.0006730817370319144,0.0006730817370319144,0.0006730817370319144,0.0006730817370319144,0.0006730817370319144,0.0006730817370319144,0.0006730817370319144,0.0006730817370319144,0.0006730817370319144,0.0008513678868493023,0.0008513678868493023,0.0006730817370319144,0.0008513678868493023,0.0006730817370319144,0.0008803843360110821,0.06182326798715256,0.07242652937004335,0.07360098353680009,0.07510231598279536,0.07510231598279536,0.07510231598279536,0.07890251130623278,0.07709140655925169,0.07709140655925169,0.07709140655925169,0.07709140655925169,0.07709140655925169,0.07863078491280372,0.0794476353999036,0.07750655704605693,0.07750655704605693,0.07750655704605693,0.07750655704605693,0.07863078491280372,0.07863078491280372,0.07641088585707467,0.07641088585707467,0.07641088585707467,0.07641088585707467,0.07641088585707467,0.07641088585707467,0.07587889084103164,0.07587889084103164,0.07587889084103164,0.07587889084103164,0.07641088585707467,0.07641088585707467,0.07641088585707467,0.07641088585707467,0.07641088585707467,0.07641088585707467,0.07587889084103164,0.07587889084103164,0.07587889084103164,0.07641088585707467,0.07641088585707467,0.07587889084103164,0.07587889084103164,0.07587889084103164,0.07587889084103164,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07863078491280372,0.07750655704605693,0.07890251130623278,0.07890251130623278,0.07641088585707467,0.07242652937004335,0.06629241433622061,0.06419178582416135,0.06419178582416135,0.06419178582416135,0.06517778907594862,0.06419178582416135,0.06419178582416135,0.06419178582416135,0.06419178582416135,0.06517778907594862,0.06517778907594862,0.06517778907594862,0.07242652937004335,0.07337340093590598)
maxHPD=c(0.1459440583805175, 0.14523700532809183,0.14495881801676433,0.14495881801676433,0.14495881801676433,0.14495881801676433,0.14495881801676433,0.14495881801676433,0.14502600881331695,0.1459440583805175,0.14736373210935821,0.1475303580848965,0.14803034556471023,0.15201166069300118,0.16498296173037325,0.18259708297586116,0.22734082672575184,0.20762918178566567,0.20762918178566567,0.20762918178566567,0.20762918178566567,0.20762918178566567,0.21118193392142123,0.20824936370275282,0.20824936370275282,0.20762918178566567,0.20762918178566567,0.20762918178566567,0.20824936370275282,0.20762918178566567,0.20536385660168918,0.20536385660168918,0.20536385660168918,0.20536385660168918,0.20435405923567046,0.20435405923567046,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20095382920132004,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20435405923567046,0.20536385660168918,0.20536385660168918,0.20536385660168918,0.20762918178566567,0.21118193392142123,0.21118193392142123,0.21285989135043096,0.21428717551232576,0.23622497744492485,0.2562375316271334,0.28630772030775153,0.32805000588764993,0.3628671683797477,0.3757810000134252,0.42862633088036584,0.47333459587344184,0.5155729540146252,0.5422736240440297,0.565814383897447,0.5801733941020906,0.635780765902752)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.6993588424930273), xlim = c(-130.0919895245172,-66.37208442561405), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.69390212813377, -67.33753753317319,-67.98117293821261,-68.62480834325203,-69.26844374829147,-69.9120791533309,-70.55571455837031,-71.19934996340973,-71.84298536844918,-72.4866207734886,-73.13025617852801,-73.77389158356743,-74.41752698860688,-75.0611623936463,-75.70479779868572,-76.34843320372514,-76.99206860876458,-77.635704013804,-78.27933941884342,-78.92297482388284,-79.56661022892229,-80.2102456339617,-80.85388103900112,-81.49751644404054,-82.14115184907999,-82.78478725411941,-83.42842265915883,-84.07205806419825,-84.71569346923769,-85.35932887427711,-86.00296427931653,-86.64659968435595,-87.2902350893954,-87.93387049443481,-88.57750589947423,-89.22114130451365,-89.8647767095531,-90.50841211459252,-91.15204751963194,-91.79568292467135,-92.4393183297108,-93.08295373475022,-93.72658913978964,-94.37022454482906,-95.0138599498685,-95.65749535490792,-96.30113075994734,-96.94476616498676,-97.5884015700262,-98.23203697506563,-98.87567238010504,-99.51930778514446,-100.16294319018391,-100.80657859522333,-101.45021400026275,-102.09384940530217,-102.73748481034161,-103.38112021538103,-104.02475562042045,-104.66839102545987,-105.31202643049932,-105.95566183553873,-106.59929724057815,-107.24293264561757,-107.88656805065702,-108.53020345569644,-109.17383886073586,-109.81747426577527,-110.46110967081472,-111.10474507585414,-111.74838048089356,-112.39201588593298,-113.03565129097242,-113.67928669601184,-114.32292210105126,-114.96655750609068,-115.61019291113013,-116.25382831616955,-116.89746372120896,-117.54109912624838,-118.18473453128783,-118.82836993632725,-119.47200534136667,-120.11564074640609,-120.75927615144553,-121.40291155648495,-122.04654696152437,-122.69018236656379,-123.33381777160324,-123.97745317664265,-124.62108858168207,-125.26472398672149,-125.90835939176094,-126.55199479680036,-127.19563020183978,-127.8392656068792,-128.48290101191864,-129.12653641695806,-129.77017182199748)
counts=c(0.004, 0.003,0.0,0.002,0.0,0.002,0.002,0.002,0.003,0.004,0.004,0.011,0.034,0.082,0.164,0.139,0.022,0.004,0.001,0.0,0.001,0.004,0.004,0.002,0.001,0.002,0.002,0.002,0.003,0.001,0.004,0.002,0.001,0.004,0.002,0.001,0.0,0.0,0.0,0.0,0.001,0.0,0.001,0.0,0.002,0.0,0.0,0.001,0.0,0.0,0.002,0.001,0.001,0.001,0.001,0.0,0.001,0.002,0.001,0.002,0.0,0.0,0.001,0.0,0.0,0.002,0.0,0.0,0.0,0.001,0.001,0.0,0.001,0.0,0.001,0.001,0.002,0.002,0.002,0.0,0.006,0.005,0.008,0.009,0.008,0.016,0.01,0.015,0.014,0.011,0.009,0.015,0.012,0.017,0.011,0.01,0.008,0.016,0.006)
plot(mids,counts,type = 'h', xlim = c(-130.0919895245172,-66.37208442561405), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.0326530770205437
bf6 = 0.19962846105462428
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.69068395110855, -67.3278830020976,-67.96508205308663,-68.60228110407567,-69.23948015506468,-69.87667920605372,-70.51387825704276,-71.1510773080318,-71.78827635902081,-72.42547541000985,-73.06267446099889,-73.6998735119879,-74.33707256297694,-74.97427161396598,-75.61147066495502,-76.24866971594403,-76.88586876693307,-77.52306781792211,-78.16026686891112,-78.79746591990016,-79.4346649708892,-80.07186402187824,-80.70906307286725,-81.34626212385629,-81.98346117484533,-82.62066022583437,-83.25785927682338,-83.89505832781242,-84.53225737880146,-85.16945642979047,-85.80665548077951,-86.44385453176855,-87.08105358275759,-87.7182526337466,-88.35545168473564,-88.99265073572468,-89.62984978671369,-90.26704883770273,-90.90424788869177,-91.54144693968081,-92.17864599066982,-92.81584504165886,-93.4530440926479,-94.09024314363691,-94.72744219462595,-95.36464124561499,-96.00184029660403,-96.63903934759304,-97.27623839858208,-97.91343744957112,-98.55063650056016,-99.18783555154917,-99.82503460253821,-100.46223365352725,-101.09943270451626,-101.7366317555053,-102.37383080649434,-103.01102985748338,-103.64822890847239,-104.28542795946143,-104.92262701045047,-105.55982606143948,-106.19702511242852,-106.83422416341756,-107.4714232144066,-108.10862226539561,-108.74582131638465,-109.38302036737369,-110.0202194183627,-110.65741846935174,-111.29461752034078,-111.93181657132982,-112.56901562231883,-113.20621467330787,-113.84341372429691,-114.48061277528592,-115.11781182627496,-115.755010877264,-116.39220992825304,-117.02940897924205,-117.66660803023109,-118.30380708122013,-118.94100613220917,-119.57820518319818,-120.21540423418722,-120.85260328517626,-121.48980233616527,-122.12700138715431,-122.76420043814335,-123.40139948913239,-124.0385985401214,-124.67579759111044,-125.31299664209948,-125.95019569308849,-126.58739474407753,-127.22459379506657,-127.86179284605561,-128.49899189704462,-129.13619094803366,-129.7733899990227)
rate=c(0.24996210776963806, 0.12846085622444214,0.12228626794695341,0.12043505208563858,0.1185039726265466,0.11796010877359406,0.11759354469058751,0.11721928637406445,0.11671697866192637,0.11652029499594861,0.11621477386413048,0.11518961091367566,0.11471583121933872,0.11456202400293342,0.11371361702750644,0.11330853144064572,0.111995594183447,0.1110813966420029,0.11101884961984218,0.11098540063741798,0.11098540063741798,0.11092492190234307,0.11085730257485091,0.11081382731506983,0.11081382731506983,0.11081382731506983,0.11081382731506983,0.11081382731506983,0.11081382731506983,0.11085730257485091,0.11085730257485091,0.11085730257485091,0.11085730257485091,0.11085730257485091,0.11085730257485091,0.11085730257485091,0.11085730257485091,0.11085730257485091,0.11085730257485091,0.11081382731506983,0.11081382731506983,0.11085730257485091,0.11085730257485091,0.11081382731506983,0.11081382731506983,0.11080015234338048,0.11080015234338048,0.11080015234338048,0.11080015234338048,0.11080015234338048,0.11075173754947493,0.11080015234338048,0.11075173754947493,0.11075173754947493,0.11066958152895784,0.11066958152895784,0.11066958152895784,0.11058714512560684,0.11058714512560684,0.11058714512560684,0.11054499651957231,0.11054499651957231,0.11054499651957231,0.11054499651957231,0.11058714512560684,0.11058714512560684,0.11054499651957231,0.11054499651957231,0.11054499651957231,0.11052490200284795,0.11058714512560684,0.11058714512560684,0.11058714512560684,0.11058714512560684,0.11054499651957231,0.11054499651957231,0.11054499651957231,0.11054499651957231,0.11054499651957231,0.11052490200284795,0.11054499651957231,0.11054499651957231,0.11054499651957231,0.11054499651957231,0.11054499651957231,0.11058714512560684,0.11066958152895784,0.11080015234338048,0.11081382731506983,0.11081382731506983,0.11085730257485091,0.11098540063741798,0.11092492190234307,0.11092492190234307,0.11101491042744026,0.11101491042744026,0.11105115382677125,0.11105115382677125,0.11105115382677125,0.11107177128931886)
minHPD=c(0.06851727294104049, 0.059775224315086105,0.059775224315086105,0.059775224315086105,0.059775224315086105,0.06149112544020042,0.059775224315086105,0.06149112544020042,0.06149112544020042,0.06149112544020042,0.06149112544020042,0.059775224315086105,0.06149112544020042,0.06149112544020042,0.06617564329776304,0.06110811088677296,0.06617564329776304,0.06312676958556426,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06810582332403474,0.06851727294104049,0.06617564329776304,0.06627436617877665,0.06627436617877665,0.06627436617877665,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06810582332403474,0.06810582332403474,0.06810582332403474,0.06810582332403474,0.06810582332403474,0.06810582332403474,0.06810582332403474,0.06810582332403474,0.06810582332403474,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06627436617877665,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06810582332403474,0.06810582332403474,0.06810582332403474,0.06810582332403474,0.06810582332403474,0.06810582332403474,0.06810582332403474,0.06810582332403474,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06617564329776304,0.06627436617877665,0.06043843072982976,0.06149112544020042,0.06149112544020042,0.06110811088677296,0.06110811088677296,0.06043843072982976,0.059397171114200724,0.059397171114200724,0.05701065728036103,0.05701065728036103,0.05701065728036103,0.05701065728036103)
maxHPD=c(2.638718248998192, 1.0334299767564101,0.5307661435703505,0.413719621837592,0.32412829286089206,0.29689362121447377,0.2728371072728082,0.2659364446026152,0.2557476313595699,0.2470517972700286,0.238592716616479,0.21427409366450462,0.20039466928450614,0.18947964616044763,0.18427736816583876,0.17678040684853738,0.17340613130913865,0.16369922780417354,0.16332154976583757,0.16332154976583757,0.16314506176769394,0.16369922780417354,0.16332154976583757,0.15998819783285873,0.15998819783285873,0.15998819783285873,0.15998819783285873,0.15918387468637432,0.15918387468637432,0.15918387468637432,0.1589905105749903,0.1589905105749903,0.1589905105749903,0.1589905105749903,0.1589905105749903,0.1589905105749903,0.1589905105749903,0.1589905105749903,0.1589905105749903,0.1589905105749903,0.1589905105749903,0.15998819783285873,0.15998819783285873,0.15998819783285873,0.15998819783285873,0.15998819783285873,0.15998819783285873,0.15998819783285873,0.15998819783285873,0.15998819783285873,0.1589905105749903,0.1589905105749903,0.1589905105749903,0.1589905105749903,0.1589905105749903,0.1589905105749903,0.1589905105749903,0.15918387468637432,0.15918387468637432,0.15918387468637432,0.15998819783285873,0.15998819783285873,0.15998819783285873,0.15998819783285873,0.16105536491943348,0.16105536491943348,0.16105536491943348,0.16105536491943348,0.16105536491943348,0.16332154976583757,0.16369922780417354,0.16369922780417354,0.16369922780417354,0.16369922780417354,0.16446995939500555,0.16446995939500555,0.16446995939500555,0.16314506176769394,0.16314506176769394,0.16332154976583757,0.16332154976583757,0.16332154976583757,0.16369922780417354,0.16369922780417354,0.16369922780417354,0.16332154976583757,0.16369922780417354,0.16446995939500555,0.15998819783285873,0.16314506176769394,0.16332154976583757,0.16369922780417354,0.16369922780417354,0.16369922780417354,0.16369922780417354,0.16446995939500555,0.16332154976583757,0.16369922780417354,0.16577856927857348,0.16883650861880573)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 2.9025900738980117), xlim = c(-130.0919895245172,-66.37208442561405), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.69390212813377, -67.33753753317319,-67.98117293821261,-68.62480834325203,-69.26844374829147,-69.9120791533309,-70.55571455837031,-71.19934996340973,-71.84298536844918,-72.4866207734886,-73.13025617852801,-73.77389158356743,-74.41752698860688,-75.0611623936463,-75.70479779868572,-76.34843320372514,-76.99206860876458,-77.635704013804,-78.27933941884342,-78.92297482388284,-79.56661022892229,-80.2102456339617,-80.85388103900112,-81.49751644404054,-82.14115184907999,-82.78478725411941,-83.42842265915883,-84.07205806419825,-84.71569346923769,-85.35932887427711,-86.00296427931653,-86.64659968435595,-87.2902350893954,-87.93387049443481,-88.57750589947423,-89.22114130451365,-89.8647767095531,-90.50841211459252,-91.15204751963194,-91.79568292467135,-92.4393183297108,-93.08295373475022,-93.72658913978964,-94.37022454482906,-95.0138599498685,-95.65749535490792,-96.30113075994734,-96.94476616498676,-97.5884015700262,-98.23203697506563,-98.87567238010504,-99.51930778514446,-100.16294319018391,-100.80657859522333,-101.45021400026275,-102.09384940530217,-102.73748481034161,-103.38112021538103,-104.02475562042045,-104.66839102545987,-105.31202643049932,-105.95566183553873,-106.59929724057815,-107.24293264561757,-107.88656805065702,-108.53020345569644,-109.17383886073586,-109.81747426577527,-110.46110967081472,-111.10474507585414,-111.74838048089356,-112.39201588593298,-113.03565129097242,-113.67928669601184,-114.32292210105126,-114.96655750609068,-115.61019291113013,-116.25382831616955,-116.89746372120896,-117.54109912624838,-118.18473453128783,-118.82836993632725,-119.47200534136667,-120.11564074640609,-120.75927615144553,-121.40291155648495,-122.04654696152437,-122.69018236656379,-123.33381777160324,-123.97745317664265,-124.62108858168207,-125.26472398672149,-125.90835939176094,-126.55199479680036,-127.19563020183978,-127.8392656068792,-128.48290101191864,-129.12653641695806,-129.77017182199748)
counts=c(0.268, 0.09,0.039,0.03,0.015,0.01,0.011,0.007,0.007,0.01,0.016,0.005,0.007,0.014,0.011,0.022,0.015,0.006,0.003,0.003,0.002,0.002,0.001,0.001,0.0,0.0,0.001,0.0,0.002,0.0,0.0,0.0,0.0,0.001,0.0,0.0,0.0,0.001,0.001,0.0,0.001,0.001,0.0,0.001,0.0,0.0,0.0,0.001,0.001,0.001,0.0,0.002,0.001,0.001,0.002,0.001,0.001,0.0,0.002,0.001,0.0,0.0,0.001,0.001,0.001,0.0,0.001,0.001,0.002,0.003,0.0,0.001,0.001,0.0,0.0,0.001,0.0,0.001,0.001,0.002,0.001,0.001,0.001,0.002,0.003,0.003,0.001,0.002,0.004,0.003,0.001,0.002,0.004,0.002,0.003,0.001,0.002,0.003,0.0)
plot(mids,counts,type = 'h', xlim = c(-130.0919895245172,-66.37208442561405), ylim=c(0,0.268), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.69068395110855, -67.3278830020976,-67.96508205308663,-68.60228110407567,-69.23948015506468,-69.87667920605372,-70.51387825704276,-71.1510773080318,-71.78827635902081,-72.42547541000985,-73.06267446099889,-73.6998735119879,-74.33707256297694,-74.97427161396598,-75.61147066495502,-76.24866971594403,-76.88586876693307,-77.52306781792211,-78.16026686891112,-78.79746591990016,-79.4346649708892,-80.07186402187824,-80.70906307286725,-81.34626212385629,-81.98346117484533,-82.62066022583437,-83.25785927682338,-83.89505832781242,-84.53225737880146,-85.16945642979047,-85.80665548077951,-86.44385453176855,-87.08105358275759,-87.7182526337466,-88.35545168473564,-88.99265073572468,-89.62984978671369,-90.26704883770273,-90.90424788869177,-91.54144693968081,-92.17864599066982,-92.81584504165886,-93.4530440926479,-94.09024314363691,-94.72744219462595,-95.36464124561499,-96.00184029660403,-96.63903934759304,-97.27623839858208,-97.91343744957112,-98.55063650056016,-99.18783555154917,-99.82503460253821,-100.46223365352725,-101.09943270451626,-101.7366317555053,-102.37383080649434,-103.01102985748338,-103.64822890847239,-104.28542795946143,-104.92262701045047,-105.55982606143948,-106.19702511242852,-106.83422416341756,-107.4714232144066,-108.10862226539561,-108.74582131638465,-109.38302036737369,-110.0202194183627,-110.65741846935174,-111.29461752034078,-111.93181657132982,-112.56901562231883,-113.20621467330787,-113.84341372429691,-114.48061277528592,-115.11781182627496,-115.755010877264,-116.39220992825304,-117.02940897924205,-117.66660803023109,-118.30380708122013,-118.94100613220917,-119.57820518319818,-120.21540423418722,-120.85260328517626,-121.48980233616527,-122.12700138715431,-122.76420043814335,-123.40139948913239,-124.0385985401214,-124.67579759111044,-125.31299664209948,-125.95019569308849,-126.58739474407753,-127.22459379506657,-127.86179284605561,-128.49899189704462,-129.13619094803366,-129.7733899990227)
net_rate=c(-0.6311121607473734, -0.19927883681205114,-0.11305980726491421,-0.08741334868887683,-0.0745458900482113,-0.06917905655047302,-0.06543713001760519,-0.06253627316817907,-0.060675813729167735,-0.058513334986720615,-0.056023634155845735,-0.05288743207025517,-0.05020375504221875,-0.04596399164544001,-0.0333366302981215,-0.01078920793913566,0.01603428220631311,0.022190571696953508,0.023022266845116792,0.02338753765195252,0.02347471083537374,0.023771810292317782,0.024950866376709353,0.025595217894361737,0.025638905957795013,0.025808111157553073,0.026754882894220865,0.026643766543265356,0.026687186306949277,0.02498316356474002,0.024899205038763465,0.02452913972117225,0.024558237590991634,0.024558237590991634,0.024107085687607326,0.024063124814030445,0.023900541276443203,0.023900541276443203,0.023900541276443203,0.023980527449246867,0.023980527449246867,0.023909162227210817,0.023806361088787503,0.023903368618682273,0.023903368618682273,0.02394176610869807,0.02395449602651849,0.02395449602651849,0.024037994340861818,0.024042474548028873,0.02415241270330877,0.024021258448596594,0.024251693109728068,0.024263433417716283,0.024044900529181183,0.0238548036922494,0.02386332342049638,0.023861213307658516,0.023861213307658516,0.023835562087504782,0.02394200707006914,0.023778594003410432,0.023778594003410432,0.023778594003410432,0.0237291580527254,0.023727687521276148,0.023792075202838787,0.023820328980208243,0.023820328980208243,0.023893413551070646,0.02374591080594438,0.023858737563543748,0.023897886021151036,0.023897886021151036,0.023873850561915974,0.023873850561915974,0.023897819576326154,0.02399557673784373,0.02399557673784373,0.024415620080015656,0.02443649334032055,0.02465255545861771,0.025234386057614976,0.026680867882777775,0.0280253692269333,0.030185052156661844,0.032233512513528705,0.03738221241796899,0.041410675371682866,0.04450460120817178,0.04914322018480556,0.052795490963276986,0.05571252114720092,0.0608995845952933,0.0646013297780706,0.07040938606673637,0.07601431877381185,0.0803641951644993,0.08368701606516141,0.094686882268738)
net_minHPD=c(-2.59782879731892, -1.0074849706678701,-0.4929735172825173,-0.353560748504319,-0.2719354681767699,-0.2475550943810292,-0.21743783858346208,-0.2121047762512779,-0.19076763831524013,-0.17572563680036954,-0.16850437654348757,-0.15502992049429282,-0.15359738117459884,-0.15250650295815085,-0.15201548089894187,-0.1400032727485308,-0.08833867332738306,-0.057327481730385904,-0.057327481730385904,-0.057327481730385904,-0.057327481730385904,-0.057327481730385904,-0.057327481730385904,-0.0565661312809632,-0.0565661312809632,-0.04910132904388008,-0.04910132904388008,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05033432935045998,-0.05033432935045998,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05033432935045998,-0.05033432935045998,-0.05033432935045998,-0.05033432935045998,-0.05033432935045998,-0.05033432935045998,-0.05033432935045998,-0.05033432935045998,-0.05033432935045998,-0.04910132904388008,-0.04910132904388008,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.04618023288996716,-0.04618023288996716,-0.04618023288996716,-0.04618023288996716,-0.04618023288996716,-0.04618023288996716,-0.04618023288996716,-0.04618023288996716,-0.04618023288996716,-0.04618023288996716,-0.04618023288996716,-0.04618023288996716,-0.04618023288996716,-0.05078142462023989,-0.05078142462023989,-0.05078142462023989,-0.05033432935045998,-0.0565661312809632,-0.0565661312809632,-0.057250259077491275,-0.06847409967556095,-0.07523485427235915,-0.07233886890851135,-0.0765295422120445,-0.0765295422120445,-0.0868535606549866,-0.07523485427235915,-0.06663392854629344,-0.07233886890851135,-0.06994085937947038,-0.0737216525508366,-0.0737216525508366,-0.0737216525508366,-0.0737216525508366)
net_maxHPD=c(0.0798720621656859, 0.08542883164789457,0.07672722678226182,0.07672722678226182,0.07188413040199643,0.07188413040199643,0.0798720621656859,0.07188413040199643,0.07672722678226182,0.07620375627508343,0.07188413040199643,0.07220166378750367,0.07053120399577437,0.07053120399577437,0.07620375627508343,0.08387725521031779,0.11100335290739105,0.11001652183177806,0.10481803373825849,0.10464255212238381,0.10464255212238381,0.10355298025816598,0.10393214730078569,0.10408234264543144,0.10408234264543144,0.11100335290739105,0.11100335290739105,0.10861919282329076,0.10861919282329076,0.10669942922604736,0.10597346301920373,0.10597346301920373,0.10597346301920373,0.10597346301920373,0.10597346301920373,0.10597346301920373,0.10481803373825849,0.10481803373825849,0.10481803373825849,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10597346301920373,0.10597346301920373,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10505775287128764,0.10597346301920373,0.10597346301920373,0.10597346301920373,0.10669942922604736,0.10669942922604736,0.11100335290739105,0.11100335290739105,0.11100335290739105,0.11100335290739105,0.11100335290739105,0.11100335290739105,0.11100335290739105,0.11100335290739105,0.11100335290739105,0.11100335290739105,0.11100335290739105,0.11100335290739105,0.11100335290739105,0.10792376162173742,0.10861919282329076,0.10861919282329076,0.11049347090715894,0.10792376162173742,0.11049347090715894,0.11670840659717703,0.1117338447281307,0.1304230750141651,0.16415032261847867,0.19637702673095694,0.23055304124420495,0.2823644841980305,0.3304097563603233,0.38027848305375744,0.3929812016960747,0.44811652272065494,0.4945650447934586,0.5127191689814884,0.5329727558471384,0.5954002647683406)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-2.857611677050812, 0.6549402912451747), xlim = c(-130.0919895245172,-66.37208442561405), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.69068395110855, -67.3278830020976,-67.96508205308663,-68.60228110407567,-69.23948015506468,-69.87667920605372,-70.51387825704276,-71.1510773080318,-71.78827635902081,-72.42547541000985,-73.06267446099889,-73.6998735119879,-74.33707256297694,-74.97427161396598,-75.61147066495502,-76.24866971594403,-76.88586876693307,-77.52306781792211,-78.16026686891112,-78.79746591990016,-79.4346649708892,-80.07186402187824,-80.70906307286725,-81.34626212385629,-81.98346117484533,-82.62066022583437,-83.25785927682338,-83.89505832781242,-84.53225737880146,-85.16945642979047,-85.80665548077951,-86.44385453176855,-87.08105358275759,-87.7182526337466,-88.35545168473564,-88.99265073572468,-89.62984978671369,-90.26704883770273,-90.90424788869177,-91.54144693968081,-92.17864599066982,-92.81584504165886,-93.4530440926479,-94.09024314363691,-94.72744219462595,-95.36464124561499,-96.00184029660403,-96.63903934759304,-97.27623839858208,-97.91343744957112,-98.55063650056016,-99.18783555154917,-99.82503460253821,-100.46223365352725,-101.09943270451626,-101.7366317555053,-102.37383080649434,-103.01102985748338,-103.64822890847239,-104.28542795946143,-104.92262701045047,-105.55982606143948,-106.19702511242852,-106.83422416341756,-107.4714232144066,-108.10862226539561,-108.74582131638465,-109.38302036737369,-110.0202194183627,-110.65741846935174,-111.29461752034078,-111.93181657132982,-112.56901562231883,-113.20621467330787,-113.84341372429691,-114.48061277528592,-115.11781182627496,-115.755010877264,-116.39220992825304,-117.02940897924205,-117.66660803023109,-118.30380708122013,-118.94100613220917,-119.57820518319818,-120.21540423418722,-120.85260328517626,-121.48980233616527,-122.12700138715431,-122.76420043814335,-123.40139948913239,-124.0385985401214,-124.67579759111044,-125.31299664209948,-125.95019569308849,-126.58739474407753,-127.22459379506657,-127.86179284605561,-128.49899189704462,-129.13619094803366,-129.7733899990227)
rate=c(1.424256691723468, 3.703571551122088,5.456044795608689,6.343708706495414,6.905789990606741,7.17158488352464,7.369383624084456,7.521686639374308,7.6183543081601535,7.727537188911128,7.856146128694476,8.015138151102413,8.113732735944357,8.183978407809983,8.323873673102609,8.430269844942512,8.68628833558944,8.83523163660088,8.89050987888243,8.913203141244317,8.920134016621535,8.943468446093016,8.959229519753327,8.965173818259187,8.968686593445508,8.968686593445508,8.968686593445508,8.96334281949284,8.96334281949284,8.951846485070979,8.956088320356688,8.956088320356688,8.956088320356688,8.956088320356688,8.956069196987123,8.956069196987123,8.956069196987123,8.956069196987123,8.956069196987123,8.962489581245721,8.962489581245721,8.956760746976245,8.956760746976245,8.960628813335711,8.960628813335711,8.963712919095999,8.963712919095999,8.963712919095999,8.963712919095999,8.96407290990731,8.972915661219298,8.96810100504071,8.972081429232512,8.973026602983227,8.97731302587934,8.979220836829816,8.979907804458975,8.987753436192596,8.987753436192596,8.987753436192596,8.996360265374177,9.000159381615566,9.000159381615566,9.000159381615566,8.99363502364567,8.99351608058994,8.998726988270667,8.997883334604653,8.997883334604653,9.003804294312719,8.991862329188258,8.990316522246058,8.993481841361557,8.993481841361557,9.000189529884453,9.000189529884453,9.000189529884453,9.004007380043832,9.004007380043832,9.010104082663526,9.004310100307308,9.004310100307308,9.008226949203104,9.00761293573951,9.0076739871378,8.997192771825665,8.978797986442052,8.956959823061766,8.94755073463013,8.894806004907053,8.882430348396129,8.833107743755845,8.838246490183886,8.805423904657932,8.738016475871737,8.735100154678118,8.703471622205777,8.691734363642627,8.64457595711274,8.498150388617168)
minHPD=c(1.424256691723468, 3.703571551122088,5.456044795608689,6.343708706495414,6.905789990606741,7.17158488352464,7.369383624084456,7.521686639374308,7.6183543081601535,7.727537188911128,7.856146128694476,8.015138151102413,8.113732735944357,8.183978407809983,8.323873673102609,8.430269844942512,8.68628833558944,8.83523163660088,8.89050987888243,8.913203141244317,8.920134016621535,8.943468446093016,8.959229519753327,8.965173818259187,8.968686593445508,8.968686593445508,8.968686593445508,8.96334281949284,8.96334281949284,8.951846485070979,8.956088320356688,8.956088320356688,8.956088320356688,8.956088320356688,8.956069196987123,8.956069196987123,8.956069196987123,8.956069196987123,8.956069196987123,8.962489581245721,8.962489581245721,8.956760746976245,8.956760746976245,8.960628813335711,8.960628813335711,8.963712919095999,8.963712919095999,8.963712919095999,8.963712919095999,8.96407290990731,8.972915661219298,8.96810100504071,8.972081429232512,8.973026602983227,8.97731302587934,8.979220836829816,8.979907804458975,8.987753436192596,8.987753436192596,8.987753436192596,8.996360265374177,9.000159381615566,9.000159381615566,9.000159381615566,8.99363502364567,8.99351608058994,8.998726988270667,8.997883334604653,8.997883334604653,9.003804294312719,8.991862329188258,8.990316522246058,8.993481841361557,8.993481841361557,9.000189529884453,9.000189529884453,9.000189529884453,9.004007380043832,9.004007380043832,9.010104082663526,9.004310100307308,9.004310100307308,9.008226949203104,9.00761293573951,9.0076739871378,8.997192771825665,8.978797986442052,8.956959823061766,8.94755073463013,8.894806004907053,8.882430348396129,8.833107743755845,8.838246490183886,8.805423904657932,8.738016475871737,8.735100154678118,8.703471622205777,8.691734363642627,8.64457595711274,8.498150388617168)
maxHPD=c(1.424256691723468, 3.703571551122088,5.456044795608689,6.343708706495414,6.905789990606741,7.17158488352464,7.369383624084456,7.521686639374308,7.6183543081601535,7.727537188911128,7.856146128694476,8.015138151102413,8.113732735944357,8.183978407809983,8.323873673102609,8.430269844942512,8.68628833558944,8.83523163660088,8.89050987888243,8.913203141244317,8.920134016621535,8.943468446093016,8.959229519753327,8.965173818259187,8.968686593445508,8.968686593445508,8.968686593445508,8.96334281949284,8.96334281949284,8.951846485070979,8.956088320356688,8.956088320356688,8.956088320356688,8.956088320356688,8.956069196987123,8.956069196987123,8.956069196987123,8.956069196987123,8.956069196987123,8.962489581245721,8.962489581245721,8.956760746976245,8.956760746976245,8.960628813335711,8.960628813335711,8.963712919095999,8.963712919095999,8.963712919095999,8.963712919095999,8.96407290990731,8.972915661219298,8.96810100504071,8.972081429232512,8.973026602983227,8.97731302587934,8.979220836829816,8.979907804458975,8.987753436192596,8.987753436192596,8.987753436192596,8.996360265374177,9.000159381615566,9.000159381615566,9.000159381615566,8.99363502364567,8.99351608058994,8.998726988270667,8.997883334604653,8.997883334604653,9.003804294312719,8.991862329188258,8.990316522246058,8.993481841361557,8.993481841361557,9.000189529884453,9.000189529884453,9.000189529884453,9.004007380043832,9.004007380043832,9.010104082663526,9.004310100307308,9.004310100307308,9.008226949203104,9.00761293573951,9.0076739871378,8.997192771825665,8.978797986442052,8.956959823061766,8.94755073463013,8.894806004907053,8.882430348396129,8.833107743755845,8.838246490183886,8.805423904657932,8.738016475871737,8.735100154678118,8.703471622205777,8.691734363642627,8.64457595711274,8.498150388617168)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 9.91111449092988), xlim = c(-130.0919895245172,-66.37208442561405), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()