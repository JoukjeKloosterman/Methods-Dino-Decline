

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.15508150474699, -66.35128951515807,-66.54749752556916,-66.74370553598027,-66.93991354639135,-67.13612155680244,-67.33232956721355,-67.52853757762463,-67.72474558803574,-67.92095359844683,-68.11716160885791,-68.31336961926903,-68.50957762968011,-68.7057856400912,-68.9019936505023,-69.09820166091339,-69.2944096713245,-69.49061768173559,-69.68682569214667,-69.88303370255778,-70.07924171296887,-70.27544972337995,-70.47165773379106,-70.66786574420215,-70.86407375461323,-71.06028176502434,-71.25648977543543,-71.45269778584654,-71.64890579625762,-71.8451138066687,-72.04132181707982,-72.2375298274909,-72.43373783790199,-72.6299458483131,-72.82615385872418,-73.0223618691353,-73.21856987954638,-73.41477788995746,-73.61098590036858,-73.80719391077966,-74.00340192119074,-74.19960993160186,-74.39581794201294,-74.59202595242405,-74.78823396283514,-74.98444197324622,-75.18064998365733,-75.37685799406842,-75.5730660044795,-75.76927401489061,-75.9654820253017,-76.16169003571278,-76.35789804612389,-76.55410605653498,-76.75031406694609,-76.94652207735717,-77.14273008776826,-77.33893809817937,-77.53514610859045,-77.73135411900154,-77.92756212941265,-78.12377013982373,-78.31997815023485,-78.51618616064593,-78.71239417105701,-78.90860218146813,-79.10481019187921,-79.3010182022903,-79.4972262127014,-79.69343422311249,-79.88964223352357,-80.08585024393469,-80.28205825434577,-80.47826626475688,-80.67447427516797,-80.87068228557905,-81.06689029599016,-81.26309830640125,-81.45930631681233,-81.65551432722344,-81.85172233763453,-82.04793034804564,-82.24413835845672,-82.44034636886781,-82.63655437927892,-82.83276238969,-83.02897040010109,-83.2251784105122,-83.42138642092328,-83.61759443133437,-83.81380244174548,-84.01001045215656,-84.20621846256768,-84.40242647297876,-84.59863448338984,-84.79484249380096,-84.99105050421204,-85.18725851462312,-85.38346652503424,-85.57967453544532)
rate=c(0.12072220514739826, 0.12072220514739826,0.12037337792172532,0.12031039164251792,0.12031039164251792,0.12015068753698757,0.12000898593580178,0.12000898593580178,0.12010023204926715,0.12000898593580178,0.1197947300239798,0.11943272156720895,0.11929575947055049,0.11920377698146643,0.11898631201716675,0.11809700447652266,0.11744576996186532,0.1170782876884599,0.11674250176371491,0.11641994902765551,0.1162109180607935,0.11601625689991882,0.11591547220944277,0.11484406539665179,0.11341010759425543,0.11073122619409134,0.10910918815720927,0.10840820478246457,0.10838995768165567,0.10793687489491105,0.10780982894857469,0.10760833996752148,0.10753827005450026,0.10736769823797514,0.10731031148367763,0.10731031148367763,0.10726672388747002,0.10716571847362964,0.10716571847362964,0.10712595422994664,0.10712595422994664,0.10706576772907231,0.10706576772907231,0.10706576772907231,0.10706576772907231,0.10706576772907231,0.1068808833231199,0.1068808833231199,0.1068808833231199,0.1068808833231199,0.10679981544857121,0.10679981544857121,0.10679981544857121,0.1068808833231199,0.1068808833231199,0.1068808833231199,0.1068808833231199,0.10679981544857121,0.10679981544857121,0.10676906698380566,0.10676906698380566,0.10676906698380566,0.10676906698380566,0.10679981544857121,0.10679981544857121,0.10679981544857121,0.1068808833231199,0.1068808833231199,0.10698937069300707,0.10698937069300707,0.10706576772907231,0.10706576772907231,0.10710605551020692,0.10710605551020692,0.10710605551020692,0.10710605551020692,0.10710605551020692,0.10698937069300707,0.10679981544857121,0.1068808833231199,0.10679981544857121,0.10673867821629773,0.10679981544857121,0.1068808833231199,0.10679981544857121,0.10679981544857121,0.10676906698380566,0.10679981544857121,0.10706576772907231,0.10716571847362964,0.10726672388747002,0.10745845073511867,0.10811080626269196,0.11014593261078447,0.11601612744426612,0.46099595496417656,1.2608283982155029,1.362620336170485,1.4095820751083799,1.4209077877014642)
minHPD=c(0.06300832703476474, 0.06357503030533598,0.056514759040064116,0.056514759040064116,0.06300832703476474,0.06300832703476474,0.06300832703476474,0.05953282190783201,0.05953282190783201,0.05953282190783201,0.05953282190783201,0.06300832703476474,0.06300832703476474,0.06300832703476474,0.06300832703476474,0.06300832703476474,0.05953282190783201,0.05626612219969944,0.06300832703476474,0.06357503030533598,0.06357503030533598,0.06300832703476474,0.06300832703476474,0.05872875480256912,0.05383234867826682,0.05383234867826682,0.05829716673032728,0.06357503030533598,0.06300832703476474,0.06357503030533598,0.06398150923091953,0.06484237852617931,0.06555725943431794,0.06357503030533598,0.06398150923091953,0.06398150923091953,0.06421369278786,0.06484237852617931,0.06484237852617931,0.06484237852617931,0.06484237852617931,0.06555725943431794,0.06555725943431794,0.06555725943431794,0.06555725943431794,0.06555725943431794,0.06555725943431794,0.06555725943431794,0.06555725943431794,0.06555725943431794,0.06357503030533598,0.06281902648317918,0.06281902648317918,0.06357503030533598,0.06555725943431794,0.06555725943431794,0.06555725943431794,0.06555725943431794,0.06357503030533598,0.06281902648317918,0.06281902648317918,0.06281902648317918,0.06281902648317918,0.06281902648317918,0.06281902648317918,0.06281902648317918,0.06281902648317918,0.06281902648317918,0.06281902648317918,0.06281902648317918,0.06281902648317918,0.06555725943431794,0.06555725943431794,0.06555725943431794,0.06555725943431794,0.06555725943431794,0.06555725943431794,0.06484237852617931,0.06421369278786,0.06421369278786,0.06281902648317918,0.06281902648317918,0.06484237852617931,0.06398150923091953,0.06281902648317918,0.06281902648317918,0.06281902648317918,0.06281902648317918,0.05829716673032728,0.05589913450481924,0.05829716673032728,0.05323055625119605,0.005187561079873332,0.005744967703158071,0.005744967703158071,0.04428972012105385,0.05383234867826682,0.007206101124981135,0.06300832703476474,0.09974800144318362)
maxHPD=c(0.39631769064519184, 0.3944573058131149,0.37751488363739655,0.37389988098273913,0.3696485060397864,0.3560433113974491,0.3560433113974491,0.3486404709546551,0.3486404709546551,0.3486404709546551,0.3486404709546551,0.3486404709546551,0.345732157547514,0.345732157547514,0.3402869300548791,0.3355723585498419,0.3304699489327429,0.3163381691964673,0.31481198549104283,0.31481198549104283,0.31481198549104283,0.3136475152628799,0.3090711292549794,0.3020767060452175,0.278329861924228,0.2159665611910931,0.17502740529705607,0.17436138046747301,0.16811923259094583,0.1631970641576215,0.16118176742451754,0.16118176742451754,0.16118176742451754,0.1579312751260942,0.1579312751260942,0.1579312751260942,0.15770425733973448,0.1579312751260942,0.1579312751260942,0.15770425733973448,0.15770425733973448,0.1579312751260942,0.1579312751260942,0.1579312751260942,0.1579312751260942,0.1579312751260942,0.15770425733973448,0.15770425733973448,0.15770425733973448,0.15770425733973448,0.15549292329635203,0.1537149329279837,0.1537149329279837,0.15549292329635203,0.15770425733973448,0.15770425733973448,0.15770425733973448,0.15770425733973448,0.15549292329635203,0.15310793993106017,0.15310793993106017,0.15310793993106017,0.15310793993106017,0.1537149329279837,0.1537149329279837,0.1537149329279837,0.1537149329279837,0.1537149329279837,0.1537149329279837,0.1537149329279837,0.1537149329279837,0.15770425733973448,0.15770425733973448,0.15770425733973448,0.15770425733973448,0.15770425733973448,0.15770425733973448,0.1579312751260942,0.15770425733973448,0.1579312751260942,0.1579312751260942,0.15770425733973448,0.16118176742451754,0.16118176742451754,0.16118176742451754,0.16118176742451754,0.1629034031647248,0.1629034031647248,0.16118176742451754,0.1631970641576215,0.17430974746512842,0.18198385428638386,0.23987675555274862,0.8688615248177877,1.4094346963487807,2.4051932158983846,2.7595522914567794,2.857406495358648,2.961930692208235,3.017594167658986)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 3.319353584424885), xlim = c(-85.67777854065088,-66.05697749954143), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.1560724542945, -66.35426236380067,-66.55245227330681,-66.75064218281298,-66.94883209231912,-67.14702200182529,-67.34521191133146,-67.5434018208376,-67.74159173034377,-67.93978163984991,-68.13797154935608,-68.33616145886222,-68.53435136836839,-68.73254127787453,-68.9307311873807,-69.12892109688684,-69.32711100639301,-69.52530091589915,-69.72349082540532,-69.92168073491146,-70.11987064441763,-70.3180605539238,-70.51625046342994,-70.71444037293611,-70.91263028244225,-71.11082019194842,-71.30901010145456,-71.50720001096073,-71.70538992046687,-71.90357982997304,-72.10176973947918,-72.29995964898535,-72.49814955849149,-72.69633946799766,-72.8945293775038,-73.09271928700997,-73.29090919651614,-73.48909910602228,-73.68728901552845,-73.88547892503459,-74.08366883454076,-74.2818587440469,-74.48004865355307,-74.67823856305921,-74.87642847256538,-75.07461838207152,-75.27280829157769,-75.47099820108383,-75.66918811059,-75.86737802009617,-76.06556792960231,-76.26375783910848,-76.46194774861462,-76.66013765812079,-76.85832756762693,-77.0565174771331,-77.25470738663924,-77.45289729614541,-77.65108720565155,-77.84927711515772,-78.04746702466386,-78.24565693417003,-78.44384684367617,-78.64203675318234,-78.84022666268851,-79.03841657219465,-79.23660648170082,-79.43479639120696,-79.63298630071313,-79.83117621021927,-80.02936611972544,-80.22755602923158,-80.42574593873775,-80.62393584824389,-80.82212575775006,-81.0203156672562,-81.21850557676237,-81.41669548626854,-81.61488539577468,-81.81307530528085,-82.01126521478699,-82.20945512429316,-82.4076450337993,-82.60583494330547,-82.80402485281161,-83.00221476231778,-83.20040467182392,-83.39859458133009,-83.59678449083623,-83.7949744003424,-83.99316430984857,-84.19135421935471,-84.38954412886088,-84.58773403836702,-84.78592394787319,-84.98411385737933,-85.1823037668855,-85.38049367639164,-85.5786835858978)
counts=c(0.003, 0.006,0.001,0.005,0.006,0.002,0.002,0.001,0.003,0.002,0.004,0.002,0.002,0.006,0.01,0.01,0.006,0.01,0.006,0.007,0.005,0.007,0.014,0.031,0.037,0.022,0.011,0.009,0.005,0.002,0.003,0.003,0.004,0.0,0.0,0.003,0.002,0.002,0.001,0.0,0.003,0.0,0.0,0.0,0.003,0.002,0.001,0.001,0.002,0.001,0.0,0.001,0.001,0.0,0.0,0.002,0.001,0.003,0.0,0.004,0.0,0.001,0.0,0.001,0.0,0.001,0.001,0.002,0.002,0.001,0.003,0.001,0.0,0.0,0.0,0.001,0.005,0.001,0.003,0.004,0.003,0.002,0.006,0.001,0.001,0.001,0.003,0.005,0.012,0.01,0.022,0.044,0.09,0.312,0.281,0.111,0.045,0.024,0.012)
plot(mids,counts,type = 'h', xlim = c(-85.67777854065088,-66.05697749954143), ylim=c(0,0.312), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.025812591584077275
bf6 = 0.16372883894523804
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.15508150474699, -66.35128951515807,-66.54749752556916,-66.74370553598027,-66.93991354639135,-67.13612155680244,-67.33232956721355,-67.52853757762463,-67.72474558803574,-67.92095359844683,-68.11716160885791,-68.31336961926903,-68.50957762968011,-68.7057856400912,-68.9019936505023,-69.09820166091339,-69.2944096713245,-69.49061768173559,-69.68682569214667,-69.88303370255778,-70.07924171296887,-70.27544972337995,-70.47165773379106,-70.66786574420215,-70.86407375461323,-71.06028176502434,-71.25648977543543,-71.45269778584654,-71.64890579625762,-71.8451138066687,-72.04132181707982,-72.2375298274909,-72.43373783790199,-72.6299458483131,-72.82615385872418,-73.0223618691353,-73.21856987954638,-73.41477788995746,-73.61098590036858,-73.80719391077966,-74.00340192119074,-74.19960993160186,-74.39581794201294,-74.59202595242405,-74.78823396283514,-74.98444197324622,-75.18064998365733,-75.37685799406842,-75.5730660044795,-75.76927401489061,-75.9654820253017,-76.16169003571278,-76.35789804612389,-76.55410605653498,-76.75031406694609,-76.94652207735717,-77.14273008776826,-77.33893809817937,-77.53514610859045,-77.73135411900154,-77.92756212941265,-78.12377013982373,-78.31997815023485,-78.51618616064593,-78.71239417105701,-78.90860218146813,-79.10481019187921,-79.3010182022903,-79.4972262127014,-79.69343422311249,-79.88964223352357,-80.08585024393469,-80.28205825434577,-80.47826626475688,-80.67447427516797,-80.87068228557905,-81.06689029599016,-81.26309830640125,-81.45930631681233,-81.65551432722344,-81.85172233763453,-82.04793034804564,-82.24413835845672,-82.44034636886781,-82.63655437927892,-82.83276238969,-83.02897040010109,-83.2251784105122,-83.42138642092328,-83.61759443133437,-83.81380244174548,-84.01001045215656,-84.20621846256768,-84.40242647297876,-84.59863448338984,-84.79484249380096,-84.99105050421204,-85.18725851462312,-85.38346652503424,-85.57967453544532)
rate=c(0.5663512632891701, 0.5370273735895656,0.5175479792472525,0.5066166449565876,0.5012136213464762,0.4987163672341129,0.49700907243146825,0.4952049059135196,0.49500610314374616,0.49394284822810325,0.4925535789478479,0.49115846398657786,0.48842973641886445,0.4869149760663546,0.483971798616013,0.4823248927445505,0.4823248927445505,0.4822627132421217,0.4815723815765913,0.4815723815765913,0.48082541340759855,0.48008758518927797,0.47949706633192873,0.4792006475755861,0.47689164582214605,0.47319351358830836,0.46749702234851204,0.4641957766470819,0.4610998506246604,0.4592654437077075,0.45716137167853527,0.44765894910794646,0.418266578964691,0.36474808598862773,0.09951766432209647,0.07667913457625838,0.06996755036621738,0.06654767280995436,0.06491048273201368,0.06443419231608234,0.06373672249367032,0.06288444297960366,0.06257004087650758,0.06257004087650758,0.06251171924654012,0.0624044081068473,0.0624044081068473,0.0624044081068473,0.0624044081068473,0.062465880726439195,0.0624044081068473,0.0624044081068473,0.0623249964049382,0.0623249964049382,0.0623249964049382,0.0623249964049382,0.0623249964049382,0.0623249964049382,0.062269141133123276,0.062269141133123276,0.06203987807071723,0.06195555562349808,0.06186572282163595,0.061770325768735666,0.06170405720175133,0.061598088205605514,0.06155398005837111,0.06107303849586491,0.06085489489737983,0.060481400969162984,0.059944391997533125,0.05919204272188947,0.058840851376885175,0.058533601856491764,0.05836558836476449,0.05754272063040686,0.056803068805054785,0.056476880842974454,0.05580934822947638,0.05562624638593454,0.055456439812097386,0.05533273035090074,0.05519082939374996,0.05507761171579435,0.055032494860973044,0.05500999711406011,0.05500904058281393,0.05500904058281393,0.05500434546812637,0.05500434546812637,0.05500434546812637,0.05497188203886742,0.05500434546812637,0.05497188203886742,0.05497188203886742,0.05500434546812637,0.055055488188740564,0.055055488188740564,0.055286868424202995,0.05533273035090074)
minHPD=c(0.2728112303480977, 0.2368925759778695,0.2602803689615109,0.28229753292475895,0.2368925759778695,0.2602803689615109,0.28229753292475895,0.2368925759778695,0.2368925759778695,0.2368925759778695,0.2602803689615109,0.2602803689615109,0.2655298711262404,0.28229753292475895,0.23195403573934398,0.23195403573934398,0.23195403573934398,0.24649014288055462,0.28229753292475895,0.23195403573934398,0.23195403573934398,0.23195403573934398,0.23195403573934398,0.23195403573934398,0.22682403744734117,0.21768507572354379,0.07922751261608715,0.07091589280859746,0.06759306175555418,0.06759306175555418,0.06161375253742398,0.05866551224856538,0.03745325995260829,0.03249822119635895,0.02314236791270565,0.026065824934226482,0.022944362857773216,0.024972116078473987,0.018316644286353836,0.018316644286353836,0.022944362857773216,0.022944362857773216,0.022944362857773216,0.022944362857773216,0.022944362857773216,0.022944362857773216,0.019653603359336233,0.019653603359336233,0.019653603359336233,0.022944362857773216,0.022944362857773216,0.022944362857773216,0.024209745025597442,0.024209745025597442,0.024209745025597442,0.024209745025597442,0.024209745025597442,0.024209745025597442,0.022944362857773216,0.024209745025597442,0.024457773007524754,0.024972116078473987,0.024972116078473987,0.024972116078473987,0.024972116078473987,0.024209745025597442,0.02236337224186473,0.022944362857773216,0.022944362857773216,0.02236337224186473,0.01621455111947815,0.012705419292183934,0.01192285690471906,0.01192285690471906,0.005671518657551779,0.00408883748701761,0.000342828112010499,0.00031152798669707856,0.00031152798669707856,0.00031152798669707856,0.000197280774375791,0.000197280774375791,0.00031152798669707856,0.00031152798669707856,0.000197280774375791,0.00031152798669707856,0.00031152798669707856,0.00031152798669707856,0.00031152798669707856,0.00031152798669707856,0.00031152798669707856,0.00031152798669707856,0.000197280774375791,0.000197280774375791,0.000197280774375791,0.00031152798669707856,0.000197280774375791,0.000197280774375791,0.00031152798669707856,0.000197280774375791)
maxHPD=c(2.6779347165476635, 1.6798695863488255,1.314300511809801,1.122259419942329,0.8991399681034872,0.8786603431091701,0.8689387256236181,0.8079575721605814,0.8059686261343816,0.7916645257230168,0.7916645257230168,0.7901527074261424,0.7916645257230168,0.7916645257230168,0.7316677590978021,0.729341040932496,0.729341040932496,0.7401224341549179,0.7729481397948542,0.7303137025978164,0.7303137025978164,0.729341040932496,0.729341040932496,0.7303137025978164,0.7401224341549179,0.7729481397948542,0.6943205450277,0.6830307692742353,0.6830307692742353,0.6830307692742353,0.6792090136695444,0.6809565502928582,0.6395486879360789,0.6190125500933666,0.551561465986338,0.5067601693357,0.4586986414905581,0.400075578442934,0.3051647753080085,0.22164227649463664,0.15528350795835202,0.13802404086569323,0.13134548653696781,0.1286064238362881,0.12428386304993405,0.12024342810964797,0.11455278021126497,0.11455278021126497,0.113960125298207,0.11455278021126497,0.113960125298207,0.113960125298207,0.11455278021126497,0.11455278021126497,0.11455278021126497,0.11455278021126497,0.11455278021126497,0.11455278021126497,0.113960125298207,0.11455278021126497,0.113960125298207,0.113960125298207,0.11386620410888901,0.113960125298207,0.113960125298207,0.11455278021126497,0.11066614873331912,0.11386620410888901,0.11386620410888901,0.113960125298207,0.11066614873331912,0.10877464240066106,0.10877464240066106,0.10840449436665912,0.10478657906988337,0.10478657906988337,0.09891598591787666,0.09645042536773683,0.09549905440348568,0.09397278942986009,0.09374737248482144,0.09374737248482144,0.09374737248482144,0.09374737248482144,0.09311564516498003,0.09311564516498003,0.09311564516498003,0.09311564516498003,0.09311564516498003,0.09311564516498003,0.09311564516498003,0.09311564516498003,0.09311564516498003,0.09311564516498003,0.09311564516498003,0.09374737248482144,0.09444188751067406,0.09444188751067406,0.0960365004395387,0.0960365004395387)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 2.94572818820243), xlim = c(-85.67777854065088,-66.05697749954143), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.1560724542945, -66.35426236380067,-66.55245227330681,-66.75064218281298,-66.94883209231912,-67.14702200182529,-67.34521191133146,-67.5434018208376,-67.74159173034377,-67.93978163984991,-68.13797154935608,-68.33616145886222,-68.53435136836839,-68.73254127787453,-68.9307311873807,-69.12892109688684,-69.32711100639301,-69.52530091589915,-69.72349082540532,-69.92168073491146,-70.11987064441763,-70.3180605539238,-70.51625046342994,-70.71444037293611,-70.91263028244225,-71.11082019194842,-71.30901010145456,-71.50720001096073,-71.70538992046687,-71.90357982997304,-72.10176973947918,-72.29995964898535,-72.49814955849149,-72.69633946799766,-72.8945293775038,-73.09271928700997,-73.29090919651614,-73.48909910602228,-73.68728901552845,-73.88547892503459,-74.08366883454076,-74.2818587440469,-74.48004865355307,-74.67823856305921,-74.87642847256538,-75.07461838207152,-75.27280829157769,-75.47099820108383,-75.66918811059,-75.86737802009617,-76.06556792960231,-76.26375783910848,-76.46194774861462,-76.66013765812079,-76.85832756762693,-77.0565174771331,-77.25470738663924,-77.45289729614541,-77.65108720565155,-77.84927711515772,-78.04746702466386,-78.24565693417003,-78.44384684367617,-78.64203675318234,-78.84022666268851,-79.03841657219465,-79.23660648170082,-79.43479639120696,-79.63298630071313,-79.83117621021927,-80.02936611972544,-80.22755602923158,-80.42574593873775,-80.62393584824389,-80.82212575775006,-81.0203156672562,-81.21850557676237,-81.41669548626854,-81.61488539577468,-81.81307530528085,-82.01126521478699,-82.20945512429316,-82.4076450337993,-82.60583494330547,-82.80402485281161,-83.00221476231778,-83.20040467182392,-83.39859458133009,-83.59678449083623,-83.7949744003424,-83.99316430984857,-84.19135421935471,-84.38954412886088,-84.58773403836702,-84.78592394787319,-84.98411385737933,-85.1823037668855,-85.38049367639164,-85.5786835858978)
counts=c(0.084, 0.06,0.034,0.023,0.01,0.008,0.007,0.001,0.005,0.008,0.006,0.007,0.016,0.014,0.008,0.0,0.004,0.006,0.003,0.001,0.004,0.003,0.007,0.013,0.019,0.021,0.009,0.014,0.007,0.019,0.056,0.125,0.159,0.211,0.126,0.077,0.062,0.031,0.016,0.016,0.011,0.006,0.008,0.002,0.002,0.002,0.003,0.0,0.001,0.001,0.0,0.002,0.0,0.0,0.0,0.0,0.001,0.0,0.003,0.001,0.001,0.0,0.002,0.004,0.004,0.006,0.006,0.007,0.009,0.011,0.008,0.005,0.008,0.009,0.016,0.012,0.006,0.005,0.006,0.003,0.002,0.002,0.001,0.001,0.001,0.0,0.001,0.001,0.0,0.0,0.002,0.002,0.0,0.002,0.004,0.0,0.003,0.001,0.002)
plot(mids,counts,type = 'h', xlim = c(-85.67777854065088,-66.05697749954143), ylim=c(0,0.211), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.15508150474699, -66.35128951515807,-66.54749752556916,-66.74370553598027,-66.93991354639135,-67.13612155680244,-67.33232956721355,-67.52853757762463,-67.72474558803574,-67.92095359844683,-68.11716160885791,-68.31336961926903,-68.50957762968011,-68.7057856400912,-68.9019936505023,-69.09820166091339,-69.2944096713245,-69.49061768173559,-69.68682569214667,-69.88303370255778,-70.07924171296887,-70.27544972337995,-70.47165773379106,-70.66786574420215,-70.86407375461323,-71.06028176502434,-71.25648977543543,-71.45269778584654,-71.64890579625762,-71.8451138066687,-72.04132181707982,-72.2375298274909,-72.43373783790199,-72.6299458483131,-72.82615385872418,-73.0223618691353,-73.21856987954638,-73.41477788995746,-73.61098590036858,-73.80719391077966,-74.00340192119074,-74.19960993160186,-74.39581794201294,-74.59202595242405,-74.78823396283514,-74.98444197324622,-75.18064998365733,-75.37685799406842,-75.5730660044795,-75.76927401489061,-75.9654820253017,-76.16169003571278,-76.35789804612389,-76.55410605653498,-76.75031406694609,-76.94652207735717,-77.14273008776826,-77.33893809817937,-77.53514610859045,-77.73135411900154,-77.92756212941265,-78.12377013982373,-78.31997815023485,-78.51618616064593,-78.71239417105701,-78.90860218146813,-79.10481019187921,-79.3010182022903,-79.4972262127014,-79.69343422311249,-79.88964223352357,-80.08585024393469,-80.28205825434577,-80.47826626475688,-80.67447427516797,-80.87068228557905,-81.06689029599016,-81.26309830640125,-81.45930631681233,-81.65551432722344,-81.85172233763453,-82.04793034804564,-82.24413835845672,-82.44034636886781,-82.63655437927892,-82.83276238969,-83.02897040010109,-83.2251784105122,-83.42138642092328,-83.61759443133437,-83.81380244174548,-84.01001045215656,-84.20621846256768,-84.40242647297876,-84.59863448338984,-84.79484249380096,-84.99105050421204,-85.18725851462312,-85.38346652503424,-85.57967453544532)
net_rate=c(-0.7112220221337723, -0.5362921397319527,-0.44893411616401846,-0.41219813325414256,-0.3863861890702999,-0.37900122273717657,-0.37472128609110417,-0.3714917612363026,-0.3701592152590671,-0.3683314892947012,-0.3638015969229091,-0.3622039481658149,-0.35806057431246624,-0.3519347943794676,-0.3467558205902053,-0.34404839978661994,-0.345625994191149,-0.34754103341451814,-0.3491030232764215,-0.35033599068980553,-0.3505734360522826,-0.3501938679951704,-0.3508178506726155,-0.35117193002965313,-0.3505945376049387,-0.3524556961622331,-0.34638735152512506,-0.34496976609752245,-0.3421726786875411,-0.33769280728457995,-0.3333457611967011,-0.3166457566193971,-0.26894471926800917,-0.20022287510899825,-0.11214154413739391,-0.05383692519151577,-0.016392139772798846,0.0067416563110557215,0.02148783193028278,0.02839698254092601,0.033132095421060825,0.03747325950086261,0.03996397242422018,0.04057355088101276,0.04146351631553928,0.041981541850357615,0.04210662006676863,0.042135858295969414,0.042314059764139704,0.04224612525839347,0.04233186786796575,0.04229248957089246,0.04252763496367829,0.04257660454947989,0.04262528658204133,0.04262528658204133,0.04262496589796508,0.04258734723158088,0.042609948365109264,0.042571603846265654,0.04274639926883038,0.042889141391886945,0.04303514700949844,0.04320814049778144,0.043304858888207,0.043682398316710676,0.04411362259131519,0.044696303018635655,0.04556999509561933,0.04608971425026385,0.04712232693426984,0.04800098413601389,0.04848341787767127,0.04870619261945779,0.04916620112752367,0.05036597939996057,0.05157891386287877,0.05201257861683628,0.05251479549296029,0.05306161159632604,0.05342499924060679,0.05345872215828826,0.05388097509576182,0.054427530361615795,0.054782114204375607,0.05495264857156546,0.05487790110386669,0.055221934064773374,0.0558408043754899,0.057880141517613004,0.06210613510334595,0.06961436550603742,0.08711467245674212,0.1353511289341283,0.2477233479398231,0.739594472188835,1.1915498381872462,1.3611940855704028,1.4343734942007438,1.4678401610209202)
net_minHPD=c(-2.720469500227397, -1.7729817830801389,-1.2918643691897047,-1.0734276663499585,-0.8595253431587059,-0.7956698161714633,-0.7494289142751418,-0.7410224624380723,-0.7294309816222284,-0.7494289142751418,-0.6980448451596222,-0.6961953286119898,-0.6980448451596222,-0.6478097109778267,-0.638725508435091,-0.6205005737468319,-0.6205005737468319,-0.6350988425803581,-0.6205005737468319,-0.638725508435091,-0.638725508435091,-0.6205005737468319,-0.6205005737468319,-0.6205005737468319,-0.6350988425803581,-0.6860892039727802,-0.5987514244286697,-0.5840778447015464,-0.6030472577171111,-0.5875365549701441,-0.5840778447015464,-0.564977885176936,-0.5397353322605823,-0.5057092721989243,-0.4495997448077498,-0.38882017333675933,-0.35189703753233104,-0.2888166440040372,-0.18500597355092757,-0.127009706393862,-0.05788714234583221,-0.03781229528020488,-0.029919621604065957,-0.02970105575127971,-0.025828178892492004,-0.024015740487823116,-0.019533600114576374,-0.019533600114576374,-0.017645981596184607,-0.017645981596184607,-0.01571786837730356,-0.014981023937461965,-0.016126810198353186,-0.016126810198353186,-0.016126810198353186,-0.016126810198353186,-0.016126810198353186,-0.014981023937461965,-0.01571786837730356,-0.014981023937461965,-0.016126810198353186,-0.01571786837730356,-0.016126810198353186,-0.01571786837730356,-0.016126810198353186,-0.016126810198353186,-0.01571786837730356,-0.014321906065997397,-0.013789533449567973,-0.01307248132226109,-0.01307248132226109,-0.016126810198353186,-0.011281338397072682,-0.011281338397072682,-0.011281338397072682,-0.011281338397072682,-0.011281338397072682,-0.014981023937461965,-0.007791091087682694,-0.007676618076436034,-0.011023713217125197,-0.011281338397072682,-0.007791091087682694,-0.007791091087682694,-0.011023713217125197,-0.011023713217125197,-0.011023713217125197,-0.011023713217125197,-0.01307248132226109,-0.016126810198353186,-0.018100639059773438,-0.029546416697538963,-0.07895252560765564,-0.06101104420113245,-0.05252311564682034,-0.05252311564682034,-0.007676618076436034,-0.0036947894053555863,0.004832102081280279,0.05057181482700775)
net_maxHPD=c(-0.0020787340286623768, -0.007065607794402851,-0.007065607794402851,-0.028895314315217024,0.05408123209471821,-0.007065607794402851,-0.0020787340286623768,-0.007760618593699253,-0.0020787340286623768,-0.028895314315217024,-0.0020787340286623768,-0.007065607794402851,-0.02496297412312387,-0.0020787340286623768,-0.0193784629449662,-0.028895314315217024,-0.02496297412312387,-0.05547734302218704,-0.053725941895478246,-0.0674170365414579,-0.0674170365414579,-0.053725941895478246,-0.05547734302218704,-0.053725941895478246,-0.0674170365414579,-0.09393949821338754,0.02750025374291651,0.04177907072086494,0.03415161487582859,0.04629649363009379,0.0521492931019743,0.07195247523024523,0.08180101621840943,0.10671222701843838,0.1056279820995715,0.11287607941282243,0.12291237555507704,0.11287607941282243,0.12751858140053043,0.12751858140053043,0.12751858140053043,0.11287607941282243,0.11287607941282243,0.11084662795692793,0.11084662795692793,0.11084662795692793,0.11287607941282243,0.11287607941282243,0.11287607941282243,0.11287607941282243,0.11287607941282243,0.11287607941282243,0.11084662795692793,0.11084662795692793,0.11084662795692793,0.11084662795692793,0.11084662795692793,0.11287607941282243,0.11084662795692793,0.11084662795692793,0.10883894132668781,0.10883894132668781,0.10742272000404543,0.10883894132668781,0.10742272000404543,0.1068230185753362,0.10742272000404543,0.10742272000404543,0.10742272000404543,0.10742272000404543,0.10742272000404543,0.10742272000404543,0.11366979779187622,0.11398176786662989,0.11398176786662989,0.11657531859666548,0.11700802364475398,0.11657531859666548,0.1241204570565305,0.1241204570565305,0.12239634134581676,0.12239634134581676,0.12676877444006704,0.127609148648729,0.12676877444006704,0.12708877418546916,0.12708877418546916,0.127609148648729,0.127609148648729,0.1318471059703239,0.14247176163216257,0.14790277343195507,0.23509146424534563,0.8640423454873217,1.3514664630860294,2.3313690695171614,2.7301382217917816,2.8799105876766466,2.9439641131146033,2.968980894120448)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-2.992516450250137, 3.265878983532493), xlim = c(-85.67777854065088,-66.05697749954143), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.15508150474699, -66.35128951515807,-66.54749752556916,-66.74370553598027,-66.93991354639135,-67.13612155680244,-67.33232956721355,-67.52853757762463,-67.72474558803574,-67.92095359844683,-68.11716160885791,-68.31336961926903,-68.50957762968011,-68.7057856400912,-68.9019936505023,-69.09820166091339,-69.2944096713245,-69.49061768173559,-69.68682569214667,-69.88303370255778,-70.07924171296887,-70.27544972337995,-70.47165773379106,-70.66786574420215,-70.86407375461323,-71.06028176502434,-71.25648977543543,-71.45269778584654,-71.64890579625762,-71.8451138066687,-72.04132181707982,-72.2375298274909,-72.43373783790199,-72.6299458483131,-72.82615385872418,-73.0223618691353,-73.21856987954638,-73.41477788995746,-73.61098590036858,-73.80719391077966,-74.00340192119074,-74.19960993160186,-74.39581794201294,-74.59202595242405,-74.78823396283514,-74.98444197324622,-75.18064998365733,-75.37685799406842,-75.5730660044795,-75.76927401489061,-75.9654820253017,-76.16169003571278,-76.35789804612389,-76.55410605653498,-76.75031406694609,-76.94652207735717,-77.14273008776826,-77.33893809817937,-77.53514610859045,-77.73135411900154,-77.92756212941265,-78.12377013982373,-78.31997815023485,-78.51618616064593,-78.71239417105701,-78.90860218146813,-79.10481019187921,-79.3010182022903,-79.4972262127014,-79.69343422311249,-79.88964223352357,-80.08585024393469,-80.28205825434577,-80.47826626475688,-80.67447427516797,-80.87068228557905,-81.06689029599016,-81.26309830640125,-81.45930631681233,-81.65551432722344,-81.85172233763453,-82.04793034804564,-82.24413835845672,-82.44034636886781,-82.63655437927892,-82.83276238969,-83.02897040010109,-83.2251784105122,-83.42138642092328,-83.61759443133437,-83.81380244174548,-84.01001045215656,-84.20621846256768,-84.40242647297876,-84.59863448338984,-84.79484249380096,-84.99105050421204,-85.18725851462312,-85.38346652503424,-85.57967453544532)
rate=c(1.1501274926767537, 1.4412989753607985,1.6557066462519106,1.7658078761971123,1.8502615147100703,1.8800959295797703,1.8984517827859717,1.9092442983748887,1.9138358158083653,1.9206982567247561,1.9385556412446423,1.9473065842433108,1.9642940168645222,1.9888608089984556,2.014681826014337,2.0360494949962753,2.0360494949962753,2.035250299302341,2.0380107037543214,2.0378844179896403,2.0398967494267413,2.0439889001130824,2.047123405118048,2.051486660382152,2.0727771553995797,2.108362045717242,2.1610791408039054,2.17833807739349,2.1980665746601815,2.224831781278446,2.2494925262749894,2.339745794604633,2.6349074346311347,3.220824582009868,4.497690255646355,6.096381723459474,7.908366895102497,9.706967656135495,11.325929687606958,12.305190346107993,13.06653091634116,13.881940701725458,14.379111853805275,14.506262096111566,14.695988361764616,14.80872566839704,14.877745905315328,14.88422052553767,14.91480413607956,14.899707307919341,14.937985013018842,14.937985013018842,14.990641114312112,14.9860898186546,14.9860898186546,14.9860898186546,14.9860898186546,14.9860898186546,15.005534918591245,15.025496055955177,15.071377095662994,15.093498720072617,15.126834263292393,15.14077262158633,15.168015762153734,15.255376039207558,15.324829938500892,15.462905621130167,15.662869726192065,15.794219080623597,16.041188274192,16.257850761513716,16.369697921780315,16.436582560547564,16.561805841579666,16.897568896487645,17.25114215880037,17.459711436795853,17.670947616023728,17.79751950761345,17.897134724799372,17.974202371944415,18.035508579196218,18.07503300918572,18.12568813708103,18.169928402023533,18.18298167572676,18.18298167572676,18.20647055944507,18.207877958644758,18.207877958644758,18.22651400723231,18.134455536926374,18.13602267842537,18.13602267842537,18.031778664997777,17.43631521224923,17.43631521224923,17.26398298057638,16.972131249186692)
minHPD=c(1.1501274926767537, 1.4412989753607985,1.6557066462519106,1.7658078761971123,1.8502615147100703,1.8800959295797703,1.8984517827859717,1.9092442983748887,1.9138358158083653,1.9206982567247561,1.9385556412446423,1.9473065842433108,1.9642940168645222,1.9888608089984556,2.014681826014337,2.0360494949962753,2.0360494949962753,2.035250299302341,2.0380107037543214,2.0378844179896403,2.0398967494267413,2.0439889001130824,2.047123405118048,2.051486660382152,2.0727771553995797,2.108362045717242,2.1610791408039054,2.17833807739349,2.1980665746601815,2.224831781278446,2.2494925262749894,2.339745794604633,2.6349074346311347,3.220824582009868,4.497690255646355,6.096381723459474,7.908366895102497,9.706967656135495,11.325929687606958,12.305190346107993,13.06653091634116,13.881940701725458,14.379111853805275,14.506262096111566,14.695988361764616,14.80872566839704,14.877745905315328,14.88422052553767,14.91480413607956,14.899707307919341,14.937985013018842,14.937985013018842,14.990641114312112,14.9860898186546,14.9860898186546,14.9860898186546,14.9860898186546,14.9860898186546,15.005534918591245,15.025496055955177,15.071377095662994,15.093498720072617,15.126834263292393,15.14077262158633,15.168015762153734,15.255376039207558,15.324829938500892,15.462905621130167,15.662869726192065,15.794219080623597,16.041188274192,16.257850761513716,16.369697921780315,16.436582560547564,16.561805841579666,16.897568896487645,17.25114215880037,17.459711436795853,17.670947616023728,17.79751950761345,17.897134724799372,17.974202371944415,18.035508579196218,18.07503300918572,18.12568813708103,18.169928402023533,18.18298167572676,18.18298167572676,18.20647055944507,18.207877958644758,18.207877958644758,18.22651400723231,18.134455536926374,18.13602267842537,18.13602267842537,18.031778664997777,17.43631521224923,17.43631521224923,17.26398298057638,16.972131249186692)
maxHPD=c(1.1501274926767537, 1.4412989753607985,1.6557066462519106,1.7658078761971123,1.8502615147100703,1.8800959295797703,1.8984517827859717,1.9092442983748887,1.9138358158083653,1.9206982567247561,1.9385556412446423,1.9473065842433108,1.9642940168645222,1.9888608089984556,2.014681826014337,2.0360494949962753,2.0360494949962753,2.035250299302341,2.0380107037543214,2.0378844179896403,2.0398967494267413,2.0439889001130824,2.047123405118048,2.051486660382152,2.0727771553995797,2.108362045717242,2.1610791408039054,2.17833807739349,2.1980665746601815,2.224831781278446,2.2494925262749894,2.339745794604633,2.6349074346311347,3.220824582009868,4.497690255646355,6.096381723459474,7.908366895102497,9.706967656135495,11.325929687606958,12.305190346107993,13.06653091634116,13.881940701725458,14.379111853805275,14.506262096111566,14.695988361764616,14.80872566839704,14.877745905315328,14.88422052553767,14.91480413607956,14.899707307919341,14.937985013018842,14.937985013018842,14.990641114312112,14.9860898186546,14.9860898186546,14.9860898186546,14.9860898186546,14.9860898186546,15.005534918591245,15.025496055955177,15.071377095662994,15.093498720072617,15.126834263292393,15.14077262158633,15.168015762153734,15.255376039207558,15.324829938500892,15.462905621130167,15.662869726192065,15.794219080623597,16.041188274192,16.257850761513716,16.369697921780315,16.436582560547564,16.561805841579666,16.897568896487645,17.25114215880037,17.459711436795853,17.670947616023728,17.79751950761345,17.897134724799372,17.974202371944415,18.035508579196218,18.07503300918572,18.12568813708103,18.169928402023533,18.18298167572676,18.18298167572676,18.20647055944507,18.207877958644758,18.207877958644758,18.22651400723231,18.134455536926374,18.13602267842537,18.13602267842537,18.031778664997777,17.43631521224923,17.43631521224923,17.26398298057638,16.972131249186692)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 20.04916540795554), xlim = c(-85.67777854065088,-66.05697749954143), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()