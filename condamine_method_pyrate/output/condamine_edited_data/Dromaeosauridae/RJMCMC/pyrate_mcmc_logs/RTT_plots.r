

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.49441468113187, -67.28284936091669,-68.0712840407015,-68.85971872048628,-69.6481534002711,-70.43658808005591,-71.2250227598407,-72.01345743962551,-72.80189211941033,-73.59032679919511,-74.37876147897992,-75.16719615876474,-75.95563083854955,-76.74406551833434,-77.53250019811915,-78.32093487790397,-79.10936955768875,-79.89780423747357,-80.68623891725838,-81.47467359704316,-82.26310827682798,-83.05154295661279,-83.83997763639758,-84.62841231618239,-85.4168469959672,-86.20528167575199,-86.9937163555368,-87.78215103532162,-88.5705857151064,-89.35902039489122,-90.14745507467603,-90.93588975446082,-91.72432443424563,-92.51275911403044,-93.30119379381523,-94.08962847360004,-94.87806315338486,-95.66649783316964,-96.45493251295446,-97.24336719273927,-98.03180187252406,-98.82023655230887,-99.60867123209368,-100.39710591187847,-101.18554059166328,-101.9739752714481,-102.76240995123288,-103.5508446310177,-104.33927931080251,-105.1277139905873,-105.91614867037211,-106.70458335015692,-107.49301802994171,-108.28145270972652,-109.06988738951134,-109.85832206929612,-110.64675674908094,-111.43519142886575,-112.22362610865054,-113.01206078843535,-113.80049546822016,-114.58893014800498,-115.37736482778976,-116.16579950757458,-116.95423418735939,-117.74266886714418,-118.53110354692899,-119.3195382267138,-120.10797290649859,-120.8964075862834,-121.68484226606822,-122.473276945853,-123.26171162563782,-124.05014630542263,-124.83858098520741,-125.62701566499223,-126.41545034477704,-127.20388502456183,-127.99231970434664,-128.78075438413146,-129.56918906391624,-130.35762374370105,-131.14605842348584,-131.93449310327065,-132.72292778305547,-133.51136246284028,-134.2997971426251,-135.08823182240988,-135.87666650219467,-136.66510118197948,-137.4535358617643,-138.2419705415491,-139.03040522133392,-139.8188399011187,-140.6072745809035,-141.3957092606883,-142.18414394047312,-142.97257862025793,-143.76101330004275,-144.54944797982753)
rate=c(0.36162509643259777, 0.3614972380308245,0.361598362840703,0.36126126117732205,0.3614972380308245,0.361598362840703,0.3614972380308245,0.3620263542442451,0.36177485600779535,0.36162509643259777,0.36162509643259777,0.36162509643259777,0.361598362840703,0.36162509643259777,0.36162509643259777,0.36162509643259777,0.36162509643259777,0.3620263542442451,0.3620263542442451,0.3621544454228025,0.36246755123244456,0.3628502059894789,0.36386765978692037,0.36386765978692037,0.3637914736955497,0.3637914736955497,0.36386765978692037,0.3642848404144968,0.3642848404144968,0.36433937171553776,0.364446394548921,0.364446394548921,0.36452114248061257,0.3649415572851979,0.3649415572851979,0.36505513250252075,0.36505513250252075,0.36505513250252075,0.36505513250252075,0.36544374908010413,0.36544374908010413,0.36561194342151015,0.36584532455753277,0.3657962857602416,0.36584532455753277,0.36584532455753277,0.3659088437676006,0.3659088437676006,0.3660146474404812,0.36663295387518213,0.36663295387518213,0.3670763905415108,0.3670763905415108,0.366998800344142,0.366998800344142,0.3670763905415108,0.3673056775999469,0.3674591710762283,0.3676231195592022,0.3684843877643851,0.36860432033171686,0.36978046691537414,0.37041541736820127,0.37085435843603615,0.3714289414544077,0.37227532558337617,0.3727189680123695,0.37347599242558965,0.3744645841194485,0.37458678836806486,0.375377577207548,0.37588441349256185,0.3765540895099846,0.3767514819423322,0.3777913879690714,0.37806895107638405,0.3785476942623292,0.3785476942623292,0.3787160127860876,0.37886987239627146,0.37886987239627146,0.3789742215698732,0.3789742215698732,0.37886987239627146,0.3787160127860876,0.3785476942623292,0.3787160127860876,0.37886987239627146,0.3787160127860876,0.3787160127860876,0.3787160127860876,0.37886987239627146,0.3789742215698732,0.3802403973743117,0.3808042028089713,0.3808042028089713,0.3808042028089713,0.3804350296459833,0.38176359763979767,0.38242770224181133)
minHPD=c(0.24965788286633048, 0.24912565942277015,0.24912565942277015,0.24912565942277015,0.25219655406534536,0.2548552964762867,0.2548552964762867,0.25219655406534536,0.25401015420210576,0.25401015420210576,0.2548552964762867,0.2548552964762867,0.2557215007501924,0.2557215007501924,0.2557215007501924,0.2557215007501924,0.2557215007501924,0.2557215007501924,0.2557215007501924,0.2557215007501924,0.25678277100805535,0.25588821354581637,0.25219655406534536,0.25219655406534536,0.25219655406534536,0.25219655406534536,0.25401015420210576,0.25219655406534536,0.2557215007501924,0.2548552964762867,0.2557215007501924,0.2548552964762867,0.2548552964762867,0.2548552964762867,0.25401015420210576,0.25304583017437393,0.25304583017437393,0.25304583017437393,0.25304583017437393,0.25304583017437393,0.25219655406534536,0.25219655406534536,0.25219655406534536,0.24912565942277015,0.24912565942277015,0.24912565942277015,0.24912565942277015,0.24912565942277015,0.24912565942277015,0.25011762376347596,0.25011762376347596,0.25401015420210576,0.25401015420210576,0.25401015420210576,0.248993096607265,0.248993096607265,0.248993096607265,0.248993096607265,0.248993096607265,0.248993096607265,0.248993096607265,0.25588821354581637,0.248993096607265,0.248993096607265,0.2411691043329964,0.24912565942277015,0.24912565942277015,0.248993096607265,0.248993096607265,0.248993096607265,0.248993096607265,0.248993096607265,0.248993096607265,0.248993096607265,0.25219655406534536,0.248993096607265,0.248993096607265,0.248993096607265,0.248993096607265,0.2462504534604395,0.2462504534604395,0.2462504534604395,0.248993096607265,0.248993096607265,0.248993096607265,0.2462504534604395,0.248993096607265,0.2462504534604395,0.2462504534604395,0.248993096607265,0.248993096607265,0.24854522041093063,0.24854522041093063,0.24854522041093063,0.24854522041093063,0.24854522041093063,0.24854522041093063,0.24854522041093063,0.248993096607265,0.24854522041093063)
maxHPD=c(0.4819720710842633, 0.4775581318202611,0.4764668304315475,0.4755840486014857,0.4775581318202611,0.4775581318202611,0.4775581318202611,0.47375152144139643,0.47470575585116426,0.47375152144139643,0.47375152144139643,0.47375152144139643,0.47375152144139643,0.47375152144139643,0.47375152144139643,0.47375152144139643,0.47375152144139643,0.47375152144139643,0.47375152144139643,0.47375152144139643,0.47375152144139643,0.47375152144139643,0.47375152144139643,0.47470575585116426,0.47470575585116426,0.47470575585116426,0.4775581318202611,0.4775581318202611,0.4819720710842633,0.4819720710842633,0.48338736805384047,0.4819720710842633,0.4819720710842633,0.4819720710842633,0.4819720710842633,0.4819720710842633,0.4819720710842633,0.4819720710842633,0.4819720710842633,0.4819720710842633,0.4819720710842633,0.4845909393869218,0.48846393410420963,0.48846393410420963,0.49301309912529495,0.49301309912529495,0.49429768763239645,0.49429768763239645,0.49429768763239645,0.49846825217009655,0.49846825217009655,0.504383899082282,0.5032283455544266,0.5032283455544266,0.5004838722670767,0.5004838722670767,0.5019232972169072,0.5030699728543124,0.5030699728543124,0.504383899082282,0.504383899082282,0.5148824664489431,0.513058927137014,0.5145303352723245,0.5148824664489431,0.5401340780888152,0.5401340780888152,0.54814892598934,0.5496932928036208,0.5588046942222773,0.5637667704899681,0.5663146345501655,0.5722647162997615,0.5748042488376675,0.6001261491317791,0.6021174436492579,0.6021174436492579,0.6118546300298865,0.6153647368130557,0.6322066729116524,0.6322066729116524,0.6370960008760662,0.6417871205838228,0.6417871205838228,0.6417871205838228,0.6417871205838228,0.6483614670583564,0.6417871205838228,0.6483614670583564,0.6535210678230707,0.6589978133587909,0.6660576624779372,0.6689207232735854,0.682549454491572,0.6893464060527013,0.6893464060527013,0.7058216460771737,0.7096332716182139,0.7252810675080983,0.7281740527267899)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.800991457999469), xlim = c(-144.94366531971994,-66.10019734123948), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.49839667446412, -67.29479534091342,-68.09119400736273,-68.88759267381204,-69.68399134026131,-70.48039000671062,-71.27678867315993,-72.0731873396092,-72.86958600605851,-73.66598467250782,-74.4623833389571,-75.2587820054064,-76.05518067185571,-76.85157933830499,-77.6479780047543,-78.4443766712036,-79.24077533765288,-80.03717400410218,-80.83357267055149,-81.6299713370008,-82.42637000345007,-83.22276866989938,-84.01916733634869,-84.81556600279796,-85.61196466924727,-86.40836333569658,-87.20476200214586,-88.00116066859516,-88.79755933504447,-89.59395800149375,-90.39035666794305,-91.18675533439236,-91.98315400084167,-92.77955266729094,-93.57595133374025,-94.37235000018956,-95.16874866663883,-95.96514733308814,-96.76154599953745,-97.55794466598672,-98.35434333243603,-99.15074199888534,-99.94714066533462,-100.74353933178392,-101.53993799823323,-102.3363366646825,-103.13273533113181,-103.92913399758112,-104.72553266403042,-105.5219313304797,-106.31832999692901,-107.11472866337832,-107.9111273298276,-108.7075259962769,-109.5039246627262,-110.30032332917548,-111.09672199562479,-111.8931206620741,-112.68951932852337,-113.48591799497268,-114.28231666142199,-115.07871532787127,-115.87511399432057,-116.67151266076988,-117.46791132721918,-118.26430999366846,-119.06070866011777,-119.85710732656707,-120.65350599301635,-121.44990465946566,-122.24630332591497,-123.04270199236424,-123.83910065881355,-124.63549932526286,-125.43189799171213,-126.22829665816144,-127.02469532461075,-127.82109399106005,-128.61749265750933,-129.41389132395864,-130.21028999040792,-131.00668865685722,-131.80308732330653,-132.59948598975583,-133.39588465620514,-134.19228332265442,-134.9886819891037,-135.785080655553,-136.5814793220023,-137.37787798845162,-138.17427665490092,-138.9706753213502,-139.7670739877995,-140.56347265424878,-141.3598713206981,-142.1562699871474,-142.9526686535967,-143.749067320046,-144.5454659864953)
counts=c(0.004, 0.003,0.005,0.002,0.005,0.002,0.004,0.001,0.003,0.002,0.001,0.001,0.001,0.002,0.002,0.0,0.002,0.0,0.002,0.008,0.004,0.007,0.002,0.002,0.0,0.004,0.003,0.002,0.002,0.002,0.002,0.001,0.003,0.001,0.002,0.0,0.002,0.001,0.003,0.005,0.006,0.003,0.007,0.002,0.004,0.003,0.0,0.003,0.003,0.001,0.005,0.002,0.003,0.004,0.002,0.004,0.002,0.005,0.002,0.007,0.007,0.006,0.002,0.006,0.006,0.005,0.003,0.004,0.007,0.008,0.005,0.005,0.004,0.01,0.004,0.003,0.004,0.004,0.003,0.001,0.004,0.001,0.003,0.002,0.003,0.005,0.006,0.006,0.002,0.004,0.002,0.008,0.007,0.001,0.006,0.005,0.006,0.004,0.0)
plot(mids,counts,type = 'h', xlim = c(-144.94366531971994,-66.10019734123948), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.033423156826484654
bf6 = 0.20350799108182777
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.49441468113187, -67.28284936091669,-68.0712840407015,-68.85971872048628,-69.6481534002711,-70.43658808005591,-71.2250227598407,-72.01345743962551,-72.80189211941033,-73.59032679919511,-74.37876147897992,-75.16719615876474,-75.95563083854955,-76.74406551833434,-77.53250019811915,-78.32093487790397,-79.10936955768875,-79.89780423747357,-80.68623891725838,-81.47467359704316,-82.26310827682798,-83.05154295661279,-83.83997763639758,-84.62841231618239,-85.4168469959672,-86.20528167575199,-86.9937163555368,-87.78215103532162,-88.5705857151064,-89.35902039489122,-90.14745507467603,-90.93588975446082,-91.72432443424563,-92.51275911403044,-93.30119379381523,-94.08962847360004,-94.87806315338486,-95.66649783316964,-96.45493251295446,-97.24336719273927,-98.03180187252406,-98.82023655230887,-99.60867123209368,-100.39710591187847,-101.18554059166328,-101.9739752714481,-102.76240995123288,-103.5508446310177,-104.33927931080251,-105.1277139905873,-105.91614867037211,-106.70458335015692,-107.49301802994171,-108.28145270972652,-109.06988738951134,-109.85832206929612,-110.64675674908094,-111.43519142886575,-112.22362610865054,-113.01206078843535,-113.80049546822016,-114.58893014800498,-115.37736482778976,-116.16579950757458,-116.95423418735939,-117.74266886714418,-118.53110354692899,-119.3195382267138,-120.10797290649859,-120.8964075862834,-121.68484226606822,-122.473276945853,-123.26171162563782,-124.05014630542263,-124.83858098520741,-125.62701566499223,-126.41545034477704,-127.20388502456183,-127.99231970434664,-128.78075438413146,-129.56918906391624,-130.35762374370105,-131.14605842348584,-131.93449310327065,-132.72292778305547,-133.51136246284028,-134.2997971426251,-135.08823182240988,-135.87666650219467,-136.66510118197948,-137.4535358617643,-138.2419705415491,-139.03040522133392,-139.8188399011187,-140.6072745809035,-141.3957092606883,-142.18414394047312,-142.97257862025793,-143.76101330004275,-144.54944797982753)
rate=c(0.3782130761844126, 0.37364395351401347,0.3733610278034897,0.3726347637275308,0.37242144028514046,0.3710405428667622,0.369027364495334,0.36488503100195,0.364134532173113,0.36387095086928584,0.3629498037633625,0.3629498037633625,0.3629498037633625,0.36103371545008256,0.35993028909201263,0.35993028909201263,0.35988544195766237,0.35988544195766237,0.35988544195766237,0.3598267333936494,0.35988544195766237,0.35988544195766237,0.35993028909201263,0.35993028909201263,0.3599745512004764,0.35993028909201263,0.35993028909201263,0.3600011322674897,0.3600011322674897,0.3599745512004764,0.3599745512004764,0.3599745512004764,0.3599745512004764,0.3600011322674897,0.36010474815751603,0.3602051871818578,0.3602051871818578,0.3602051871818578,0.3602051871818578,0.36039092664959277,0.36056744078546177,0.3608317733840415,0.3608317733840415,0.3608317733840415,0.3613677554132432,0.36277772724346646,0.36313260027465066,0.3638744503025615,0.3640059807242092,0.36407472238009625,0.3642780316474305,0.36450049477051905,0.364629916371445,0.36488503100195,0.36548515081138355,0.36548515081138355,0.36548515081138355,0.36548515081138355,0.36584380605040645,0.3660726332560795,0.36646213968431457,0.36664963468858236,0.36685139289318947,0.36705668409353953,0.3669970829355552,0.36705668409353953,0.36731450441993696,0.3673835587148429,0.36804262564579704,0.36825303946299753,0.36870245957131087,0.369072549669433,0.369072549669433,0.369072549669433,0.3691583603542372,0.36981898536147273,0.3702839599546562,0.3707580670922005,0.3707580670922005,0.3707580670922005,0.3707580670922005,0.3706999158541605,0.3701922070892141,0.37048469968496994,0.3701922070892141,0.3701922070892141,0.3701922070892141,0.3701922070892141,0.36954952018251985,0.36908938180445916,0.3689509950713036,0.36804262564579704,0.36773541049616454,0.36804262564579704,0.36804262564579704,0.36804262564579704,0.36804262564579704,0.36773541049616454,0.36804262564579704,0.36825303946299753)
minHPD=c(0.2219443462240634, 0.2219443462240634,0.2219443462240634,0.22858287208886793,0.22858287208886793,0.22483683338966967,0.2219443462240634,0.2588425817769592,0.2576121100932604,0.2576121100932604,0.2576121100932604,0.2576121100932604,0.24429917714116361,0.2562967600101038,0.2562967600101038,0.2562967600101038,0.25843057951174864,0.25843057951174864,0.25843057951174864,0.2588425817769592,0.2588425817769592,0.2588425817769592,0.2588425817769592,0.2562967600101038,0.25843057951174864,0.2588425817769592,0.2562967600101038,0.2562967600101038,0.2562967600101038,0.2562967600101038,0.2562967600101038,0.2562967600101038,0.2562967600101038,0.2562967600101038,0.2588425817769592,0.2588425817769592,0.2588425817769592,0.2588425817769592,0.25843057951174864,0.2562967600101038,0.2504311253271911,0.24429917714116361,0.2562967600101038,0.2562967600101038,0.2358744655274707,0.2576121100932604,0.2576121100932604,0.25843057951174864,0.2576121100932604,0.2576121100932604,0.2576121100932604,0.2504311253271911,0.2576121100932604,0.2576121100932604,0.2480015886294433,0.2480015886294433,0.2480015886294433,0.2480015886294433,0.2588425817769592,0.2588425817769592,0.2588425817769592,0.2522561903202306,0.2522561903202306,0.2576121100932604,0.2480015886294433,0.2480015886294433,0.2480015886294433,0.2480015886294433,0.24036075655704212,0.24036075655704212,0.2373432066246759,0.2588425817769592,0.2480015886294433,0.2480015886294433,0.25020796912453847,0.24429917714116361,0.2480015886294433,0.2479382576839929,0.2479382576839929,0.2479382576839929,0.24429917714116361,0.2479382576839929,0.2479382576839929,0.2479382576839929,0.2408300007571931,0.24036075655704212,0.2214148224015107,0.2408300007571931,0.2214148224015107,0.21810918997964107,0.2214148224015107,0.21810918997964107,0.21810918997964107,0.2214148224015107,0.22187470484406244,0.2214148224015107,0.2214148224015107,0.21810918997964107,0.2214148224015107,0.2214148224015107)
maxHPD=c(1.0811706490777293, 0.8039447310283283,0.7799347599812734,0.7799347599812734,0.778206524076055,0.6992760139962773,0.5815274235942672,0.5260149999487704,0.5146831486257589,0.5128709989338621,0.5146831486257589,0.5146831486257589,0.49973179799446904,0.5014268689704136,0.4981721890688277,0.4981721890688277,0.4981721890688277,0.4981721890688277,0.4981721890688277,0.4981721890688277,0.4981721890688277,0.4981721890688277,0.4981721890688277,0.49261901277839704,0.4981721890688277,0.4981721890688277,0.49261901277839704,0.49261901277839704,0.49261901277839704,0.49261901277839704,0.49261901277839704,0.49261901277839704,0.49261901277839704,0.49261901277839704,0.4981721890688277,0.4981721890688277,0.4981721890688277,0.4981721890688277,0.4981721890688277,0.4981721890688277,0.4981721890688277,0.4981721890688277,0.5146831486257589,0.5146831486257589,0.4981721890688277,0.5186275384734974,0.5228888375271804,0.5228888375271804,0.5228888375271804,0.5274909292097394,0.5228888375271804,0.5146831486257589,0.5228888375271804,0.5274909292097394,0.5228888375271804,0.5228888375271804,0.5228888375271804,0.5228888375271804,0.5336672853498632,0.5336672853498632,0.5336672853498632,0.5341432072705624,0.5341432072705624,0.5427812345962143,0.5341432072705624,0.5341432072705624,0.5341432072705624,0.5427812345962143,0.5427812345962143,0.5427812345962143,0.5427812345962143,0.5680369899214784,0.5608434392157747,0.5608434392157747,0.5680369899214784,0.5680369899214784,0.5883754079496002,0.5963501326995284,0.5983045669070113,0.6058473976781547,0.6058473976781547,0.6150204643992092,0.6153092309343106,0.6153092309343106,0.6153092309343106,0.6153092309343106,0.5983045669070113,0.6153092309343106,0.5983045669070113,0.5983045669070113,0.5963501326995284,0.590606604721166,0.6050419386556999,0.6143569078030657,0.6153092309343106,0.6153092309343106,0.6153092309343106,0.6153092309343106,0.6227828525825003,0.62900138294995)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.1892877139855023), xlim = c(-144.94366531971994,-66.10019734123948), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.49839667446412, -67.29479534091342,-68.09119400736273,-68.88759267381204,-69.68399134026131,-70.48039000671062,-71.27678867315993,-72.0731873396092,-72.86958600605851,-73.66598467250782,-74.4623833389571,-75.2587820054064,-76.05518067185571,-76.85157933830499,-77.6479780047543,-78.4443766712036,-79.24077533765288,-80.03717400410218,-80.83357267055149,-81.6299713370008,-82.42637000345007,-83.22276866989938,-84.01916733634869,-84.81556600279796,-85.61196466924727,-86.40836333569658,-87.20476200214586,-88.00116066859516,-88.79755933504447,-89.59395800149375,-90.39035666794305,-91.18675533439236,-91.98315400084167,-92.77955266729094,-93.57595133374025,-94.37235000018956,-95.16874866663883,-95.96514733308814,-96.76154599953745,-97.55794466598672,-98.35434333243603,-99.15074199888534,-99.94714066533462,-100.74353933178392,-101.53993799823323,-102.3363366646825,-103.13273533113181,-103.92913399758112,-104.72553266403042,-105.5219313304797,-106.31832999692901,-107.11472866337832,-107.9111273298276,-108.7075259962769,-109.5039246627262,-110.30032332917548,-111.09672199562479,-111.8931206620741,-112.68951932852337,-113.48591799497268,-114.28231666142199,-115.07871532787127,-115.87511399432057,-116.67151266076988,-117.46791132721918,-118.26430999366846,-119.06070866011777,-119.85710732656707,-120.65350599301635,-121.44990465946566,-122.24630332591497,-123.04270199236424,-123.83910065881355,-124.63549932526286,-125.43189799171213,-126.22829665816144,-127.02469532461075,-127.82109399106005,-128.61749265750933,-129.41389132395864,-130.21028999040792,-131.00668865685722,-131.80308732330653,-132.59948598975583,-133.39588465620514,-134.19228332265442,-134.9886819891037,-135.785080655553,-136.5814793220023,-137.37787798845162,-138.17427665490092,-138.9706753213502,-139.7670739877995,-140.56347265424878,-141.3598713206981,-142.1562699871474,-142.9526686535967,-143.749067320046,-144.5454659864953)
counts=c(0.04, 0.003,0.006,0.004,0.013,0.03,0.035,0.01,0.005,0.007,0.0,0.002,0.014,0.008,0.004,0.0,0.002,0.001,0.001,0.001,0.0,0.001,0.001,0.005,0.002,0.006,0.001,0.001,0.0,0.002,0.002,0.001,0.001,0.001,0.002,0.001,0.0,0.003,0.002,0.003,0.005,0.003,0.001,0.009,0.004,0.005,0.007,0.003,0.004,0.006,0.003,0.003,0.008,0.002,0.003,0.001,0.002,0.003,0.004,0.005,0.004,0.004,0.002,0.001,0.003,0.005,0.002,0.006,0.002,0.002,0.003,0.004,0.004,0.006,0.004,0.006,0.002,0.002,0.005,0.004,0.003,0.002,0.003,0.004,0.002,0.002,0.007,0.004,0.002,0.005,0.003,0.005,0.001,0.001,0.001,0.003,0.002,0.004,0.002)
plot(mids,counts,type = 'h', xlim = c(-144.94366531971994,-66.10019734123948), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.49441468113187, -67.28284936091669,-68.0712840407015,-68.85971872048628,-69.6481534002711,-70.43658808005591,-71.2250227598407,-72.01345743962551,-72.80189211941033,-73.59032679919511,-74.37876147897992,-75.16719615876474,-75.95563083854955,-76.74406551833434,-77.53250019811915,-78.32093487790397,-79.10936955768875,-79.89780423747357,-80.68623891725838,-81.47467359704316,-82.26310827682798,-83.05154295661279,-83.83997763639758,-84.62841231618239,-85.4168469959672,-86.20528167575199,-86.9937163555368,-87.78215103532162,-88.5705857151064,-89.35902039489122,-90.14745507467603,-90.93588975446082,-91.72432443424563,-92.51275911403044,-93.30119379381523,-94.08962847360004,-94.87806315338486,-95.66649783316964,-96.45493251295446,-97.24336719273927,-98.03180187252406,-98.82023655230887,-99.60867123209368,-100.39710591187847,-101.18554059166328,-101.9739752714481,-102.76240995123288,-103.5508446310177,-104.33927931080251,-105.1277139905873,-105.91614867037211,-106.70458335015692,-107.49301802994171,-108.28145270972652,-109.06988738951134,-109.85832206929612,-110.64675674908094,-111.43519142886575,-112.22362610865054,-113.01206078843535,-113.80049546822016,-114.58893014800498,-115.37736482778976,-116.16579950757458,-116.95423418735939,-117.74266886714418,-118.53110354692899,-119.3195382267138,-120.10797290649859,-120.8964075862834,-121.68484226606822,-122.473276945853,-123.26171162563782,-124.05014630542263,-124.83858098520741,-125.62701566499223,-126.41545034477704,-127.20388502456183,-127.99231970434664,-128.78075438413146,-129.56918906391624,-130.35762374370105,-131.14605842348584,-131.93449310327065,-132.72292778305547,-133.51136246284028,-134.2997971426251,-135.08823182240988,-135.87666650219467,-136.66510118197948,-137.4535358617643,-138.2419705415491,-139.03040522133392,-139.8188399011187,-140.6072745809035,-141.3957092606883,-142.18414394047312,-142.97257862025793,-143.76101330004275,-144.54944797982753)
net_rate=c(-0.11713811927981858, -0.05594988141367254,-0.05399328303264018,-0.053628556906268915,-0.05195957029115041,-0.04358199738071065,-0.027685586386665715,-0.010564733524860245,-0.007860961719218547,-0.006809295172965491,-0.005824594122598028,-0.005776412025028997,-0.00555283422955027,-0.0018233970784181188,0.0013710628917041586,0.0018332763061725068,0.0022059020991107687,0.0025991919130687524,0.0025991919130687524,0.002662341643357517,0.0032462171173799383,0.003684069008746203,0.005765370036734681,0.005774808178591862,0.004785076913774692,0.004672205959632404,0.004476335403951855,0.004352415152216052,0.00451259078977873,0.004862822711672721,0.005453449528357049,0.005543508616490326,0.005645347723864504,0.005780446356052038,0.005486055930037464,0.005550406760939998,0.0054659525239945175,0.005552558793177062,0.005353143332784225,0.0056318042334957685,0.005331485378452924,0.005261008435611648,0.006035256173940142,0.005934319034668586,0.004785146860398263,0.00383196754711272,0.0035763203540937686,0.0031201815664059023,0.002657760477079027,0.0030139322860727436,0.0023296322261770496,0.0025990948627330184,0.001896514885454148,0.0006403579226465868,-0.0012182709581138376,-0.0006861311067794755,-0.0003258689363288924,-0.00021038148558548858,-6.479699639557291e-05,0.0014568492841700686,0.0006614784408492651,0.0015813113618939239,0.002737468195023636,0.002743272674261566,0.0032308363467748063,0.0052045632962867,0.005490935712098809,0.005619477526129827,0.005210169808598608,0.005745296079352947,0.007797565641665716,0.008453529731440697,0.009622338540100467,0.009509509067540578,0.01098716214306725,0.012583165171533869,0.010602400800462944,0.010008823115596359,0.009322534071849754,0.008959133178519688,0.009118550488297012,0.009800120017973521,0.010230788201239308,0.009966962554050357,0.010668501096042221,0.010542144022143044,0.009623246826762775,0.010302675152480768,0.012059135633457013,0.012372498068168062,0.01347328172232618,0.014790033145387517,0.016507212564093186,0.01926171920460915,0.021868587514910873,0.02214486026285678,0.022661369639690437,0.022620745768125713,0.024827010636705577,0.024576267913373362)
net_minHPD=c(-0.7763808165019197, -0.51270174143853,-0.4411790696353623,-0.4391349768890113,-0.3950848554788431,-0.33815843870037,-0.29835553359294287,-0.21167695233892758,-0.18509490621433544,-0.17725968303613596,-0.17725968303613596,-0.17725968303613596,-0.17725968303613596,-0.1631990752889802,-0.16617131647661554,-0.1631990752889802,-0.16169439519533335,-0.16169439519533335,-0.16169439519533335,-0.16169439519533335,-0.16169439519533335,-0.16230543937246256,-0.1631990752889802,-0.1631990752889802,-0.16617131647661554,-0.1631990752889802,-0.1631990752889802,-0.1631990752889802,-0.1631990752889802,-0.1631990752889802,-0.16617131647661554,-0.16617131647661554,-0.16617131647661554,-0.1631990752889802,-0.1631990752889802,-0.16617131647661554,-0.1505219158384783,-0.1505219158384783,-0.1505219158384783,-0.15342038577185546,-0.15342038577185546,-0.1631990752889802,-0.16836045787431525,-0.16836045787431525,-0.17725968303613596,-0.17725968303613596,-0.17725968303613596,-0.17725968303613596,-0.17725968303613596,-0.20047283403308047,-0.20047283403308047,-0.20047283403308047,-0.1968585541869292,-0.20047283403308047,-0.20047283403308047,-0.20047283403308047,-0.20047283403308047,-0.2047459883861722,-0.20047283403308047,-0.20047283403308047,-0.20047283403308047,-0.21942601283625957,-0.22264339967854918,-0.2327291374223749,-0.2501680087271433,-0.22090145119677063,-0.2327291374223749,-0.20047283403308047,-0.2047459883861722,-0.272049079856794,-0.2047459883861722,-0.22090145119677063,-0.22090145119677063,-0.23507341458130399,-0.22090145119677063,-0.2501680087271433,-0.2501680087271433,-0.2501680087271433,-0.2501680087271433,-0.2501680087271433,-0.2501680087271433,-0.24810754204510072,-0.24810754204510072,-0.24810754204510072,-0.24810754204510072,-0.25664677775797456,-0.24810754204510072,-0.2501680087271433,-0.24810754204510072,-0.2501680087271433,-0.24507020806075291,-0.2501680087271433,-0.24810754204510072,-0.24810754204510072,-0.25664677775797456,-0.2501680087271433,-0.2501680087271433,-0.25664677775797456,-0.27036287177726703,-0.27036287177726703)
net_maxHPD=c(0.21571009024035764, 0.17692735556922384,0.20179891267654332,0.18612823700442438,0.21301749685933277,0.20179891267654332,0.15780130476768323,0.15098263792141137,0.15780130476768323,0.15780130476768323,0.15780130476768323,0.15780130476768323,0.15610026729126936,0.15780130476768323,0.15105597048353722,0.15105597048353722,0.15105597048353722,0.15105597048353722,0.15105597048353722,0.15105597048353722,0.15105597048353722,0.15105597048353722,0.15610026729126936,0.15780130476768323,0.15780130476768323,0.15780130476768323,0.15780130476768323,0.15610026729126936,0.15780130476768323,0.15610026729126936,0.15105597048353722,0.15105597048353722,0.15105597048353722,0.15610026729126936,0.15780130476768323,0.15780130476768323,0.17398772395672413,0.17398772395672413,0.17570382639275872,0.17398772395672413,0.17692735556922384,0.17692735556922384,0.17950635309089127,0.18132986364158243,0.18132986364158243,0.18612823700442438,0.18992001808138403,0.18992001808138403,0.19141345541884092,0.174515597991745,0.17398772395672413,0.17398772395672413,0.17692735556922384,0.17398772395672413,0.17398772395672413,0.17530328345026347,0.17692735556922384,0.17692735556922384,0.1827861076960431,0.18612823700442438,0.18992001808138403,0.19141345541884092,0.19609236481493653,0.19141345541884092,0.19141345541884092,0.22801955041325334,0.21878872454900455,0.27681588762774106,0.2828876350734217,0.21878872454900455,0.29614443722714384,0.2944558740313971,0.29614443722714384,0.28940142718426765,0.3146833858327544,0.31260113334454726,0.3146833858327544,0.31855874729770545,0.31855874729770545,0.34178539641971134,0.34178539641971134,0.34178539641971134,0.34178539641971134,0.34178539641971134,0.34178539641971134,0.34178539641971134,0.34178539641971134,0.33093808199444313,0.34178539641971134,0.34178539641971134,0.34178539641971134,0.33093808199444313,0.34178539641971134,0.3573890540726747,0.3608333212494858,0.37730701841030145,0.3795611203610882,0.3897253021944105,0.4018116915977857,0.4295585602440645)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-0.8540188981521117, 0.472514416268471), xlim = c(-144.94366531971994,-66.10019734123948), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.49441468113187, -67.28284936091669,-68.0712840407015,-68.85971872048628,-69.6481534002711,-70.43658808005591,-71.2250227598407,-72.01345743962551,-72.80189211941033,-73.59032679919511,-74.37876147897992,-75.16719615876474,-75.95563083854955,-76.74406551833434,-77.53250019811915,-78.32093487790397,-79.10936955768875,-79.89780423747357,-80.68623891725838,-81.47467359704316,-82.26310827682798,-83.05154295661279,-83.83997763639758,-84.62841231618239,-85.4168469959672,-86.20528167575199,-86.9937163555368,-87.78215103532162,-88.5705857151064,-89.35902039489122,-90.14745507467603,-90.93588975446082,-91.72432443424563,-92.51275911403044,-93.30119379381523,-94.08962847360004,-94.87806315338486,-95.66649783316964,-96.45493251295446,-97.24336719273927,-98.03180187252406,-98.82023655230887,-99.60867123209368,-100.39710591187847,-101.18554059166328,-101.9739752714481,-102.76240995123288,-103.5508446310177,-104.33927931080251,-105.1277139905873,-105.91614867037211,-106.70458335015692,-107.49301802994171,-108.28145270972652,-109.06988738951134,-109.85832206929612,-110.64675674908094,-111.43519142886575,-112.22362610865054,-113.01206078843535,-113.80049546822016,-114.58893014800498,-115.37736482778976,-116.16579950757458,-116.95423418735939,-117.74266886714418,-118.53110354692899,-119.3195382267138,-120.10797290649859,-120.8964075862834,-121.68484226606822,-122.473276945853,-123.26171162563782,-124.05014630542263,-124.83858098520741,-125.62701566499223,-126.41545034477704,-127.20388502456183,-127.99231970434664,-128.78075438413146,-129.56918906391624,-130.35762374370105,-131.14605842348584,-131.93449310327065,-132.72292778305547,-133.51136246284028,-134.2997971426251,-135.08823182240988,-135.87666650219467,-136.66510118197948,-137.4535358617643,-138.2419705415491,-139.03040522133392,-139.8188399011187,-140.6072745809035,-141.3957092606883,-142.18414394047312,-142.97257862025793,-143.76101330004275,-144.54944797982753)
rate=c(2.0665631449084634, 2.376465749324535,2.393176673072625,2.4036066274401637,2.410894245198392,2.457423501214093,2.559145469275075,2.6701305963053668,2.691161962478935,2.7008571689932355,2.7101619864561846,2.7101619864561846,2.7138458603106623,2.7409776027493353,2.7660658222823167,2.769373865050489,2.772234645237358,2.772558958788113,2.772558958788113,2.7726349119074283,2.7715849171431883,2.7715849171431883,2.7707483099241808,2.7695758719684482,2.7658539818118077,2.764990794327658,2.7631850200265613,2.7595887688076215,2.7595887688076215,2.7597792856763306,2.759428592185878,2.759428592185878,2.7597129869065475,2.757184965856604,2.7557281260002995,2.754384232931175,2.75374365868219,2.75374365868219,2.7522470287398324,2.749765933587685,2.7453802392290805,2.739217385984387,2.7350201577311344,2.7350201577311344,2.7213568645083206,2.7116503254367617,2.7070084947619777,2.703670079804498,2.6994667837104163,2.6958457541499063,2.691266313049061,2.687549256899908,2.6856930205143046,2.6775031178877127,2.6682436839838704,2.6682436839838704,2.6659264263002473,2.6651589984582884,2.6615312151074546,2.65627826484597,2.650208362475296,2.6451879242665406,2.6415289081161144,2.637571765720835,2.634167740421506,2.6334668095120413,2.628259686475592,2.6215260347734386,2.6138958481976835,2.6119145235652232,2.6099540700495067,2.606636970498048,2.605198690174061,2.5990897723552124,2.586422427520073,2.57548384946282,2.559853377162014,2.5520180423303787,2.543801604934313,2.5297488733416094,2.5304257637168184,2.5342996769798383,2.537181648300015,2.536488854666936,2.545885118847779,2.5464471316270587,2.5465823119276356,2.5512622402043377,2.575662173131309,2.5764812764937624,2.583157539876427,2.589413560139261,2.5927111855724947,2.5889385241761476,2.5902284872408328,2.591313479044381,2.591313479044381,2.5857053972398787,2.5805109519505933,2.5657718220581813)
minHPD=c(2.0665631449084634, 2.376465749324535,2.393176673072625,2.4036066274401637,2.410894245198392,2.457423501214093,2.559145469275075,2.6701305963053668,2.691161962478935,2.7008571689932355,2.7101619864561846,2.7101619864561846,2.7138458603106623,2.7409776027493353,2.7660658222823167,2.769373865050489,2.772234645237358,2.772558958788113,2.772558958788113,2.7726349119074283,2.7715849171431883,2.7715849171431883,2.7707483099241808,2.7695758719684482,2.7658539818118077,2.764990794327658,2.7631850200265613,2.7595887688076215,2.7595887688076215,2.7597792856763306,2.759428592185878,2.759428592185878,2.7597129869065475,2.757184965856604,2.7557281260002995,2.754384232931175,2.75374365868219,2.75374365868219,2.7522470287398324,2.749765933587685,2.7453802392290805,2.739217385984387,2.7350201577311344,2.7350201577311344,2.7213568645083206,2.7116503254367617,2.7070084947619777,2.703670079804498,2.6994667837104163,2.6958457541499063,2.691266313049061,2.687549256899908,2.6856930205143046,2.6775031178877127,2.6682436839838704,2.6682436839838704,2.6659264263002473,2.6651589984582884,2.6615312151074546,2.65627826484597,2.650208362475296,2.6451879242665406,2.6415289081161144,2.637571765720835,2.634167740421506,2.6334668095120413,2.628259686475592,2.6215260347734386,2.6138958481976835,2.6119145235652232,2.6099540700495067,2.606636970498048,2.605198690174061,2.5990897723552124,2.586422427520073,2.57548384946282,2.559853377162014,2.5520180423303787,2.543801604934313,2.5297488733416094,2.5304257637168184,2.5342996769798383,2.537181648300015,2.536488854666936,2.545885118847779,2.5464471316270587,2.5465823119276356,2.5512622402043377,2.575662173131309,2.5764812764937624,2.583157539876427,2.589413560139261,2.5927111855724947,2.5889385241761476,2.5902284872408328,2.591313479044381,2.591313479044381,2.5857053972398787,2.5805109519505933,2.5657718220581813)
maxHPD=c(2.0665631449084634, 2.376465749324535,2.393176673072625,2.4036066274401637,2.410894245198392,2.457423501214093,2.559145469275075,2.6701305963053668,2.691161962478935,2.7008571689932355,2.7101619864561846,2.7101619864561846,2.7138458603106623,2.7409776027493353,2.7660658222823167,2.769373865050489,2.772234645237358,2.772558958788113,2.772558958788113,2.7726349119074283,2.7715849171431883,2.7715849171431883,2.7707483099241808,2.7695758719684482,2.7658539818118077,2.764990794327658,2.7631850200265613,2.7595887688076215,2.7595887688076215,2.7597792856763306,2.759428592185878,2.759428592185878,2.7597129869065475,2.757184965856604,2.7557281260002995,2.754384232931175,2.75374365868219,2.75374365868219,2.7522470287398324,2.749765933587685,2.7453802392290805,2.739217385984387,2.7350201577311344,2.7350201577311344,2.7213568645083206,2.7116503254367617,2.7070084947619777,2.703670079804498,2.6994667837104163,2.6958457541499063,2.691266313049061,2.687549256899908,2.6856930205143046,2.6775031178877127,2.6682436839838704,2.6682436839838704,2.6659264263002473,2.6651589984582884,2.6615312151074546,2.65627826484597,2.650208362475296,2.6451879242665406,2.6415289081161144,2.637571765720835,2.634167740421506,2.6334668095120413,2.628259686475592,2.6215260347734386,2.6138958481976835,2.6119145235652232,2.6099540700495067,2.606636970498048,2.605198690174061,2.5990897723552124,2.586422427520073,2.57548384946282,2.559853377162014,2.5520180423303787,2.543801604934313,2.5297488733416094,2.5304257637168184,2.5342996769798383,2.537181648300015,2.536488854666936,2.545885118847779,2.5464471316270587,2.5465823119276356,2.5512622402043377,2.575662173131309,2.5764812764937624,2.583157539876427,2.589413560139261,2.5927111855724947,2.5889385241761476,2.5902284872408328,2.591313479044381,2.591313479044381,2.5857053972398787,2.5805109519505933,2.5657718220581813)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 3.0498984030981715), xlim = c(-144.94366531971994,-66.10019734123948), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()