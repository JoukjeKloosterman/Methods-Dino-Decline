

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.10109614571707, -66.27403537195539,-66.44697459819369,-66.61991382443202,-66.79285305067032,-66.96579227690864,-67.13873150314694,-67.31167072938524,-67.48460995562357,-67.65754918186187,-67.8304884081002,-68.0034276343385,-68.17636686057682,-68.34930608681512,-68.52224531305345,-68.69518453929174,-68.86812376553007,-69.04106299176837,-69.2140022180067,-69.386941444245,-69.55988067048332,-69.73281989672162,-69.90575912295992,-70.07869834919825,-70.25163757543655,-70.42457680167487,-70.59751602791317,-70.7704552541515,-70.9433944803898,-71.11633370662813,-71.28927293286642,-71.46221215910475,-71.63515138534305,-71.80809061158138,-71.98102983781968,-72.15396906405797,-72.3269082902963,-72.4998475165346,-72.67278674277293,-72.84572596901123,-73.01866519524955,-73.19160442148785,-73.36454364772618,-73.53748287396448,-73.7104221002028,-73.8833613264411,-74.05630055267943,-74.22923977891773,-74.40217900515603,-74.57511823139436,-74.74805745763265,-74.92099668387098,-75.09393591010928,-75.26687513634761,-75.4398143625859,-75.61275358882423,-75.78569281506253,-75.95863204130086,-76.13157126753916,-76.30451049377749,-76.47744972001578,-76.65038894625411,-76.82332817249241,-76.99626739873071,-77.16920662496904,-77.34214585120733,-77.51508507744566,-77.68802430368396,-77.86096352992229,-78.03390275616059,-78.20684198239891,-78.37978120863721,-78.55272043487554,-78.72565966111384,-78.89859888735216,-79.07153811359046,-79.24447733982879,-79.41741656606709,-79.59035579230539,-79.76329501854372,-79.93623424478201,-80.10917347102034,-80.28211269725864,-80.45505192349697,-80.62799114973527,-80.80093037597359,-80.97386960221189,-81.14680882845022,-81.31974805468852,-81.49268728092684,-81.66562650716514,-81.83856573340344,-82.01150495964177,-82.18444418588007,-82.3573834121184,-82.5303226383567,-82.70326186459502,-82.87620109083332,-83.04914031707165,-83.22207954330995)
rate=c(0.4023137760106518, 0.40258481214050523,0.4023137760106518,0.40258481214050523,0.4029382539861337,0.4035589073044436,0.40420955437903827,0.4042624754002213,0.40462509341998876,0.4060680542769074,0.40916770827513516,0.41053027989744445,0.4128071452161475,0.4128071452161475,0.4128071452161475,0.4128071452161475,0.4125519179220463,0.4128071452161475,0.4128071452161475,0.4128071452161475,0.4131575537652527,0.4128071452161475,0.4125519179220463,0.4128071452161475,0.4128071452161475,0.4130325238627062,0.4128071452161475,0.4128071452161475,0.4131012568614541,0.4128071452161475,0.4131012568614541,0.4128071452161475,0.4121522316224932,0.41175038842457623,0.4114884763694837,0.4109054396762234,0.4108114538159453,0.4096026469990236,0.4093166515883068,0.40857524977684134,0.40841623662127674,0.4082265066601717,0.40623903096960007,0.4060680542769074,0.40542913036774497,0.40542913036774497,0.4049891054357705,0.40455696835791116,0.40431191568345604,0.4042624754002213,0.4042624754002213,0.40420955437903827,0.40415136600115026,0.40415136600115026,0.40415136600115026,0.40405872907504425,0.40405872907504425,0.40405872907504425,0.40405872907504425,0.40415136600115026,0.40415136600115026,0.40405872907504425,0.40405872907504425,0.40415136600115026,0.4042624754002213,0.4042624754002213,0.4042624754002213,0.40431191568345604,0.40438077939690154,0.40438077939690154,0.4044894602575053,0.40455696835791116,0.40468322950154456,0.40462509341998876,0.4049891054357705,0.4051201388839855,0.40542913036774497,0.40542913036774497,0.4052906836526041,0.40572370309604233,0.4055767845183097,0.40542913036774497,0.4052906836526041,0.40572370309604233,0.40623903096960007,0.40847364121435226,0.40857524977684134,0.40857524977684134,0.40943712778474195,0.41029770319582154,0.4111732967463542,0.4133232050615711,0.41535186451229666,0.4159372904741301,0.419005638350191,0.4208948967677414,0.42230642310265476,0.42586641897441757,0.43200647059713465,0.43421831339391104)
minHPD=c(0.00013651491419482378, 0.00013651491419482378,0.00013651491419482378,0.00013651491419482378,0.00013651491419482378,0.07569189010548548,0.121490941104768,0.12164305329143806,0.13873570374548586,0.19061554990242588,0.24329579026974676,0.285187780328191,0.26729609476256655,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.28728501154989433,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.28728501154989433,0.28728501154989433,0.28728501154989433,0.28728501154989433,0.28728501154989433,0.28728501154989433,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.285187780328191,0.2860950897907258,0.285187780328191,0.285187780328191,0.26729609476256655,0.285187780328191,0.26729609476256655,0.26729609476256655,0.26729609476256655,0.23388335780350403,0.2724411008597606,0.26729609476256655,0.2724411008597606)
maxHPD=c(0.5637542763641188, 0.5637542763641188,0.5613266570593785,0.5596766839701983,0.5572049341535407,0.6306663384820791,0.6544955684402775,0.6483319027967817,0.6551629799153199,0.6433520116726356,0.662288879923429,0.6544955684402775,0.5753459516849582,0.5828128885091507,0.5751295364334321,0.5751295364334321,0.5734236042736709,0.5707286631408902,0.5707286631408902,0.5707286631408902,0.5694192717332986,0.5694192717332986,0.568109698700525,0.5697662091743226,0.5697662091743226,0.5697662091743226,0.5697662091743226,0.5697662091743226,0.5707286631408902,0.5707286631408902,0.5751295364334321,0.5734236042736709,0.5734236042736709,0.5697662091743226,0.5694192717332986,0.5661383355672867,0.5661383355672867,0.5613266570593785,0.5555839968050512,0.5525489142549972,0.5502841072821176,0.5525489142549972,0.5501118743217267,0.5502841072821176,0.5401482058098931,0.5352460920592879,0.533920305618866,0.5306627273548727,0.5306627273548727,0.5306627273548727,0.5306627273548727,0.5306627273548727,0.5306627273548727,0.5325142243667168,0.5325142243667168,0.52996943622057,0.52996943622057,0.52996943622057,0.52996943622057,0.52996943622057,0.52996943622057,0.52996943622057,0.52996943622057,0.529142910840889,0.529142910840889,0.529142910840889,0.529142910840889,0.529142910840889,0.52996943622057,0.52996943622057,0.52996943622057,0.529142910840889,0.5306627273548727,0.5306627273548727,0.5352460920592879,0.5375017807503969,0.5502841072821176,0.5502841072821176,0.5511970034050141,0.5516720156887513,0.5516720156887513,0.5511970034050141,0.5502841072821176,0.5534828652487224,0.5552314018472814,0.5613266570593785,0.5643307618072356,0.5643307618072356,0.5710382195113964,0.5753459516849582,0.594017868407548,0.6260731919686924,0.6829475257173253,0.6875007258098885,0.7775677597221817,0.8647057508152716,0.9466673130463698,1.1712271187671508,1.3567120174813623,1.427809112390384)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 1.5705900236294226), xlim = c(-83.30854915642911,-66.01462653259792), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.10196957615261, -66.27665566326203,-66.45134175037143,-66.62602783748085,-66.80071392459024,-66.97540001169966,-67.15008609880906,-67.32477218591845,-67.49945827302787,-67.67414436013726,-67.84883044724668,-68.02351653435608,-68.1982026214655,-68.37288870857489,-68.54757479568431,-68.7222608827937,-68.89694696990313,-69.07163305701252,-69.24631914412191,-69.42100523123133,-69.59569131834073,-69.77037740545015,-69.94506349255954,-70.11974957966896,-70.29443566677836,-70.46912175388778,-70.64380784099717,-70.81849392810659,-70.99318001521598,-71.1678661023254,-71.3425521894348,-71.51723827654419,-71.69192436365361,-71.866610450763,-72.04129653787243,-72.21598262498182,-72.39066871209124,-72.56535479920063,-72.74004088631006,-72.91472697341945,-73.08941306052887,-73.26409914763826,-73.43878523474768,-73.61347132185708,-73.78815740896647,-73.96284349607589,-74.13752958318528,-74.3122156702947,-74.4869017574041,-74.66158784451352,-74.83627393162291,-75.01096001873233,-75.18564610584173,-75.36033219295115,-75.53501828006054,-75.70970436716993,-75.88439045427936,-76.05907654138875,-76.23376262849817,-76.40844871560756,-76.58313480271698,-76.75782088982638,-76.9325069769358,-77.10719306404519,-77.28187915115461,-77.456565238264,-77.63125132537343,-77.80593741248282,-77.98062349959221,-78.15530958670163,-78.32999567381103,-78.50468176092045,-78.67936784802984,-78.85405393513926,-79.02874002224866,-79.20342610935808,-79.37811219646747,-79.55279828357689,-79.72748437068628,-79.9021704577957,-80.0768565449051,-80.25154263201449,-80.42622871912391,-80.6009148062333,-80.77560089334273,-80.95028698045212,-81.12497306756154,-81.29965915467093,-81.47434524178036,-81.64903132888975,-81.82371741599917,-81.99840350310856,-82.17308959021796,-82.34777567732738,-82.52246176443677,-82.69714785154619,-82.87183393865558,-83.046520025765,-83.2212061128744)
counts=c(0.004, 0.005,0.005,0.004,0.006,0.006,0.005,0.007,0.013,0.015,0.016,0.012,0.002,0.002,0.003,0.002,0.005,0.001,0.001,0.004,0.002,0.003,0.002,0.003,0.001,0.003,0.002,0.005,0.002,0.007,0.003,0.005,0.003,0.001,0.004,0.002,0.015,0.005,0.004,0.004,0.002,0.005,0.004,0.003,0.004,0.003,0.008,0.0,0.002,0.002,0.001,0.001,0.002,0.002,0.002,0.0,0.002,0.002,0.002,0.002,0.0,0.0,0.005,0.0,0.001,0.003,0.003,0.001,0.002,0.003,0.002,0.003,0.003,0.007,0.002,0.003,0.001,0.004,0.003,0.002,0.006,0.002,0.006,0.005,0.004,0.0,0.007,0.006,0.01,0.013,0.013,0.009,0.017,0.011,0.021,0.021,0.035,0.014,0.007)
plot(mids,counts,type = 'h', xlim = c(-83.30854915642911,-66.01462653259792), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.02514249682106274
bf6 = 0.16006671152542618
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.10109614571707, -66.27403537195539,-66.44697459819369,-66.61991382443202,-66.79285305067032,-66.96579227690864,-67.13873150314694,-67.31167072938524,-67.48460995562357,-67.65754918186187,-67.8304884081002,-68.0034276343385,-68.17636686057682,-68.34930608681512,-68.52224531305345,-68.69518453929174,-68.86812376553007,-69.04106299176837,-69.2140022180067,-69.386941444245,-69.55988067048332,-69.73281989672162,-69.90575912295992,-70.07869834919825,-70.25163757543655,-70.42457680167487,-70.59751602791317,-70.7704552541515,-70.9433944803898,-71.11633370662813,-71.28927293286642,-71.46221215910475,-71.63515138534305,-71.80809061158138,-71.98102983781968,-72.15396906405797,-72.3269082902963,-72.4998475165346,-72.67278674277293,-72.84572596901123,-73.01866519524955,-73.19160442148785,-73.36454364772618,-73.53748287396448,-73.7104221002028,-73.8833613264411,-74.05630055267943,-74.22923977891773,-74.40217900515603,-74.57511823139436,-74.74805745763265,-74.92099668387098,-75.09393591010928,-75.26687513634761,-75.4398143625859,-75.61275358882423,-75.78569281506253,-75.95863204130086,-76.13157126753916,-76.30451049377749,-76.47744972001578,-76.65038894625411,-76.82332817249241,-76.99626739873071,-77.16920662496904,-77.34214585120733,-77.51508507744566,-77.68802430368396,-77.86096352992229,-78.03390275616059,-78.20684198239891,-78.37978120863721,-78.55272043487554,-78.72565966111384,-78.89859888735216,-79.07153811359046,-79.24447733982879,-79.41741656606709,-79.59035579230539,-79.76329501854372,-79.93623424478201,-80.10917347102034,-80.28211269725864,-80.45505192349697,-80.62799114973527,-80.80093037597359,-80.97386960221189,-81.14680882845022,-81.31974805468852,-81.49268728092684,-81.66562650716514,-81.83856573340344,-82.01150495964177,-82.18444418588007,-82.3573834121184,-82.5303226383567,-82.70326186459502,-82.87620109083332,-83.04914031707165,-83.22207954330995)
rate=c(0.624681258810598, 0.6155482170157771,0.6125713113367395,0.6060177289896749,0.6027743722407266,0.6003878255922747,0.5986972761713276,0.5979917670751314,0.5978802219560679,0.5978802219560679,0.5976301877642529,0.5969029224533959,0.5949762576197422,0.5942913579962177,0.5937186206570324,0.5942913579962177,0.5943266820458343,0.5943266820458343,0.5942913579962177,0.5943266820458343,0.5946258052985348,0.5943266820458343,0.5949762576197422,0.5949762576197422,0.5957792882871679,0.5967058447262457,0.5969029224533959,0.5979917670751314,0.5981320701700352,0.598249938885071,0.5991776904304225,0.6007830430743082,0.6007830430743082,0.600616078371957,0.6007830430743082,0.6007830430743082,0.6007830430743082,0.5995353850516023,0.5969029224533959,0.5949762576197422,0.5928776476505229,0.5900878713451887,0.5878218627763789,0.5809333801491706,0.5712797841048953,0.5653889687588776,0.560282397537589,0.557917504968352,0.5519319680014905,0.5499854378251823,0.5482756820542106,0.5442380147916601,0.5392370676272875,0.5358505518189528,0.5325951450359303,0.5312484059069986,0.5295437048903875,0.5178236958779985,0.4931105292440641,0.4594048177734132,0.43641919748187835,0.39729014596125806,0.3655958002304781,0.33437220140367685,0.30884536738203316,0.28551530577668455,0.2665337283724966,0.2446310563432365,0.23394975261023027,0.22836515462651788,0.22545195242854418,0.22263942992267943,0.2222681380123805,0.22074108862008837,0.21911787220187418,0.2185577298690134,0.21753279127993796,0.21725475743361994,0.21562167562993895,0.2146826491648485,0.21439724512157723,0.21411353751346768,0.21411353751346768,0.21411353751346768,0.21379334573473735,0.21314535972839493,0.2126667749826499,0.2126667749826499,0.2126667749826499,0.21270859448537544,0.2126667749826499,0.2126667749826499,0.21270859448537544,0.21270859448537544,0.21270859448537544,0.21275940360720044,0.21270859448537544,0.21275940360720044,0.21275940360720044,0.21282602079609428)
minHPD=c(0.25377687219975453, 0.26132666022801415,0.26132666022801415,0.3170294256601108,0.32344070883948256,0.3291385282479221,0.3403337402815671,0.34195860266641975,0.3170294256601108,0.3170294256601108,0.32344070883948256,0.32344070883948256,0.3255777189881266,0.3255777189881266,0.33248934716434736,0.33248934716434736,0.33248934716434736,0.33248934716434736,0.3403337402815671,0.3403337402815671,0.33248934716434736,0.3403337402815671,0.3403337402815671,0.3403337402815671,0.3403337402815671,0.3403337402815671,0.33248934716434736,0.33248934716434736,0.3250903097755824,0.32344070883948256,0.32344070883948256,0.32344070883948256,0.32344070883948256,0.32344070883948256,0.32344070883948256,0.32344070883948256,0.32344070883948256,0.32344070883948256,0.28877330192881223,0.29941461442292366,0.29941461442292366,0.29941461442292366,0.2876586035014667,0.2677216866972809,0.2677216866972809,0.26331615773330797,0.24919914546274788,0.2329184217776273,0.2329184217776273,0.2329184217776273,0.23833378270483407,0.22792804460227326,0.22792804460227326,0.22570022432227,0.22570022432227,0.22570022432227,0.22570022432227,0.17905672993840027,0.14770471884708725,0.13171220987926915,0.13342136765423168,0.11636332102508982,0.12152327188182098,0.11236805660318887,0.10207575647460711,0.08682241042188897,0.08682241042188897,0.06727328239322007,0.06577358214904791,0.06577358214904791,0.06657871820446344,0.06448889732791523,0.06448889732791523,0.06577358214904791,0.06448889732791523,0.06577358214904791,0.06577358214904791,0.06448889732791523,0.06867432547414955,0.06867432547414955,0.06448889732791523,0.06448889732791523,0.06657871820446344,0.06448889732791523,0.06577358214904791,0.06577358214904791,0.06577358214904791,0.06577358214904791,0.06577358214904791,0.06577358214904791,0.06577358214904791,0.06448889732791523,0.06448889732791523,0.06448889732791523,0.06448889732791523,0.06448889732791523,0.07527839551638536,0.07527839551638536,0.07527839551638536,0.06867432547414955)
maxHPD=c(1.8552209397781905, 1.5053207144100673,1.2664863716622372,1.0755536206561913,0.9679398534328515,0.9381034947752006,0.92711458778381,0.9227252695300527,0.8822622587534027,0.8822622587534027,0.8675254583386117,0.8618582725915793,0.8618582725915793,0.8618582725915793,0.8647947774812699,0.8647947774812699,0.8647947774812699,0.8647947774812699,0.8675254583386117,0.8675254583386117,0.8618582725915793,0.8675254583386117,0.8675254583386117,0.8647947774812699,0.8618582725915793,0.8647947774812699,0.8618582725915793,0.8618582725915793,0.8584875396166692,0.8584875396166692,0.8584875396166692,0.8771847225157553,0.8822622587534027,0.8822622587534027,0.900988659772241,0.9080435349603097,0.9080435349603097,0.9127156153546699,0.8747168744836596,0.8675254583386117,0.8675254583386117,0.8603617666232092,0.8747168744836596,0.8584875396166692,0.8559036080932763,0.8548551452242051,0.8430561542115004,0.8078391962046336,0.8047182877509454,0.7991828906204294,0.8091914484285232,0.7924312248017069,0.7924312248017069,0.7991828906204294,0.7991828906204294,0.7991828906204294,0.7960663487902856,0.7729659524111163,0.756054376139841,0.7269568214483692,0.7175073126281903,0.6929191391232485,0.6929191391232485,0.6846483587638746,0.6752396978163062,0.6493901550748119,0.629639946964311,0.5691000580051917,0.5170006574584448,0.4949701388844244,0.479738971249153,0.46723679797974293,0.46723679797974293,0.46723679797974293,0.45926776536227726,0.455730928775562,0.44701749248436007,0.4437452965698642,0.44222038693003934,0.44222038693003934,0.43652687154551667,0.43652687154551667,0.43652687154551667,0.4281123889218624,0.4281123889218624,0.4281123889218624,0.4281123889218624,0.4281123889218624,0.4281123889218624,0.4281123889218624,0.4281123889218624,0.4281123889218624,0.4281123889218624,0.4281123889218624,0.4281123889218624,0.4281123889218624,0.4437452965698642,0.4437452965698642,0.44701749248436007,0.441097887254728)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 2.0407430337560095), xlim = c(-83.30854915642911,-66.01462653259792), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.10196957615261, -66.27665566326203,-66.45134175037143,-66.62602783748085,-66.80071392459024,-66.97540001169966,-67.15008609880906,-67.32477218591845,-67.49945827302787,-67.67414436013726,-67.84883044724668,-68.02351653435608,-68.1982026214655,-68.37288870857489,-68.54757479568431,-68.7222608827937,-68.89694696990313,-69.07163305701252,-69.24631914412191,-69.42100523123133,-69.59569131834073,-69.77037740545015,-69.94506349255954,-70.11974957966896,-70.29443566677836,-70.46912175388778,-70.64380784099717,-70.81849392810659,-70.99318001521598,-71.1678661023254,-71.3425521894348,-71.51723827654419,-71.69192436365361,-71.866610450763,-72.04129653787243,-72.21598262498182,-72.39066871209124,-72.56535479920063,-72.74004088631006,-72.91472697341945,-73.08941306052887,-73.26409914763826,-73.43878523474768,-73.61347132185708,-73.78815740896647,-73.96284349607589,-74.13752958318528,-74.3122156702947,-74.4869017574041,-74.66158784451352,-74.83627393162291,-75.01096001873233,-75.18564610584173,-75.36033219295115,-75.53501828006054,-75.70970436716993,-75.88439045427936,-76.05907654138875,-76.23376262849817,-76.40844871560756,-76.58313480271698,-76.75782088982638,-76.9325069769358,-77.10719306404519,-77.28187915115461,-77.456565238264,-77.63125132537343,-77.80593741248282,-77.98062349959221,-78.15530958670163,-78.32999567381103,-78.50468176092045,-78.67936784802984,-78.85405393513926,-79.02874002224866,-79.20342610935808,-79.37811219646747,-79.55279828357689,-79.72748437068628,-79.9021704577957,-80.0768565449051,-80.25154263201449,-80.42622871912391,-80.6009148062333,-80.77560089334273,-80.95028698045212,-81.12497306756154,-81.29965915467093,-81.47434524178036,-81.64903132888975,-81.82371741599917,-81.99840350310856,-82.17308959021796,-82.34777567732738,-82.52246176443677,-82.69714785154619,-82.87183393865558,-83.046520025765,-83.2212061128744)
counts=c(0.032, 0.017,0.026,0.016,0.014,0.011,0.005,0.005,0.002,0.005,0.004,0.005,0.007,0.008,0.001,0.001,0.002,0.004,0.001,0.004,0.002,0.003,0.002,0.001,0.002,0.005,0.007,0.002,0.003,0.003,0.007,0.001,0.0,0.005,0.005,0.002,0.011,0.007,0.005,0.011,0.012,0.006,0.026,0.02,0.018,0.014,0.013,0.013,0.007,0.007,0.018,0.012,0.008,0.006,0.004,0.015,0.061,0.069,0.05,0.041,0.054,0.052,0.053,0.05,0.055,0.065,0.048,0.035,0.019,0.008,0.006,0.001,0.008,0.008,0.005,0.003,0.005,0.008,0.004,0.003,0.003,0.002,0.002,0.003,0.008,0.001,0.0,0.002,0.001,0.003,0.002,0.0,0.001,0.001,0.003,0.002,0.002,0.002,0.002)
plot(mids,counts,type = 'h', xlim = c(-83.30854915642911,-66.01462653259792), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.10109614571707, -66.27403537195539,-66.44697459819369,-66.61991382443202,-66.79285305067032,-66.96579227690864,-67.13873150314694,-67.31167072938524,-67.48460995562357,-67.65754918186187,-67.8304884081002,-68.0034276343385,-68.17636686057682,-68.34930608681512,-68.52224531305345,-68.69518453929174,-68.86812376553007,-69.04106299176837,-69.2140022180067,-69.386941444245,-69.55988067048332,-69.73281989672162,-69.90575912295992,-70.07869834919825,-70.25163757543655,-70.42457680167487,-70.59751602791317,-70.7704552541515,-70.9433944803898,-71.11633370662813,-71.28927293286642,-71.46221215910475,-71.63515138534305,-71.80809061158138,-71.98102983781968,-72.15396906405797,-72.3269082902963,-72.4998475165346,-72.67278674277293,-72.84572596901123,-73.01866519524955,-73.19160442148785,-73.36454364772618,-73.53748287396448,-73.7104221002028,-73.8833613264411,-74.05630055267943,-74.22923977891773,-74.40217900515603,-74.57511823139436,-74.74805745763265,-74.92099668387098,-75.09393591010928,-75.26687513634761,-75.4398143625859,-75.61275358882423,-75.78569281506253,-75.95863204130086,-76.13157126753916,-76.30451049377749,-76.47744972001578,-76.65038894625411,-76.82332817249241,-76.99626739873071,-77.16920662496904,-77.34214585120733,-77.51508507744566,-77.68802430368396,-77.86096352992229,-78.03390275616059,-78.20684198239891,-78.37978120863721,-78.55272043487554,-78.72565966111384,-78.89859888735216,-79.07153811359046,-79.24447733982879,-79.41741656606709,-79.59035579230539,-79.76329501854372,-79.93623424478201,-80.10917347102034,-80.28211269725864,-80.45505192349697,-80.62799114973527,-80.80093037597359,-80.97386960221189,-81.14680882845022,-81.31974805468852,-81.49268728092684,-81.66562650716514,-81.83856573340344,-82.01150495964177,-82.18444418588007,-82.3573834121184,-82.5303226383567,-82.70326186459502,-82.87620109083332,-83.04914031707165,-83.22207954330995)
net_rate=c(-0.3681124704613997, -0.30981658224275616,-0.28287253712111743,-0.25457035404569817,-0.23603562974088774,-0.21792789192765807,-0.21201804610009234,-0.20906916498262743,-0.20686919873068135,-0.2028022321810921,-0.19615988707144816,-0.18953986195975617,-0.18156239005288247,-0.18080572850126114,-0.17921191905053968,-0.1795050852477729,-0.17949789998338564,-0.17811216596137153,-0.17726637801193781,-0.1776154179116663,-0.17693019836616763,-0.17755954581625624,-0.17791629242475082,-0.17749025033423962,-0.17782665987230847,-0.17820676190725,-0.17872202421511274,-0.1797627142471655,-0.18014608668188978,-0.18123041513729796,-0.18135716769635485,-0.18256614606709484,-0.18608739720407197,-0.18611696308785577,-0.18980011204386618,-0.19058414208520075,-0.19066073795219002,-0.19550506457817943,-0.19517667363511412,-0.19229107237255463,-0.1911502436613346,-0.18162640007039546,-0.17789930319650218,-0.16929717112102324,-0.1604172400098005,-0.15114734286458867,-0.1469570099957223,-0.1436084457512357,-0.13675330006959246,-0.13512498038198784,-0.1324902395804229,-0.12757002281558882,-0.12304438006901838,-0.11828320641845869,-0.1160057506176991,-0.11423682712300127,-0.11186735025915981,-0.09707978371427628,-0.06877253784533406,-0.04022091982349484,-0.02231747304500781,-0.0006435164193212264,0.016711084795702005,0.03851616790194959,0.061031678992129905,0.07999492592920095,0.0997484136264977,0.13101404206615594,0.14629151974062185,0.1557212454162469,0.16132991632715082,0.16408686115427323,0.16513701545678022,0.1666083327831759,0.16992823378853644,0.17316746732517407,0.17504473317617758,0.1754078936257858,0.17718250382044917,0.17940385314867976,0.18006297963072254,0.18021369217274896,0.1806527216939008,0.1818889456165566,0.18318744656026342,0.18507873403328,0.18699937076181752,0.18699937076181752,0.18900905022993894,0.19093317671429005,0.19535214388078578,0.204220825779675,0.21229664474458798,0.21609089890690056,0.22843781452432588,0.2392479957649352,0.2504462759514514,0.27291606890294234,0.30835506676740754,0.32748941421192973)
net_minHPD=c(-1.5126819448686426, -1.2616101903425032,-1.013929754013019,-0.7994125864047766,-0.7150136798155228,-0.6778637833204937,-0.6521241202789296,-0.6750343784207531,-0.5964386056891376,-0.5679863018682237,-0.5520330454714867,-0.5431604694442829,-0.5229212724023773,-0.5229212724023773,-0.5539350808363511,-0.5135877866870873,-0.5099697579537337,-0.5135877866870873,-0.5099697579537337,-0.5099697579537337,-0.5099697579537337,-0.4854458138160428,-0.4854458138160428,-0.5099697579537337,-0.5099697579537337,-0.5135877866870873,-0.5439442272579111,-0.5135877866870873,-0.5229212724023773,-0.5229212724023773,-0.5346828909080239,-0.5539350808363511,-0.5539350808363511,-0.5439442272579111,-0.5539350808363511,-0.5539350808363511,-0.5539350808363511,-0.5431604694442829,-0.5207716231662844,-0.5097388584584592,-0.5135877866870873,-0.5135877866870873,-0.4851872326268734,-0.4851872326268734,-0.44622108507728864,-0.4413799843824049,-0.4413799843824049,-0.44622108507728864,-0.44622108507728864,-0.4413799843824049,-0.4413799843824049,-0.44622108507728864,-0.44115292548815976,-0.44622108507728864,-0.42848594325745865,-0.43036471100322454,-0.42848594325745865,-0.376488624440402,-0.3714154285322019,-0.3604155606389909,-0.3385429669856025,-0.31876774558067367,-0.3137841639107734,-0.3137841639107734,-0.28715808190391473,-0.2682312108808031,-0.263238979262315,-0.17903207319292536,-0.11554330284304776,-0.10719928196466,-0.08486333865236867,-0.0707514878333137,-0.0835432350096168,-0.0707514878333137,-0.06968038348797922,-0.06876487853151053,-0.06876487853151053,-0.06635713170963586,-0.06337282591589216,-0.0645084018827663,-0.06337282591589216,-0.06337282591589216,-0.06337282591589216,-0.06337282591589216,-0.06337282591589216,-0.06876487853151053,-0.0707514878333137,-0.0707514878333137,-0.0707514878333137,-0.06635713170963586,-0.0707514878333137,-0.10520272645530837,-0.10934533131891633,-0.13328386662450792,-0.11554330284304776,-0.09462236557540882,-0.13066449998611357,-0.11895769542083856,-0.13066449998611357,-0.10934533131891633)
net_maxHPD=c(0.3039087672521743, 0.22917458742838526,0.22917458742838526,0.19529297323863065,0.1894515449307369,0.1444128871794581,0.13521591108167164,0.09756780490102152,0.1504891221481119,0.1444128871794581,0.13521591108167164,0.13521591108167164,0.13521591108167164,0.13521591108167164,0.09756780490102152,0.13521591108167164,0.13521591108167164,0.13521591108167164,0.13521591108167164,0.13521591108167164,0.13521591108167164,0.15573903517291926,0.15573903517291926,0.13521591108167164,0.13521591108167164,0.13521591108167164,0.09756780490102152,0.13521591108167164,0.13521591108167164,0.1444128871794581,0.13521591108167164,0.13521591108167164,0.13521591108167164,0.1395813331093101,0.13521591108167164,0.13521591108167164,0.13521591108167164,0.13521591108167164,0.13521591108167164,0.13521591108167164,0.13521591108167164,0.13521591108167164,0.16713218614552494,0.16713218614552494,0.1894515449307369,0.1836654672631048,0.18502698313526006,0.1727450361711774,0.17435015715691657,0.17435015715691657,0.18100160681985467,0.17522562015212678,0.18100160681985467,0.18502698313526006,0.20561956140943682,0.1996262368281272,0.1996262368281272,0.26996609308170183,0.26996609308170183,0.29162085224445045,0.3097388422882271,0.3129395193877267,0.31610940269971044,0.3280270013909907,0.3475293477476801,0.3468460856372568,0.3476477779323968,0.39351255790748757,0.3976066297839685,0.38174990164353695,0.39515979268837975,0.4012862957257252,0.3949994123994277,0.3976066297839685,0.3949994123994277,0.3949994123994277,0.3949994123994277,0.3949994123994277,0.39351255790748757,0.3949994123994277,0.39351255790748757,0.39351255790748757,0.3949994123994277,0.3949994123994277,0.3949994123994277,0.3949994123994277,0.3976066297839685,0.3976066297839685,0.40583229167773055,0.4188147858308022,0.43590875086662656,0.4429655724088236,0.4726500989071718,0.47731706447726324,0.5843122170935687,0.724771444412848,0.7936461395955541,0.9473877870227971,1.1158466984812727,1.2684885062741234)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-1.663950139355507, 1.3953373569015357), xlim = c(-83.30854915642911,-66.01462653259792), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.10109614571707, -66.27403537195539,-66.44697459819369,-66.61991382443202,-66.79285305067032,-66.96579227690864,-67.13873150314694,-67.31167072938524,-67.48460995562357,-67.65754918186187,-67.8304884081002,-68.0034276343385,-68.17636686057682,-68.34930608681512,-68.52224531305345,-68.69518453929174,-68.86812376553007,-69.04106299176837,-69.2140022180067,-69.386941444245,-69.55988067048332,-69.73281989672162,-69.90575912295992,-70.07869834919825,-70.25163757543655,-70.42457680167487,-70.59751602791317,-70.7704552541515,-70.9433944803898,-71.11633370662813,-71.28927293286642,-71.46221215910475,-71.63515138534305,-71.80809061158138,-71.98102983781968,-72.15396906405797,-72.3269082902963,-72.4998475165346,-72.67278674277293,-72.84572596901123,-73.01866519524955,-73.19160442148785,-73.36454364772618,-73.53748287396448,-73.7104221002028,-73.8833613264411,-74.05630055267943,-74.22923977891773,-74.40217900515603,-74.57511823139436,-74.74805745763265,-74.92099668387098,-75.09393591010928,-75.26687513634761,-75.4398143625859,-75.61275358882423,-75.78569281506253,-75.95863204130086,-76.13157126753916,-76.30451049377749,-76.47744972001578,-76.65038894625411,-76.82332817249241,-76.99626739873071,-77.16920662496904,-77.34214585120733,-77.51508507744566,-77.68802430368396,-77.86096352992229,-78.03390275616059,-78.20684198239891,-78.37978120863721,-78.55272043487554,-78.72565966111384,-78.89859888735216,-79.07153811359046,-79.24447733982879,-79.41741656606709,-79.59035579230539,-79.76329501854372,-79.93623424478201,-80.10917347102034,-80.28211269725864,-80.45505192349697,-80.62799114973527,-80.80093037597359,-80.97386960221189,-81.14680882845022,-81.31974805468852,-81.49268728092684,-81.66562650716514,-81.83856573340344,-82.01150495964177,-82.18444418588007,-82.3573834121184,-82.5303226383567,-82.70326186459502,-82.87620109083332,-83.04914031707165,-83.22207954330995)
rate=c(1.2995425023134604, 1.4060694978450208,1.4627446021826922,1.5255375257802477,1.56974979520414,1.616213386155359,1.6324061110808141,1.6395729731571846,1.642648708363661,1.6430006422759118,1.6499873821134772,1.6528751192072482,1.6611937781902641,1.663097141491886,1.66838881226206,1.6677897716665928,1.6674179176766897,1.6672529445447373,1.6695725731539326,1.6687890949619268,1.669113466337728,1.668511729957737,1.6671738475966555,1.6663983073327922,1.6658568720009297,1.6642545399630964,1.6631439064467908,1.655646529291877,1.6527296224678392,1.6477550926855482,1.644232505604598,1.6355284525117222,1.6290120329322666,1.6300020638945396,1.6210954918724072,1.6211092033260206,1.6211859943551632,1.6261189789532031,1.6380586848113166,1.6493015748572404,1.6538658065647673,1.6803975592902944,1.6931703307430692,1.7201860984319972,1.751083817120788,1.780524867723411,1.7981194369004037,1.8128892407206092,1.83756278493013,1.8434648499621262,1.8526231551957595,1.8710409675455475,1.8875761785305443,1.9053269918618285,1.9135724216964713,1.9209554326654386,1.9298329762776927,1.9862523310870441,2.1045832238730133,2.2370180249198577,2.330349290358471,2.4547835144605084,2.5640151466345356,2.7137951316516213,2.8883144501600406,3.0556795827006473,3.252015372315912,3.6198447309337975,3.828329399619624,3.9727141195724216,4.062607792934925,4.106842340040799,4.11338838257309,4.140250781698879,4.176273272032718,4.220207732184021,4.243286433900463,4.250772904359403,4.28935599634538,4.3135307026952905,4.327627409234003,4.331140027974921,4.332616603754736,4.33631850311517,4.346885668767466,4.352933460546135,4.369117091326832,4.369117091326832,4.369117091326832,4.364609994742355,4.3681452721326695,4.373596886550007,4.371355349938363,4.371355349938363,4.371973457954898,4.3702785557770865,4.3645053337356225,4.360407976145606,4.347359162284869,4.345065053581246)
minHPD=c(1.2995425023134604, 1.4060694978450208,1.4627446021826922,1.5255375257802477,1.56974979520414,1.616213386155359,1.6324061110808141,1.6395729731571846,1.642648708363661,1.6430006422759118,1.6499873821134772,1.6528751192072482,1.6611937781902641,1.663097141491886,1.66838881226206,1.6677897716665928,1.6674179176766897,1.6672529445447373,1.6695725731539326,1.6687890949619268,1.669113466337728,1.668511729957737,1.6671738475966555,1.6663983073327922,1.6658568720009297,1.6642545399630964,1.6631439064467908,1.655646529291877,1.6527296224678392,1.6477550926855482,1.644232505604598,1.6355284525117222,1.6290120329322666,1.6300020638945396,1.6210954918724072,1.6211092033260206,1.6211859943551632,1.6261189789532031,1.6380586848113166,1.6493015748572404,1.6538658065647673,1.6803975592902944,1.6931703307430692,1.7201860984319972,1.751083817120788,1.780524867723411,1.7981194369004037,1.8128892407206092,1.83756278493013,1.8434648499621262,1.8526231551957595,1.8710409675455475,1.8875761785305443,1.9053269918618285,1.9135724216964713,1.9209554326654386,1.9298329762776927,1.9862523310870441,2.1045832238730133,2.2370180249198577,2.330349290358471,2.4547835144605084,2.5640151466345356,2.7137951316516213,2.8883144501600406,3.0556795827006473,3.252015372315912,3.6198447309337975,3.828329399619624,3.9727141195724216,4.062607792934925,4.106842340040799,4.11338838257309,4.140250781698879,4.176273272032718,4.220207732184021,4.243286433900463,4.250772904359403,4.28935599634538,4.3135307026952905,4.327627409234003,4.331140027974921,4.332616603754736,4.33631850311517,4.346885668767466,4.352933460546135,4.369117091326832,4.369117091326832,4.369117091326832,4.364609994742355,4.3681452721326695,4.373596886550007,4.371355349938363,4.371355349938363,4.371973457954898,4.3702785557770865,4.3645053337356225,4.360407976145606,4.347359162284869,4.345065053581246)
maxHPD=c(1.2995425023134604, 1.4060694978450208,1.4627446021826922,1.5255375257802477,1.56974979520414,1.616213386155359,1.6324061110808141,1.6395729731571846,1.642648708363661,1.6430006422759118,1.6499873821134772,1.6528751192072482,1.6611937781902641,1.663097141491886,1.66838881226206,1.6677897716665928,1.6674179176766897,1.6672529445447373,1.6695725731539326,1.6687890949619268,1.669113466337728,1.668511729957737,1.6671738475966555,1.6663983073327922,1.6658568720009297,1.6642545399630964,1.6631439064467908,1.655646529291877,1.6527296224678392,1.6477550926855482,1.644232505604598,1.6355284525117222,1.6290120329322666,1.6300020638945396,1.6210954918724072,1.6211092033260206,1.6211859943551632,1.6261189789532031,1.6380586848113166,1.6493015748572404,1.6538658065647673,1.6803975592902944,1.6931703307430692,1.7201860984319972,1.751083817120788,1.780524867723411,1.7981194369004037,1.8128892407206092,1.83756278493013,1.8434648499621262,1.8526231551957595,1.8710409675455475,1.8875761785305443,1.9053269918618285,1.9135724216964713,1.9209554326654386,1.9298329762776927,1.9862523310870441,2.1045832238730133,2.2370180249198577,2.330349290358471,2.4547835144605084,2.5640151466345356,2.7137951316516213,2.8883144501600406,3.0556795827006473,3.252015372315912,3.6198447309337975,3.828329399619624,3.9727141195724216,4.062607792934925,4.106842340040799,4.11338838257309,4.140250781698879,4.176273272032718,4.220207732184021,4.243286433900463,4.250772904359403,4.28935599634538,4.3135307026952905,4.327627409234003,4.331140027974921,4.332616603754736,4.33631850311517,4.346885668767466,4.352933460546135,4.369117091326832,4.369117091326832,4.369117091326832,4.364609994742355,4.3681452721326695,4.373596886550007,4.371355349938363,4.371355349938363,4.371973457954898,4.3702785557770865,4.3645053337356225,4.360407976145606,4.347359162284869,4.345065053581246)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 4.810956575205008), xlim = c(-83.30854915642911,-66.01462653259792), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()