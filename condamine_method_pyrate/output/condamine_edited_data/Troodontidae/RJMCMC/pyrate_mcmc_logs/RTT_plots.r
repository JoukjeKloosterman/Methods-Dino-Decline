

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.48779470602864, -67.4515412250247,-68.41528774402079,-69.37903426301685,-70.34278078201294,-71.306527301009,-72.27027382000509,-73.23402033900115,-74.19776685799724,-75.1615133769933,-76.12525989598939,-77.08900641498545,-78.05275293398154,-79.01649945297763,-79.98024597197369,-80.94399249096978,-81.90773900996584,-82.87148552896193,-83.83523204795799,-84.79897856695408,-85.76272508595014,-86.72647160494623,-87.69021812394229,-88.65396464293838,-89.61771116193444,-90.58145768093053,-91.54520419992659,-92.50895071892268,-93.47269723791874,-94.43644375691483,-95.40019027591089,-96.36393679490698,-97.32768331390304,-98.29142983289913,-99.25517635189519,-100.21892287089128,-101.18266938988734,-102.14641590888343,-103.11016242787949,-104.07390894687558,-105.03765546587167,-106.00140198486773,-106.96514850386382,-107.92889502285988,-108.89264154185597,-109.85638806085203,-110.82013457984812,-111.78388109884418,-112.74762761784027,-113.71137413683633,-114.67512065583242,-115.63886717482848,-116.60261369382457,-117.56636021282063,-118.53010673181672,-119.49385325081278,-120.45759976980887,-121.42134628880493,-122.38509280780102,-123.34883932679708,-124.31258584579317,-125.27633236478923,-126.24007888378532,-127.20382540278138,-128.16757192177747,-129.13131844077353,-130.09506495976962,-131.0588114787657,-132.02255799776177,-132.98630451675783,-133.95005103575392,-134.91379755475,-135.87754407374607,-136.84129059274213,-137.80503711173822,-138.7687836307343,-139.73253014973037,-140.69627666872643,-141.66002318772252,-142.6237697067186,-143.58751622571467,-144.55126274471075,-145.51500926370684,-146.4787557827029,-147.44250230169897,-148.40624882069505,-149.36999533969114,-150.3337418586872,-151.29748837768327,-152.26123489667935,-153.22498141567544,-154.1887279346715,-155.15247445366757,-156.11622097266365,-157.07996749165974,-158.0437140106558,-159.00746052965187,-159.97120704864795,-160.93495356764404,-161.8987000866401)
rate=c(0.43868428122285374, 0.43868428122285374,0.438861328107768,0.43930660076547046,0.4398779077098305,0.4400179943180881,0.4400179943180881,0.44011542069160386,0.44022996421264426,0.440407834773313,0.4404329897531506,0.4404798224139999,0.4404798224139999,0.4405932076356559,0.44117287797341587,0.44117287797341587,0.441762401786701,0.4419140167747847,0.4420990686186838,0.4419140167747847,0.4419140167747847,0.4419140167747847,0.441762401786701,0.441762401786701,0.44144449968602856,0.44144449968602856,0.4410477933055118,0.4410477933055118,0.4410477933055118,0.44117287797341587,0.4410477933055118,0.4410477933055118,0.4410477933055118,0.44117287797341587,0.44137916232543356,0.44137916232543356,0.4416047712297379,0.4419140167747847,0.44249925867609974,0.44281382379525414,0.44281382379525414,0.44281382379525414,0.44281382379525414,0.4420990686186838,0.44249925867609974,0.44286124099994273,0.44281382379525414,0.44286124099994273,0.44249925867609974,0.4420990686186838,0.4419140167747847,0.4420990686186838,0.4420990686186838,0.4419140167747847,0.44130387348395017,0.4414641450276595,0.44130387348395017,0.44130387348395017,0.4410938061138201,0.4410938061138201,0.4410938061138201,0.4414641450276595,0.44249925867609974,0.44249925867609974,0.44286124099994273,0.4432496615235171,0.4436211129349683,0.44412929347385177,0.44434286731409345,0.44434286731409345,0.4454436727222899,0.4454436727222899,0.4463704799256126,0.4466145273255248,0.44663886483106663,0.44666397708695016,0.44672865496998365,0.4467876683307347,0.4467876683307347,0.4467876683307347,0.4469608736185281,0.4469608736185281,0.4469608736185281,0.4483205149126369,0.4483205149126369,0.4488165019741444,0.4488165019741444,0.4483205149126369,0.447657148550623,0.4469608736185281,0.44672865496998365,0.4469608736185281,0.4469608736185281,0.44672865496998365,0.44666397708695016,0.44663886483106663,0.44663886483106663,0.44666397708695016,0.4462703562226491,0.44666397708695016)
minHPD=c(0.27830693910613347, 0.2814579901302058,0.2803042557567736,0.2803042557567736,0.2847087645259113,0.29071470844424935,0.29036317289265545,0.29036317289265545,0.29036317289265545,0.2928584922265458,0.2928584922265458,0.2928584922265458,0.2928584922265458,0.2928584922265458,0.2928584922265458,0.2928584922265458,0.2928584922265458,0.2928584922265458,0.29071470844424935,0.29036317289265545,0.29036317289265545,0.2928584922265458,0.29036317289265545,0.2928584922265458,0.29036317289265545,0.29036317289265545,0.29036317289265545,0.29071470844424935,0.29036317289265545,0.2928584922265458,0.2928584922265458,0.2928584922265458,0.2928584922265458,0.29036317289265545,0.29036317289265545,0.29036317289265545,0.29036317289265545,0.29036317289265545,0.29036317289265545,0.2847087645259113,0.2854137890943599,0.2814579901302058,0.2854137890943599,0.2854137890943599,0.2847087645259113,0.2847087645259113,0.2854137890943599,0.2829413710087773,0.2829413710087773,0.2829413710087773,0.2829413710087773,0.2829413710087773,0.2814579901302058,0.27830693910613347,0.2814579901302058,0.2814579901302058,0.2829413710087773,0.2829413710087773,0.2829413710087773,0.2829413710087773,0.2829413710087773,0.2814579901302058,0.2803042557567736,0.2803042557567736,0.2753582089151926,0.27094983890658914,0.2753582089151926,0.2753582089151926,0.26803520471736353,0.27094983890658914,0.2753582089151926,0.2753582089151926,0.2753582089151926,0.27094983890658914,0.2665644096692462,0.26967935945774446,0.26967935945774446,0.26967935945774446,0.26967935945774446,0.2753582089151926,0.2753582089151926,0.2665644096692462,0.2753582089151926,0.2753582089151926,0.27324684040719854,0.2642303656674213,0.26967935945774446,0.2665644096692462,0.27324684040719854,0.2642303656674213,0.27324684040719854,0.27324684040719854,0.27324684040719854,0.27324684040719854,0.26967935945774446,0.2642303656674213,0.2642303656674213,0.243877812241772,0.2481774870689148,0.2665644096692462)
maxHPD=c(0.607263728930352, 0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.607263728930352,0.6045886503475194,0.6045886503475194,0.6045886503475194,0.6076266356906574,0.6076266356906574,0.607263728930352,0.607263728930352,0.6076266356906574,0.607263728930352,0.607263728930352,0.607263728930352,0.607263728930352,0.607263728930352,0.6062068526429079,0.6062068526429079,0.6076266356906574,0.6045886503475194,0.6076266356906574,0.6045886503475194,0.6045886503475194,0.6028613980800317,0.6028613980800317,0.6028613980800317,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6062068526429079,0.6062068526429079,0.6071755725334885,0.6062068526429079,0.6071755725334885,0.6101741456708439,0.6076266356906574,0.6076266356906574,0.6028613980800317,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6071755725334885,0.6071755725334885,0.6071755725334885,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6076266356906574,0.6071755725334885,0.6071755725334885,0.6062068526429079,0.6071755725334885,0.620370304209906,0.628477025341003,0.6293884879895234,0.6324924655277294,0.6427364828959795,0.6452807663084974,0.6525264227285142,0.6525264227285142,0.6462234091278094,0.6525264227285142,0.6525264227285142,0.6525264227285142,0.6525264227285142,0.6617517778987891,0.6622120985675324,0.6622120985675324,0.674794342030706,0.6734138283482494,0.674794342030706,0.6622120985675324,0.6622120985675324,0.6622120985675324,0.674794342030706,0.6622120985675324,0.674794342030706,0.674794342030706,0.674794342030706,0.6770690135204325,0.6770690135204325,0.6770690135204325,0.6770690135204325,0.6626768839664794,0.6734138283482494,0.7069377301913137)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.777631503210445), xlim = c(-162.38057334613814,-66.00592144653059), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.49266211269023, -67.4661434450095,-68.43962477732876,-69.41310610964803,-70.38658744196731,-71.36006877428657,-72.33355010660584,-73.30703143892511,-74.28051277124437,-75.25399410356364,-76.22747543588291,-77.20095676820218,-78.17443810052144,-79.14791943284071,-80.12140076515998,-81.09488209747924,-82.06836342979851,-83.04184476211779,-84.01532609443706,-84.98880742675632,-85.96228875907559,-86.93577009139486,-87.90925142371412,-88.88273275603339,-89.85621408835266,-90.82969542067194,-91.8031767529912,-92.77665808531047,-93.75013941762974,-94.723620749949,-95.69710208226827,-96.67058341458754,-97.6440647469068,-98.61754607922607,-99.59102741154534,-100.56450874386461,-101.53799007618387,-102.51147140850314,-103.48495274082241,-104.45843407314169,-105.43191540546096,-106.40539673778022,-107.37887807009949,-108.35235940241876,-109.32584073473802,-110.2993220670573,-111.27280339937657,-112.24628473169584,-113.2197660640151,-114.19324739633437,-115.16672872865364,-116.1402100609729,-117.11369139329217,-118.08717272561144,-119.0606540579307,-120.03413539024997,-121.00761672256924,-121.9810980548885,-122.95457938720777,-123.92806071952704,-124.9015420518463,-125.87502338416559,-126.84850471648485,-127.82198604880413,-128.7954673811234,-129.76894871344268,-130.74243004576192,-131.71591137808122,-132.68939271040045,-133.66287404271975,-134.636355375039,-135.60983670735828,-136.58331803967752,-137.55679937199682,-138.53028070431606,-139.50376203663535,-140.4772433689546,-141.45072470127388,-142.42420603359312,-143.39768736591242,-144.3711686982317,-145.34465003055095,-146.31813136287025,-147.29161269518949,-148.26509402750878,-149.23857535982802,-150.2120566921473,-151.18553802446655,-152.15901935678585,-153.1325006891051,-154.10598202142438,-155.07946335374362,-156.05294468606292,-157.02642601838215,-157.99990735070145,-158.9733886830207,-159.94687001533998,-160.92035134765922,-161.89383267997852)
counts=c(0.004, 0.002,0.002,0.006,0.007,0.005,0.002,0.001,0.004,0.001,0.002,0.003,0.001,0.002,0.003,0.002,0.001,0.003,0.003,0.0,0.002,0.002,0.001,0.001,0.001,0.003,0.001,0.004,0.0,0.002,0.0,0.0,0.003,0.001,0.002,0.002,0.004,0.006,0.003,0.001,0.001,0.003,0.006,0.001,0.004,0.002,0.004,0.003,0.002,0.001,0.002,0.007,0.004,0.002,0.001,0.002,0.002,0.001,0.0,0.001,0.007,0.001,0.008,0.006,0.006,0.007,0.004,0.005,0.005,0.004,0.005,0.002,0.004,0.001,0.003,0.002,0.003,0.002,0.005,0.005,0.002,0.005,0.005,0.003,0.003,0.004,0.004,0.0,0.006,0.006,0.0,0.003,0.002,0.002,0.0,0.004,0.008,0.007,0.002)
plot(mids,counts,type = 'h', xlim = c(-162.38057334613814,-66.00592144653059), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03417734599492765
bf6 = 0.20727709671717393
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.48779470602864, -67.4515412250247,-68.41528774402079,-69.37903426301685,-70.34278078201294,-71.306527301009,-72.27027382000509,-73.23402033900115,-74.19776685799724,-75.1615133769933,-76.12525989598939,-77.08900641498545,-78.05275293398154,-79.01649945297763,-79.98024597197369,-80.94399249096978,-81.90773900996584,-82.87148552896193,-83.83523204795799,-84.79897856695408,-85.76272508595014,-86.72647160494623,-87.69021812394229,-88.65396464293838,-89.61771116193444,-90.58145768093053,-91.54520419992659,-92.50895071892268,-93.47269723791874,-94.43644375691483,-95.40019027591089,-96.36393679490698,-97.32768331390304,-98.29142983289913,-99.25517635189519,-100.21892287089128,-101.18266938988734,-102.14641590888343,-103.11016242787949,-104.07390894687558,-105.03765546587167,-106.00140198486773,-106.96514850386382,-107.92889502285988,-108.89264154185597,-109.85638806085203,-110.82013457984812,-111.78388109884418,-112.74762761784027,-113.71137413683633,-114.67512065583242,-115.63886717482848,-116.60261369382457,-117.56636021282063,-118.53010673181672,-119.49385325081278,-120.45759976980887,-121.42134628880493,-122.38509280780102,-123.34883932679708,-124.31258584579317,-125.27633236478923,-126.24007888378532,-127.20382540278138,-128.16757192177747,-129.13131844077353,-130.09506495976962,-131.0588114787657,-132.02255799776177,-132.98630451675783,-133.95005103575392,-134.91379755475,-135.87754407374607,-136.84129059274213,-137.80503711173822,-138.7687836307343,-139.73253014973037,-140.69627666872643,-141.66002318772252,-142.6237697067186,-143.58751622571467,-144.55126274471075,-145.51500926370684,-146.4787557827029,-147.44250230169897,-148.40624882069505,-149.36999533969114,-150.3337418586872,-151.29748837768327,-152.26123489667935,-153.22498141567544,-154.1887279346715,-155.15247445366757,-156.11622097266365,-157.07996749165974,-158.0437140106558,-159.00746052965187,-159.97120704864795,-160.93495356764404,-161.8987000866401)
rate=c(0.45113413629986954, 0.450557233470716,0.44851927881149234,0.44844017714359796,0.44835329238675037,0.4482196916643557,0.4473951421175978,0.4458482444004095,0.44551240319220564,0.4450741951309404,0.4450741951309404,0.4447699705084389,0.4443113239374903,0.4443113239374903,0.4443113239374903,0.44406006859768776,0.44406006859768776,0.44406006859768776,0.44406006859768776,0.4443113239374903,0.4443113239374903,0.4443113239374903,0.4443113239374903,0.44406006859768776,0.44406006859768776,0.44406006859768776,0.44401112090570416,0.4442834373175397,0.4442834373175397,0.4444882806471637,0.4444882806471637,0.44459375777221,0.4447699705084389,0.44529272696422173,0.4453630929210374,0.44529272696422173,0.44564529626973387,0.44564529626973387,0.44564529626973387,0.44580576846805686,0.4458482444004095,0.44590943065451977,0.4461371774502879,0.44590943065451977,0.44590943065451977,0.4461371774502879,0.4461371774502879,0.4461371774502879,0.44590943065451977,0.44590943065451977,0.4461371774502879,0.44580576846805686,0.44580576846805686,0.44580576846805686,0.4458482444004095,0.4458482444004095,0.4458482444004095,0.44573199812815245,0.44564529626973387,0.4453630929210374,0.4450741951309404,0.4450741951309404,0.4450741951309404,0.44529272696422173,0.44529272696422173,0.44551240319220564,0.44564529626973387,0.4458482444004095,0.4461371774502879,0.44690860883608763,0.4473984942310686,0.4480824981183851,0.4480824981183851,0.44835329238675037,0.44851927881149234,0.4492807688371702,0.44975188718449943,0.44975188718449943,0.45003626152130427,0.45003626152130427,0.44975188718449943,0.44975188718449943,0.4495790929555469,0.44975188718449943,0.44975188718449943,0.4495790929555469,0.45003626152130427,0.4495790929555469,0.44892548019915324,0.4492807688371702,0.4486477249950226,0.4480824981183851,0.4471611547892905,0.44590943065451977,0.44564529626973387,0.4456153848087472,0.4448634472481204,0.4444882806471637,0.44459375777221,0.4444882806471637)
minHPD=c(0.26977749988078153, 0.28683477418682296,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.2942833247359282,0.3061334403585619,0.30109987430173907,0.30109987430173907,0.30109987430173907,0.3005034495466406,0.30109987430173907,0.30109987430173907,0.30109987430173907,0.30109987430173907,0.3005034495466406,0.3005034495466406,0.30109987430173907,0.3005034495466406,0.3005034495466406,0.3005034495466406,0.3005034495466406,0.3005034495466406,0.3005034495466406,0.3005034495466406,0.30344663245529346,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.2989158627892107,0.2989158627892107,0.29877367645141245,0.29877367645141245,0.2946856086150231,0.3005034495466406,0.3005034495466406,0.3005034495466406,0.3005034495466406,0.30344663245529346,0.30344663245529346,0.3005034495466406,0.3005034495466406,0.3005034495466406,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.3005034495466406,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.29877367645141245,0.2946856086150231,0.2767130411358343,0.2721244609598338,0.26977749988078153,0.2879866690831353,0.2721244609598338,0.2739070918361489,0.2739070918361489,0.25745859021368983,0.26977749988078153,0.26977749988078153,0.26977749988078153,0.2767130411358343,0.26977749988078153,0.2739070918361489,0.26977749988078153,0.2739070918361489,0.2739070918361489,0.2739070918361489,0.2739070918361489,0.2739070918361489,0.26977749988078153,0.26977749988078153,0.26977749988078153,0.26977749988078153,0.26977749988078153,0.2739070918361489,0.26677308275053463,0.26018949615337933,0.1670920746081012,0.16541820955989864,0.16511296859141178,0.13991110721650188,0.16511296859141178,0.1613264914411286)
maxHPD=c(0.6591955690405035, 0.6558259680903972,0.6474472465064262,0.6474472465064262,0.6474472465064262,0.6474472465064262,0.6317092953957874,0.6317092953957874,0.6186412933946566,0.6186412933946566,0.6186412933946566,0.6186412933946566,0.6186412933946566,0.6186412933946566,0.6186412933946566,0.6186412933946566,0.6186412933946566,0.6186412933946566,0.6186412933946566,0.6171505930144505,0.6171505930144505,0.6171505930144505,0.6171505930144505,0.6171505930144505,0.6171505930144505,0.6171505930144505,0.6186412933946566,0.6186412933946566,0.6186412933946566,0.6186412933946566,0.6186412933946566,0.6186412933946566,0.6186412933946566,0.6204065983708054,0.6204065983708054,0.6186412933946566,0.630159794082172,0.630159794082172,0.630159794082172,0.630159794082172,0.6317092953957874,0.6317092953957874,0.630159794082172,0.630159794082172,0.630159794082172,0.629049367126879,0.629049367126879,0.629049367126879,0.6317092953957874,0.6308087780461543,0.6317092953957874,0.6308087780461543,0.6308087780461543,0.6308087780461543,0.6317092953957874,0.6317092953957874,0.6308087780461543,0.6308087780461543,0.6317092953957874,0.630159794082172,0.6317092953957874,0.6334801683934543,0.6334801683934543,0.6334801683934543,0.6334801683934543,0.6334801683934543,0.6317092953957874,0.6334801683934543,0.6334801683934543,0.6591955690405035,0.6558259680903972,0.6599006694495112,0.6628659600357203,0.6818897799025506,0.7075498683304876,0.7136554283920223,0.7230060257522325,0.7316181379815185,0.7230060257522325,0.7294358281785944,0.7230060257522325,0.7294358281785944,0.7312689085949737,0.7341891668652273,0.7341891668652273,0.7316181379815185,0.7341891668652273,0.7341891668652273,0.7341891668652273,0.7402678345993625,0.7402678345993625,0.7402678345993625,0.7402678345993625,0.7402678345993625,0.6599006694495112,0.6628659600357203,0.6599006694495112,0.6599006694495112,0.7075498683304876,0.7136554283920223)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.8142946180592988), xlim = c(-162.38057334613814,-66.00592144653059), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.49266211269023, -67.4661434450095,-68.43962477732876,-69.41310610964803,-70.38658744196731,-71.36006877428657,-72.33355010660584,-73.30703143892511,-74.28051277124437,-75.25399410356364,-76.22747543588291,-77.20095676820218,-78.17443810052144,-79.14791943284071,-80.12140076515998,-81.09488209747924,-82.06836342979851,-83.04184476211779,-84.01532609443706,-84.98880742675632,-85.96228875907559,-86.93577009139486,-87.90925142371412,-88.88273275603339,-89.85621408835266,-90.82969542067194,-91.8031767529912,-92.77665808531047,-93.75013941762974,-94.723620749949,-95.69710208226827,-96.67058341458754,-97.6440647469068,-98.61754607922607,-99.59102741154534,-100.56450874386461,-101.53799007618387,-102.51147140850314,-103.48495274082241,-104.45843407314169,-105.43191540546096,-106.40539673778022,-107.37887807009949,-108.35235940241876,-109.32584073473802,-110.2993220670573,-111.27280339937657,-112.24628473169584,-113.2197660640151,-114.19324739633437,-115.16672872865364,-116.1402100609729,-117.11369139329217,-118.08717272561144,-119.0606540579307,-120.03413539024997,-121.00761672256924,-121.9810980548885,-122.95457938720777,-123.92806071952704,-124.9015420518463,-125.87502338416559,-126.84850471648485,-127.82198604880413,-128.7954673811234,-129.76894871344268,-130.74243004576192,-131.71591137808122,-132.68939271040045,-133.66287404271975,-134.636355375039,-135.60983670735828,-136.58331803967752,-137.55679937199682,-138.53028070431606,-139.50376203663535,-140.4772433689546,-141.45072470127388,-142.42420603359312,-143.39768736591242,-144.3711686982317,-145.34465003055095,-146.31813136287025,-147.29161269518949,-148.26509402750878,-149.23857535982802,-150.2120566921473,-151.18553802446655,-152.15901935678585,-153.1325006891051,-154.10598202142438,-155.07946335374362,-156.05294468606292,-157.02642601838215,-157.99990735070145,-158.9733886830207,-159.94687001533998,-160.92035134765922,-161.89383267997852)
counts=c(0.008, 0.008,0.003,0.003,0.002,0.015,0.007,0.01,0.005,0.002,0.005,0.005,0.0,0.001,0.0,0.001,0.0,0.002,0.005,0.0,0.002,0.001,0.002,0.0,0.003,0.003,0.008,0.001,0.004,0.002,0.0,0.002,0.004,0.002,0.003,0.005,0.001,0.001,0.003,0.003,0.003,0.003,0.001,0.001,0.0,0.001,0.002,0.002,0.001,0.003,0.001,0.002,0.001,0.0,0.001,0.005,0.002,0.002,0.005,0.004,0.001,0.0,0.002,0.005,0.004,0.01,0.004,0.005,0.006,0.005,0.003,0.005,0.002,0.004,0.006,0.002,0.003,0.002,0.001,0.002,0.001,0.001,0.004,0.004,0.004,0.003,0.003,0.004,0.006,0.007,0.008,0.006,0.006,0.004,0.008,0.01,0.011,0.003,0.003)
plot(mids,counts,type = 'h', xlim = c(-162.38057334613814,-66.00592144653059), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.48779470602864, -67.4515412250247,-68.41528774402079,-69.37903426301685,-70.34278078201294,-71.306527301009,-72.27027382000509,-73.23402033900115,-74.19776685799724,-75.1615133769933,-76.12525989598939,-77.08900641498545,-78.05275293398154,-79.01649945297763,-79.98024597197369,-80.94399249096978,-81.90773900996584,-82.87148552896193,-83.83523204795799,-84.79897856695408,-85.76272508595014,-86.72647160494623,-87.69021812394229,-88.65396464293838,-89.61771116193444,-90.58145768093053,-91.54520419992659,-92.50895071892268,-93.47269723791874,-94.43644375691483,-95.40019027591089,-96.36393679490698,-97.32768331390304,-98.29142983289913,-99.25517635189519,-100.21892287089128,-101.18266938988734,-102.14641590888343,-103.11016242787949,-104.07390894687558,-105.03765546587167,-106.00140198486773,-106.96514850386382,-107.92889502285988,-108.89264154185597,-109.85638806085203,-110.82013457984812,-111.78388109884418,-112.74762761784027,-113.71137413683633,-114.67512065583242,-115.63886717482848,-116.60261369382457,-117.56636021282063,-118.53010673181672,-119.49385325081278,-120.45759976980887,-121.42134628880493,-122.38509280780102,-123.34883932679708,-124.31258584579317,-125.27633236478923,-126.24007888378532,-127.20382540278138,-128.16757192177747,-129.13131844077353,-130.09506495976962,-131.0588114787657,-132.02255799776177,-132.98630451675783,-133.95005103575392,-134.91379755475,-135.87754407374607,-136.84129059274213,-137.80503711173822,-138.7687836307343,-139.73253014973037,-140.69627666872643,-141.66002318772252,-142.6237697067186,-143.58751622571467,-144.55126274471075,-145.51500926370684,-146.4787557827029,-147.44250230169897,-148.40624882069505,-149.36999533969114,-150.3337418586872,-151.29748837768327,-152.26123489667935,-153.22498141567544,-154.1887279346715,-155.15247445366757,-156.11622097266365,-157.07996749165974,-158.0437140106558,-159.00746052965187,-159.97120704864795,-160.93495356764404,-161.8987000866401)
net_rate=c(-0.031254519359887434, -0.02636230660780606,-0.020825190696101253,-0.019443474006161067,-0.01727378842221935,-0.014110313414639426,-0.011061085268329643,-0.007229129570865899,-0.0029733811563004684,-0.00029984474361750385,-0.00019455380473050544,0.00026326351296905744,0.00025047174161302814,0.0006062548367638021,0.0011014991159601574,0.0011191414429502031,0.0012673991354663064,0.001496343876357634,0.001167123969009551,0.0008726123443037959,0.0008726123443037959,0.0010485044506068966,0.0010026753893761652,0.0009008346759072863,0.0005910540288216625,0.0007355909341301126,-0.00021224038535885693,-0.0007236755178360763,-0.0005301944291925723,-0.000447108044404731,-0.0008151132481875685,-0.0010132503450457633,-0.001152828024416237,-0.0013932908556972996,-0.0014639686661266063,-0.00047353498645061126,-0.005145627856179367,-0.003910576569973657,-0.0030212185928981793,-0.002350038451644649,-0.0039563609428661895,-0.004997881079170979,-0.005169953960909753,-0.005711440266850788,-0.004264857598981756,-0.004240010380367591,-0.00459810778900934,-0.0044000382142104985,-0.004612541700007311,-0.0045836521349517855,-0.0051363991764197476,-0.004661593985074334,-0.004817582760895916,-0.006389978846097839,-0.00965692742643642,-0.00947634598394154,-0.00966180338972371,-0.006451167759632315,-0.007905812708251624,-0.0032161571738662104,-0.0024632503765707947,-0.0018586887553059702,0.0005129986636398501,0.0005267842824085743,0.001730891424587802,-0.0019328817592646442,-0.004815008412480348,-0.01066729702899865,-0.01126628714302688,-0.014455506244302842,-0.02095816186214576,-0.025265669163422894,-0.022622470006713937,-0.0263273620348027,-0.02701846987005653,-0.029640250023752306,-0.030088177188481186,-0.03114042531479829,-0.0313883766837154,-0.033200411936787536,-0.032048821032133995,-0.02932367660600913,-0.02896588117512346,-0.030210896006993775,-0.028349637676201876,-0.02735693958109724,-0.032236558986775035,-0.02855042408039108,-0.025269307825726037,-0.024986191564102242,-0.019933250551706357,-0.01039055753556246,0.001636639507914451,0.004942698005952751,0.00777815816834582,0.009131430509716097,0.011828884423022636,0.014544407598301976,0.013056796879783448,0.017654318759692245)
net_minHPD=c(-0.33001968105838264, -0.33001968105838264,-0.30810483170910813,-0.2767043303632979,-0.2767043303632979,-0.2640922055080205,-0.23069695459008893,-0.22732105754736698,-0.22082130131158528,-0.22082130131158528,-0.22082130131158528,-0.22082130131158528,-0.22082130131158528,-0.22082130131158528,-0.22082130131158528,-0.22082130131158528,-0.22082130131158528,-0.22082130131158528,-0.22082130131158528,-0.22082130131158528,-0.22082130131158528,-0.21759666361086566,-0.23589736172868847,-0.21632532624539602,-0.21632532624539602,-0.21632532624539602,-0.23064659435032847,-0.22082130131158528,-0.21759666361086566,-0.21632532624539602,-0.21632532624539602,-0.21632532624539602,-0.21632532624539602,-0.22082130131158528,-0.22082130131158528,-0.22082130131158528,-0.22082130131158528,-0.22082130131158528,-0.22082130131158528,-0.23064659435032847,-0.23064659435032847,-0.23064659435032847,-0.23064659435032847,-0.23064659435032847,-0.23064659435032847,-0.23589736172868847,-0.23589736172868847,-0.24120687565060578,-0.23589736172868847,-0.23589736172868847,-0.24120687565060578,-0.24120687565060578,-0.24692980652713664,-0.24692980652713664,-0.24288978423470592,-0.24288978423470592,-0.26374657888887504,-0.26374657888887504,-0.24810880459937407,-0.23589736172868847,-0.26374657888887504,-0.24692980652713664,-0.24120687565060578,-0.24120687565060578,-0.23064659435032847,-0.23589736172868847,-0.257767254066088,-0.26374657888887504,-0.25728485466853607,-0.26374657888887504,-0.25728485466853607,-0.26374657888887504,-0.26374657888887504,-0.2793412960828358,-0.3023992989284008,-0.3023992989284008,-0.3023992989284008,-0.3176669372433849,-0.3176669372433849,-0.3281491503008963,-0.3176669372433849,-0.3023992989284008,-0.3023992989284008,-0.3176669372433849,-0.3176669372433849,-0.3023992989284008,-0.3023992989284008,-0.3023992989284008,-0.300870362331683,-0.300870362331683,-0.3023992989284008,-0.3023992989284008,-0.26374657888887504,-0.26374657888887504,-0.26374657888887504,-0.27732243720568794,-0.26374657888887504,-0.26374657888887504,-0.29418622746881407,-0.26374657888887504)
net_maxHPD=c(0.28332491107958613, 0.24174128374634296,0.24174128374634296,0.26019995643071187,0.24174128374634296,0.24174128374634296,0.24317451797367584,0.22359696901087872,0.22047397676304964,0.22047397676304964,0.22047397676304964,0.22047397676304964,0.21941880604455088,0.22047397676304964,0.22047397676304964,0.22047397676304964,0.22047397676304964,0.22047397676304964,0.21941880604455088,0.21941880604455088,0.21941880604455088,0.22047397676304964,0.20076998585343264,0.22047397676304964,0.22047397676304964,0.22047397676304964,0.20076998585343264,0.21240785189324074,0.21758033462515486,0.22047397676304964,0.22047397676304964,0.22047397676304964,0.22047397676304964,0.21695063319622632,0.21695063319622632,0.21758033462515486,0.21941880604455088,0.22047397676304964,0.21941880604455088,0.21695063319622632,0.21695063319622632,0.21758033462515486,0.21758033462515486,0.21941880604455088,0.22047397676304964,0.21941880604455088,0.21941880604455088,0.22047397676304964,0.21941880604455088,0.22047397676304964,0.22047397676304964,0.22047397676304964,0.21941880604455088,0.22047397676304964,0.22047397676304964,0.22047397676304964,0.19681557408796063,0.19681557408796063,0.21758033462515486,0.22047397676304964,0.19681557408796063,0.22047397676304964,0.22047397676304964,0.22047397676304964,0.24149247606132113,0.24317451797367584,0.24149247606132113,0.24792835556486736,0.25851171868545963,0.25851171868545963,0.2889697411388787,0.2919389037602447,0.3074309935456991,0.3409164490968479,0.3059677755907,0.3059677755907,0.3059677755907,0.3059677755907,0.3059677755907,0.3059677755907,0.3059677755907,0.3409164490968479,0.3409164490968479,0.3409164490968479,0.3409164490968479,0.3409164490968479,0.3409164490968479,0.3409164490968479,0.3409164490968479,0.3409164490968479,0.3225870665019447,0.30001107582269154,0.33526538078814144,0.3235807997754411,0.34188542729685745,0.34188542729685745,0.35344346437683966,0.36424378784712275,0.36424378784712275,0.42952608313844237)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-0.3630216491642209, 0.47247869145228666), xlim = c(-162.38057334613814,-66.00592144653059), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.48779470602864, -67.4515412250247,-68.41528774402079,-69.37903426301685,-70.34278078201294,-71.306527301009,-72.27027382000509,-73.23402033900115,-74.19776685799724,-75.1615133769933,-76.12525989598939,-77.08900641498545,-78.05275293398154,-79.01649945297763,-79.98024597197369,-80.94399249096978,-81.90773900996584,-82.87148552896193,-83.83523204795799,-84.79897856695408,-85.76272508595014,-86.72647160494623,-87.69021812394229,-88.65396464293838,-89.61771116193444,-90.58145768093053,-91.54520419992659,-92.50895071892268,-93.47269723791874,-94.43644375691483,-95.40019027591089,-96.36393679490698,-97.32768331390304,-98.29142983289913,-99.25517635189519,-100.21892287089128,-101.18266938988734,-102.14641590888343,-103.11016242787949,-104.07390894687558,-105.03765546587167,-106.00140198486773,-106.96514850386382,-107.92889502285988,-108.89264154185597,-109.85638806085203,-110.82013457984812,-111.78388109884418,-112.74762761784027,-113.71137413683633,-114.67512065583242,-115.63886717482848,-116.60261369382457,-117.56636021282063,-118.53010673181672,-119.49385325081278,-120.45759976980887,-121.42134628880493,-122.38509280780102,-123.34883932679708,-124.31258584579317,-125.27633236478923,-126.24007888378532,-127.20382540278138,-128.16757192177747,-129.13131844077353,-130.09506495976962,-131.0588114787657,-132.02255799776177,-132.98630451675783,-133.95005103575392,-134.91379755475,-135.87754407374607,-136.84129059274213,-137.80503711173822,-138.7687836307343,-139.73253014973037,-140.69627666872643,-141.66002318772252,-142.6237697067186,-143.58751622571467,-144.55126274471075,-145.51500926370684,-146.4787557827029,-147.44250230169897,-148.40624882069505,-149.36999533969114,-150.3337418586872,-151.29748837768327,-152.26123489667935,-153.22498141567544,-154.1887279346715,-155.15247445366757,-156.11622097266365,-157.07996749165974,-158.0437140106558,-159.00746052965187,-159.97120704864795,-160.93495356764404,-161.8987000866401)
rate=c(2.1148062732512733, 2.1383438559864905,2.160216380371996,2.1631682633894256,2.1640144470572347,2.170972974312013,2.189335474563203,2.2073421624531675,2.227371250654037,2.236700332840728,2.2369628594679978,2.237451135976504,2.238002715622627,2.238002715622627,2.238002715622627,2.2383504942818586,2.2376290721553302,2.2376290721553302,2.2363134401935447,2.235648380427513,2.235648380427513,2.235685995013321,2.235685995013321,2.236606141557789,2.236606141557789,2.2373294078011723,2.236797920610821,2.2356381890022616,2.235671035221981,2.2344022450062258,2.2333131076188626,2.2323252988176696,2.2316299613396526,2.22989326178272,2.228967651846599,2.2305429340617,2.205829172554466,2.205829172554466,2.2052218340897074,2.204143777168801,2.2012149277771824,2.195480950551982,2.1938565993889863,2.188253783870225,2.188253783870225,2.1868253864823175,2.186924983173627,2.18687975807905,2.1914217792159034,2.1923964637565954,2.1904913347200208,2.1927230516609586,2.1932095617437657,2.1932095617437657,2.191041902093938,2.191509316500041,2.192867181700621,2.208488665751338,2.2024977741719356,2.2254847075188713,2.2292199495967733,2.228086478956929,2.228086478956929,2.227533332084292,2.227328405217621,2.200965751926045,2.1729541315448433,2.1349791804578655,2.129199776473438,2.110158350505457,2.0694900578275686,2.046553520596909,2.0444987616124997,2.027595665723341,2.0253540836297073,2.016639904303919,2.0142934937668806,2.0086898026788766,2.0072854777759557,1.9978940168960428,2.0024150094866684,2.00295682325516,2.0044603866255106,1.9989369272475497,2.007707793320447,2.0099843865835982,2.0041173032845925,2.017227776447079,2.030258530411072,2.04039197220506,2.0714123739667523,2.1134498038906724,2.1685724815703336,2.1879322507470884,2.2028679159593256,2.208231360609953,2.2214637366690626,2.2298631340042268,2.227934128140448,2.2290580068183083)
minHPD=c(2.1148062732512733, 2.1383438559864905,2.160216380371996,2.1631682633894256,2.1640144470572347,2.170972974312013,2.189335474563203,2.2073421624531675,2.227371250654037,2.236700332840728,2.2369628594679978,2.237451135976504,2.238002715622627,2.238002715622627,2.238002715622627,2.2383504942818586,2.2376290721553302,2.2376290721553302,2.2363134401935447,2.235648380427513,2.235648380427513,2.235685995013321,2.235685995013321,2.236606141557789,2.236606141557789,2.2373294078011723,2.236797920610821,2.2356381890022616,2.235671035221981,2.2344022450062258,2.2333131076188626,2.2323252988176696,2.2316299613396526,2.22989326178272,2.228967651846599,2.2305429340617,2.205829172554466,2.205829172554466,2.2052218340897074,2.204143777168801,2.2012149277771824,2.195480950551982,2.1938565993889863,2.188253783870225,2.188253783870225,2.1868253864823175,2.186924983173627,2.18687975807905,2.1914217792159034,2.1923964637565954,2.1904913347200208,2.1927230516609586,2.1932095617437657,2.1932095617437657,2.191041902093938,2.191509316500041,2.192867181700621,2.208488665751338,2.2024977741719356,2.2254847075188713,2.2292199495967733,2.228086478956929,2.228086478956929,2.227533332084292,2.227328405217621,2.200965751926045,2.1729541315448433,2.1349791804578655,2.129199776473438,2.110158350505457,2.0694900578275686,2.046553520596909,2.0444987616124997,2.027595665723341,2.0253540836297073,2.016639904303919,2.0142934937668806,2.0086898026788766,2.0072854777759557,1.9978940168960428,2.0024150094866684,2.00295682325516,2.0044603866255106,1.9989369272475497,2.007707793320447,2.0099843865835982,2.0041173032845925,2.017227776447079,2.030258530411072,2.04039197220506,2.0714123739667523,2.1134498038906724,2.1685724815703336,2.1879322507470884,2.2028679159593256,2.208231360609953,2.2214637366690626,2.2298631340042268,2.227934128140448,2.2290580068183083)
maxHPD=c(2.1148062732512733, 2.1383438559864905,2.160216380371996,2.1631682633894256,2.1640144470572347,2.170972974312013,2.189335474563203,2.2073421624531675,2.227371250654037,2.236700332840728,2.2369628594679978,2.237451135976504,2.238002715622627,2.238002715622627,2.238002715622627,2.2383504942818586,2.2376290721553302,2.2376290721553302,2.2363134401935447,2.235648380427513,2.235648380427513,2.235685995013321,2.235685995013321,2.236606141557789,2.236606141557789,2.2373294078011723,2.236797920610821,2.2356381890022616,2.235671035221981,2.2344022450062258,2.2333131076188626,2.2323252988176696,2.2316299613396526,2.22989326178272,2.228967651846599,2.2305429340617,2.205829172554466,2.205829172554466,2.2052218340897074,2.204143777168801,2.2012149277771824,2.195480950551982,2.1938565993889863,2.188253783870225,2.188253783870225,2.1868253864823175,2.186924983173627,2.18687975807905,2.1914217792159034,2.1923964637565954,2.1904913347200208,2.1927230516609586,2.1932095617437657,2.1932095617437657,2.191041902093938,2.191509316500041,2.192867181700621,2.208488665751338,2.2024977741719356,2.2254847075188713,2.2292199495967733,2.228086478956929,2.228086478956929,2.227533332084292,2.227328405217621,2.200965751926045,2.1729541315448433,2.1349791804578655,2.129199776473438,2.110158350505457,2.0694900578275686,2.046553520596909,2.0444987616124997,2.027595665723341,2.0253540836297073,2.016639904303919,2.0142934937668806,2.0086898026788766,2.0072854777759557,1.9978940168960428,2.0024150094866684,2.00295682325516,2.0044603866255106,1.9989369272475497,2.007707793320447,2.0099843865835982,2.0041173032845925,2.017227776447079,2.030258530411072,2.04039197220506,2.0714123739667523,2.1134498038906724,2.1685724815703336,2.1879322507470884,2.2028679159593256,2.208231360609953,2.2214637366690626,2.2298631340042268,2.227934128140448,2.2290580068183083)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 2.462185543710045), xlim = c(-162.38057334613814,-66.00592144653059), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()