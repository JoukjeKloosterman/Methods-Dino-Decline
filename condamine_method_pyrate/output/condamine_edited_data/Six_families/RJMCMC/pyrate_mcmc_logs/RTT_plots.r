

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.43919349311926, -67.41089053489287,-68.38258757666645,-69.35428461844006,-70.32598166021364,-71.29767870198725,-72.26937574376086,-73.24107278553444,-74.21276982730805,-75.18446686908166,-76.15616391085524,-77.12786095262885,-78.09955799440246,-79.07125503617604,-80.04295207794965,-81.01464911972323,-81.98634616149684,-82.95804320327045,-83.92974024504403,-84.90143728681764,-85.87313432859125,-86.84483137036483,-87.81652841213844,-88.78822545391205,-89.75992249568563,-90.73161953745924,-91.70331657923282,-92.67501362100643,-93.64671066278004,-94.61840770455362,-95.59010474632723,-96.56180178810084,-97.53349882987442,-98.50519587164803,-99.47689291342164,-100.44858995519522,-101.42028699696883,-102.39198403874241,-103.36368108051602,-104.33537812228963,-105.3070751640632,-106.27877220583682,-107.25046924761043,-108.222166289384,-109.19386333115762,-110.16556037293122,-111.1372574147048,-112.10895445647841,-113.08065149825202,-114.0523485400256,-115.02404558179921,-115.9957426235728,-116.9674396653464,-117.93913670712001,-118.9108337488936,-119.8825307906672,-120.85422783244081,-121.8259248742144,-122.797621915988,-123.76931895776161,-124.7410159995352,-125.7127130413088,-126.68441008308238,-127.65610712485599,-128.6278041666296,-129.59950120840318,-130.5711982501768,-131.5428952919504,-132.51459233372398,-133.4862893754976,-134.45798641727117,-135.42968345904478,-136.4013805008184,-137.373077542592,-138.34477458436558,-139.31647162613916,-140.28816866791277,-141.25986570968638,-142.23156275146,-143.20325979323357,-144.17495683500718,-145.14665387678076,-146.11835091855437,-147.09004796032798,-148.0617450021016,-149.03344204387517,-150.00513908564875,-150.97683612742236,-151.94853316919597,-152.92023021096958,-153.8919272527432,-154.86362429451677,-155.83532133629035,-156.80701837806396,-157.77871541983757,-158.75041246161118,-159.72210950338476,-160.69380654515837,-161.66550358693195,-162.63720062870556)
rate=c(0.2554926172087426, 0.2772324556821525,0.31599818998424156,0.3165772709406439,0.32964384887708237,0.33870459036767675,0.34491117457256615,0.3450125968853898,0.3450125968853898,0.34500323218919104,0.34500323218919104,0.34500323218919104,0.34491117457256615,0.34491117457256615,0.34491117457256615,0.34500323218919104,0.34500323218919104,0.3450125968853898,0.34504574565429647,0.34500323218919104,0.34455716628488575,0.34451473408620753,0.34450564286054897,0.34450564286054897,0.34450332492499536,0.34450096698381716,0.34443646657265625,0.34443646657265625,0.3442891948447456,0.34411688551734215,0.343949890506586,0.343949890506586,0.343949890506586,0.343949890506586,0.343949890506586,0.3442891948447456,0.34450096698381716,0.34450096698381716,0.34450564286054897,0.34455716628488575,0.3447059746965876,0.34491117457256615,0.34500323218919104,0.3450125968853898,0.34491117457256615,0.34500323218919104,0.34491117457256615,0.34500323218919104,0.34500323218919104,0.34500323218919104,0.34500323218919104,0.3450125968853898,0.3450282629085107,0.3450282629085107,0.3450282629085107,0.3450282629085107,0.3450125968853898,0.3450125968853898,0.3450125968853898,0.34504574565429647,0.34510434821191494,0.34510434821191494,0.3454870140547338,0.34580492401713037,0.345847164263392,0.345847164263392,0.345847164263392,0.3458687652808518,0.3458992344714982,0.3458992344714982,0.3458992344714982,0.34597146670480083,0.3460866788316553,0.3463602078958334,0.34647254209262046,0.34647254209262046,0.3466442087646945,0.3467542602604719,0.3466442087646945,0.34683237729499045,0.34689121803131934,0.34683237729499045,0.3469917561873186,0.3469917561873186,0.3471430077683405,0.3471430077683405,0.34724322684015607,0.3469917561873186,0.34689121803131934,0.34694924209861844,0.34694924209861844,0.34724322684015607,0.34725692946518544,0.3473881647777579,0.3477464971206282,0.34776312601446413,0.3479489268736241,0.348248821122794,0.3481245219080573,0.3484066820608096)
minHPD=c(0.003905927828244613, 0.012602449429121301,0.12161410816526842,0.12231792374086542,0.15105639039165494,0.1768895885114539,0.2906705988631677,0.29162542815245923,0.29162542815245923,0.29162542815245923,0.29162542815245923,0.29162542815245923,0.29248405747684636,0.29248405747684636,0.29248405747684636,0.29248405747684636,0.29248405747684636,0.29248405747684636,0.29248405747684636,0.293015968773475,0.29248405747684636,0.29248405747684636,0.29162542815245923,0.29248405747684636,0.29248405747684636,0.293015968773475,0.29162542815245923,0.29162542815245923,0.29162542815245923,0.29162542815245923,0.2906705988631677,0.29248405747684636,0.29341834109628234,0.29341834109628234,0.29341834109628234,0.29162542815245923,0.29341834109628234,0.29341834109628234,0.29248405747684636,0.29162542815245923,0.29162542815245923,0.29162542815245923,0.29162542815245923,0.29162542815245923,0.29162542815245923,0.29162542815245923,0.29248405747684636,0.29341834109628234,0.29341834109628234,0.29341834109628234,0.29248405747684636,0.29248405747684636,0.29341834109628234,0.29341834109628234,0.29341834109628234,0.29167467020740157,0.2936863754181306,0.2936863754181306,0.2936863754181306,0.29341834109628234,0.29341834109628234,0.29341834109628234,0.28425155850934775,0.29341834109628234,0.28425155850934775,0.28425155850934775,0.28425155850934775,0.28425155850934775,0.27937010076318797,0.27937010076318797,0.27937010076318797,0.27937010076318797,0.27937010076318797,0.27937010076318797,0.27966889524699606,0.2794387647053362,0.2742136631707889,0.27113795300164883,0.27937010076318797,0.27937010076318797,0.26825395740423397,0.26825395740423397,0.27113795300164883,0.27113795300164883,0.26164479324277584,0.26164479324277584,0.27113795300164883,0.27113795300164883,0.27339236111357834,0.27113795300164883,0.27113795300164883,0.26344769439357896,0.26164479324277584,0.26164479324277584,0.245731727514569,0.23204462872194453,0.21808948308842563,0.2483795645483617,0.23759262690377123,0.23204462872194453)
maxHPD=c(0.3637143135327924, 0.37164512573415975,0.3818641540578038,0.3818641540578038,0.39651484224124117,0.39885961844581314,0.40302793854767716,0.40302793854767716,0.4029683454063889,0.4029683454063889,0.4029683454063889,0.4029683454063889,0.40302793854767716,0.40302793854767716,0.40302793854767716,0.40302793854767716,0.40302793854767716,0.40302793854767716,0.40302793854767716,0.40302793854767716,0.40302793854767716,0.40302793854767716,0.4029683454063889,0.40302793854767716,0.40302793854767716,0.40302793854767716,0.4029683454063889,0.4029683454063889,0.40302793854767716,0.4053061586290697,0.40302793854767716,0.4056570175568469,0.4056570175568469,0.4056570175568469,0.4056570175568469,0.40302793854767716,0.4056570175568469,0.4056570175568469,0.4056570175568469,0.40536283855552113,0.40536283855552113,0.4056570175568469,0.4056570175568469,0.4056570175568469,0.40536283855552113,0.40536283855552113,0.4056570175568469,0.4056570175568469,0.4056570175568469,0.4056570175568469,0.4056570175568469,0.4056570175568469,0.4073574196447571,0.4073574196447571,0.4073574196447571,0.4073574196447571,0.40974889283527655,0.40974889283527655,0.40974889283527655,0.41033067498587983,0.40974889283527655,0.41033067498587983,0.4056570175568469,0.4159405431100476,0.40974889283527655,0.40974889283527655,0.41033067498587983,0.41151617188103284,0.40974889283527655,0.40974889283527655,0.41151617188103284,0.41433266693790505,0.4151686284718117,0.4159405431100476,0.42890035707160706,0.42890035707160706,0.43031021605721725,0.43031021605721725,0.442315631675087,0.44979665980617417,0.442315631675087,0.442315631675087,0.44979665980617417,0.44979665980617417,0.442315631675087,0.4463799636339802,0.45702698436156125,0.45702698436156125,0.45702698436156125,0.45702698436156125,0.46087825264786175,0.46087825264786175,0.45702698436156125,0.46087825264786175,0.45702698436156125,0.46087825264786175,0.46087825264786175,0.5198276692351799,0.5198276692351799,0.5198276692351799)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.5718104361586979), xlim = c(-163.12304914959236,-65.95334497223246), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.4441010539363, -67.42561321734398,-68.40712538075165,-69.38863754415932,-70.370149707567,-71.35166187097468,-72.33317403438235,-73.31468619779002,-74.2961983611977,-75.27771052460538,-76.25922268801305,-77.24073485142073,-78.22224701482841,-79.20375917823608,-80.18527134164376,-81.16678350505143,-82.14829566845911,-83.12980783186678,-84.11131999527446,-85.09283215868214,-86.07434432208981,-87.05585648549749,-88.03736864890516,-89.01888081231284,-90.00039297572052,-90.98190513912819,-91.96341730253587,-92.94492946594355,-93.92644162935122,-94.90795379275889,-95.88946595616657,-96.87097811957425,-97.85249028298193,-98.8340024463896,-99.81551460979728,-100.79702677320495,-101.77853893661262,-102.76005110002029,-103.74156326342798,-104.72307542683565,-105.70458759024334,-106.686099753651,-107.66761191705868,-108.64912408046635,-109.63063624387402,-110.61214840728171,-111.59366057068938,-112.57517273409707,-113.55668489750474,-114.53819706091241,-115.51970922432008,-116.50122138772775,-117.48273355113544,-118.46424571454311,-119.4457578779508,-120.42727004135847,-121.40878220476614,-122.39029436817381,-123.37180653158148,-124.35331869498917,-125.33483085839684,-126.31634302180453,-127.2978551852122,-128.27936734861987,-129.26087951202754,-130.24239167543524,-131.22390383884292,-132.2054160022506,-133.18692816565826,-134.16844032906593,-135.1499524924736,-136.13146465588127,-137.11297681928895,-138.09448898269662,-139.0760011461043,-140.05751330951196,-141.03902547291966,-142.02053763632733,-143.002049799735,-143.98356196314268,-144.96507412655038,-145.94658628995805,-146.92809845336572,-147.9096106167734,-148.89112278018106,-149.87263494358874,-150.8541471069964,-151.83565927040408,-152.81717143381175,-153.79868359721942,-154.78019576062712,-155.7617079240348,-156.74322008744247,-157.72473225085014,-158.70624441425784,-159.6877565776655,-160.66926874107318,-161.65078090448085,-162.63229306788853)
counts=c(0.018, 0.133,0.008,0.142,0.119,0.105,0.008,0.002,0.001,0.0,0.0,0.003,0.003,0.002,0.001,0.0,0.003,0.004,0.004,0.002,0.001,0.002,0.004,0.001,0.001,0.003,0.001,0.001,0.003,0.001,0.001,0.001,0.0,0.002,0.003,0.002,0.002,0.001,0.004,0.0,0.004,0.001,0.001,0.002,0.0,0.001,0.003,0.0,0.002,0.001,0.001,0.001,0.001,0.0,0.004,0.0,0.001,0.004,0.003,0.002,0.006,0.005,0.003,0.002,0.001,0.004,0.001,0.006,0.004,0.003,0.002,0.005,0.006,0.007,0.006,0.005,0.004,0.004,0.001,0.001,0.002,0.001,0.004,0.002,0.004,0.003,0.001,0.002,0.004,0.004,0.006,0.001,0.007,0.009,0.007,0.009,0.004,0.009,0.006)
plot(mids,counts,type = 'h', xlim = c(-163.12304914959236,-65.95334497223246), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.03404600904253787
bf6 = 0.20662287772405416
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.43919349311926, -67.41089053489287,-68.38258757666645,-69.35428461844006,-70.32598166021364,-71.29767870198725,-72.26937574376086,-73.24107278553444,-74.21276982730805,-75.18446686908166,-76.15616391085524,-77.12786095262885,-78.09955799440246,-79.07125503617604,-80.04295207794965,-81.01464911972323,-81.98634616149684,-82.95804320327045,-83.92974024504403,-84.90143728681764,-85.87313432859125,-86.84483137036483,-87.81652841213844,-88.78822545391205,-89.75992249568563,-90.73161953745924,-91.70331657923282,-92.67501362100643,-93.64671066278004,-94.61840770455362,-95.59010474632723,-96.56180178810084,-97.53349882987442,-98.50519587164803,-99.47689291342164,-100.44858995519522,-101.42028699696883,-102.39198403874241,-103.36368108051602,-104.33537812228963,-105.3070751640632,-106.27877220583682,-107.25046924761043,-108.222166289384,-109.19386333115762,-110.16556037293122,-111.1372574147048,-112.10895445647841,-113.08065149825202,-114.0523485400256,-115.02404558179921,-115.9957426235728,-116.9674396653464,-117.93913670712001,-118.9108337488936,-119.8825307906672,-120.85422783244081,-121.8259248742144,-122.797621915988,-123.76931895776161,-124.7410159995352,-125.7127130413088,-126.68441008308238,-127.65610712485599,-128.6278041666296,-129.59950120840318,-130.5711982501768,-131.5428952919504,-132.51459233372398,-133.4862893754976,-134.45798641727117,-135.42968345904478,-136.4013805008184,-137.373077542592,-138.34477458436558,-139.31647162613916,-140.28816866791277,-141.25986570968638,-142.23156275146,-143.20325979323357,-144.17495683500718,-145.14665387678076,-146.11835091855437,-147.09004796032798,-148.0617450021016,-149.03344204387517,-150.00513908564875,-150.97683612742236,-151.94853316919597,-152.92023021096958,-153.8919272527432,-154.86362429451677,-155.83532133629035,-156.80701837806396,-157.77871541983757,-158.75041246161118,-159.72210950338476,-160.69380654515837,-161.66550358693195,-162.63720062870556)
rate=c(4.710529332908955, 0.4341868365117863,0.4341157219969355,0.4341157219969355,0.4344287837615157,0.4344681292025348,0.43528429226507576,0.436774532220083,0.44210135695453695,0.44735935945251937,0.4485961734476773,0.16948146922297233,0.1659667163304238,0.1659667163304238,0.1659667163304238,0.1658419606660413,0.16693163165768993,0.17203091313468255,0.1771113058555987,0.17870360790045886,0.18035523324116048,0.18107846037951744,0.18107846037951744,0.1810887220571631,0.1811152272444691,0.1811152272444691,0.1811152272444691,0.1810887220571631,0.1810887220571631,0.18107846037951744,0.18107846037951744,0.18120532995658584,0.1812658443471185,0.1820616294173406,0.1840702011135023,0.18814808215091366,0.19632886462271404,0.2035919598251991,0.21739036758509472,0.23297614962161078,0.2584306696107296,0.28158304691757907,0.300372340131741,0.30617572849283614,0.3110300149646549,0.3126021176325352,0.31483569699819536,0.3199697243515701,0.32137229818293866,0.3215561796997877,0.3213187182990152,0.32102008561308065,0.3213187182990152,0.3216220095931391,0.3216220095931391,0.3218225183336759,0.3219896080578814,0.3222827172633086,0.3220563904889786,0.3220563904889786,0.3220563904889786,0.3222827172633086,0.3222827172633086,0.3222827172633086,0.3225372010373088,0.32281392910967366,0.32308869866547335,0.3234275091424425,0.3234275091424425,0.3234908974326465,0.3234908974326465,0.3234908974326465,0.3237950642419776,0.3239215948893651,0.3237950642419776,0.3239215948893651,0.3245842848990289,0.3245842848990289,0.32482486679638,0.32507139810334695,0.3254162425621794,0.3254162425621794,0.32507139810334695,0.32507139810334695,0.32507139810334695,0.32558087181392537,0.32558972923949214,0.3256615984889769,0.32605344916653267,0.3258353176676109,0.32558972923949214,0.32558972923949214,0.3258353176676109,0.3258353176676109,0.3258353176676109,0.3256615984889769,0.32557327244112827,0.3248684744014525,0.3245842848990289,0.3245842848990289)
minHPD=c(1.5730291721180125, 0.3338577427326229,0.3338577427326229,0.3338577427326229,0.3322865394388408,0.3338577427326229,0.3322865394388408,0.33399619390874963,0.33963517190553555,0.3516215092581746,0.3516215092581746,0.08591410095586288,0.0862947528090516,0.08636713032869917,0.08636713032869917,0.08591410095586288,0.0862947528090516,0.08636713032869917,0.10699946656060945,0.10606329177215111,0.11223956556026513,0.11223956556026513,0.11203494069348349,0.11203494069348349,0.11203494069348349,0.11203494069348349,0.11223956556026513,0.11203494069348349,0.11203494069348349,0.11203494069348349,0.11203494069348349,0.11203494069348349,0.10742258966526491,0.12081956326375824,0.11203494069348349,0.11303646077533368,0.11698058453741271,0.11440160741097274,0.11741592029359502,0.11741592029359502,0.1145496964953522,0.1197748666527455,0.13267498241605316,0.13267498241605316,0.1424205351047802,0.14320218422654152,0.157349259989833,0.17255896182915426,0.17999769834866008,0.17382817528443467,0.17382817528443467,0.1787695056691244,0.17999769834866008,0.17999769834866008,0.17275080763561282,0.17385504765192078,0.17385504765192078,0.1787695056691244,0.17999769834866008,0.17999769834866008,0.17999769834866008,0.17999769834866008,0.17999769834866008,0.17999769834866008,0.17999769834866008,0.17999769834866008,0.17999769834866008,0.17999769834866008,0.17999769834866008,0.17999769834866008,0.17999769834866008,0.17999769834866008,0.1787695056691244,0.1787695056691244,0.1787695056691244,0.17999769834866008,0.1787695056691244,0.1787695056691244,0.1787695056691244,0.17999769834866008,0.1811456830206338,0.18091364644278699,0.18091364644278699,0.18091364644278699,0.17999769834866008,0.17999769834866008,0.18091364644278699,0.18091364644278699,0.18091364644278699,0.18091364644278699,0.17999769834866008,0.17999769834866008,0.17999769834866008,0.17999769834866008,0.17999769834866008,0.1787695056691244,0.17999769834866008,0.17638911864470624,0.17999769834866008,0.17999769834866008)
maxHPD=c(8.668867977127286, 0.5292399460054866,0.5280001476865726,0.5280001476865726,0.5233566750171359,0.5233566750171359,0.5214290435726303,0.5322616826135056,0.5803717454464118,0.6646619859242701,0.6871096421713446,0.4029304073022682,0.2405570175386626,0.2405570175386626,0.2405570175386626,0.24097743019839982,0.2474658631488441,0.28322076682121416,0.312345324044452,0.31484467822039824,0.3219920450231987,0.3219920450231987,0.32158615361149046,0.32158615361149046,0.32158615361149046,0.32158615361149046,0.3219920450231987,0.32353794591010643,0.32670830175519894,0.32722926812360104,0.32749032666855704,0.32749032666855704,0.32749032666855704,0.3429292248609439,0.3429292248609439,0.3579853735614193,0.3721996852500912,0.38422668388030334,0.40779740311783164,0.4376279809141883,0.44478157492648973,0.46686456976531804,0.47999973636633414,0.47999973636633414,0.4857954119744711,0.4782413048024097,0.4863713809410318,0.491178240956093,0.48987461545163236,0.4810624961508295,0.4778921514240591,0.4782413048024097,0.4782413048024097,0.4782413048024097,0.46930820479182583,0.4682228057658371,0.4682228057658371,0.46930820479182583,0.46930820479182583,0.46930820479182583,0.46930820479182583,0.4682228057658371,0.4682228057658371,0.46930820479182583,0.46930820479182583,0.4682228057658371,0.46930820479182583,0.46930820479182583,0.46930820479182583,0.46930820479182583,0.46930820479182583,0.46930820479182583,0.47028468335389817,0.47028468335389817,0.47028468335389817,0.47028468335389817,0.4721130070491596,0.4721130070491596,0.4721130070491596,0.47571532547991935,0.4779518000557173,0.4779518000557173,0.4779518000557173,0.4782413048024097,0.4779518000557173,0.4779518000557173,0.4782413048024097,0.4779518000557173,0.4782413048024097,0.4782413048024097,0.4779518000557173,0.4779518000557173,0.4782413048024097,0.4782413048024097,0.4782413048024097,0.4782413048024097,0.4810624961508295,0.4810624961508295,0.4857954119744711,0.4863713809410318)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 9.535754774840015), xlim = c(-163.12304914959236,-65.95334497223246), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.4441010539363, -67.42561321734398,-68.40712538075165,-69.38863754415932,-70.370149707567,-71.35166187097468,-72.33317403438235,-73.31468619779002,-74.2961983611977,-75.27771052460538,-76.25922268801305,-77.24073485142073,-78.22224701482841,-79.20375917823608,-80.18527134164376,-81.16678350505143,-82.14829566845911,-83.12980783186678,-84.11131999527446,-85.09283215868214,-86.07434432208981,-87.05585648549749,-88.03736864890516,-89.01888081231284,-90.00039297572052,-90.98190513912819,-91.96341730253587,-92.94492946594355,-93.92644162935122,-94.90795379275889,-95.88946595616657,-96.87097811957425,-97.85249028298193,-98.8340024463896,-99.81551460979728,-100.79702677320495,-101.77853893661262,-102.76005110002029,-103.74156326342798,-104.72307542683565,-105.70458759024334,-106.686099753651,-107.66761191705868,-108.64912408046635,-109.63063624387402,-110.61214840728171,-111.59366057068938,-112.57517273409707,-113.55668489750474,-114.53819706091241,-115.51970922432008,-116.50122138772775,-117.48273355113544,-118.46424571454311,-119.4457578779508,-120.42727004135847,-121.40878220476614,-122.39029436817381,-123.37180653158148,-124.35331869498917,-125.33483085839684,-126.31634302180453,-127.2978551852122,-128.27936734861987,-129.26087951202754,-130.24239167543524,-131.22390383884292,-132.2054160022506,-133.18692816565826,-134.16844032906593,-135.1499524924736,-136.13146465588127,-137.11297681928895,-138.09448898269662,-139.0760011461043,-140.05751330951196,-141.03902547291966,-142.02053763632733,-143.002049799735,-143.98356196314268,-144.96507412655038,-145.94658628995805,-146.92809845336572,-147.9096106167734,-148.89112278018106,-149.87263494358874,-150.8541471069964,-151.83565927040408,-152.81717143381175,-153.79868359721942,-154.78019576062712,-155.7617079240348,-156.74322008744247,-157.72473225085014,-158.70624441425784,-159.6877565776655,-160.66926874107318,-161.65078090448085,-162.63229306788853)
counts=c(0.997, 0.001,0.0,0.003,0.004,0.015,0.016,0.049,0.043,0.01,0.941,0.049,0.003,0.002,0.002,0.016,0.073,0.038,0.014,0.016,0.004,0.003,0.003,0.001,0.0,0.002,0.006,0.004,0.001,0.001,0.007,0.005,0.014,0.031,0.033,0.052,0.048,0.057,0.067,0.089,0.08,0.046,0.027,0.031,0.015,0.015,0.022,0.01,0.002,0.008,0.006,0.003,0.006,0.005,0.003,0.007,0.001,0.0,0.0,0.003,0.003,0.002,0.001,0.002,0.001,0.004,0.0,0.001,0.002,0.0,0.002,0.003,0.0,0.003,0.003,0.0,0.0,0.002,0.002,0.001,0.004,0.001,0.002,0.005,0.003,0.002,0.002,0.002,0.002,0.002,0.002,0.001,0.005,0.002,0.008,0.004,0.003,0.003,0.0)
plot(mids,counts,type = 'h', xlim = c(-163.12304914959236,-65.95334497223246), ylim=c(0,0.997), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.43919349311926, -67.41089053489287,-68.38258757666645,-69.35428461844006,-70.32598166021364,-71.29767870198725,-72.26937574376086,-73.24107278553444,-74.21276982730805,-75.18446686908166,-76.15616391085524,-77.12786095262885,-78.09955799440246,-79.07125503617604,-80.04295207794965,-81.01464911972323,-81.98634616149684,-82.95804320327045,-83.92974024504403,-84.90143728681764,-85.87313432859125,-86.84483137036483,-87.81652841213844,-88.78822545391205,-89.75992249568563,-90.73161953745924,-91.70331657923282,-92.67501362100643,-93.64671066278004,-94.61840770455362,-95.59010474632723,-96.56180178810084,-97.53349882987442,-98.50519587164803,-99.47689291342164,-100.44858995519522,-101.42028699696883,-102.39198403874241,-103.36368108051602,-104.33537812228963,-105.3070751640632,-106.27877220583682,-107.25046924761043,-108.222166289384,-109.19386333115762,-110.16556037293122,-111.1372574147048,-112.10895445647841,-113.08065149825202,-114.0523485400256,-115.02404558179921,-115.9957426235728,-116.9674396653464,-117.93913670712001,-118.9108337488936,-119.8825307906672,-120.85422783244081,-121.8259248742144,-122.797621915988,-123.76931895776161,-124.7410159995352,-125.7127130413088,-126.68441008308238,-127.65610712485599,-128.6278041666296,-129.59950120840318,-130.5711982501768,-131.5428952919504,-132.51459233372398,-133.4862893754976,-134.45798641727117,-135.42968345904478,-136.4013805008184,-137.373077542592,-138.34477458436558,-139.31647162613916,-140.28816866791277,-141.25986570968638,-142.23156275146,-143.20325979323357,-144.17495683500718,-145.14665387678076,-146.11835091855437,-147.09004796032798,-148.0617450021016,-149.03344204387517,-150.00513908564875,-150.97683612742236,-151.94853316919597,-152.92023021096958,-153.8919272527432,-154.86362429451677,-155.83532133629035,-156.80701837806396,-157.77871541983757,-158.75041246161118,-159.72210950338476,-160.69380654515837,-161.66550358693195,-162.63720062870556)
net_rate=c(-4.734312100053903, -0.19216253008684886,-0.15274522905855367,-0.15179575152908484,-0.12712721155631307,-0.10461273505664848,-0.0878807321965441,-0.09122336977607468,-0.10303067379007345,-0.11686174566198922,-0.1205322424185507,0.1617742598257121,0.17807189474816001,0.1785694871146696,0.17865985540086224,0.17908365198127968,0.1773268840070903,0.1673595671736035,0.15846867248018648,0.15467780718258944,0.15237139449585077,0.1508384795721536,0.15083761105004131,0.1506807773525734,0.15036106700831156,0.15024383837641464,0.15010670141242433,0.15025180473306848,0.15017038646929887,0.15018312296095118,0.14997898828780762,0.14929497883800458,0.1488438766471195,0.14692280119367176,0.14224533568257566,0.1373946359948614,0.12756644027861888,0.11863254531624905,0.10828302218585693,0.09274672205593755,0.07748737617672188,0.054805010986499786,0.03620423227298512,0.03083940724908487,0.02571671466689112,0.026697545043497955,0.02613141020204217,0.023142591498304207,0.022188989130575508,0.02283301442066938,0.023886718250393478,0.02512944059297625,0.024929254562440575,0.024019920894902264,0.02446910263333544,0.025000304962373144,0.024789465052109442,0.024004625269282022,0.024258077131915627,0.025057273129164514,0.0251055582292677,0.025104811603018404,0.026069388801001403,0.02622191618417375,0.02811375014317764,0.027946561997077284,0.027967387576903178,0.02855639852883004,0.029121597531860645,0.027635876348558498,0.02696331477607164,0.027014956576886767,0.02630026384638446,0.026529041837278767,0.027268022834818807,0.02760728864607632,0.02725294258379043,0.026933258476924887,0.02693718011878619,0.027043153588795624,0.02702609305135093,0.026372464349211436,0.028138845871797245,0.027980281938095958,0.028101689486887908,0.025969322670534596,0.026945360130276333,0.026671345240875544,0.024905148614062917,0.025533193474872918,0.02569596274013085,0.025936195353300925,0.02544117618146987,0.02617380656030443,0.027044145059943944,0.0281851068529025,0.031071987223135252,0.03377669519190447,0.03409924585879129,0.037502602451818925)
net_minHPD=c(-8.410610201983136, -0.420927764073702,-0.3557766020486899,-0.3557766020486899,-0.30496693042840595,-0.26411243199339984,-0.20342778732893846,-0.20980403062675484,-0.22156249420211016,-0.3150178406305906,-0.3456550607685864,-0.06133007040554672,0.08461033569044896,0.08578014444835758,0.0870368822028687,0.08461033569044896,0.09110189756436571,0.06125594633554099,0.021288793499056047,0.021288793499056047,0.005596097081322304,0.021288793499056047,0.01979079554353058,0.01979079554353058,0.021288793499056047,0.021288793499056047,0.01979079554353058,0.00603683418155937,0.006364574597060468,0.006364574597060468,0.006364574597060468,0.00603683418155937,0.005596097081322304,-0.0034638866673692426,-0.006444122383569062,-0.011259705551817323,-0.03381243874415274,-0.04577226324319261,-0.0777656595675213,-0.11085497361274793,-0.11269523445226554,-0.13966699669685173,-0.14347316602779153,-0.14347316602779153,-0.14244835953031637,-0.1464374111523462,-0.13966699669685173,-0.1392641726982477,-0.14347316602779153,-0.13966699669685173,-0.13734469132824556,-0.14244835953031637,-0.14347316602779153,-0.14347316602779153,-0.13966699669685173,-0.13966699669685173,-0.13966699669685173,-0.13734469132824556,-0.13647260378023296,-0.13734469132824556,-0.13734469132824556,-0.13647260378023296,-0.13734469132824556,-0.13734469132824556,-0.14244835953031637,-0.14244835953031637,-0.14758616032692057,-0.1499475520621963,-0.14244835953031637,-0.14244835953031637,-0.14347316602779153,-0.14347316602779153,-0.14347316602779153,-0.15845030774925817,-0.14153158617966127,-0.1499475520621963,-0.14347316602779153,-0.14347316602779153,-0.14758616032692057,-0.1499475520621963,-0.1499475520621963,-0.15739025710682186,-0.15845030774925817,-0.15845030774925817,-0.15958854387701532,-0.15958854387701532,-0.15845030774925817,-0.15845030774925817,-0.15845030774925817,-0.15958854387701532,-0.1603056810196647,-0.1603056810196647,-0.1603056810196647,-0.1603056810196647,-0.1603056810196647,-0.17380811127187273,-0.17560398690610352,-0.19716913941021913,-0.20302321355874453,-0.19645627435535)
net_maxHPD=c(-1.1995226053749075, -0.014654156039579869,-0.008651738851330137,-0.008651738851330137,0.0136608966066194,0.033997230853132776,0.018797404391122763,0.018797404391122763,0.05936835898451753,0.03271185425028783,0.029049814145915842,0.2830451751694218,0.2724146982639676,0.2724146982639676,0.2724146982639676,0.2724146982639676,0.2830451751694218,0.2813402022639462,0.25829278033620556,0.2589982267508985,0.25071133528173883,0.26504790759918073,0.2625733927971005,0.2625733927971005,0.2625733927971005,0.2625733927971005,0.2625733927971005,0.25071133528173883,0.25659758460139337,0.25659758460139337,0.25659758460139337,0.25659758460139337,0.25659758460139337,0.25071133528173883,0.2577470424910031,0.26504790759918073,0.2577470424910031,0.2625733927971005,0.2529541639732307,0.2458642048951528,0.24065067700584913,0.23551536535473566,0.2338920684033303,0.23512036557731508,0.22774269240344627,0.20851012739733188,0.2031396152332009,0.2031396152332009,0.1933786113325235,0.19452613538378827,0.19452613538378827,0.18453710905681664,0.18219237385932702,0.18219237385932702,0.18353487132281976,0.18219237385932702,0.18219237385932702,0.18219237385932702,0.18219237385932702,0.18353487132281976,0.18353487132281976,0.18219237385932702,0.18353487132281976,0.18353487132281976,0.18219237385932702,0.18219237385932702,0.18219237385932702,0.18353487132281976,0.1933786113325235,0.1933786113325235,0.1933786113325235,0.1933786113325235,0.1967504669402036,0.18353487132281976,0.20307282909052687,0.19452613538378827,0.20581323687269865,0.20581323687269865,0.20307282909052687,0.20581323687269865,0.20969932441648848,0.20307282909052687,0.20307282909052687,0.20307282909052687,0.20307282909052687,0.20307282909052687,0.20307282909052687,0.20307282909052687,0.20307282909052687,0.20307282909052687,0.20581323687269865,0.20869190441256977,0.20581323687269865,0.20969932441648848,0.21283490701223953,0.20307282909052687,0.20969932441648848,0.20869190441256977,0.21283490701223953,0.24426387449173942)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-9.25167122218145, 0.311349692686364), xlim = c(-163.12304914959236,-65.95334497223246), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.43919349311926, -67.41089053489287,-68.38258757666645,-69.35428461844006,-70.32598166021364,-71.29767870198725,-72.26937574376086,-73.24107278553444,-74.21276982730805,-75.18446686908166,-76.15616391085524,-77.12786095262885,-78.09955799440246,-79.07125503617604,-80.04295207794965,-81.01464911972323,-81.98634616149684,-82.95804320327045,-83.92974024504403,-84.90143728681764,-85.87313432859125,-86.84483137036483,-87.81652841213844,-88.78822545391205,-89.75992249568563,-90.73161953745924,-91.70331657923282,-92.67501362100643,-93.64671066278004,-94.61840770455362,-95.59010474632723,-96.56180178810084,-97.53349882987442,-98.50519587164803,-99.47689291342164,-100.44858995519522,-101.42028699696883,-102.39198403874241,-103.36368108051602,-104.33537812228963,-105.3070751640632,-106.27877220583682,-107.25046924761043,-108.222166289384,-109.19386333115762,-110.16556037293122,-111.1372574147048,-112.10895445647841,-113.08065149825202,-114.0523485400256,-115.02404558179921,-115.9957426235728,-116.9674396653464,-117.93913670712001,-118.9108337488936,-119.8825307906672,-120.85422783244081,-121.8259248742144,-122.797621915988,-123.76931895776161,-124.7410159995352,-125.7127130413088,-126.68441008308238,-127.65610712485599,-128.6278041666296,-129.59950120840318,-130.5711982501768,-131.5428952919504,-132.51459233372398,-133.4862893754976,-134.45798641727117,-135.42968345904478,-136.4013805008184,-137.373077542592,-138.34477458436558,-139.31647162613916,-140.28816866791277,-141.25986570968638,-142.23156275146,-143.20325979323357,-144.17495683500718,-145.14665387678076,-146.11835091855437,-147.09004796032798,-148.0617450021016,-149.03344204387517,-150.00513908564875,-150.97683612742236,-151.94853316919597,-152.92023021096958,-153.8919272527432,-154.86362429451677,-155.83532133629035,-156.80701837806396,-157.77871541983757,-158.75041246161118,-159.72210950338476,-160.69380654515837,-161.66550358693195,-162.63720062870556)
rate=c(0.20124571946093728, 2.3188733982983405,2.319871200775016,2.319871200775016,2.316992824981263,2.3161421487933604,2.3000804250916143,2.2821681086008465,2.2221106206470886,2.1559944157269655,2.139066760095161,5.399944506979679,5.930736552892316,5.950249738654903,5.950861489767828,5.965155732987736,5.903292798590809,5.569283172354262,5.267563376202233,5.209966139647816,5.154992887629912,5.1164338771819,5.119646491977007,5.115837198949897,5.114138471864158,5.114138471864158,5.113496509257516,5.117147226191269,5.117079647425991,5.121456722692074,5.1173242189756865,5.09853552633084,5.084218340350475,5.03504026099961,4.919187361957158,4.795840208584346,4.577119498676107,4.397306998309636,4.196087439264454,3.9370863687138504,3.713242637433213,3.423416043079261,3.216544061092354,3.1617633788200523,3.112824982654093,3.121996855858523,3.1218909625997395,3.0921104851646537,3.083018480839964,3.089152121725044,3.099403321683528,3.1111250318063877,3.108230910542476,3.099470508166598,3.1039686444927983,3.1055919155826226,3.1029925854417506,3.0950469443773443,3.0974878755166295,3.0974878755166295,3.097181981255123,3.09599032509823,3.09592325117333,3.094527911998711,3.092601819988017,3.0910036277983393,3.088334308771887,3.0853048317179392,3.0853048317179392,3.083848997762107,3.083371853935908,3.083371853935908,3.077614369493483,3.0749920347639996,3.0757842767432777,3.0732031061815808,3.064580392232059,3.064580392232059,3.0635624306763223,3.0577810875377804,3.0550386521040487,3.049532972523766,3.0499825070602142,3.0489145704128595,3.0474264736795518,3.031150902262317,3.041093176392583,3.0394011449581786,3.035203981913974,3.0373843928740056,3.041298481456632,3.041140037785693,3.036121075237755,3.036121075237755,3.037016816210698,3.039589374560905,3.048643637527349,3.0633191330677,3.067479031357749,3.058765651474647)
minHPD=c(0.20124571946093728, 2.3188733982983405,2.319871200775016,2.319871200775016,2.316992824981263,2.3161421487933604,2.3000804250916143,2.2821681086008465,2.2221106206470886,2.1559944157269655,2.139066760095161,5.399944506979679,5.930736552892316,5.950249738654903,5.950861489767828,5.965155732987736,5.903292798590809,5.569283172354262,5.267563376202233,5.209966139647816,5.154992887629912,5.1164338771819,5.119646491977007,5.115837198949897,5.114138471864158,5.114138471864158,5.113496509257516,5.117147226191269,5.117079647425991,5.121456722692074,5.1173242189756865,5.09853552633084,5.084218340350475,5.03504026099961,4.919187361957158,4.795840208584346,4.577119498676107,4.397306998309636,4.196087439264454,3.9370863687138504,3.713242637433213,3.423416043079261,3.216544061092354,3.1617633788200523,3.112824982654093,3.121996855858523,3.1218909625997395,3.0921104851646537,3.083018480839964,3.089152121725044,3.099403321683528,3.1111250318063877,3.108230910542476,3.099470508166598,3.1039686444927983,3.1055919155826226,3.1029925854417506,3.0950469443773443,3.0974878755166295,3.0974878755166295,3.097181981255123,3.09599032509823,3.09592325117333,3.094527911998711,3.092601819988017,3.0910036277983393,3.088334308771887,3.0853048317179392,3.0853048317179392,3.083848997762107,3.083371853935908,3.083371853935908,3.077614369493483,3.0749920347639996,3.0757842767432777,3.0732031061815808,3.064580392232059,3.064580392232059,3.0635624306763223,3.0577810875377804,3.0550386521040487,3.049532972523766,3.0499825070602142,3.0489145704128595,3.0474264736795518,3.031150902262317,3.041093176392583,3.0394011449581786,3.035203981913974,3.0373843928740056,3.041298481456632,3.041140037785693,3.036121075237755,3.036121075237755,3.037016816210698,3.039589374560905,3.048643637527349,3.0633191330677,3.067479031357749,3.058765651474647)
maxHPD=c(0.20124571946093728, 2.3188733982983405,2.319871200775016,2.319871200775016,2.316992824981263,2.3161421487933604,2.3000804250916143,2.2821681086008465,2.2221106206470886,2.1559944157269655,2.139066760095161,5.399944506979679,5.930736552892316,5.950249738654903,5.950861489767828,5.965155732987736,5.903292798590809,5.569283172354262,5.267563376202233,5.209966139647816,5.154992887629912,5.1164338771819,5.119646491977007,5.115837198949897,5.114138471864158,5.114138471864158,5.113496509257516,5.117147226191269,5.117079647425991,5.121456722692074,5.1173242189756865,5.09853552633084,5.084218340350475,5.03504026099961,4.919187361957158,4.795840208584346,4.577119498676107,4.397306998309636,4.196087439264454,3.9370863687138504,3.713242637433213,3.423416043079261,3.216544061092354,3.1617633788200523,3.112824982654093,3.121996855858523,3.1218909625997395,3.0921104851646537,3.083018480839964,3.089152121725044,3.099403321683528,3.1111250318063877,3.108230910542476,3.099470508166598,3.1039686444927983,3.1055919155826226,3.1029925854417506,3.0950469443773443,3.0974878755166295,3.0974878755166295,3.097181981255123,3.09599032509823,3.09592325117333,3.094527911998711,3.092601819988017,3.0910036277983393,3.088334308771887,3.0853048317179392,3.0853048317179392,3.083848997762107,3.083371853935908,3.083371853935908,3.077614369493483,3.0749920347639996,3.0757842767432777,3.0732031061815808,3.064580392232059,3.064580392232059,3.0635624306763223,3.0577810875377804,3.0550386521040487,3.049532972523766,3.0499825070602142,3.0489145704128595,3.0474264736795518,3.031150902262317,3.041093176392583,3.0394011449581786,3.035203981913974,3.0373843928740056,3.041298481456632,3.041140037785693,3.036121075237755,3.036121075237755,3.037016816210698,3.039589374560905,3.048643637527349,3.0633191330677,3.067479031357749,3.058765651474647)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 6.5616713062865095), xlim = c(-163.12304914959236,-65.95334497223246), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()