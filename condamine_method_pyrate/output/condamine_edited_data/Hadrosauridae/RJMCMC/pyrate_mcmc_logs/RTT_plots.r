

pdf(file='./RTT_plots.pdf',width=10, height=15)
par(mfrow=c(3,2))
library(scales)

time=c(-66.13531322128567, -66.3655265437976,-66.59573986630953,-66.82595318882146,-67.0561665113334,-67.28637983384533,-67.51659315635726,-67.74680647886919,-67.97701980138112,-68.20723312389305,-68.43744644640498,-68.6676597689169,-68.89787309142883,-69.12808641394076,-69.3582997364527,-69.58851305896464,-69.81872638147657,-70.0489397039885,-70.27915302650042,-70.50936634901235,-70.73957967152428,-70.96979299403621,-71.20000631654814,-71.43021963906007,-71.66043296157201,-71.89064628408394,-72.12085960659587,-72.3510729291078,-72.58128625161973,-72.81149957413166,-73.04171289664359,-73.27192621915552,-73.50213954166745,-73.73235286417938,-73.9625661866913,-74.19277950920325,-74.42299283171518,-74.6532061542271,-74.88341947673904,-75.11363279925096,-75.3438461217629,-75.57405944427482,-75.80427276678675,-76.03448608929868,-76.26469941181062,-76.49491273432255,-76.72512605683448,-76.95533937934641,-77.18555270185834,-77.41576602437027,-77.6459793468822,-77.87619266939413,-78.10640599190606,-78.33661931441799,-78.56683263692992,-78.79704595944186,-79.02725928195379,-79.25747260446572,-79.48768592697765,-79.71789924948958,-79.9481125720015,-80.17832589451343,-80.40853921702536,-80.6387525395373,-80.86896586204924,-81.09917918456117,-81.3293925070731,-81.55960582958502,-81.78981915209695,-82.02003247460888,-82.25024579712081,-82.48045911963274,-82.71067244214467,-82.9408857646566,-83.17109908716853,-83.40131240968046,-83.6315257321924,-83.86173905470433,-84.09195237721626,-84.32216569972819,-84.55237902224012,-84.78259234475205,-85.01280566726398,-85.2430189897759,-85.47323231228785,-85.70344563479978,-85.9336589573117,-86.16387227982364,-86.39408560233556,-86.6242989248475,-86.85451224735942,-87.08472556987135,-87.31493889238328,-87.54515221489521,-87.77536553740714,-88.00557885991907,-88.23579218243101,-88.46600550494294,-88.69621882745487,-88.9264321499668)
rate=c(0.12212992171126189, 0.12197741245037155,0.12197741245037155,0.12212992171126189,0.12223751685682943,0.12381006510271265,0.12491093556209079,0.12506406149943552,0.125173433579639,0.12506406149943552,0.12444566402844975,0.1242979830345606,0.12327678195905242,0.12327678195905242,0.1242979830345606,0.1245960516341977,0.12584512047507224,0.12909777498877534,0.13828680127985482,0.15751889267135308,0.2811081360413859,0.3216965752716451,0.34785176123835115,0.3686125264857478,0.3844425802747462,0.3914002263358178,0.3914823575719881,0.3914286015883588,0.3914002263358178,0.3895713302304382,0.38617116691807296,0.38571423874251964,0.3855261803274116,0.3852872263210686,0.3851514355868839,0.3851514355868839,0.3851514355868839,0.38506757390290136,0.38468178577552925,0.38468178577552925,0.38433525378190375,0.38421956015561426,0.38421956015561426,0.3841573503684198,0.38421956015561426,0.38421956015561426,0.3841573503684198,0.3840624072833241,0.3840624072833241,0.3839533879096817,0.3839533879096817,0.3839533879096817,0.38354330500123185,0.38354330500123185,0.3839533879096817,0.3840624072833241,0.3839533879096817,0.3839533879096817,0.3839533879096817,0.3840624072833241,0.38421956015561426,0.38421956015561426,0.38468178577552925,0.3851514355868839,0.3855171052161347,0.3859493139062418,0.38886599490146556,0.3896460155740023,0.39041908281327853,0.39169063213616995,0.393253035469724,0.39358455114289614,0.39458860781959704,0.3952092455657221,0.39612002938775215,0.3970161752185709,0.3973600386700123,0.39852292784574334,0.39852292784574334,0.39872898541717616,0.3996753029442469,0.3996753029442469,0.4000812095549838,0.4002055035571467,0.40046090282651087,0.4002055035571467,0.40046090282651087,0.4006801393124534,0.40082361133265165,0.4011310184667325,0.4011310184667325,0.4015984931087168,0.40203582782826874,0.401771140856784,0.40203582782826874,0.401771140856784,0.40241258248831047,0.40251925913862013,0.40251925913862013,0.4025997061665414)
minHPD=c(0.00016073906271179343, 0.00016073906271179343,0.00016073906271179343,0.022231889652985736,0.024242316627271707,0.024242316627271707,0.03168904867368994,0.03648961974173695,0.03648961974173695,0.03648961974173695,0.03648961974173695,0.03648961974173695,0.028375361260821852,0.028375361260821852,0.03275982283591001,0.03648961974173695,0.030949193029805283,0.016755708209941534,0.027519879790911198,0.03648961974173695,0.039690227808200744,0.049709691443005216,0.05743198093478128,0.06712005757623653,0.10936412538023137,0.21675947025746256,0.22851989922017427,0.22851989922017427,0.22851989922017427,0.22851989922017427,0.24042799130856854,0.2471658077720237,0.2486024602060396,0.25027342397526325,0.2486024602060396,0.25027342397526325,0.25027342397526325,0.25027342397526325,0.2515743560746772,0.2522513177316926,0.24896319689769464,0.25027342397526325,0.25065831759842533,0.2486024602060396,0.2486024602060396,0.2657618960019033,0.2657618960019033,0.2657618960019033,0.2657618960019033,0.2657618960019033,0.2657618960019033,0.2657618960019033,0.265701735610563,0.265701735610563,0.265701735610563,0.265701735610563,0.265701735610563,0.265701735610563,0.265701735610563,0.265701735610563,0.265701735610563,0.265701735610563,0.265701735610563,0.2657618960019033,0.2657618960019033,0.2657618960019033,0.25065831759842533,0.2486024602060396,0.2486024602060396,0.24042799130856854,0.22851989922017427,0.24042799130856854,0.24042799130856854,0.21553412639917138,0.21553412639917138,0.23694325506559075,0.23008834409380502,0.23008834409380502,0.23008834409380502,0.23008834409380502,0.21279358837047901,0.21279358837047901,0.21279358837047901,0.21279358837047901,0.2427729802695302,0.2427729802695302,0.23008834409380502,0.2427729802695302,0.24896319689769464,0.2427729802695302,0.2427729802695302,0.23008834409380502,0.24896319689769464,0.2427729802695302,0.2427729802695302,0.2427729802695302,0.23008834409380502,0.21553412639917138,0.21279358837047901,0.21279358837047901)
maxHPD=c(0.32862786903154945, 0.32862786903154945,0.3272248360220732,0.3481540980064679,0.3475396000062089,0.34061888580187444,0.3481540980064679,0.35119290459801883,0.3514849743981922,0.35119290459801883,0.3542960812089022,0.3542960812089022,0.3481540980064679,0.3481540980064679,0.3542960812089022,0.3600869789769801,0.36169330269249333,0.36169330269249333,0.397909044290411,0.4403988011787594,0.46457380934321735,0.4929592701296524,0.5126970899080303,0.5252001405259443,0.5873278300295173,0.5912842936662355,0.5912842936662355,0.5873278300295173,0.5797178083940989,0.5398704713072174,0.5246542067814082,0.5252001405259443,0.5246542067814082,0.5252001405259443,0.5228460413354883,0.5216388036928501,0.5216388036928501,0.5216388036928501,0.5216388036928501,0.5216388036928501,0.516520005650623,0.516520005650623,0.516520005650623,0.5134042862440511,0.5134042862440511,0.5280790017306813,0.5280790017306813,0.5280790017306813,0.5266913463655363,0.5266913463655363,0.5280790017306813,0.5280790017306813,0.5252001405259443,0.5252001405259443,0.5246542067814082,0.5246542067814082,0.5246542067814082,0.5246542067814082,0.5246542067814082,0.5252001405259443,0.5252001405259443,0.5266913463655363,0.5266913463655363,0.5266913463655363,0.5280790017306813,0.5315216949383745,0.5216388036928501,0.5258889217560796,0.5294968461661497,0.5448157085750287,0.5561497920697233,0.579817453418571,0.5912842936662355,0.5983544480822945,0.614399401939441,0.6709676079241521,0.6968558059131394,0.7300261897537855,0.7300261897537855,0.737531876775923,0.737531876775923,0.7300261897537855,0.7619783081220659,0.737531876775923,0.7981297654027435,0.7981297654027435,0.7981297654027435,0.8149888120098369,0.8246840964345039,0.8246840964345039,0.8246840964345039,0.8274455507126441,0.8504438979852621,0.846553980475461,0.846553980475461,0.846553980475461,0.8563859630315253,0.8563859630315253,0.8563859630315253,0.8702332688225639)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 0.9572565957048204), xlim = c(-89.04153881122276,-66.0202065600297), ylab = 'Speciation rate', xlab = 'Time',main='Speciation (PyRate_Inputs_2_RJMCMC_Grj_mcmc)' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#4c4cec',0.3), border = NA)
lines(time,rate[remove_na], col = '#4c4cec', lwd=2)
mids=c(-66.13647591483371, -66.36901462444172,-66.60155333404974,-66.83409204365775,-67.06663075326576,-67.29916946287376,-67.53170817248177,-67.7642468820898,-67.9967855916978,-68.22932430130581,-68.46186301091382,-68.69440172052182,-68.92694043012985,-69.15947913973785,-69.39201784934586,-69.62455655895387,-69.85709526856188,-70.0896339781699,-70.32217268777791,-70.55471139738592,-70.78725010699392,-71.01978881660193,-71.25232752620995,-71.48486623581796,-71.71740494542597,-71.94994365503398,-72.18248236464198,-72.41502107425,-72.64755978385801,-72.88009849346602,-73.11263720307403,-73.34517591268204,-73.57771462229006,-73.81025333189807,-74.04279204150608,-74.27533075111408,-74.50786946072209,-74.74040817033011,-74.97294687993812,-75.20548558954613,-75.43802429915414,-75.67056300876216,-75.90310171837017,-76.13564042797817,-76.36817913758618,-76.60071784719419,-76.8332565568022,-77.06579526641022,-77.29833397601823,-77.53087268562624,-77.76341139523424,-77.99595010484227,-78.22848881445027,-78.46102752405828,-78.69356623366629,-78.9261049432743,-79.1586436528823,-79.39118236249033,-79.62372107209833,-79.85625978170634,-80.08879849131435,-80.32133720092237,-80.55387591053038,-80.78641462013839,-81.0189533297464,-81.2514920393544,-81.48403074896241,-81.71656945857043,-81.94910816817844,-82.18164687778645,-82.41418558739446,-82.64672429700248,-82.87926300661049,-83.1118017162185,-83.3443404258265,-83.57687913543451,-83.80941784504252,-84.04195655465054,-84.27449526425855,-84.50703397386656,-84.73957268347456,-84.97211139308259,-85.2046501026906,-85.4371888122986,-85.66972752190661,-85.90226623151462,-86.13480494112262,-86.36734365073065,-86.59988236033865,-86.83242106994666,-87.06495977955467,-87.29749848916269,-87.5300371987707,-87.76257590837871,-87.99511461798672,-88.22765332759472,-88.46019203720273,-88.69273074681075,-88.92526945641876)
counts=c(0.003, 0.001,0.006,0.003,0.011,0.01,0.006,0.002,0.003,0.007,0.004,0.008,0.001,0.005,0.01,0.018,0.031,0.05,0.106,0.164,0.096,0.109,0.107,0.097,0.02,0.003,0.004,0.007,0.017,0.015,0.003,0.005,0.004,0.003,0.002,0.002,0.004,0.002,0.006,0.002,0.002,0.001,0.003,0.002,0.002,0.004,0.001,0.0,0.002,0.001,0.004,0.0,0.002,0.0,0.002,0.002,0.0,0.001,0.001,0.003,0.002,0.003,0.004,0.003,0.007,0.014,0.005,0.013,0.01,0.007,0.005,0.007,0.006,0.007,0.004,0.009,0.002,0.001,0.005,0.004,0.006,0.002,0.003,0.004,0.003,0.004,0.002,0.006,0.001,0.005,0.004,0.002,0.003,0.004,0.009,0.004,0.004,0.003,0.001)
plot(mids,counts,type = 'h', xlim = c(-89.04153881122276,-66.0202065600297), ylim=c(0,0.2), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#4c4cec')
bf2 = 0.027170230686729628
bf6 = 0.17106655196627238
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)

time=c(-66.13531322128567, -66.3655265437976,-66.59573986630953,-66.82595318882146,-67.0561665113334,-67.28637983384533,-67.51659315635726,-67.74680647886919,-67.97701980138112,-68.20723312389305,-68.43744644640498,-68.6676597689169,-68.89787309142883,-69.12808641394076,-69.3582997364527,-69.58851305896464,-69.81872638147657,-70.0489397039885,-70.27915302650042,-70.50936634901235,-70.73957967152428,-70.96979299403621,-71.20000631654814,-71.43021963906007,-71.66043296157201,-71.89064628408394,-72.12085960659587,-72.3510729291078,-72.58128625161973,-72.81149957413166,-73.04171289664359,-73.27192621915552,-73.50213954166745,-73.73235286417938,-73.9625661866913,-74.19277950920325,-74.42299283171518,-74.6532061542271,-74.88341947673904,-75.11363279925096,-75.3438461217629,-75.57405944427482,-75.80427276678675,-76.03448608929868,-76.26469941181062,-76.49491273432255,-76.72512605683448,-76.95533937934641,-77.18555270185834,-77.41576602437027,-77.6459793468822,-77.87619266939413,-78.10640599190606,-78.33661931441799,-78.56683263692992,-78.79704595944186,-79.02725928195379,-79.25747260446572,-79.48768592697765,-79.71789924948958,-79.9481125720015,-80.17832589451343,-80.40853921702536,-80.6387525395373,-80.86896586204924,-81.09917918456117,-81.3293925070731,-81.55960582958502,-81.78981915209695,-82.02003247460888,-82.25024579712081,-82.48045911963274,-82.71067244214467,-82.9408857646566,-83.17109908716853,-83.40131240968046,-83.6315257321924,-83.86173905470433,-84.09195237721626,-84.32216569972819,-84.55237902224012,-84.78259234475205,-85.01280566726398,-85.2430189897759,-85.47323231228785,-85.70344563479978,-85.9336589573117,-86.16387227982364,-86.39408560233556,-86.6242989248475,-86.85451224735942,-87.08472556987135,-87.31493889238328,-87.54515221489521,-87.77536553740714,-88.00557885991907,-88.23579218243101,-88.46600550494294,-88.69621882745487,-88.9264321499668)
rate=c(2.2502961645918718, 1.4210019209897131,0.30732994850769,0.2759945651150173,0.2691274130267639,0.2682289729535897,0.26811695311015815,0.2681897434955627,0.26811695311015815,0.26811695311015815,0.2681897434955627,0.2682289729535897,0.26853851534413525,0.26875857598135156,0.26900718674658186,0.2690715449223857,0.2690715449223857,0.2690715449223857,0.26900718674658186,0.26900718674658186,0.2690715449223857,0.2691274130267639,0.2691885450232818,0.26957051739177196,0.26973504777403007,0.2701208080920236,0.270416095059542,0.2705740878762235,0.27095344253665093,0.27095344253665093,0.27095344253665093,0.2708702613722204,0.27095344253665093,0.27103621058240523,0.27095344253665093,0.27095344253665093,0.27103621058240523,0.27095344253665093,0.27095344253665093,0.2708702613722204,0.2706914156517425,0.2706914156517425,0.27022159169064963,0.2690715449223857,0.26812923959032864,0.26654121853303026,0.2662976354961343,0.2662920057092404,0.2662855731670456,0.26628191779127763,0.2662804269206172,0.2662804269206172,0.26625172872866487,0.26625172872866487,0.26620806692506715,0.26620806692506715,0.26610616197250275,0.26610616197250275,0.26610616197250275,0.26592947363169944,0.26592947363169944,0.26610616197250275,0.26610616197250275,0.26610616197250275,0.26610616197250275,0.2659848963221934,0.2659848963221934,0.2659848963221934,0.2659848963221934,0.26625172872866487,0.26620806692506715,0.26620806692506715,0.26610616197250275,0.2659848963221934,0.2659848963221934,0.26620806692506715,0.26625172872866487,0.26628091375162755,0.26628091375162755,0.26631772589305636,0.26654121853303026,0.2669944050954459,0.2669944050954459,0.26705965635314544,0.2672132944310175,0.26673976090260076,0.26631772589305636,0.2662855731670456,0.2659848963221934,0.2659115100669157,0.265880584453652,0.2659115100669157,0.26580955428780206,0.26580955428780206,0.26576103729074896,0.26533911640472596,0.26533911640472596,0.2654255938834871,0.26533911640472596,0.26533911640472596)
minHPD=c(0.7167975359903609, 0.16054606789853756,0.0907334859367153,0.11399951252961874,0.1461069892911967,0.17480297240466955,0.17778761751866654,0.17961463458970314,0.17961463458970314,0.17862804256173154,0.18085188885588846,0.18085188885588846,0.18085188885588846,0.18384909237614608,0.18339220851485594,0.18569326642771847,0.18569326642771847,0.18569326642771847,0.18569326642771847,0.18569326642771847,0.18569326642771847,0.1954061728494938,0.18569326642771847,0.19495165174302212,0.19495165174302212,0.19495165174302212,0.19495165174302212,0.1954061728494938,0.1954061728494938,0.19495165174302212,0.19495165174302212,0.19495165174302212,0.19163739850651684,0.19163739850651684,0.19495165174302212,0.19163739850651684,0.19163739850651684,0.18569326642771847,0.1954061728494938,0.19495165174302212,0.19495165174302212,0.19495165174302212,0.18569326642771847,0.18569326642771847,0.184056828060653,0.18569326642771847,0.184056828060653,0.18569326642771847,0.184056828060653,0.184056828060653,0.18569326642771847,0.18569326642771847,0.18569326642771847,0.18569326642771847,0.18569326642771847,0.184056828060653,0.17778761751866654,0.17778761751866654,0.17778761751866654,0.17778761751866654,0.17778761751866654,0.18569326642771847,0.18569326642771847,0.18569326642771847,0.18569326642771847,0.18085188885588846,0.18085188885588846,0.18569326642771847,0.18085188885588846,0.18085188885588846,0.17862804256173154,0.17862804256173154,0.17778761751866654,0.17778761751866654,0.17778761751866654,0.16861947328893634,0.1573786241541553,0.15690377647782489,0.15690377647782489,0.15948242172984742,0.15460676816204458,0.15460676816204458,0.14719699404880424,0.1573786241541553,0.15690377647782489,0.14719699404880424,0.1399059662926976,0.13136557535648635,0.1271372971650543,0.1271372971650543,0.1271372971650543,0.06898699433547469,0.06898699433547469,0.07014858043500097,0.07014858043500097,0.07014858043500097,0.06898699433547469,0.06898699433547469,0.05815757383204241,0.06898699433547469)
maxHPD=c(4.9122825074082455, 3.646847345849426,2.579393657582188,1.305188196038108,0.4098780042791553,0.3838743113892587,0.3743100285573821,0.3743100285573821,0.368403098985153,0.3651141859714461,0.3649718255696775,0.3639266861612182,0.3639266861612182,0.3651141859714461,0.3639266861612182,0.3651141859714461,0.3651141859714461,0.3639266861612182,0.3639266861612182,0.3639266861612182,0.3639266861612182,0.3743100285573821,0.3639266861612182,0.37100825288360123,0.3685902475534927,0.3685902475534927,0.3685902475534927,0.3685902475534927,0.3685902475534927,0.3685902475534927,0.3685902475534927,0.3685902475534927,0.3685902475534927,0.3685902475534927,0.37100825288360123,0.3685902475534927,0.3685902475534927,0.3639266861612182,0.3743100285573821,0.3771272457933709,0.3771272457933709,0.3772603614607949,0.36816750095421397,0.36816750095421397,0.3651141859714461,0.36816750095421397,0.3651141859714461,0.36816750095421397,0.3651141859714461,0.3651141859714461,0.36816750095421397,0.36816750095421397,0.368403098985153,0.368403098985153,0.368403098985153,0.3685902475534927,0.3651141859714461,0.3651141859714461,0.3651141859714461,0.3651141859714461,0.3651141859714461,0.3738979733932411,0.3738979733932411,0.3738979733932411,0.3738979733932411,0.3685902475534927,0.3685902475534927,0.3738979733932411,0.3685902475534927,0.374237472044327,0.374237472044327,0.374237472044327,0.38023360128703015,0.38023360128703015,0.38023360128703015,0.374237472044327,0.3639266861612182,0.36710973526271334,0.3685902475534927,0.374237472044327,0.3772603614607949,0.3872655180519972,0.3872655180519972,0.4039957472570333,0.4039957472570333,0.4039957472570333,0.40833495423923366,0.4041866590908553,0.41710436185235666,0.42377514912385517,0.4300745980751413,0.3997102791979483,0.3997102791979483,0.40181919113375847,0.4041866590908553,0.4041866590908553,0.4041866590908553,0.40833495423923366,0.4041866590908553,0.42377514912385517)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 5.4035107581490704), xlim = c(-89.04153881122276,-66.0202065600297), ylab = 'Extinction rate', xlab = 'Time',main='Extinction' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#e34a33',0.3), border = NA)
lines(time,rate[remove_na], col = '#e34a33', lwd=2)
mids=c(-66.13647591483371, -66.36901462444172,-66.60155333404974,-66.83409204365775,-67.06663075326576,-67.29916946287376,-67.53170817248177,-67.7642468820898,-67.9967855916978,-68.22932430130581,-68.46186301091382,-68.69440172052182,-68.92694043012985,-69.15947913973785,-69.39201784934586,-69.62455655895387,-69.85709526856188,-70.0896339781699,-70.32217268777791,-70.55471139738592,-70.78725010699392,-71.01978881660193,-71.25232752620995,-71.48486623581796,-71.71740494542597,-71.94994365503398,-72.18248236464198,-72.41502107425,-72.64755978385801,-72.88009849346602,-73.11263720307403,-73.34517591268204,-73.57771462229006,-73.81025333189807,-74.04279204150608,-74.27533075111408,-74.50786946072209,-74.74040817033011,-74.97294687993812,-75.20548558954613,-75.43802429915414,-75.67056300876216,-75.90310171837017,-76.13564042797817,-76.36817913758618,-76.60071784719419,-76.8332565568022,-77.06579526641022,-77.29833397601823,-77.53087268562624,-77.76341139523424,-77.99595010484227,-78.22848881445027,-78.46102752405828,-78.69356623366629,-78.9261049432743,-79.1586436528823,-79.39118236249033,-79.62372107209833,-79.85625978170634,-80.08879849131435,-80.32133720092237,-80.55387591053038,-80.78641462013839,-81.0189533297464,-81.2514920393544,-81.48403074896241,-81.71656945857043,-81.94910816817844,-82.18164687778645,-82.41418558739446,-82.64672429700248,-82.87926300661049,-83.1118017162185,-83.3443404258265,-83.57687913543451,-83.80941784504252,-84.04195655465054,-84.27449526425855,-84.50703397386656,-84.73957268347456,-84.97211139308259,-85.2046501026906,-85.4371888122986,-85.66972752190661,-85.90226623151462,-86.13480494112262,-86.36734365073065,-86.59988236033865,-86.83242106994666,-87.06495977955467,-87.29749848916269,-87.5300371987707,-87.76257590837871,-87.99511461798672,-88.22765332759472,-88.46019203720273,-88.69273074681075,-88.92526945641876)
counts=c(0.344, 0.289,0.256,0.074,0.015,0.005,0.002,0.005,0.004,0.004,0.002,0.002,0.004,0.001,0.004,0.002,0.002,0.001,0.001,0.002,0.002,0.004,0.004,0.001,0.003,0.004,0.002,0.003,0.002,0.0,0.002,0.003,0.002,0.001,0.003,0.001,0.003,0.003,0.007,0.001,0.006,0.007,0.01,0.008,0.01,0.002,0.004,0.004,0.001,0.002,0.001,0.001,0.0,0.002,0.004,0.0,0.001,0.001,0.002,0.002,0.002,0.0,0.001,0.002,0.001,0.002,0.002,0.006,0.005,0.0,0.002,0.002,0.001,0.002,0.002,0.004,0.002,0.005,0.007,0.003,0.005,0.007,0.003,0.003,0.007,0.008,0.007,0.004,0.003,0.006,0.001,0.003,0.006,0.003,0.002,0.002,0.002,0.002,0.001)
plot(mids,counts,type = 'h', xlim = c(-89.04153881122276,-66.0202065600297), ylim=c(0,0.344), ylab = 'Frequency of rate shift', xlab = 'Time',lwd=5,col='#e34a33')
abline(h=bf2, lty=2)
abline(h=bf6, lty=2)
#Net Diversification Rate
time=c(-66.13531322128567, -66.3655265437976,-66.59573986630953,-66.82595318882146,-67.0561665113334,-67.28637983384533,-67.51659315635726,-67.74680647886919,-67.97701980138112,-68.20723312389305,-68.43744644640498,-68.6676597689169,-68.89787309142883,-69.12808641394076,-69.3582997364527,-69.58851305896464,-69.81872638147657,-70.0489397039885,-70.27915302650042,-70.50936634901235,-70.73957967152428,-70.96979299403621,-71.20000631654814,-71.43021963906007,-71.66043296157201,-71.89064628408394,-72.12085960659587,-72.3510729291078,-72.58128625161973,-72.81149957413166,-73.04171289664359,-73.27192621915552,-73.50213954166745,-73.73235286417938,-73.9625661866913,-74.19277950920325,-74.42299283171518,-74.6532061542271,-74.88341947673904,-75.11363279925096,-75.3438461217629,-75.57405944427482,-75.80427276678675,-76.03448608929868,-76.26469941181062,-76.49491273432255,-76.72512605683448,-76.95533937934641,-77.18555270185834,-77.41576602437027,-77.6459793468822,-77.87619266939413,-78.10640599190606,-78.33661931441799,-78.56683263692992,-78.79704595944186,-79.02725928195379,-79.25747260446572,-79.48768592697765,-79.71789924948958,-79.9481125720015,-80.17832589451343,-80.40853921702536,-80.6387525395373,-80.86896586204924,-81.09917918456117,-81.3293925070731,-81.55960582958502,-81.78981915209695,-82.02003247460888,-82.25024579712081,-82.48045911963274,-82.71067244214467,-82.9408857646566,-83.17109908716853,-83.40131240968046,-83.6315257321924,-83.86173905470433,-84.09195237721626,-84.32216569972819,-84.55237902224012,-84.78259234475205,-85.01280566726398,-85.2430189897759,-85.47323231228785,-85.70344563479978,-85.9336589573117,-86.16387227982364,-86.39408560233556,-86.6242989248475,-86.85451224735942,-87.08472556987135,-87.31493889238328,-87.54515221489521,-87.77536553740714,-88.00557885991907,-88.23579218243101,-88.46600550494294,-88.69621882745487,-88.9264321499668)
net_rate=c(-2.343884373092176, -1.3414707567489594,-0.6750655472364309,-0.22970068463672433,-0.14235789534978543,-0.12613243240805722,-0.12045241579349798,-0.119926906916535,-0.11897069199475932,-0.11893068502900257,-0.1200710241617539,-0.1203497044636618,-0.12095202009971505,-0.12133756289676868,-0.12048714105618466,-0.11892092190846773,-0.1156428689556112,-0.10842995553845337,-0.09565256460950529,-0.06791197171741856,-0.014550486454425098,0.016410789300710778,0.04706017258635705,0.08384435217586295,0.12132542568713431,0.1389750143076679,0.13922411465627998,0.13795410500787406,0.1359963682728763,0.1271504380491194,0.11681271295794739,0.1151336125545351,0.11337343632206909,0.11296344857560367,0.11263590157601283,0.11104319379965753,0.11083368141192497,0.11077358496234728,0.1094434068250212,0.10930635654405632,0.10828190530424052,0.1081229261194398,0.10919678243341571,0.11181821776454376,0.11495005559481247,0.11780225042073313,0.11786264910747549,0.11778460978402172,0.11773766965141758,0.11755671882345478,0.11765235834466356,0.1176874932033696,0.11762465318969008,0.11762465318969008,0.11778434715360037,0.11797956533177209,0.11822965031636784,0.1182399644854654,0.1182399644854654,0.11863462518150765,0.11899233959783855,0.11889848632772361,0.11970946551661105,0.12061421680486961,0.12084341947579505,0.12268168169684493,0.12697927806609857,0.13059140100752303,0.13320886761298473,0.13960173057655553,0.14517828082375978,0.1470796722827461,0.14884531679921859,0.15279293169552258,0.1540788699959627,0.15680089497529062,0.158161598392518,0.16110364495488047,0.16019269016145007,0.15793652804510933,0.15841154483353168,0.15331205742183734,0.1538876453545406,0.15012463649207464,0.15094342854159232,0.153025464472867,0.15715879725624698,0.16288809893544656,0.1675967844659291,0.17015048428203416,0.1701279531489575,0.17005435097697227,0.17082937167372986,0.16990779323097577,0.17017135556017252,0.17149018921758777,0.17404884366098772,0.17441958683310937,0.17575023060424885,0.17699500344618038)
net_minHPD=c(-4.798861248627024, -3.5155991683966876,-2.4357061179167325,-1.1903945453960356,-0.31748599344842615,-0.2919180153037737,-0.2945315641191515,-0.2945315641191515,-0.2919180153037737,-0.2919180153037737,-0.2919180153037737,-0.2919180153037737,-0.2936343084738122,-0.2936343084738122,-0.2919180153037737,-0.2919180153037737,-0.2919180153037737,-0.2919180153037737,-0.2919180153037737,-0.26509455103140156,-0.26509455103140156,-0.2610562649710143,-0.23134711664845953,-0.21498618614441645,-0.16929224538187682,-0.12887802762880834,-0.12887802762880834,-0.12887802762880834,-0.09497252321857474,-0.06169108723994415,-0.05141942231483765,-0.05141942231483765,-0.05141942231483765,-0.05399520054662155,-0.05141942231483765,-0.05141942231483765,-0.05141942231483765,-0.05141942231483765,-0.05399520054662155,-0.05141942231483765,-0.05141942231483765,-0.05141942231483765,-0.05141942231483765,-0.05100666666662329,-0.03945872005018672,-0.03945872005018672,-0.03977522995360355,-0.03977522995360355,-0.03977522995360355,-0.03977522995360355,-0.03977522995360355,-0.03977522995360355,-0.03205367102249834,-0.03205367102249834,-0.03205367102249834,-0.03205367102249834,-0.03977522995360355,-0.03977522995360355,-0.03977522995360355,-0.03977522995360355,-0.03977522995360355,-0.03977522995360355,-0.03205367102249834,-0.03977522995360355,-0.03977522995360355,-0.03977522995360355,-0.03977522995360355,-0.04803568005648021,-0.05141942231483765,-0.05141942231483765,-0.05399520054662155,-0.06290655016816282,-0.06107619610649398,-0.06290655016816282,-0.06290655016816282,-0.06107619610649398,-0.08410286984047177,-0.09011520413179641,-0.06290655016816282,-0.09011520413179641,-0.06290655016816282,-0.09011520413179641,-0.0597228572756387,-0.0597228572756387,-0.0597228572756387,-0.06290655016816282,-0.05399520054662155,-0.06290655016816282,-0.09011520413179641,-0.06290655016816282,-0.07166127296912161,-0.09011520413179641,-0.09011520413179641,-0.07166127296912161,-0.08410286984047177,-0.08410286984047177,-0.08410286984047177,-0.14680764381681075,-0.14680764381681075,-0.14680764381681075)
net_maxHPD=c(-0.5677473550245498, 0.11717080457275342,0.1928308611084055,0.1362032643124186,0.11717080457275342,0.11176055304923582,0.10235316901445124,0.09907921915883414,0.09907921915883414,0.09731567955052578,0.09731567955052578,0.09731567955052578,0.09670962041626596,0.09670962041626596,0.09901442265926019,0.1029770441486455,0.11021034452747946,0.12089175273756725,0.14509906907452308,0.2103985753120555,0.23760528793953578,0.2546060727368102,0.2806937118997642,0.2833878250124167,0.310591050894951,0.32308226369050225,0.3219176737886549,0.3066934766483608,0.32308226369050225,0.3066934766483608,0.28937640268790676,0.2833878250124167,0.2833878250124167,0.27852149675019433,0.27852149675019433,0.27852149675019433,0.27852149675019433,0.27852149675019433,0.2750277115725437,0.2750277115725437,0.27219973221199084,0.27219973221199084,0.27177441812318665,0.2710796961293752,0.2785654727131657,0.2785654727131657,0.2756746141811536,0.2756746141811536,0.2750277115725437,0.2750277115725437,0.2756746141811536,0.2756746141811536,0.2818916064896999,0.2818916064896999,0.2818916064896999,0.2818916064896999,0.2750277115725437,0.2750277115725437,0.2750277115725437,0.2756746141811536,0.2750277115725437,0.2756746141811536,0.2818916064896999,0.2758685626156309,0.2758685626156309,0.276284388241933,0.2785654727131657,0.2785654727131657,0.2785654727131657,0.3066934766483608,0.32308226369050225,0.32308226369050225,0.3418059436788472,0.36154242681687887,0.369179996341176,0.40459758336463836,0.42587243218191834,0.4844312034941006,0.5491327745448086,0.5624239316542742,0.6292096052477899,0.6140904159196334,0.6649602363595314,0.6649602363595314,0.6649602363595314,0.6435728199586579,0.6674410177677317,0.6470705793113333,0.6292096052477899,0.6674410177677317,0.6674410177677317,0.6674410177677317,0.6674410177677317,0.7036157848615812,0.7036157848615812,0.701616121223392,0.7036157848615812,0.6649602363595314,0.6674410177677317,0.6857926034582258)
remove_na = !is.na(net_rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(-5.278747373489727, 0.7739773633477394), xlim = c(-89.04153881122276,-66.0202065600297), ylab = 'Net Rate', xlab = 'Time',lwd=2, main='Net diversification', col= '#504A4B' )
polygon(c(time, rev(time)), c(net_maxHPD[remove_na], rev(net_minHPD[remove_na])), col = alpha('#504A4B',0.3), border = NA)
lines(time,net_rate[remove_na], col = '#504A4B', lwd=2)
abline(h=0,lty=2)


time=c(-66.13531322128567, -66.3655265437976,-66.59573986630953,-66.82595318882146,-67.0561665113334,-67.28637983384533,-67.51659315635726,-67.74680647886919,-67.97701980138112,-68.20723312389305,-68.43744644640498,-68.6676597689169,-68.89787309142883,-69.12808641394076,-69.3582997364527,-69.58851305896464,-69.81872638147657,-70.0489397039885,-70.27915302650042,-70.50936634901235,-70.73957967152428,-70.96979299403621,-71.20000631654814,-71.43021963906007,-71.66043296157201,-71.89064628408394,-72.12085960659587,-72.3510729291078,-72.58128625161973,-72.81149957413166,-73.04171289664359,-73.27192621915552,-73.50213954166745,-73.73235286417938,-73.9625661866913,-74.19277950920325,-74.42299283171518,-74.6532061542271,-74.88341947673904,-75.11363279925096,-75.3438461217629,-75.57405944427482,-75.80427276678675,-76.03448608929868,-76.26469941181062,-76.49491273432255,-76.72512605683448,-76.95533937934641,-77.18555270185834,-77.41576602437027,-77.6459793468822,-77.87619266939413,-78.10640599190606,-78.33661931441799,-78.56683263692992,-78.79704595944186,-79.02725928195379,-79.25747260446572,-79.48768592697765,-79.71789924948958,-79.9481125720015,-80.17832589451343,-80.40853921702536,-80.6387525395373,-80.86896586204924,-81.09917918456117,-81.3293925070731,-81.55960582958502,-81.78981915209695,-82.02003247460888,-82.25024579712081,-82.48045911963274,-82.71067244214467,-82.9408857646566,-83.17109908716853,-83.40131240968046,-83.6315257321924,-83.86173905470433,-84.09195237721626,-84.32216569972819,-84.55237902224012,-84.78259234475205,-85.01280566726398,-85.2430189897759,-85.47323231228785,-85.70344563479978,-85.9336589573117,-86.16387227982364,-86.39408560233556,-86.6242989248475,-86.85451224735942,-87.08472556987135,-87.31493889238328,-87.54515221489521,-87.77536553740714,-88.00557885991907,-88.23579218243101,-88.46600550494294,-88.69621882745487,-88.9264321499668)
rate=c(0.4013153940434168, 0.6720458290486531,1.2181062772799474,2.659117682513638,3.4605426264920545,3.6323235730021124,3.673924371375342,3.676596937056455,3.6820862524132583,3.685490451622615,3.6778838235775986,3.673875880287295,3.672132353229689,3.6649634127702564,3.6603386039306924,3.6545799507514483,3.6545799507514483,3.651073272830288,3.652102697520682,3.652102697520682,3.650194690668777,3.645337211741103,3.6414125842839296,3.6352975807404584,3.634038794961078,3.6303810497246856,3.6256742864538074,3.6217694496636503,3.6191799178930655,3.617419367826711,3.617780745436146,3.618515103509032,3.6042529299695594,3.6026656680050686,3.604282255203281,3.5879650158847873,3.586544604201579,3.5863280294133966,3.5770555351160285,3.578118641773812,3.579233044490379,3.5792143723723098,3.5982002225757057,3.635756800229517,3.676774342142774,3.7148486282484345,3.7215078519413893,3.722146537706319,3.723552057623109,3.72350651896611,3.726243680988647,3.7269440293490006,3.732945245111632,3.732945245111632,3.733727237638827,3.7359783281633856,3.7394513328726555,3.739595566580767,3.739595566580767,3.742010485691746,3.742010485691746,3.738893840769395,3.738973610989463,3.738973610989463,3.738330040008769,3.7380049066276375,3.738258862436646,3.735467713012629,3.7349551204747287,3.723272925102574,3.7282071219779387,3.7282071219779387,3.7170987327292817,3.718865581641464,3.7196612844730743,3.715323049385953,3.7102069535940743,3.6961132448072433,3.68447133566535,3.640805082569408,3.6120950126216003,3.5577785187301747,3.5488033106040886,3.5113387917951577,3.5081576570879087,3.538184154565109,3.564991559517439,3.6170035279063835,3.6632069296961225,3.6737169751663155,3.666330030017423,3.6614029156426997,3.6642801281214554,3.6609728545162983,3.656552844863876,3.6744460740249614,3.6771117491222114,3.66843043563426,3.673102713399435,3.6731331769462447)
minHPD=c(0.4013153940434168, 0.6720458290486531,1.2181062772799474,2.659117682513638,3.4605426264920545,3.6323235730021124,3.673924371375342,3.676596937056455,3.6820862524132583,3.685490451622615,3.6778838235775986,3.673875880287295,3.672132353229689,3.6649634127702564,3.6603386039306924,3.6545799507514483,3.6545799507514483,3.651073272830288,3.652102697520682,3.652102697520682,3.650194690668777,3.645337211741103,3.6414125842839296,3.6352975807404584,3.634038794961078,3.6303810497246856,3.6256742864538074,3.6217694496636503,3.6191799178930655,3.617419367826711,3.617780745436146,3.618515103509032,3.6042529299695594,3.6026656680050686,3.604282255203281,3.5879650158847873,3.586544604201579,3.5863280294133966,3.5770555351160285,3.578118641773812,3.579233044490379,3.5792143723723098,3.5982002225757057,3.635756800229517,3.676774342142774,3.7148486282484345,3.7215078519413893,3.722146537706319,3.723552057623109,3.72350651896611,3.726243680988647,3.7269440293490006,3.732945245111632,3.732945245111632,3.733727237638827,3.7359783281633856,3.7394513328726555,3.739595566580767,3.739595566580767,3.742010485691746,3.742010485691746,3.738893840769395,3.738973610989463,3.738973610989463,3.738330040008769,3.7380049066276375,3.738258862436646,3.735467713012629,3.7349551204747287,3.723272925102574,3.7282071219779387,3.7282071219779387,3.7170987327292817,3.718865581641464,3.7196612844730743,3.715323049385953,3.7102069535940743,3.6961132448072433,3.68447133566535,3.640805082569408,3.6120950126216003,3.5577785187301747,3.5488033106040886,3.5113387917951577,3.5081576570879087,3.538184154565109,3.564991559517439,3.6170035279063835,3.6632069296961225,3.6737169751663155,3.666330030017423,3.6614029156426997,3.6642801281214554,3.6609728545162983,3.656552844863876,3.6744460740249614,3.6771117491222114,3.66843043563426,3.673102713399435,3.6731331769462447)
maxHPD=c(0.4013153940434168, 0.6720458290486531,1.2181062772799474,2.659117682513638,3.4605426264920545,3.6323235730021124,3.673924371375342,3.676596937056455,3.6820862524132583,3.685490451622615,3.6778838235775986,3.673875880287295,3.672132353229689,3.6649634127702564,3.6603386039306924,3.6545799507514483,3.6545799507514483,3.651073272830288,3.652102697520682,3.652102697520682,3.650194690668777,3.645337211741103,3.6414125842839296,3.6352975807404584,3.634038794961078,3.6303810497246856,3.6256742864538074,3.6217694496636503,3.6191799178930655,3.617419367826711,3.617780745436146,3.618515103509032,3.6042529299695594,3.6026656680050686,3.604282255203281,3.5879650158847873,3.586544604201579,3.5863280294133966,3.5770555351160285,3.578118641773812,3.579233044490379,3.5792143723723098,3.5982002225757057,3.635756800229517,3.676774342142774,3.7148486282484345,3.7215078519413893,3.722146537706319,3.723552057623109,3.72350651896611,3.726243680988647,3.7269440293490006,3.732945245111632,3.732945245111632,3.733727237638827,3.7359783281633856,3.7394513328726555,3.739595566580767,3.739595566580767,3.742010485691746,3.742010485691746,3.738893840769395,3.738973610989463,3.738973610989463,3.738330040008769,3.7380049066276375,3.738258862436646,3.735467713012629,3.7349551204747287,3.723272925102574,3.7282071219779387,3.7282071219779387,3.7170987327292817,3.718865581641464,3.7196612844730743,3.715323049385953,3.7102069535940743,3.6961132448072433,3.68447133566535,3.640805082569408,3.6120950126216003,3.5577785187301747,3.5488033106040886,3.5113387917951577,3.5081576570879087,3.538184154565109,3.564991559517439,3.6170035279063835,3.6632069296961225,3.6737169751663155,3.666330030017423,3.6614029156426997,3.6642801281214554,3.6609728545162983,3.656552844863876,3.6744460740249614,3.6771117491222114,3.66843043563426,3.673102713399435,3.6731331769462447)
remove_na = !is.na(rate)
time = time[remove_na]
plot(time,time,type = 'n', ylim = c(0, 4.116211534260921), xlim = c(-89.04153881122276,-66.0202065600297), ylab = 'Mean longevity', xlab = 'Time',main='Longevity' )
polygon(c(time, rev(time)), c(maxHPD[remove_na], rev(minHPD[remove_na])), col = alpha('#756bb1',0.3), border = NA)
lines(time,rate[remove_na], col = '#756bb1', lwd=4)

n <- dev.off()