# 1 files combined:
# 	./PyRate_Inputs_2_BDMCMC_Grj_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='./PyRate_Inputs_2_BDMCMC_Grj_marginal_rates_RTT.pdf',width=10.8, height=8.4)
par(mfrow=c(2,2))
library(scales)
plot_RTT <- function (age,hpd_M,hpd_m,mean_m,color){
    N=100
    beta=(1:(N-1))/N
    alpha_shape=0.25
    cat=1-(beta^(1./alpha_shape))
    for (i in 1:(N-1)){
        trans= 1/N + 2/N
        polygon(c(age, rev(age)), c(hpd_M-((hpd_M-mean_m)*cat[i]), rev(hpd_m+((mean_m-hpd_m)*cat[i]))), col = alpha(color,trans), border = NA)
    }
    lines(rev(age), rev(mean_m), col = color, lwd=3)
}
    
L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.035548468570875,0.034824043995327,0.033410109087498,0.025320533058942,0.053645650947302,0.202591250295625,0.252500159202533,0.259254483460838,0.236581289698822,0.245606319455136,0.248280714062243,0.245606319455136,0.245606319455136,0.249886617712333,0.248280714062243,0.246966817665873,0.23305878234987,0.237758316999978,0.246966817665873,0.219939596402324,0.23305878234987,0.237758316999978)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.342554808420283,0.342725710669677,0.344434925673599,0.380112585194513,0.501734021158947,0.627627986439769,0.547024723167449,0.552313549744944,0.510330607912806,0.510330607912806,0.510330607912806,0.510330607912806,0.510330607912806,0.522142378556869,0.528819131758174,0.552313549744944,0.602539466802188,0.684453618008663,0.755034458041105,0.78705553244829,0.81610077013978,0.857029969028131)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.180237674727914,0.186524962544365,0.186524962544365,0.185593298668804,0.186524962544365,0.186524962544365,0.186524962544365,0.186524962544365,0.186524962544365,0.186524962544365,0.186524962544365,0.18299762240156,0.181422411148219,0.176583419605047,0.176583419605047,0.180369341806485,0.180237674727914,0.181422411148219,0.178160618777397,0.166045466428254,0.136417031545071,0.135392515049176)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.376276131167271,0.365254766230421,0.364076989447571,0.359340955461482,0.359340955461482,0.357690363077347,0.357690363077347,0.357690363077347,0.358368461552213,0.359137557415494,0.364972820479482,0.365254766230421,0.364076989447571,0.359340955461482,0.359340955461482,0.364076989447571,0.364972820479482,0.376276131167271,0.377034932726092,0.382145699559544,0.375697761682154,0.377034932726092)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.285720390381456,-0.289360102431049,-0.289360102431049,-0.295555713675888,-0.265439965242779,-0.096181592975243,-0.066244874180575,-0.058098497149833,-0.057636157637293,-0.058098497149833,-0.033098337799821,-0.028239934013405,-0.028239934013405,-0.028239934013405,-0.052850048770737,-0.056628508510758,-0.096181592975243,-0.072243685562017,-0.085949687472914,-0.117065336454084,-0.096181592975243,-0.091245161395509)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.10872446754044,0.083365193808035,0.08290447131478,0.111459169951974,0.245685825027895,0.362606014662259,0.289868836372744,0.294239465290088,0.280277994115059,0.272971339926123,0.285409508090661,0.287770139780746,0.287770139780746,0.287770139780746,0.286288195029852,0.322319020654578,0.356737468717781,0.482653887582177,0.509150014712592,0.544224601598302,0.562182030951933,0.629004083231252)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.146464687009824,0.146246932629835,0.144198849783047,0.158917045577686,0.315139061137229,0.412663856890784,0.393481582081193,0.39110631688907,0.386932132968556,0.38530764838273,0.385468634994166,0.385727763208915,0.385620133786798,0.387528821430912,0.391994190461761,0.404181465242575,0.418826898371937,0.426809152405679,0.433143616013901,0.441375966313466,0.439700822399923,0.444265890627029)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.283984946675545,0.271517841878256,0.272496272348002,0.273503864995227,0.274513349308516,0.276211774112452,0.276288559916759,0.276829342199437,0.27860083758784,0.276112258567585,0.269914375857647,0.268587529307698,0.267876025581238,0.267770630325148,0.267849775056029,0.268164307512248,0.269184799583037,0.272565388900051,0.27576601757165,0.274355527384944,0.271101700893994,0.271021512021279)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.13752025966572,-0.125270909248422,-0.128297422564954,-0.114586819417541,0.040625711828713,0.136452082778331,0.117193022164434,0.114276974689633,0.108331295380716,0.109195389815144,0.115554259136519,0.117140233901216,0.11774410820556,0.119758191105763,0.124144415405732,0.136017157730327,0.1496420987889,0.154243763505628,0.157377598442251,0.167020438928522,0.168599121505929,0.17324437860575)
trans=0.5
age=(0:(89-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.9427329659309441), xlim = c(-93.45,-62.55), ylab = 'Speciation rate', xlab = 'Ma',main='PyRate' )
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 0.4203602695154985), xlim = c(-93.45,-62.55), ylab = 'Extinction rate', xlab = 'Ma' )
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.32511128504347686, 0.6919044915543773), xlim = c(-93.45,-62.55), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
n <- dev.off()