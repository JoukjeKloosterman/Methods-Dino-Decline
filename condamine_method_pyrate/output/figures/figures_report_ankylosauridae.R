# 1 files combined:
# 	./PyRate_Inputs_2_BDMCMC_Grj_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

if(!require('base64')) {
  install.packages('base64')
  library('base64')
}

library("magick")


pngfile <- "./figures report Ankylosauridae.png"
png(pngfile, width = 8, height = 15, units = "in", res = 1200)
# par(mfrow=c(4,2))

# Define the layout matrix
layout_matrix <- matrix(c(1, 1, 
                          2, 3, 
                          4, 5, 
                          6, 7, 
                          8, 9), 
                        nrow = 5, ncol = 2, byrow = TRUE)

# Set up the layout
layout(layout_matrix)

images <- image_read("Results Condamine Ankylosauridae.png")
par(mar = c(0, 0, 0, 0))
plot.new()
rasterImage(images, 0, 0, 1, 1)

par(mar = c(5, 4, 4, 2))

library(scales)
plot_RTT <- function (age,hpd_M,hpd_m,mean_m,color){
  N=100
  beta=(1:(N-1))/N
  alpha_shape=0.25
  cat=1-(beta^(1./alpha_shape))
  for (i in 1:(N-1)){
    trans= 1/N + 2/N
    polygon(c(age, rev(age)), c(hpd_M-((hpd_M-mean_m)*cat[i]), rev(hpd_m+((mean_m-hpd_m)*cat[i]))), col = alpha(color,trans), border = NA)
  }
  lines(rev(age), rev(mean_m), col = color, lwd=3)
}


# CONDAMINE EDITED DATA - Ankylosauridae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.122791203850803,0.122791203850803,0.122791203850803,0.123389300215823,0.124864153370295,0.12312029879305,0.122868325421156,0.122868325421156,0.122868325421156,0.122868325421156,0.122868325421156,0.122791203850803,0.122868325421156,0.122868325421156,0.122868325421156,0.122868325421156,0.122791203850803,0.122791203850803,0.122868325421156,0.122791203850803,0.122791203850803,0.122791203850803,0.122791203850803,0.122791203850803,0.122868325421156,0.122868325421156,0.122791203850803,0.122791203850803,0.122791203850803,0.122868325421156,0.122791203850803,0.118465434985441,0.117154771132446,0.117154771132446,0.117154771132446,0.117649689549339,0.110889152034082,0.110889152034082,0.117649689549339,0.117649689549339,0.117649689549339,0.110889152034082,0.117649689549339,0.117649689549339,0.117649689549339,0.117649689549339,0.117649689549339,0.117649689549339,0.119350143668245,0.119350143668245,0.119350143668245,0.119350143668245,0.117649689549339,0.102430695480781,0.08467504475014,0.110889152034082,0.110889152034082,0.094252338783611,0.094252338783611)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.264294179297704,0.26103108301218,0.260342146052216,0.260054282978251,0.260054282978251,0.257144270611888,0.256159813238578,0.256159813238578,0.256159813238578,0.256159813238578,0.256159813238578,0.256159813238578,0.257144270611888,0.257144270611888,0.257144270611888,0.257144270611888,0.256159813238578,0.256159813238578,0.257144270611888,0.256159813238578,0.256159813238578,0.256159813238578,0.256159813238578,0.256159813238578,0.257144270611888,0.257144270611888,0.258478130046601,0.257144270611888,0.26103108301218,0.261565104504157,0.264294179297704,0.26771746466932,0.268964496321262,0.273649828655003,0.283149902948202,0.283149902948202,0.284744918907264,0.290482724810781,0.314148347711186,0.315616542630103,0.322305397038631,0.321571189533569,0.340409894600281,0.345636400446559,0.345636400446559,0.345636400446559,0.345636400446559,0.345636400446559,0.348552022438866,0.349252206395262,0.348552022438866,0.349252206395262,0.352612836283079,0.356366235806236,0.356366235806236,0.407592339722275,0.453399099411248,0.516552579725138,0.638268499112764)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.09825706409438,0.120175730051497,0.113918022859571,0.113918022859571,0.118190035358359,0.121386457681322,0.104651035681011,0.097812980010243,0.097812980010243,0.07494004826251,0.07198129305483,0.07494004826251,0.07494004826251,0.07198129305483,0.072383121971994,0.072383121971994,0.072383121971994,0.07494004826251,0.075163068695021,0.07198129305483,0.07198129305483,0.07198129305483,0.07198129305483,0.07198129305483,0.07198129305483,0.07198129305483,0.07198129305483,0.070131926186297,0.070131926186297,0.07198129305483,0.07198129305483,0.07198129305483,0.081376375107071,0.074766376516972,0.081376375107071,0.072686204721254,0.07198129305483,0.07198129305483,0.074766376516972,0.072383121971994,0.07198129305483,0.07198129305483,0.074766376516972,0.072383121971994,0.070131926186297,0.07198129305483,0.061449109482076,0.070131926186297,0.07198129305483,0.072383121971994,0.07198129305483,0.070131926186297,0.070131926186297,0.07198129305483,0.059913356571078,0.057820148139504,0.070131926186297,0.059913356571078,0.043767111562746)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.759601389522585,0.533286574089554,0.512942967097052,0.512942967097052,0.498097283331323,0.494964580516174,0.456636257335206,0.442671215533807,0.441874898078015,0.357811572505654,0.272003004324076,0.263118168499686,0.261674975118496,0.257897552889348,0.257897552889348,0.257897552889348,0.257897552889348,0.257588575635215,0.257897552889348,0.254043038622683,0.252398888665032,0.252398888665032,0.252398888665032,0.252398888665032,0.251179282715854,0.251179282715854,0.251179282715854,0.251179282715854,0.251179282715854,0.254043038622683,0.254043038622683,0.254043038622683,0.264094745533699,0.257897552889348,0.264094745533699,0.257897552889348,0.257897552889348,0.258551989646504,0.264094745533699,0.263365426551336,0.264094745533699,0.268306723060666,0.272502622895728,0.272502622895728,0.272502622895728,0.277369118009081,0.272502622895728,0.272502622895728,0.272502622895728,0.272502622895728,0.272502622895728,0.272502622895728,0.274439154157175,0.283557810710539,0.272502622895728,0.272502622895728,0.28914848970742,0.2875361261979,0.313884057938775)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.59833461177275,-0.367473847030406,-0.3625214081805,-0.341793005527575,-0.336179981862761,-0.309473919205802,-0.284653768841942,-0.280789896148536,-0.275911664646563,-0.165452795374656,-0.091861257527267,-0.090888779924114,-0.087492565089036,-0.084843649371564,-0.083429821286217,-0.083429821286217,-0.081362353034755,-0.080258722269616,-0.081657088720659,-0.080258722269616,-0.081362353034755,-0.081657088720659,-0.081657088720659,-0.081657088720659,-0.083429821286217,-0.083429821286217,-0.080258722269616,-0.081657088720659,-0.083429821286217,-0.089546605451043,-0.091861257527267,-0.091861257527267,-0.096507589489352,-0.091861257527267,-0.095203737285008,-0.110533236714755,-0.10740162958022,-0.10740162958022,-0.110533236714755,-0.121227076243198,-0.119125887868064,-0.121227076243198,-0.121227076243198,-0.121227076243198,-0.121227076243198,-0.119125887868064,-0.119125887868064,-0.121227076243198,-0.121227076243198,-0.121227076243198,-0.121227076243198,-0.121227076243198,-0.121227076243198,-0.121227076243198,-0.121227076243198,-0.119125887868064,-0.201826296653947,-0.214638854215865,-0.481439834029212)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.155020862812896,0.097992485435311,0.097992485435311,0.109118978033379,0.09967666826308,0.109118978033379,0.09967666826308,0.09967666826308,0.104445465579314,0.156948503893147,0.139649891529761,0.129137512479456,0.129137512479456,0.129137512479456,0.129137512479456,0.129137512479456,0.129137512479456,0.129137512479456,0.129137512479456,0.129137512479456,0.129137512479456,0.129137512479456,0.129137512479456,0.129137512479456,0.129137512479456,0.129137512479456,0.136562465090301,0.136176440614201,0.141363592628441,0.137404728136216,0.137925392238341,0.148699341742243,0.149120812990966,0.159240734910508,0.160178294216073,0.149120812990966,0.16520151128421,0.167501099528438,0.17159688657558,0.167501099528438,0.188859279271567,0.211741549531249,0.223863601765021,0.245072018023993,0.248232073707718,0.254922160424361,0.265751189206306,0.254922160424361,0.245072018023993,0.238217722506961,0.238217722506961,0.245072018023993,0.248232073707718,0.302023934185282,0.341270358947825,0.374514704966788,0.341270358947825,0.497827347295344,0.612425903939483)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.187779532702088,0.187496537324038,0.187765688274463,0.188226065534734,0.188762037755861,0.188699784996827,0.188499972415467,0.188536864536539,0.188669254098372,0.188669254098372,0.188508029347903,0.188331451725636,0.188561737564466,0.188498759398323,0.188498759398323,0.188477009422313,0.188432055929378,0.188432055929378,0.188209564812817,0.188236873032869,0.188134877658106,0.188200839089937,0.188313823252052,0.188295414111232,0.188603031652406,0.188603031652406,0.189610590362475,0.189826612111784,0.191494761753756,0.191863687718278,0.193177459267169,0.194897746000418,0.19624686922447,0.19686712474546,0.197896530106071,0.1982001080202,0.199528268852936,0.199978781885686,0.20088825271484,0.201317795244517,0.202721321869729,0.203369858606277,0.203779596027346,0.204087402153907,0.204224419496805,0.20432177513543,0.204354015226824,0.20500416307107,0.204762697082823,0.204777156173552,0.204669870178319,0.204905399055564,0.206562016840586,0.21034457248798,0.211828882001342,0.215522797419509,0.221903838119723,0.240969195034373,0.260647044892931)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.346248280294928,0.281143291101964,0.27595195708412,0.276207209041256,0.269688185226608,0.262223198984971,0.244491794523273,0.240223237283064,0.233952110088219,0.185328850982222,0.166617680401464,0.163737897146384,0.163131079331137,0.162874333192499,0.162297836134598,0.16218877659826,0.16209259358825,0.161934048632087,0.162020245449071,0.16209678146392,0.162035286890653,0.16208913768874,0.16208913768874,0.16208913768874,0.161859057646872,0.161559783527243,0.16159682677644,0.161925037716329,0.161977568431816,0.162369177797567,0.162301146246844,0.162805743754664,0.163054700564044,0.16334098032753,0.163846139511463,0.16518450944877,0.16581535597045,0.165966159295443,0.166600333348583,0.167934483950317,0.169860461781971,0.179735308418667,0.180327332811775,0.184603095009177,0.189878226269059,0.19177955085869,0.191702705689252,0.183522814136974,0.175577086994425,0.172407504402742,0.171620675583556,0.172203761574742,0.172182325999627,0.17361517880834,0.174235198808441,0.175346896038916,0.176455548273023,0.178504314169856,0.183772934257599)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.15846874759284,-0.093646753777926,-0.088186268809657,-0.087981143506522,-0.080926147470747,-0.073523413988144,-0.055991822107806,-0.051686372746525,-0.045282855989847,0.00334040311615,0.021890348946439,0.024593554579253,0.025430658233328,0.025624426205824,0.026200923263725,0.026288232824053,0.026339462341128,0.026498007297291,0.026189319363746,0.026140091568949,0.026099590767453,0.026111701401197,0.026224685563312,0.026206276422492,0.026743974005534,0.027043248125163,0.028013763586035,0.027901574395455,0.029517193321941,0.029494509920711,0.030876313020324,0.032092002245754,0.033192168660426,0.033526144417929,0.034050390594608,0.03301559857143,0.033712912882486,0.034012622590243,0.034287919366257,0.033383311294201,0.032860860087758,0.02363455018761,0.023452263215571,0.01948430714473,0.014346193227747,0.01254222427674,0.012651309537571,0.021481348934096,0.029185610088398,0.03236965177081,0.033049194594763,0.032701637480822,0.034379690840959,0.03672939367964,0.037593683192902,0.040175901380593,0.0454482898467,0.062464880864518,0.076874110635332)
trans=0.5
age=(-2:(127-3))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="a - Condamine et al.'s Edited Ankylosauridae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 0.8, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "b - Condamine et al.'s Edited Ankylosauridae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 0.6, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")




# CONDAMINE RAW DATA - Ankylosauridae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.001379581786591,0.001477718421852,0.001731782155333,0.001731782155333,0.001731782155333,0.001731782155333,0.001477718421852,0.001131589594074,0.000981660203653,0.000981660203653,0.069899737401717,0.074167238212528,0.075924724893336,0.075924724893336,0.075924724893336,0.075924724893336,0.076362407422847,0.075924724893336,0.075924724893336,0.070108813466908,0.072134920500194,0.073080677533146,0.073713375352254,0.069899737401717,0.073713375352254,0.073713375352254,0.073713375352254,0.073713375352254,0.073713375352254,0.069899737401717,0.069899737401717,0.069899737401717,0.069899737401717,0.069899737401717,0.069899737401717,0.069899737401717,0.069899737401717,0.069899737401717,0.069899737401717,0.073713375352254,0.073713375352254,0.068881002985602,0.068881002985602,0.068881002985602,0.068881002985602,0.068066621118873,0.068881002985602,0.069899737401717,0.068881002985602,0.068066621118873,0.068881002985602,0.068066621118873,0.076400116728715,0.074942282470848,0.069899737401717,0.068881002985602,0.068881002985602,0.068881002985602,0.068881002985602,0.063439017222539,0.063439017222539,0.063439017222539,0.070973679930358)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.148173280545073,0.14812061155097,0.148173280545073,0.148173280545073,0.14812061155097,0.148173280545073,0.148173280545073,0.14823462698529,0.152918695751361,0.180926149675739,0.206885807077244,0.207205151238862,0.207205151238862,0.207205151238862,0.206885807077244,0.206885807077244,0.206885807077244,0.206263572688506,0.206025882861167,0.198277796518632,0.198277796518632,0.198277796518632,0.198277796518632,0.193626556278899,0.198277796518632,0.198277796518632,0.198277796518632,0.198277796518632,0.198277796518632,0.193626556278899,0.193626556278899,0.193626556278899,0.193626556278899,0.193626556278899,0.193626556278899,0.193626556278899,0.193626556278899,0.193626556278899,0.193626556278899,0.198277796518632,0.198277796518632,0.193626556278899,0.193626556278899,0.193626556278899,0.193626556278899,0.193626556278899,0.192247261432487,0.193626556278899,0.193626556278899,0.193626556278899,0.198277796518632,0.198277796518632,0.207205151238862,0.207205151238862,0.206885807077244,0.217927027131868,0.245782546184642,0.299351246520455,0.354478951476706,0.39725920636812,0.47441202158569,0.562132777964384,0.70013692945487)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.055546987310362,0.055546987310362,0.062793012243782,0.064059291859109,0.062793012243782,0.062793012243782,0.064694495124879,0.06816442069821,0.062793012243782,0.054730772996594,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.062545530560821,0.062545530560821,0.062545530560821,0.062545530560821,0.062545530560821,0.063525608697134,0.063525608697134,0.063525608697134,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.058943541848064,0.057984832273586,0.057984832273586,0.055546987310362,0.055546987310362)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.9825690212659,0.42928350136271,0.330283755814361,0.307571309970347,0.289622662043872,0.28342631314352,0.265181308660334,0.24370725173878,0.228169610789311,0.193481822606886,0.171536785871137,0.160272925128511,0.160272925128511,0.15828724770069,0.15828724770069,0.15828724770069,0.15828724770069,0.158553051486478,0.160542350847288,0.160542350847288,0.160542350847288,0.160542350847288,0.160542350847288,0.16246554862411,0.16246554862411,0.16246554862411,0.15828724770069,0.15828724770069,0.15828724770069,0.15828724770069,0.158553051486478,0.158553051486478,0.158628999589474,0.158628999589474,0.158628999589474,0.158553051486478,0.158553051486478,0.158553051486478,0.158553051486478,0.158553051486478,0.158553051486478,0.158553051486478,0.158553051486478,0.158553051486478,0.158628999589474,0.158628999589474,0.158628999589474,0.158628999589474,0.158628999589474,0.158628999589474,0.158628999589474,0.159388901235501,0.160272925128511,0.159388901235501,0.159388901235501,0.158628999589474,0.160542350847288,0.162000236688541,0.163722233489118,0.163722233489118,0.163722233489118,0.16246554862411,0.16246554862411)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.973129438564761,-0.381290397271323,-0.265969058368225,-0.240353148924344,-0.227216518686342,-0.213349974849375,-0.206690266202788,-0.163548206223999,-0.151324888781486,-0.151324888781486,-0.058531348686741,-0.058531348686741,-0.058531348686741,-0.058531348686741,-0.058531348686741,-0.058531348686741,-0.058531348686741,-0.054078576222012,-0.054078576222012,-0.04982148174373,-0.04982148174373,-0.04982148174373,-0.049363088619439,-0.049363088619439,-0.04982148174373,-0.04982148174373,-0.04982148174373,-0.04982148174373,-0.049363088619439,-0.049363088619439,-0.04982148174373,-0.04982148174373,-0.049363088619439,-0.049363088619439,-0.049363088619439,-0.049363088619439,-0.049363088619439,-0.049363088619439,-0.049363088619439,-0.04982148174373,-0.053360921356148,-0.053686770719071,-0.054078576222012,-0.053686770719071,-0.054078576222012,-0.055694904024353,-0.055694904024353,-0.054078576222012,-0.057721660556126,-0.058531348686741,-0.058531348686741,-0.058531348686741,-0.058531348686741,-0.058396948720422,-0.04982148174373,-0.058531348686741,-0.075862402329722,-0.079808625784873,-0.078293838333042,-0.089054919179933,-0.079808625784873,-0.063415739546482,-0.078293838333042)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.065180518284265,0.068439085107214,0.068439085107214,0.068439085107214,0.068439085107214,0.068439085107214,0.068439085107214,0.068439085107214,0.07443471889664,0.085266296654883,0.122994714697344,0.10001575900749,0.10001575900749,0.098949027283503,0.098949027283503,0.098949027283503,0.09816781408008,0.101825392421651,0.098949027283503,0.101825392421651,0.100372038583896,0.100372038583896,0.100372038583896,0.09816781408008,0.09816781408008,0.09816781408008,0.09816781408008,0.09816781408008,0.100372038583896,0.09816781408008,0.09816781408008,0.09816781408008,0.100372038583896,0.100372038583896,0.100372038583896,0.100372038583896,0.100372038583896,0.100372038583896,0.100372038583896,0.100372038583896,0.09816781408008,0.09816781408008,0.09816781408008,0.09816781408008,0.09816781408008,0.09816781408008,0.09816781408008,0.100372038583896,0.09816781408008,0.09816781408008,0.101825392421651,0.100372038583896,0.101825392421651,0.108408883372592,0.12369401725587,0.12369401725587,0.15292069646736,0.214879703553276,0.275910303978969,0.324482730652059,0.455539301460799,0.539743818504497,0.639369384347273)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.078572901165837,0.077780825285896,0.077070736748101,0.077070736748101,0.077031067519811,0.077252491499429,0.077883126146005,0.079285047040192,0.08497494680313,0.110862233656561,0.130189718789433,0.130753090684593,0.130908465283739,0.131207715905488,0.131416543491378,0.132264899232296,0.132309643175985,0.131860413254733,0.131665896492155,0.131504541606624,0.131103902939818,0.130974280851582,0.130741793170942,0.130593289191208,0.130829424022357,0.130883121557018,0.130883121557018,0.130883121557018,0.130687120997587,0.130356645339796,0.130476575409309,0.130560108533362,0.130614832793547,0.130617544611747,0.130681430781352,0.130596328023033,0.130566843066017,0.130637219108874,0.130780894165795,0.131009180513888,0.130917227232602,0.130722798888735,0.130754460522442,0.130634866180533,0.130741317134344,0.130706958639262,0.130780740987654,0.130903756710666,0.131102308734298,0.131285015899261,0.132199398569162,0.132310447973391,0.132949106334538,0.134077651655822,0.135997770049399,0.139535890049908,0.14691657011034,0.152135174749176,0.156854061103869,0.166269349580793,0.179811294018387,0.191832175740747,0.213177046726594)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.270388456781004,0.169945221889698,0.147954209309683,0.139536673723085,0.136015680667767,0.134418917399645,0.131508812966604,0.126577191810838,0.123475968752467,0.118816175606349,0.112610512911212,0.10944396885083,0.1090225860948,0.10873652805031,0.10873652805031,0.108732652820856,0.108732652820856,0.108766243149528,0.108622678355146,0.108622678355146,0.109317246935127,0.109317246935127,0.109312648287518,0.108672156637515,0.108644638994322,0.108644638994322,0.108578745749257,0.108578745749257,0.108605303604637,0.108605303604637,0.108657687129561,0.108552260553763,0.108736411020455,0.108736411020455,0.108736411020455,0.108833369086916,0.108774595246664,0.108774595246664,0.108774595246664,0.108738755634192,0.108738755634192,0.108692098775169,0.108619789394871,0.108619789394871,0.108699790280963,0.108699790280963,0.108684270715862,0.108741654497019,0.108741654497019,0.108704178244077,0.108749140451868,0.108847826506675,0.109104205958624,0.108966297288291,0.108966297288291,0.108891789282194,0.109614310932051,0.109814579198401,0.110847620053905,0.111356773939357,0.111390319443894,0.112156396861965,0.112121112490239)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.191815555615168,-0.092164396603802,-0.070883472561582,-0.062465936974984,-0.058984613147956,-0.057166425900216,-0.0536256868206,-0.047292144770646,-0.038501021949337,-0.007953941949788,0.017579205878221,0.021309121833763,0.021885879188939,0.022471187855178,0.022680015441067,0.02353224641144,0.02357699035513,0.023094170105206,0.023043218137008,0.022881863251477,0.021786656004691,0.021657033916455,0.021429144883424,0.021921132553693,0.022184785028035,0.022238482562695,0.02230437580776,0.02230437580776,0.02208181739295,0.021751341735159,0.021818888279748,0.022007847979599,0.021878421773093,0.021881133591293,0.021945019760898,0.021762958936117,0.021792247819354,0.02186262386221,0.022006298919131,0.022270424879697,0.02217847159841,0.022030700113566,0.022134671127571,0.022015076785662,0.022041526853381,0.022007168358299,0.022096470271792,0.022162102213646,0.022360654237279,0.022580837655185,0.023450258117294,0.023462621466716,0.023844900375914,0.02511135436753,0.027031472761108,0.030644100767714,0.037302259178289,0.042320595550775,0.046006441049964,0.054912575641436,0.068420974574493,0.079675778878782,0.101055934236355)
trans=0.5
age=(-1:(130-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="c - Condamine et al.'s Unedited Ankylosauridae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 1.2, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "d - Condamine et al.'s Unedited Ankylosauridae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 1.2, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")



# OUR DATA - Ankylosauridae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.069226596516758,0.06707929763945,0.069226596516758,0.069226596516758,0.069492066538123,0.070020206857199,0.07020042538677,0.07020042538677,0.070941341335113,0.070941341335113,0.070941341335113,0.072442856486034,0.072442856486034,0.072307725936148,0.072307725936148,0.072307725936148,0.072307725936148,0.072307725936148,0.072307725936148,0.072307725936148,0.072307725936148,0.072442856486034,0.072307725936148,0.072442856486034,0.069226596516758,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.072442856486034,0.069492066538123,0.069492066538123,0.069492066538123,0.069492066538123,0.069226596516758,0.069226596516758,0.069226596516758,0.072442856486034,0.072442856486034,0.069919285170621,0.069919285170621,0.069492066538123,0.069492066538123,0.069492066538123,0.068955336017207,0.068955336017207,0.068955336017207,0.06692505045934,0.069919285170621,0.069492066538123,0.068955336017207,0.068955336017207,0.06692505045934,0.06692505045934,0.062761188251749,0.059610315684317,0.053870871075528,0.047195201464855,0.058531221643688,0.047195201464855)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.143202591451215,0.139670483370455,0.140295501464267,0.139404538656977,0.139404538656977,0.139404538656977,0.139404538656977,0.139404538656977,0.139670483370455,0.139670483370455,0.139670483370455,0.140629465250358,0.140629465250358,0.139670483370455,0.139670483370455,0.139670483370455,0.139404538656977,0.139670483370455,0.140295501464267,0.140295501464267,0.140295501464267,0.140629465250358,0.140629465250358,0.140629465250358,0.137173313995687,0.140295501464267,0.140295501464267,0.139670483370455,0.139670483370455,0.139670483370455,0.139670483370455,0.139670483370455,0.139670483370455,0.139670483370455,0.139670483370455,0.139670483370455,0.139404538656977,0.139404538656977,0.139670483370455,0.139670483370455,0.139670483370455,0.139670483370455,0.139670483370455,0.139670483370455,0.137173313995687,0.137173313995687,0.137173313995687,0.137173313995687,0.137173313995687,0.137173313995687,0.137173313995687,0.140629465250358,0.140629465250358,0.139404538656977,0.139404538656977,0.139404538656977,0.140629465250358,0.142356670627808,0.142356670627808,0.143202591451215,0.143202591451215,0.143202591451215,0.147241585391767,0.147241585391767,0.147241585391767,0.147241585391767,0.147981608800338,0.14949008734166,0.147981608800338,0.14949008734166,0.14949008734166,0.14949008734166,0.172864559924548,0.184165884902052)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.062212295310782,0.062212295310782,0.062212295310782,0.062758973389659,0.062212295310782,0.067303846352029,0.067303846352029,0.067303846352029,0.062112588866563,0.053985227192936,0.041729679834501,0.037325339014272,0.036479769117827,0.028392539808097,0.029904943221617,0.028392539808097,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.030485220566291,0.029904943221617,0.029904943221617,0.030700316770207,0.031208469667069,0.032276786862253,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.031208469667069,0.031208469667069,0.031208469667069,0.029904943221617,0.031208469667069,0.031208469667069,0.031208469667069,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.031208469667069,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.029904943221617,0.031747395502294,0.031208469667069,0.030700316770207)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.453403644723463,0.387391720487457,0.379253120974785,0.379253120974785,0.378143040783607,0.379253120974785,0.375437151497328,0.375437151497328,0.367944355630844,0.357116460559111,0.327858097258015,0.301206788602719,0.275333252442668,0.213812703770693,0.171293267733931,0.147623281977277,0.141681047600673,0.127411338719862,0.117690088356367,0.112203506627799,0.110339256093527,0.108811106893249,0.107432128810908,0.105515621110694,0.10412081511729,0.103445467029409,0.103445467029409,0.103445467029409,0.100284523418812,0.100090009748306,0.100090009748306,0.100090009748306,0.099486313805612,0.09963504474956,0.099486313805612,0.100284523418812,0.100284523418812,0.100284523418812,0.099164887959046,0.100284523418812,0.100284523418812,0.100284523418812,0.098223068970773,0.098223068970773,0.098148975647684,0.098148975647684,0.098148975647684,0.098148975647684,0.098148975647684,0.098148975647684,0.098148975647684,0.098148975647684,0.098148975647684,0.098148975647684,0.098148975647684,0.098223068970773,0.100284523418812,0.099164887959046,0.099164887959046,0.099164887959046,0.099164887959046,0.099164887959046,0.099486313805612,0.099486313805612,0.099486313805612,0.099486313805612,0.099486313805612,0.099486313805612,0.100090009748306,0.100090009748306,0.100284523418812,0.103445467029409,0.103352379497382,0.103445467029409)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.365000016032923,-0.301133658411476,-0.289896351655414,-0.286814178800458,-0.283262373460622,-0.28258242251225,-0.281091052256226,-0.280892133118127,-0.277095331389113,-0.257770926768124,-0.225905357648654,-0.211448506790614,-0.178053705874336,-0.123093570358574,-0.081356574086435,-0.062862323075851,-0.048221006517868,-0.030852561900382,-0.02895877116116,-0.024455334996596,-0.025858267187841,-0.024455334996596,-0.018704917201055,-0.018704917201055,-0.017136064822065,-0.015848228706857,-0.016126012592565,-0.015848228706857,-0.017136064822065,-0.017136064822065,-0.017136064822065,-0.012684927932648,-0.010990798405787,-0.010546563647377,-0.010546563647377,-0.010990798405787,-0.010546563647377,-0.010546563647377,-0.010990798405787,-0.010990798405787,-0.010990798405787,-0.010990798405787,-0.010990798405787,-0.010546563647377,-0.010546563647377,-0.010546563647377,-0.010546563647377,-0.010546563647377,-0.010546563647377,-0.010546563647377,-0.010546563647377,-0.010990798405787,-0.011337938201175,-0.012980686894008,-0.012980686894008,-0.012164396660204,-0.012684927932648,-0.012980686894008,-0.012980686894008,-0.016126012592565,-0.016126012592565,-0.018704917201055,-0.018704917201055,-0.024455334996596,-0.024455334996596,-0.024455334996596,-0.024163498649914,-0.02539024898636,-0.02895877116116,-0.02895877116116,-0.02895877116116,-0.02895877116116,-0.035532416610034,-0.096176292024365)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.055603154151314,0.045071607889022,0.045071607889022,0.045071607889022,0.045071607889022,0.045071607889022,0.045071607889022,0.045071607889022,0.045104952105342,0.059601918606309,0.076380046780372,0.078850340180239,0.092561419940709,0.095551573379049,0.098707147653171,0.092561419940709,0.095551573379049,0.10018367901088,0.090970492852115,0.090970492852115,0.087466418469622,0.087466418469622,0.090605692199935,0.088380035922446,0.088380035922446,0.087466418469622,0.087466418469622,0.086377664898249,0.08409243382718,0.08409243382718,0.08409243382718,0.087466418469622,0.088380035922446,0.087466418469622,0.087466418469622,0.086704552837421,0.086704552837421,0.086704552837421,0.086704552837421,0.086704552837421,0.086704552837421,0.086704552837421,0.086704552837421,0.087437783460105,0.087437783460105,0.087437783460105,0.087437783460105,0.087437783460105,0.087466418469622,0.087466418469622,0.087466418469622,0.087466418469622,0.087466418469622,0.087466418469622,0.088380035922446,0.090970492852115,0.092647685284216,0.093876478256436,0.094526582232038,0.092647685284216,0.092647685284216,0.092647685284216,0.094526582232038,0.090605692199935,0.090970492852115,0.090970492852115,0.092647685284216,0.092647685284216,0.092647685284216,0.099374016854826,0.110421306398434,0.112016966555886,0.123961889548623,0.123961889548623)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.10526515657291,0.104830279669742,0.104438857075564,0.104458246960791,0.104424180158165,0.104524870268782,0.10448384671175,0.10448384671175,0.104407819351588,0.104365630865309,0.104253851973921,0.104041304618214,0.103903333332254,0.103624310805374,0.103624310805374,0.103624310805374,0.103562720867841,0.103485999407335,0.10343997200375,0.103433628840601,0.103433628840601,0.1033600103877,0.103290886087387,0.10311890094089,0.103060120455684,0.103066818296023,0.103068347972314,0.10282222160229,0.102772091039557,0.102772091039557,0.102772091039557,0.102772091039557,0.102772091039557,0.102793742019109,0.102765354684804,0.102765354684804,0.102724001738006,0.10265703358459,0.102594645892539,0.102546886544284,0.102546886544284,0.102546886544284,0.102542924353853,0.102542924353853,0.102733031163863,0.102697035496823,0.102676148949562,0.102676148949562,0.102762150373999,0.102762150373999,0.102762150373999,0.103050518881749,0.103114328714157,0.103641828801274,0.103843940538344,0.103938645750475,0.104406868739079,0.104724569530553,0.104973738038802,0.105560803878586,0.105620543688183,0.106050653086111,0.106452622197868,0.106811932145228,0.10702959003295,0.106927585805136,0.107124545452339,0.107539849002248,0.108090481892574,0.109919907016792,0.110858697753178,0.110944807082334,0.112031995979673,0.118719122105143)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.259731110359753,0.239927771621661,0.236870145526617,0.236511550406705,0.23653544290955,0.235904821315067,0.232854317442167,0.228549004986801,0.216142871339894,0.205097471793115,0.181409000554286,0.14696749375085,0.117219040858278,0.088842366726819,0.078374676176859,0.074765096141239,0.073420206679144,0.071263680899793,0.070064454800265,0.068969017630516,0.068700073899919,0.068297417763742,0.067828559706875,0.067447604817259,0.067229723570486,0.066684720562707,0.066415723120661,0.066034477230595,0.065872198620714,0.065828152353661,0.065698681701234,0.065527651904247,0.065306036844058,0.065059530377876,0.065006202120915,0.064890131701309,0.064890131701309,0.064890131701309,0.064841267370007,0.064758749376348,0.064758749376348,0.064752892207263,0.064698790490491,0.064689792204785,0.064622985841889,0.064622985841889,0.064596355196998,0.064576979808665,0.064548878169949,0.06457071047823,0.06457071047823,0.06457071047823,0.06457071047823,0.06457071047823,0.064595889768115,0.06467365338753,0.064631323333256,0.064725426288004,0.064725426288004,0.064725426288004,0.064725426288004,0.064751823318353,0.064835222238959,0.064860515757481,0.064880783700565,0.064880783700565,0.064880783700565,0.064880783700565,0.065075399718709,0.065075399718709,0.065329095150844,0.065705159863807,0.065820268530892,0.066230852841199)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.154465953786842,-0.135097491951919,-0.132431288451053,-0.132053303445914,-0.132111262751385,-0.131379951046285,-0.128370470730418,-0.124065158275052,-0.111735051988306,-0.100731840927806,-0.077155148580365,-0.042926189132636,-0.013315707526024,0.014781944078554,0.025249634628514,0.028859214664135,0.030142514188698,0.032222318507541,0.033375517203485,0.034464611210085,0.034733554940682,0.035062592623958,0.035462326380513,0.035671296123632,0.035830396885199,0.036382097733315,0.036652624851653,0.036787744371695,0.036899892418843,0.036943938685896,0.037073409338323,0.03724443913531,0.037466054195498,0.037734211641233,0.037759152563889,0.037875222983495,0.037833870036697,0.03776690188328,0.037753378522532,0.037788137167936,0.037788137167936,0.037793994337022,0.037844133863362,0.037853132149069,0.038110045321974,0.038074049654934,0.038079793752564,0.038099169140897,0.038213272204049,0.038191439895769,0.038191439895769,0.038479808403519,0.038543618235927,0.039071118323045,0.039248050770229,0.039264992362945,0.039775545405823,0.039999143242549,0.040248311750798,0.040835377590581,0.040895117400179,0.041298829767758,0.041617399958909,0.041951416387748,0.042148806332385,0.042046802104571,0.042243761751774,0.042659065301683,0.043015082173865,0.044844507298084,0.045529602602334,0.045239647218527,0.046211727448781,0.052488269263944)
trans=0.5
age=(-1:(141-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="e - Our Ankylosauridae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 0.8, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "f - Our Ankylosauridae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 0.6, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")



# SAKAMOTO DATA - Ankylosaurus

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.051695541701392,0.051695541701392,0.051695541701392,0.052872670359758,0.052872670359758,0.052872670359758,0.052872670359758,0.052872670359758,0.052872670359758,0.051695541701392,0.052872670359758,0.052872670359758,0.052872670359758,0.052872670359758,0.052872670359758,0.051207282099284,0.051207282099284,0.051207282099284,0.051207282099284,0.052872670359758,0.052872670359758,0.052872670359758,0.052872670359758,0.052872670359758,0.052872670359758,0.052872670359758,0.050431475348907,0.050431475348907,0.050431475348907,0.051695541701392,0.051695541701392,0.048667234577721,0.048667234577721,0.048667234577721,0.048667234577721,0.048667234577721,0.046606728018912,0.042875285263306,0.046606728018912,0.038279358650112,0.038279358650112,0.038279358650112,0.038279358650112,0.038279358650112,0.038279358650112,0.038279358650112,0.038279358650112,0.038279358650112,0.038279358650112,0.037226941831246,0.037226941831246,0.037226941831246,0.037226941831246,0.038279358650112,0.038279358650112,0.038279358650112,0.038279358650112,0.037226941831246,0.037226941831246,0.034918911658771,0.034918911658771,0.033855640453404,0.030931849305414,0.033164372095356,0.033164372095356,0.03189210723149,0.030931849305414,0.030931849305414,0.026672241710629,0.027238169853861,0.026672241710629,0.027238169853861,0.027238169853861,0.027238169853861,0.027238169853861,0.027238169853861,0.027238169853861,0.027238169853861,0.027238169853861,0.027238169853861,0.027238169853861,0.027238169853861,0.023686306421564,0.023686306421564,0.023686306421564,0.023686306421564,0.021472534344488,0.021399105075807,0.021399105075807,0.021399105075807,0.021399105075807,0.021399105075807,0.020974692333925,0.020974692333925,0.020974692333925,0.020974692333925,0.021399105075807,0.021399105075807,0.021399105075807,0.020974692333925,0.020974692333925,0.020974692333925,0.020974692333925,0.020974692333925,0.020974692333925,0.020974692333925,0.020974692333925,0.020974692333925,0.020974692333925,0.021399105075807,0.020974692333925,0.021399105075807,0.021399105075807,0.020974692333925,0.016114765889801,0.016114765889801)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.12199215133536,0.12199215133536,0.12199215133536,0.122320410301876,0.122320410301876,0.12199215133536,0.12199215133536,0.12199215133536,0.122320410301876,0.12199215133536,0.122320410301876,0.122320410301876,0.122320410301876,0.122320410301876,0.123391515008479,0.122320410301876,0.122320410301876,0.122320410301876,0.122320410301876,0.12427158230569,0.12427158230569,0.12427158230569,0.12427158230569,0.12427158230569,0.12427158230569,0.12427158230569,0.12199215133536,0.122320410301876,0.122320410301876,0.12427158230569,0.12427158230569,0.122320410301876,0.122320410301876,0.12427158230569,0.12427158230569,0.12427158230569,0.121721526033079,0.122320410301876,0.126466577410197,0.121313415176338,0.121313415176338,0.122320410301876,0.122320410301876,0.122320410301876,0.122320410301876,0.122320410301876,0.122320410301876,0.122320410301876,0.122320410301876,0.121721526033079,0.121721526033079,0.121721526033079,0.121721526033079,0.122320410301876,0.122320410301876,0.122320410301876,0.122320410301876,0.121721526033079,0.122320410301876,0.121721526033079,0.121721526033079,0.121313415176338,0.118304267793458,0.121313415176338,0.121313415176338,0.121313415176338,0.121313415176338,0.122320410301876,0.117641907414112,0.119479986237875,0.119479986237875,0.121013155186295,0.12068240946951,0.121013155186295,0.121174468895608,0.121013155186295,0.121013155186295,0.121013155186295,0.121013155186295,0.121013155186295,0.121013155186295,0.121174468895608,0.117641907414112,0.117641907414112,0.118304267793458,0.118304267793458,0.116466873835835,0.116466873835835,0.116466873835835,0.11674592806276,0.11674592806276,0.11674592806276,0.116466873835835,0.116466873835835,0.116466873835835,0.116466873835835,0.117139169056152,0.117139169056152,0.117139169056152,0.117139169056152,0.117139169056152,0.117641907414112,0.117641907414112,0.117641907414112,0.117641907414112,0.117641907414112,0.117641907414112,0.119331410883123,0.119479986237875,0.121313415176338,0.120573270284812,0.121313415176338,0.121313415176338,0.121313415176338,0.116971226036534,0.118304267793458)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.027166803766134,0.034193033829151,0.036132791510636,0.03949583383676,0.036921069322253,0.036921069322253,0.036921069322253,0.036921069322253,0.036921069322253,0.036921069322253,0.036921069322253,0.036921069322253,0.036921069322253,0.03949583383676,0.03949583383676,0.03949583383676,0.03949583383676,0.03949583383676,0.03949583383676,0.03949583383676,0.03949583383676,0.03949583383676,0.03949583383676,0.03949583383676,0.03949583383676,0.03949583383676,0.03949583383676,0.03949583383676,0.034193033829151,0.032963693012175,0.034193033829151,0.034193033829151,0.031224994997468,0.019169265299667,0.016623734841961,0.007184828184534,0.000350755786122,0.0008577527813,0.000264028782609,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000264028782609,0.000159694810252,0.000179773573538,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000248098116189,0.000248098116189,0.000248098116189,0.000248098116189,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000159694810252,0.000248098116189,0.000248098116189,0.000248098116189,0.000264028782609,0.000264028782609,0.000264028782609,0.000264028782609,0.000264028782609,0.000264028782609,0.000264028782609,0.000264028782609,0.000264028782609,0.000264028782609,0.000264028782609,0.000264028782609,0.000264028782609,0.000264028782609,0.000264028782609,0.000264028782609,0.000264028782609,0.000264028782609,0.000248098116189,0.000248098116189,0.000248098116189,0.000248098116189,0.000248098116189,0.000248098116189,0.000248098116189,0.000248098116189,0.000248098116189,0.000248098116189,0.000248098116189,0.000248098116189,0.000179773573538,0.000179773573538,0.000179773573538,0.000248098116189,0.000248098116189,0.000248098116189,0.000179773573538,0.000179773573538)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,1.882979609468609,0.162327708342697,0.13534023867056,0.135104891067477,0.131947618876153,0.131947618876153,0.131947618876153,0.131947618876153,0.131947618876153,0.131947618876153,0.131947618876153,0.131947618876153,0.131947618876153,0.13340507617749,0.13340507617749,0.13340507617749,0.13340507617749,0.13340507617749,0.13340507617749,0.13340507617749,0.13340507617749,0.13340507617749,0.13340507617749,0.13340507617749,0.13340507617749,0.13340507617749,0.13340507617749,0.136260772172773,0.131740389422923,0.13340507617749,0.13534023867056,0.137050432068838,0.138840881122668,0.131947618876153,0.132271930091589,0.124690301034856,0.117489821992506,0.117489821992506,0.112689103431044,0.109901195561696,0.107772093068114,0.106090411190679,0.101941497880545,0.100245102466923,0.098723774300304,0.093265042349435,0.089439561791472,0.087237664127062,0.086433223959665,0.086056464343545,0.085268897004748,0.084082852245648,0.083226350624469,0.082965180855637,0.082879006983488,0.082879006983488,0.082879006983488,0.082344975572962,0.081683943744391,0.081683943744391,0.081683943744391,0.081683943744391,0.081683943744391,0.081683943744391,0.081683943744391,0.081636477701154,0.081683943744391,0.081636477701154,0.081636477701154,0.081636477701154,0.081296278788882,0.081296278788882,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382,0.081144299685382)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-1.811966380991549,-0.090271117590886,-0.065193878226214,-0.059856744122179,-0.059220507909348,-0.057997358462569,-0.057997358462569,-0.057997358462569,-0.057997358462569,-0.059220507909348,-0.059220507909348,-0.059220507909348,-0.059220507909348,-0.059220507909348,-0.057997358462569,-0.06397981379411,-0.06397981379411,-0.06397981379411,-0.06397981379411,-0.06397981379411,-0.06397981379411,-0.06397981379411,-0.059856744122179,-0.059856744122179,-0.059856744122179,-0.057997358462569,-0.059220507909348,-0.057997358462569,-0.053492719997053,-0.053492719997053,-0.053492719997053,-0.05157634808768,-0.053492719997053,-0.060224251500594,-0.06362168807251,-0.060224251500594,-0.060224251500594,-0.06362168807251,-0.051237848392647,-0.053492719997053,-0.050629435525977,-0.040115612477948,-0.037797460240594,-0.037797460240594,-0.038368128340064,-0.030402784220455,-0.028710127062947,-0.028710127062947,-0.024246436691055,-0.0224422653757,-0.02173009001092,-0.022326589713126,-0.022326589713126,-0.022326589713126,-0.02173009001092,-0.019471203709499,-0.019471203709499,-0.019471203709499,-0.02173009001092,-0.02173009001092,-0.02173009001092,-0.0224422653757,-0.0224422653757,-0.0224422653757,-0.0224422653757,-0.024246436691055,-0.026026954669223,-0.026026954669223,-0.026026954669223,-0.024246436691055,-0.030402784220455,-0.030402784220455,-0.024246436691055,-0.024246436691055,-0.024246436691055,-0.030402784220455,-0.030402784220455,-0.030402784220455,-0.030402784220455,-0.030402784220455,-0.029891042466525,-0.030402784220455,-0.030402784220455,-0.030402784220455,-0.030402784220455,-0.030402784220455,-0.030402784220455,-0.030402784220455,-0.031548195397575,-0.035401201787759,-0.035401201787759,-0.031548195397575,-0.035401201787759,-0.035401201787759,-0.035401201787759,-0.035401201787759,-0.035308062785145,-0.035308062785145,-0.035308062785145,-0.035401201787759,-0.035401201787759,-0.037462756662804,-0.037462756662804,-0.037462756662804,-0.037462756662804,-0.037462756662804,-0.037462756662804,-0.037462756662804,-0.037462756662804,-0.037462756662804,-0.037462756662804,-0.037462756662804,-0.037462756662804,-0.037462756662804,-0.037462756662804,-0.037462756662804)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.090506725973098,0.073458066305714,0.064584700735447,0.064584700735447,0.064584700735447,0.064584700735447,0.064584700735447,0.064584700735447,0.064584700735447,0.064584700735447,0.064584700735447,0.064584700735447,0.064584700735447,0.064584700735447,0.067924030193203,0.062572740319889,0.062572740319889,0.062572740319889,0.062572740319889,0.062572740319889,0.062572740319889,0.062572740319889,0.064584700735447,0.064584700735447,0.064584700735447,0.064584700735447,0.064584700735447,0.067924030193203,0.073458066305714,0.073458066305714,0.075081398472957,0.073458066305714,0.072650711966325,0.071720368664592,0.071029652247872,0.076395418622751,0.081409945408454,0.080186968006855,0.08747916878367,0.08747916878367,0.093116708553718,0.101172553024754,0.099795695387976,0.099171458187956,0.096330530523013,0.101172553024754,0.100677661616802,0.099795695387976,0.102829192320383,0.102829192320383,0.101277640334915,0.101277640334915,0.101277640334915,0.101277640334915,0.101277640334915,0.102829192320383,0.102829192320383,0.102829192320383,0.101277640334915,0.101277640334915,0.101277640334915,0.100677661616802,0.101080416907725,0.102829192320383,0.102829192320383,0.10270863766561,0.102829192320383,0.102829192320383,0.102829192320383,0.106054113175578,0.101080416907725,0.101080416907725,0.106054113175578,0.106054113175578,0.106054113175578,0.101080416907725,0.101080416907725,0.101080416907725,0.101080416907725,0.101080416907725,0.101080416907725,0.101080416907725,0.101080416907725,0.101080416907725,0.101080416907725,0.101080416907725,0.102829192320383,0.102829192320383,0.102829192320383,0.099795695387976,0.099795695387976,0.102829192320383,0.099795695387976,0.099795695387976,0.099795695387976,0.099795695387976,0.100677661616802,0.100677661616802,0.100677661616802,0.101080416907725,0.101080416907725,0.09977249635558,0.09977249635558,0.09977249635558,0.09977249635558,0.09977249635558,0.09977249635558,0.099795695387976,0.100677661616802,0.10270863766561,0.10270863766561,0.102829192320383,0.102829192320383,0.105076285554765,0.106054113175578,0.109373412185588)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.084566390272049,0.084566390272049,0.084566390272049,0.084625068080446,0.084625068080446,0.08468646023368,0.084720747903431,0.084782108624147,0.08486941164473,0.084962764501294,0.085036903286845,0.085036903286845,0.085036903286845,0.085158762213784,0.085838345069555,0.086065422887225,0.086065422887225,0.086065422887225,0.086065422887225,0.086129549998611,0.086129549998611,0.086129549998611,0.086070520879234,0.086070520879234,0.086070520879234,0.085938571736706,0.085872433814235,0.086101789017124,0.086445561169207,0.086722955156234,0.086703592350267,0.085338650567135,0.083821374510104,0.08320804165486,0.08254277457619,0.082421855506009,0.081843487290856,0.081392282208455,0.081067470913766,0.080535703299368,0.080341028680759,0.08016077561064,0.080184413817581,0.080116668303005,0.080116668303005,0.080116668303005,0.08013339669566,0.08013339669566,0.08013339669566,0.079998415306582,0.079924016946392,0.079852716888899,0.079852716888899,0.07979149448556,0.07979149448556,0.07979149448556,0.07979149448556,0.07967647768842,0.079386118631824,0.079022072534476,0.07891100750679,0.07880327234023,0.078702506883263,0.078265705494186,0.078265705494186,0.078158033223225,0.077922106536863,0.077767454522724,0.077291902046071,0.077070779140119,0.076962480362347,0.076962842680919,0.076787225538793,0.076570908154753,0.076537052732258,0.076425770256146,0.07629398309576,0.076176809573497,0.076176809573497,0.076078535519676,0.075937063142169,0.075707344277622,0.075501203937175,0.075501203937175,0.075458583669688,0.075458583669688,0.075298766340272,0.075211157615257,0.075159732260461,0.075091275030453,0.075075368197339,0.075054509616315,0.075168588538067,0.075168588538067,0.075168588538067,0.075168588538067,0.075282283693309,0.075199866095704,0.075199866095704,0.075384826005133,0.075384826005133,0.075312812630677,0.07531299346595,0.07531299346595,0.07531299346595,0.07531299346595,0.07531299346595,0.075465399608905,0.075623592221052,0.075810862320468,0.075894570435361,0.076028156321923,0.076076189436369,0.076518039895383,0.076648064157869,0.078241286823535)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.459887166045618,0.100245166948583,0.082014497876495,0.079746063787707,0.079237184496032,0.079285950796501,0.079285950796501,0.079285950796501,0.079285950796501,0.079309183576828,0.079309183576828,0.079309183576828,0.079309183576828,0.079228618891122,0.079228618891122,0.079228618891122,0.079228618891122,0.079228618891122,0.079228618891122,0.079213606567079,0.079213606567079,0.079213606567079,0.079090244023971,0.079090244023971,0.079096600670477,0.078954121454358,0.078736666348247,0.078262042236817,0.077702578345529,0.077031465721523,0.076745072407915,0.076230115461379,0.075480432038077,0.074526813907605,0.074741672595217,0.073463945674393,0.071005924238313,0.069742537324804,0.065920940234999,0.062912085733392,0.059646199777185,0.057594359849039,0.054900624726909,0.052278529588243,0.051158084971184,0.04925737028714,0.048020483624663,0.046592512583188,0.045659752506949,0.04464056424782,0.043718511836008,0.042748964471525,0.042405458577529,0.042163741271439,0.0419442669763,0.041812607216487,0.041760492488628,0.041417603260738,0.041129977429344,0.041010010351114,0.041010010351114,0.041010010351114,0.040928547439776,0.040928547439776,0.040928547439776,0.040840951238745,0.04072687048122,0.04054195330247,0.040485074119965,0.040485074119965,0.040367157374883,0.040299810548544,0.040184709425016,0.040184709425016,0.039943722640897,0.039714054468608,0.039700228534984,0.039700228534984,0.039673324747121,0.039551147395661,0.039497407784293,0.039497407784293,0.039497407784293,0.039497407784293,0.039434599468722,0.039434599468722,0.039434599468722,0.039387986813752,0.039347688324141,0.039347688324141,0.039347688324141,0.039324598457158,0.039258531069265,0.039258531069265,0.039258531069265,0.039258531069265,0.039305233308578,0.039305233308578,0.039305233308578,0.039281881882039,0.039281881882039,0.039281881882039,0.039281881882039,0.039205286106648,0.039166803208067,0.039166803208067,0.039166803208067,0.039166803208067,0.039253390953116,0.039253390953116,0.039253390953116,0.039206154042499,0.039206154042499,0.039206154042499,0.039257089240697,0.039257089240697)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.37532077577357,-0.015678776676534,0.002551892395554,0.004879004292739,0.005387883584414,0.00540050943718,0.00543479710693,0.005496157827647,0.005583460848229,0.005653580924466,0.005727719710017,0.005727719710017,0.005727719710017,0.005930143322662,0.006609726178433,0.006836803996103,0.006836803996103,0.006836803996103,0.006836803996103,0.006915943431533,0.006915943431533,0.006915943431533,0.006980276855263,0.006980276855263,0.006973920208758,0.006984450282348,0.007135767465987,0.007839746780307,0.008742982823678,0.009691489434711,0.009958519942352,0.009108535105756,0.008340942472027,0.008681227747255,0.007801101980974,0.008957909831616,0.010837563052543,0.011649744883652,0.015146530678767,0.017623617565976,0.020694828903574,0.022566415761601,0.025283789090672,0.027838138714762,0.028958583331821,0.030859298015865,0.032112913070997,0.033540884112471,0.03447364418871,0.035357851058762,0.036205505110384,0.037103752417374,0.03744725831137,0.037627753214121,0.03784722750926,0.037978887269073,0.038031001996932,0.038258874427683,0.038256141202479,0.038012062183362,0.037900997155676,0.037793261989117,0.037773959443487,0.03733715805441,0.03733715805441,0.03731708198448,0.037195236055643,0.037225501220254,0.036806827926106,0.036585705020154,0.036595322987464,0.036663032132374,0.036602516113777,0.036386198729738,0.036593330091361,0.036711715787538,0.036593754560775,0.036476581038513,0.036503484826375,0.036527388124016,0.036439655357876,0.036209936493329,0.036003796152882,0.036003796152882,0.036023984200966,0.036023984200966,0.03586416687155,0.035823170801505,0.03581204393632,0.035743586706312,0.035727679873198,0.035729911159157,0.035910057468802,0.035910057468802,0.035910057468802,0.035910057468802,0.035977050384731,0.035894632787126,0.035894632787126,0.036102944123094,0.036102944123094,0.036030930748638,0.036031111583911,0.036107707359302,0.036146190257883,0.036146190257883,0.036146190257883,0.036298596400838,0.036370201267936,0.036557471367352,0.036641179482245,0.036822002279424,0.03687003539387,0.037311885852884,0.037390974917172,0.038984197582838)
trans=0.5
age=(-1:(183-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="g - Sakamoto et al.'s Ankylosauridae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 1.2, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "h - Sakamoto et al.'s Ankylosauridae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 1.2, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")

n <- dev.off()