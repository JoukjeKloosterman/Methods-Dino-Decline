# 1 files combined:
# 	./PyRate_Inputs_2_BDMCMC_Grj_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

if(!require('base64')) {
  install.packages('base64')
  library('base64')
}

library("magick")


pngfile <- "./figures report Troodontidae.png"
png(pngfile, width = 8, height = 15, units = "in", res = 1200)
# par(mfrow=c(4,2))

# Define the layout matrix
layout_matrix <- matrix(c(1, 1, 
                          2, 3, 
                          4, 5, 
                          6, 7, 
                          8, 9), 
                        nrow = 5, ncol = 2, byrow = TRUE)

# Set up the layout
layout(layout_matrix)

images <- image_read("Results Condamine Troodontidae.png")
par(mar = c(0, 0, 0, 0))
plot.new()
rasterImage(images, 0, 0, 1, 1)

par(mar = c(5, 4, 4, 2))

library(scales)
plot_RTT <- function (age,hpd_M,hpd_m,mean_m,color){
  N=100
  beta=(1:(N-1))/N
  alpha_shape=0.25
  cat=1-(beta^(1./alpha_shape))
  for (i in 1:(N-1)){
    trans= 1/N + 2/N
    polygon(c(age, rev(age)), c(hpd_M-((hpd_M-mean_m)*cat[i]), rev(hpd_m+((mean_m-hpd_m)*cat[i]))), col = alpha(color,trans), border = NA)
  }
  lines(rev(age), rev(mean_m), col = color, lwd=3)
}



# CONDAMINE EDITED DATA - Troodontidae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.300989319855644,0.287374727563927,0.294477566590678,0.301169051643091,0.300989319855644,0.300989319855644,0.298110787765595,0.300989319855644,0.301804384680959,0.300989319855644,0.300989319855644,0.298110787765595,0.300112530742879,0.300112530742879,0.300112530742879,0.300112530742879,0.300112530742879,0.300112530742879,0.298110787765595,0.298110787765595,0.300112530742879,0.300112530742879,0.300112530742879,0.300112530742879,0.301169051643091,0.301169051643091,0.301169051643091,0.301169051643091,0.300112530742879,0.300112530742879,0.300112530742879,0.298110787765595,0.300112530742879,0.300989319855644,0.300112530742879,0.300112530742879,0.297945349809654,0.297945349809654,0.297945349809654,0.297945349809654,0.297945349809654,0.297945349809654,0.297945349809654,0.297945349809654,0.297945349809654,0.297945349809654,0.297945349809654,0.300112530742879,0.300112530742879,0.300112530742879,0.300112530742879,0.297945349809654,0.297945349809654,0.297945349809654,0.297945349809654,0.294477566590678,0.296827072456884,0.296827072456884,0.296827072456884,0.284412180316262,0.296827072456884,0.284412180316262,0.284412180316262,0.278319997396262,0.278319997396262,0.278319997396262,0.272262964115502,0.272262964115502,0.272262964115502,0.272262964115502,0.272262964115502,0.272262964115502,0.272262964115502,0.287374727563927,0.287374727563927,0.287374727563927,0.287374727563927,0.272262964115502,0.284412180316262,0.284412180316262,0.284412180316262,0.284412180316262,0.281864679757631,0.284412180316262,0.281864679757631,0.284412180316262,0.284412180316262,0.272262964115502,0.272262964115502,0.284412180316262,0.281864679757631,0.281864679757631,0.284412180316262,0.28478425628116,0.284412180316262)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.64103195277744,0.615364747913967,0.615364747913967,0.615364747913967,0.612989718459302,0.612989718459302,0.609603762065395,0.612989718459302,0.615364747913967,0.612989718459302,0.612989718459302,0.609603762065395,0.609603762065395,0.609603762065395,0.609603762065395,0.608610789063934,0.608610789063934,0.609603762065395,0.609603762065395,0.609603762065395,0.612989718459302,0.612989718459302,0.612989718459302,0.612989718459302,0.615364747913967,0.615364747913967,0.615364747913967,0.615364747913967,0.615364747913967,0.615364747913967,0.617042079329068,0.617042079329068,0.622211480720485,0.622211480720485,0.622211480720485,0.624344102547172,0.623226023508044,0.623226023508044,0.62689127677883,0.624344102547172,0.624344102547172,0.62689127677883,0.62689127677883,0.6315765353821,0.6315765353821,0.6315765353821,0.6315765353821,0.631924746817562,0.631924746817562,0.631924746817562,0.631924746817562,0.631924746817562,0.633757275840684,0.6315765353821,0.631924746817562,0.62689127677883,0.631924746817562,0.633757275840684,0.633757275840684,0.623226023508044,0.642948772220085,0.64103195277744,0.64103195277744,0.642948772220085,0.642948772220085,0.656631776109389,0.652456886499526,0.652456886499526,0.656631776109389,0.665594740936827,0.670490324434632,0.670490324434632,0.670490324434632,0.693311094864426,0.693311094864426,0.693311094864426,0.693311094864426,0.670490324434632,0.692340252331034,0.693311094864426,0.693311094864426,0.693311094864426,0.693311094864426,0.693311094864426,0.693311094864426,0.693311094864426,0.691409464180163,0.670490324434632,0.670490324434632,0.693311094864426,0.693311094864426,0.693311094864426,0.693311094864426,0.697118164311879,0.697118164311879)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.292070749474244,0.261439893323933,0.261439893323933,0.265911986568154,0.266531177596707,0.279986313971446,0.279986313971446,0.28781338295997,0.279986313971446,0.28781338295997,0.28781338295997,0.289757345558576,0.289757345558576,0.292070749474244,0.289757345558576,0.289757345558576,0.289757345558576,0.289757345558576,0.289757345558576,0.28781338295997,0.28781338295997,0.28781338295997,0.279986313971446,0.289757345558576,0.28781338295997,0.28781338295997,0.289757345558576,0.289757345558576,0.289757345558576,0.28781338295997,0.28781338295997,0.28781338295997,0.28781338295997,0.28781338295997,0.289757345558576,0.28781338295997,0.289757345558576,0.289757345558576,0.283539289566228,0.279986313971446,0.26141436001737,0.266531177596707,0.266531177596707,0.266531177596707,0.266531177596707,0.279986313971446,0.279986313971446,0.266531177596707,0.266531177596707,0.266531177596707,0.266531177596707,0.292070749474244,0.293648606889613,0.266531177596707,0.266531177596707,0.266746850158054,0.266746850158054,0.266531177596707,0.266531177596707,0.266531177596707,0.266531177596707,0.289757345558576,0.249722450717622,0.248998426335716,0.28781338295997,0.28781338295997,0.28781338295997,0.292070749474244,0.28781338295997,0.248998426335716,0.28781338295997,0.238493658948187,0.235940358929459,0.235940358929459,0.248998426335716,0.248998426335716,0.255865638968508,0.255865638968508,0.266531177596707,0.255865638968508,0.255865638968508,0.266531177596707,0.248998426335716,0.28781338295997,0.28781338295997,0.28781338295997,0.285649059509584,0.28781338295997,0.28781338295997,0.266531177596707,0.250956162370829,0.238493658948187,0.238493658948187,0.229232919424304,0.229232919424304)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.666871494614961,0.624339179414115,0.624339179414115,0.624339179414115,0.621668894202412,0.621668894202412,0.621668894202412,0.624339179414115,0.6188089441814,0.624339179414115,0.6188089441814,0.621668894202412,0.621668894202412,0.621668894202412,0.621668894202412,0.621668894202412,0.621668894202412,0.621668894202412,0.621668894202412,0.621668894202412,0.624339179414115,0.624339179414115,0.619744748427304,0.629989992629846,0.629989992629846,0.629989992629846,0.629989992629846,0.629989992629846,0.629989992629846,0.621668894202412,0.621668894202412,0.621668894202412,0.621668894202412,0.621668894202412,0.629989992629846,0.624339179414115,0.629989992629846,0.629989992629846,0.629989992629846,0.629989992629846,0.613498435934916,0.622589924527032,0.622589924527032,0.621668894202412,0.621668894202412,0.629989992629846,0.629989992629846,0.621668894202412,0.621668894202412,0.622589924527032,0.624339179414115,0.652522962594816,0.652522962594816,0.624339179414115,0.624339179414115,0.622762201407959,0.622762201407959,0.622762201407959,0.624339179414115,0.624339179414115,0.624339179414115,0.652522962594816,0.622762201407959,0.624339179414115,0.669448595115515,0.669448595115515,0.669448595115515,0.681866541845074,0.692569779652774,0.6521806198145,0.694790049046189,0.650012802412748,0.6521806198145,0.6521806198145,0.669448595115515,0.669448595115515,0.681866541845074,0.681866541845074,0.694790049046189,0.681866541845074,0.681866541845074,0.694790049046189,0.669448595115515,0.694790049046189,0.694790049046189,0.694790049046189,0.681866541845074,0.681866541845074,0.681866541845074,0.656852668142985,0.6521806198145,0.650012802412748,0.6521806198145,0.6521806198145,0.6521806198145)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.253792796013349,-0.236572210841802,-0.226019309258083,-0.221317017274188,-0.213861365477522,-0.226019309258083,-0.225033620204407,-0.225033620204407,-0.226019309258083,-0.213861365477522,-0.213861365477522,-0.212794434481549,-0.212794434481549,-0.212794434481549,-0.212794434481549,-0.213861365477522,-0.212794434481549,-0.212794434481549,-0.212794434481549,-0.212794434481549,-0.213861365477522,-0.195872210547952,-0.213861365477522,-0.194887435158882,-0.195872210547952,-0.194887435158882,-0.194887435158882,-0.195872210547952,-0.195872210547952,-0.195872210547952,-0.195872210547952,-0.195872210547952,-0.213861365477522,-0.195872210547952,-0.213861365477522,-0.205521082727392,-0.210169507403753,-0.210169507403753,-0.210169507403753,-0.210169507403753,-0.211731385390271,-0.223403400307486,-0.223403400307486,-0.226019309258083,-0.226019309258083,-0.228152178403202,-0.228152178403202,-0.226019309258083,-0.223403400307486,-0.226019309258083,-0.226019309258083,-0.226019309258083,-0.226019309258083,-0.226019309258083,-0.226019309258083,-0.220007474521699,-0.226019309258083,-0.226019309258083,-0.226019309258083,-0.226019309258083,-0.23503938392701,-0.23503938392701,-0.238483318693397,-0.252374857311358,-0.239840820890573,-0.239840820890573,-0.244366497972864,-0.252374857311358,-0.278280204017664,-0.278280204017664,-0.301168592036863,-0.313995188430921,-0.313995188430921,-0.325237263578124,-0.325237263578124,-0.313995188430921,-0.325237263578124,-0.313995188430921,-0.325237263578124,-0.325237263578124,-0.325237263578124,-0.343313265458484,-0.325237263578124,-0.313995188430921,-0.313995188430921,-0.301168592036863,-0.278280204017664,-0.23503938392701,-0.23503938392701,-0.23503938392701,-0.23503938392701,-0.23503938392701,-0.23503938392701,-0.23503938392701,-0.23503938392701)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.226721109813143,0.226721109813143,0.226721109813143,0.225809967055306,0.225809967055306,0.206198057058679,0.206198057058679,0.206198057058679,0.203309682328131,0.210763043259659,0.208892634056414,0.206198057058679,0.206198057058679,0.206198057058679,0.206198057058679,0.203309682328131,0.206198057058679,0.206198057058679,0.206198057058679,0.206198057058679,0.208892634056414,0.225809967055306,0.206198057058679,0.225809967055306,0.225809967055306,0.225809967055306,0.225809967055306,0.225809967055306,0.230823605322782,0.225809967055306,0.225809967055306,0.225809967055306,0.212420402089863,0.225809967055306,0.214869178338886,0.225809967055306,0.225809967055306,0.225809967055306,0.225809967055306,0.225809967055306,0.225809967055306,0.225809967055306,0.225809967055306,0.225809967055306,0.225809967055306,0.225809967055306,0.225809967055306,0.224347508906039,0.225809967055306,0.223864591677801,0.224347508906039,0.225809967055306,0.224347508906039,0.223864591677801,0.224347508906039,0.225809967055306,0.223864591677801,0.224347508906039,0.224347508906039,0.225809967055306,0.224347508906039,0.250874103704596,0.251298951067919,0.272248778688267,0.299263374955101,0.321269874193049,0.321269874193049,0.332808522965846,0.332808522965846,0.352448308072561,0.332808522965846,0.332808522965846,0.36173230642309,0.36173230642309,0.36173230642309,0.36173230642309,0.36173230642309,0.36173230642309,0.372996235737053,0.36173230642309,0.36173230642309,0.36173230642309,0.36173230642309,0.329289989515133,0.329289989515133,0.332808522965846,0.321269874193049,0.329289989515133,0.321269874193049,0.319526270679562,0.315799390042705,0.319526270679562,0.319526270679562,0.323318885096951,0.323318885096951)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.445038314970722,0.446897623964836,0.448949434406336,0.450581234938302,0.451243157453338,0.451243157453338,0.451503462145246,0.452584941488227,0.453343688321638,0.453937975697796,0.453937975697796,0.453460194147203,0.453610279840105,0.453466565611063,0.453462312705775,0.45361158784632,0.453642993188434,0.454090471770441,0.45376332737965,0.45376332737965,0.454489566286687,0.454562058249466,0.453818544618424,0.453669690130382,0.45378082141683,0.453756952306041,0.453620133528494,0.45380087339864,0.453359526116101,0.453536623861018,0.453881829203752,0.45419219537508,0.455225165486379,0.455662709664052,0.458820498416309,0.460927923512088,0.462277056639983,0.46245400239019,0.466995449132184,0.467021431723821,0.467021431723821,0.467997696343303,0.467997696343303,0.470534101228153,0.470813807727107,0.470813807727107,0.470927923532146,0.464931785433389,0.464484318154382,0.464151545149665,0.464151545149665,0.462351261427067,0.462015087323991,0.45871643074483,0.458441817168411,0.454286036122375,0.454799579037569,0.45520427018868,0.45520427018868,0.4555516602109,0.45975103870027,0.472564091890966,0.472302581035855,0.475794405716089,0.476383770796874,0.478140616454807,0.478638129719984,0.480389210874982,0.481233127983544,0.482272364063859,0.482319303852989,0.483610187275824,0.483610187275824,0.4843635280846,0.4843635280846,0.484251030250489,0.48373185642432,0.481713890829349,0.481548040186459,0.481956645765357,0.481954241768471,0.481903168974368,0.480916760403511,0.477265401225354,0.478340815984799,0.473164220530315,0.469599061154908,0.469350549873876,0.469198997349366,0.470164246209597,0.469126103289961,0.469115866181499,0.468447054472359,0.469348356411614,0.47001782447904)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.465995789140004,0.461297673536752,0.460806964807249,0.459698959350896,0.458736170756725,0.455582406453633,0.452415019145217,0.449604940466263,0.448044679333885,0.446648957450868,0.446091557608462,0.446191932106718,0.446191932106718,0.446392521197666,0.446553664410339,0.44671845058081,0.446644933086733,0.44688158456149,0.44688158456149,0.447977933327833,0.448344135682588,0.448148514020211,0.448210071762691,0.448169473882041,0.44914183502628,0.448677864704189,0.44860322375853,0.448681119855066,0.448681119855066,0.449278403980723,0.44932105984223,0.448511989114568,0.447323899182696,0.447323899182696,0.448745578377564,0.449317824015802,0.450048399354797,0.450048399354797,0.450107151562329,0.45172811259063,0.452619281291535,0.456212675190139,0.456212675190139,0.456039618595034,0.455654088881906,0.455202803407337,0.455478172250963,0.454840526721968,0.455209396064206,0.455900229196236,0.45610571815745,0.456353013156773,0.455870180504737,0.455441009599862,0.455220124623112,0.45181420250905,0.447526160752162,0.446372489476858,0.446077088345595,0.446190746974776,0.446461182542089,0.452533933668131,0.457808036855581,0.46526064055243,0.467537953687292,0.469932527815648,0.470136687926805,0.486974761731458,0.491540271350998,0.491301183060725,0.493448705255656,0.494827943342779,0.496301342470794,0.496133281594429,0.496750435173214,0.496968631281604,0.499106979193775,0.49915136878645,0.50214665356441,0.50258200357172,0.502627149231784,0.503052630248341,0.500343876308711,0.492727763687517,0.49063862652008,0.487218971692966,0.484148285909985,0.464538101513758,0.456441700013324,0.454418953914517,0.452694253313161,0.449782756764764,0.449037119696904,0.448792399965424,0.44929124625808)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.020957474169283,-0.014400049571915,-0.011857530400913,-0.009117724412594,-0.007493013303387,-0.004339249000295,-0.000911556999971,0.002980001021963,0.005299008987754,0.007289018246928,0.007846418089333,0.007268262040485,0.007418347733388,0.007074044413397,0.006908648295436,0.006893137265511,0.0069980601017,0.007208887208951,0.00688174281816,0.005785394051817,0.006145430604099,0.006413544229255,0.005608472855733,0.005500216248341,0.004638986390549,0.005079087601851,0.005016909769964,0.005119753543574,0.004678406261035,0.004258219880295,0.004560769361522,0.005680206260512,0.007901266303683,0.008338810481356,0.010074920038745,0.011610099496286,0.012228657285185,0.012405603035393,0.016888297569855,0.015293319133191,0.014402150432285,0.011785021153164,0.011785021153164,0.014494482633119,0.015159718845201,0.01561100431977,0.015449751281183,0.010091258711421,0.009274922090176,0.008251315953429,0.008045826992215,0.005998248270293,0.006144906819254,0.003275421144968,0.003221692545299,0.002471833613324,0.007273418285406,0.008831780711822,0.009127181843085,0.009360913236124,0.013289856158182,0.020030158222835,0.014494544180274,0.010533765163659,0.008845817109582,0.008208088639159,0.008501441793179,-0.006585550856476,-0.010307143367454,-0.009028818996866,-0.011129401402667,-0.011217756066954,-0.01269115519497,-0.011769753509829,-0.012386907088614,-0.012717601031115,-0.015375122769455,-0.017437477957101,-0.020598613377952,-0.020625357806363,-0.020672907463313,-0.021149461273972,-0.0194271159052,-0.015462362462163,-0.012297810535281,-0.014054751162652,-0.014549224755076,0.004812448360118,0.012757297336042,0.01574529229508,0.0164318499768,0.019333109416735,0.019409934775455,0.020555956446191,0.020726578220959)
trans=0.5
age=(-1:(162-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="a - Condamine et al.'s Edited Troodontidae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 0.8, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "b - Condamine et al.'s Edited Troodontidae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 0.6, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")




# CONDAMINE RAW DATA - Troodontidae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.075999170526496,0.078449654552494,0.081373806480927,0.081373806480927,0.081373806480927,0.081970174169526,0.081970174169526,0.081970174169526,0.081970174169526,0.08214399839996,0.081373806480927,0.081373806480927,0.081373806480927,0.081373806480927,0.081373806480927,0.081373806480927,0.081373806480927,0.081373806480927,0.081373806480927,0.081373806480927,0.081970174169526,0.081970174169526,0.081535322475876,0.081535322475876,0.081373806480927,0.078449654552494,0.077064773714546,0.077064773714546,0.077064773714546,0.077064773714546,0.077064773714546,0.077064773714546,0.077064773714546,0.077064773714546,0.077064773714546,0.076112305890363,0.073898578239971,0.068133539826397,0.068949482130538,0.068133539826397,0.068133539826397,0.068133539826397,0.068133539826397,0.068292764709757,0.068292764709757,0.068133539826397,0.068133539826397,0.068133539826397,0.061989301197753,0.057896707790564,0.068133539826397,0.068133539826397,0.034306583560267,0.02453634110225,0.02453634110225,0.001537164313597,0.074179982020336,0.078449654552494,0.082421474453542,0.078449654552494,0.078449654552494,0.078668549041975,0.076442931580912,0.075999170526496,0.075999170526496,0.075999170526496,0.070266663024555,0.075999170526496,0.075999170526496,0.075999170526496,0.086692376214322,0.082421474453542,0.082421474453542,0.082421474453542,0.067346306804397,0.067346306804397,0.098038411062586,0.101176863880918,0.101176863880918,0.101176863880918,0.101176863880918,0.101176863880918,0.101424113665838,0.101176863880918,0.101176863880918,0.101176863880918,0.101176863880918)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.200699834703932,0.202839694585293,0.201173475304125,0.201173475304125,0.200699834703932,0.200699834703932,0.200699834703932,0.200699834703932,0.200699834703932,0.200699834703932,0.199269770531251,0.199269770531251,0.199269770531251,0.19893170237327,0.199269770531251,0.199269770531251,0.199269770531251,0.199269770531251,0.199269770531251,0.199269770531251,0.200699834703932,0.200699834703932,0.200699834703932,0.200699834703932,0.200699834703932,0.201173475304125,0.200699834703932,0.200699834703932,0.200699834703932,0.200699834703932,0.200699834703932,0.201173475304125,0.201173475304125,0.201173475304125,0.201173475304125,0.200699834703932,0.202409462327293,0.19893170237327,0.201173475304125,0.200699834703932,0.201173475304125,0.202409462327293,0.203462412744354,0.206831448019035,0.20694011286879,0.20694011286879,0.20694011286879,0.211062212274275,0.20694011286879,0.20694011286879,0.222792460620576,0.220815015785303,0.20694011286879,0.20694011286879,0.224021798421827,0.237320680411667,0.41684636571773,0.415524451730926,0.41684636571773,0.415524451730926,0.415524451730926,0.41684636571773,0.41684636571773,0.441974945143624,0.464004825738155,0.517337761903827,1.216759229553621,1.80955000463156,2.845727193835975,3.185738895400776,3.240228742302696,3.242072053529596,3.286208625914407,3.410463326625786,3.456678585251918,3.549508785700622,3.641229927386742,3.662253594246867,3.706856775367336,3.730503773711586,3.786384477536116,3.81546356673325,3.894880289497344,3.894880289497344,3.894880289497344,3.894880289497344,3.894880289497344)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.059402449567119,0.059402449567119,0.06582777959571,0.079960741764046,0.082243682843654,0.083762043306534,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.079960741764046,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.081179813943337,0.081179813943337,0.081179813943337,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.081179813943337,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.074410507556755,0.080056333969417,0.080056333969417,0.080056333969417,0.080056333969417,0.077411307364195,0.077411307364195,0.077411307364195,0.077411307364195,0.074410507556755,0.072909065612849,0.072909065612849,0.065187484828274,0.06815449710347,0.059402449567119,0.016086436389486,0.057093753300365,0.057093753300365,0.057093753300365,0.016086436389486,0.043749729692622,0.043749729692622,0.057093753300365,0.016086436389486,0.057093753300365,0.016086436389486,0.057093753300365,0.082265674829774,0.083762043306534,0.083762043306534,0.075536923466216,0.065187484828274,0.075536923466216)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.765219319419386,0.318111397554164,0.228821479457191,0.218912230838517,0.218912230838517,0.218912230838517,0.214204020383094,0.213093483399209,0.212190247178651,0.206472437339991,0.201257651467198,0.19923658160885,0.199055705713859,0.198296281951918,0.197136089987592,0.196856378283781,0.195745751489584,0.196856378283781,0.196856378283781,0.196856378283781,0.196856378283781,0.195745751489584,0.195745751489584,0.195745751489584,0.196856378283781,0.196856378283781,0.196856378283781,0.196856378283781,0.196856378283781,0.197136089987592,0.197136089987592,0.19923658160885,0.19923658160885,0.19923658160885,0.197136089987592,0.197136089987592,0.197136089987592,0.197136089987592,0.197136089987592,0.197136089987592,0.197136089987592,0.197136089987592,0.197136089987592,0.197136089987592,0.19923658160885,0.198296281951918,0.198296281951918,0.198296281951918,0.198296281951918,0.198296281951918,0.199055705713859,0.199055705713859,0.201561955003626,0.20385304823212,0.19923658160885,0.205794994756346,0.207799895600368,0.207799895600368,0.207799895600368,0.207799895600368,0.207799895600368,0.207799895600368,0.207799895600368,0.206472437339991,0.205794994756346,0.207799895600368,0.207799895600368,0.218989942613748,0.329816644512825,1.064616026653941,1.564172049186824,2.075406062781077,2.578825861858514,2.700980587411317,3.004007538261835,3.051079308449716,3.301606332073664,3.414147155553996,3.585428485977686,3.585428485977686,3.789955070211819,3.831021881379864,3.831021881379864,3.831021881379864,3.831021881379864,3.831021881379864,3.881828215291714)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.682665380172041,-0.207800175622013,-0.108746152984598,-0.108746152984598,-0.093401181332175,-0.093401181332175,-0.09797680434378,-0.093401181332175,-0.093401181332175,-0.092109380115084,-0.091204420290926,-0.092109380115084,-0.091204420290926,-0.091204420290926,-0.091204420290926,-0.091204420290926,-0.093062541859947,-0.091204420290926,-0.091204420290926,-0.08072077613456,-0.091204420290926,-0.091204420290926,-0.091958306478091,-0.091958306478091,-0.089803443699804,-0.091204420290926,-0.091204420290926,-0.091204420290926,-0.091204420290926,-0.091204420290926,-0.091204420290926,-0.091204420290926,-0.091204420290926,-0.091204420290926,-0.091204420290926,-0.091204420290926,-0.091204420290926,-0.091204420290926,-0.091204420290926,-0.099089517303173,-0.095551357396192,-0.093062541859947,-0.095551357396192,-0.093062541859947,-0.095551357396192,-0.097177032062909,-0.097177032062909,-0.09797680434378,-0.099089517303173,-0.101972229168693,-0.091204420290926,-0.091204420290926,-0.119910895632913,-0.100646056988068,-0.119831803617636,-0.132917780044908,-0.132917780044908,-0.098451885676836,-0.100646056988068,-0.098451885676836,-0.093062541859947,-0.098451885676836,-0.098451885676836,-0.088138877786172,-0.096341119277234,-0.091408879993505,-0.236077900254978,-0.236077900254978,-0.229213215076846,-0.364037953110385,-1.11411517808495,-1.79778233056634,-1.907337986597058,-2.30746374430345,-2.91147481212402,-2.929046274560053,-2.747180359798432,-2.91147481212402,-2.902633358429731,-2.902633358429731,-2.91147481212402,-3.446253001463212,-3.251884575789804,-3.283759000034782,-3.341098216032732,-3.341098216032732,-2.948938127679466)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.104174400966208,0.104174400966208,0.097972296526232,0.077946413056273,0.086672709163661,0.084524558595752,0.077946413056273,0.081091628427816,0.077946413056273,0.07489438736825,0.070852023203845,0.068311056283946,0.068311056283946,0.068311056283946,0.068311056283946,0.068133866615767,0.065806751013792,0.068133866615767,0.067669680370353,0.077946413056273,0.068311056283946,0.068311056283946,0.068311056283946,0.068311056283946,0.071187162564547,0.07017374712968,0.070852023203845,0.07017374712968,0.07017374712968,0.07017374712968,0.07017374712968,0.070852023203845,0.070852023203845,0.070852023203845,0.07017374712968,0.070852023203845,0.074843159510622,0.07558116783088,0.077946413056273,0.07558116783088,0.077946413056273,0.077946413056273,0.077946413056273,0.077946413056273,0.077946413056273,0.077946413056273,0.077946413056273,0.077946413056273,0.077946413056273,0.077946413056273,0.093308957002431,0.088074065128039,0.077946413056273,0.101854924238329,0.093308957002431,0.118754242487425,0.239050701627732,0.305381567007659,0.305381567007659,0.324335630511845,0.326568706011883,0.324335630511845,0.326568706011883,0.359604858429017,0.36729428252509,0.449624215458585,1.116809539805689,1.749546446788013,3.126314721119017,3.553689650963298,3.669062348748594,3.45614244557535,3.947424855353533,3.880944984326924,3.529745723616224,3.45614244557535,3.522802094214487,3.522802094214487,3.522802094214487,3.522802094214487,3.466701139895194,2.900788012866215,3.040333798231562,3.040333798231562,3.040333798231562,3.040333798231562,3.466701139895194)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.134743815060049,0.134917996072569,0.135539828655602,0.135550237940511,0.135676215377825,0.135678665578666,0.135678665578666,0.135731394090507,0.135731394090507,0.135683898414808,0.135483723889636,0.135483723889636,0.135483723889636,0.135513181415661,0.135605765863767,0.135605765863767,0.135605765863767,0.135573412932391,0.135573412932391,0.135573412932391,0.135149038265339,0.135123638224789,0.134980712666353,0.134953674509135,0.134729922030469,0.13423823295599,0.134183370811035,0.133944281612669,0.133944281612669,0.133944281612669,0.133899487348657,0.133821353984156,0.133762392039947,0.133762392039947,0.133497851351413,0.13334314861112,0.132596359360525,0.131910339807839,0.131695806612136,0.131519296822734,0.131328359802478,0.131134638186629,0.130967602828494,0.131176765696939,0.131070666602116,0.130955643984461,0.13100689109087,0.130872329698377,0.130990864998065,0.131570621955237,0.131865222417876,0.132392317280287,0.133882342481071,0.135626848681427,0.137949352187495,0.145685756203497,0.161570654834967,0.17368851981569,0.176545639051634,0.178606993023866,0.177914878082659,0.178543779016865,0.17999580339705,0.18363326911987,0.189774378969351,0.202088794151827,0.295696788952741,0.445088563950109,0.69496774140668,0.840260259280683,0.939637760166729,0.984012029011116,1.034074583701218,1.100914631420236,1.143985386897127,1.186621542270034,1.232842728159584,1.264004807178469,1.306675950941108,1.332832265658272,1.38125643127453,1.412148874051176,1.443765705082876,1.450890021338196,1.452132145506436,1.452646088970216,1.449926657522081)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.232231368938303,0.165576015304839,0.15164172497122,0.146588270851536,0.145642288102476,0.145361179406265,0.145168414000075,0.145068322238437,0.144666338960175,0.142654371793481,0.14032344420302,0.139300358847079,0.138953762798579,0.13883923369705,0.138674962869277,0.138398535257446,0.138290073483885,0.138182169165411,0.137624303851621,0.137333811536157,0.137333811536157,0.137242199271783,0.137242199271783,0.137197121349193,0.137300119220261,0.137369176521983,0.137369176521983,0.137369176521983,0.137369176521983,0.137499912824079,0.137474214781503,0.137634499157479,0.137635886018176,0.137632127107831,0.137732582273879,0.137732582273879,0.137732582273879,0.137879467531581,0.137879467531581,0.137912126527188,0.137906700508856,0.137891281307876,0.137891281307876,0.137891281307876,0.138075841314022,0.138160525472631,0.138229912627284,0.138521342213581,0.138529055275577,0.138576740579683,0.13878385505623,0.138948795340861,0.139437267137885,0.140225404575889,0.140421644853809,0.141253246409805,0.14198501726095,0.1423170854121,0.142427218177638,0.142596921465034,0.142423932263831,0.142447827901443,0.142447827901443,0.142843451665706,0.143097381689931,0.143937923097535,0.145977368152526,0.153640320414971,0.193311610931623,0.258309317462536,0.318013105289337,0.395885030357744,0.511643270478556,0.57610202498954,0.671725100074742,0.747732921171431,0.842484487144806,0.920783779402668,1.015280677724888,1.082483304371895,1.18312741751586,1.277819161915233,1.311187716952808,1.317889868876663,1.335819831144006,1.348303562862168,1.363177172598403)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.097487553878254,-0.03065801923227,-0.016101896315618,-0.011038032911025,-0.00996607272465,-0.009682513827599,-0.009489748421409,-0.00933692814793,-0.008934944869668,-0.006970473378673,-0.004839720313383,-0.003816634957443,-0.003470038908943,-0.003326052281389,-0.003069197005509,-0.002792769393679,-0.002684307620118,-0.00260875623302,-0.00205089091923,-0.001760398603766,-0.002184773270817,-0.002118561046994,-0.00226148660543,-0.002243446840058,-0.002570197189792,-0.003130943565992,-0.003185805710947,-0.003424894909314,-0.003424894909314,-0.00355563121141,-0.003574727432846,-0.003813145173323,-0.003873493978229,-0.003869735067884,-0.004234730922466,-0.004389433662759,-0.005136222913353,-0.005969127723741,-0.006183660919445,-0.006392829704454,-0.006578340706379,-0.006756643121248,-0.006923678479382,-0.006714515610937,-0.007005174711906,-0.00720488148817,-0.007223021536414,-0.007649012515204,-0.007538190277512,-0.007006118624447,-0.006918632638355,-0.006556478060575,-0.005554924656814,-0.004598555894461,-0.002472292666314,0.004432509793692,0.019585637574018,0.03137143440359,0.034118420873996,0.036010071558832,0.035490945818828,0.036095951115422,0.037547975495608,0.040789817454164,0.04667699727942,0.058150871054292,0.149719420800214,0.291448243535138,0.501656130475057,0.581950941818147,0.621624654877392,0.588126998653373,0.522431313222662,0.524812606430697,0.472260286822385,0.438888621098603,0.390358241014777,0.343221027775801,0.291395273216219,0.250348961286378,0.198129013758669,0.134329712135943,0.132577988130068,0.133000152461533,0.116312314362429,0.104342526108049,0.086749484923678)
trans=0.5
age=(-1:(154-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="c - Condamine et al.'s Unedited Troodontidae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 0.8, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "d - Condamine et al.'s Unedited Troodontidae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 0.6, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")



# OUR DATA - Troodontidae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.05739229152769,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056918772601388,0.056861615690263,0.056861615690263,0.056861615690263,0.056918772601388,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.056861615690263,0.058265879833235,0.058265879833235,0.05739229152769,0.05739229152769,0.057729872079116,0.057729872079116,0.05739229152769,0.056861615690263,0.056148132899331,0.053340891305669,0.051506555118466,0.052077426922128,0.051729580655022,0.051506555118466,0.049892434959683,0.047867753380013,0.047819446870827,0.043803578074955,0.008430789405608,0.043803578074955,0.081637321532815,0.321678739703172,0.321678739703172,0.321678739703172,0.297315870567887,0.287021158988119,0.271032085638595,0.247814552629246)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.130361346627812,0.129148417188304,0.129065746319584,0.129065746319584,0.129065746319584,0.128837844983138,0.128837844983138,0.128837844983138,0.12855634210704,0.12855634210704,0.128218461111493,0.128218461111493,0.128218461111493,0.128218461111493,0.128218461111493,0.128218461111493,0.128218461111493,0.128218461111493,0.128218461111493,0.12855634210704,0.12855634210704,0.12855634210704,0.12855634210704,0.128837844983138,0.129065746319584,0.129065746319584,0.129065746319584,0.129065746319584,0.129065746319584,0.129065746319584,0.129065746319584,0.129148417188304,0.129148417188304,0.129148417188304,0.129148417188304,0.129148417188304,0.129148417188304,0.129148417188304,0.129148417188304,0.131224503054951,0.131224503054951,0.130493203099823,0.130493203099823,0.131224503054951,0.131224503054951,0.131224503054951,0.131224503054951,0.131224503054951,0.131224503054951,0.130361346627812,0.131224503054951,0.131224503054951,0.131224503054951,0.131224503054951,0.131224503054951,0.135225659241717,0.143784589274778,1.119666329730748,2.667983493340894,3.344832138677125,3.44157776243912,3.44157776243912,3.44157776243912,3.44157776243912,3.44157776243912,3.44157776243912,3.44157776243912)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.025248546082185,0.038491388221064,0.040316821924761,0.0407976261003,0.040004104903277,0.042062830547744,0.042062830547744,0.042400130836073,0.042400130836073,0.042400130836073,0.042400130836073,0.042400130836073,0.042400130836073,0.042400130836073,0.042400130836073,0.042400130836073,0.042400130836073,0.042400130836073,0.042400130836073,0.042062830547744,0.042400130836073,0.042400130836073,0.042400130836073,0.042400130836073,0.042400130836073,0.042400130836073,0.042062830547744,0.042062830547744,0.0407976261003,0.0407976261003,0.040316821924761,0.038491388221064,0.037687768175009,0.039024293064558,0.036921497044298,0.042062830547744,0.038491388221064,0.0352366086759,0.0352366086759,0.037687768175009,0.037687768175009,0.038491388221064,0.0352366086759,0.037742094168046,0.037742094168046,0.037742094168046,0.037742094168046,0.042062830547744,0.037742094168046,0.047106963769415,0.047106963769415,0.047921742428824,0.043133461918347,0.048546364490012,0.048546364490012,0.047106963769415,0.048546364490012,0.047106963769415,0.043133461918347,0.047106963769415,0.043133461918347,0.02871155634024,0.043133461918347,0.043133461918347,0.02871155634024,0.043133461918347,0.043133461918347)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.53419038101204,0.120968043868148,0.118195992367284,0.118195992367284,0.116842682403238,0.118195992367284,0.118195992367284,0.118195992367284,0.118195992367284,0.118195992367284,0.118195992367284,0.118195992367284,0.116842682403238,0.116842682403238,0.116842682403238,0.116842682403238,0.116842682403238,0.116842682403238,0.116842682403238,0.116842682403238,0.117992569165139,0.117992569165139,0.117992569165139,0.117992569165139,0.117992569165139,0.117992569165139,0.118195992367284,0.118195992367284,0.118195992367284,0.118195992367284,0.118195992367284,0.118195992367284,0.117992569165139,0.120968043868148,0.120968043868148,0.129373989347916,0.12978911634537,0.132822676326151,0.141381255785714,0.16844768673081,0.18468237959794,0.200095086263123,0.206955989154305,0.211825479388014,0.218294367464829,0.232572552649249,0.243531386683529,0.257134275614081,0.269176735047114,0.290600095754816,0.29924491487858,0.311347167071448,0.315215738351136,0.324311904486669,0.32506784152272,0.32506784152272,0.328097039484177,0.330491666287248,0.332752598072566,0.364621290108474,0.543895956529798,0.997486323055766,1.54857809178904,1.826706646680299,1.973372695205732,2.296640381716174,2.499311220644733)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.458352151135159,-0.044234838108261,-0.044234838108261,-0.044234838108261,-0.044234838108261,-0.044234838108261,-0.044234838108261,-0.044234838108261,-0.044234838108261,-0.044234838108261,-0.044234838108261,-0.044234838108261,-0.042255515869746,-0.042255515869746,-0.042255515869746,-0.041674710233282,-0.041674710233282,-0.041674710233282,-0.041674710233282,-0.042255515869746,-0.041674710233282,-0.041674710233282,-0.041674710233282,-0.041674710233282,-0.041674710233282,-0.041674710233282,-0.044234838108261,-0.044234838108261,-0.044234838108261,-0.044234838108261,-0.044234838108261,-0.044234838108261,-0.044057124070183,-0.044234838108261,-0.044234838108261,-0.043933830515359,-0.052532159328067,-0.051421497833952,-0.05346998594937,-0.07929457224565,-0.090645965131833,-0.114111213936773,-0.12041305551003,-0.138989046655894,-0.139506207031277,-0.167703211925411,-0.16906300362246,-0.16906300362246,-0.208124457265832,-0.215334218931301,-0.221882487824467,-0.221882487824467,-0.240273790675669,-0.240273790675669,-0.24488688615429,-0.275797066188341,-0.308032818434469,-0.302949968315994,-0.226794319400022,-0.05906719145628,-0.054821348247789,-0.461683873812184,-0.860980755986071,-0.942310431271263,-0.986185594651448,-1.540648554489859,-1.691274304163518)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.086561582338769,0.062918548900604,0.0549701668496,0.055741021137315,0.055741021137315,0.055741021137315,0.055741021137315,0.0549701668496,0.0549701668496,0.054681504381419,0.054681504381419,0.054681504381419,0.055741021137315,0.055741021137315,0.0549701668496,0.0549701668496,0.0549701668496,0.0549701668496,0.0549701668496,0.0549701668496,0.056239615389923,0.056239615389923,0.056239615389923,0.056239615389923,0.056239615389923,0.056239615389923,0.0549701668496,0.055437362177297,0.055741021137315,0.055741021137315,0.055741021137315,0.058317287841198,0.058906934993632,0.059634816239988,0.062048976939496,0.065054273181906,0.062918548900604,0.072294519381213,0.081486970997643,0.079906065682306,0.079906065682306,0.076294319826877,0.085585203866749,0.072294519381213,0.079906065682306,0.058317287841198,0.065054273181906,0.079906065682306,0.053561777686166,0.056805287158305,0.054053917792011,0.068287604222653,0.062048976939496,0.062048976939496,0.071029880085318,0.056249649794547,0.062048976939496,1.088276887869757,2.516321092685058,3.318291017852432,3.60918332071673,3.684477519841614,3.80609377936319,3.80609377936319,4.069005147582076,3.80609377936319,3.70967402994777)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.088232378929204,0.088153583279956,0.088249636278283,0.088248145874079,0.088369764463053,0.088407138958532,0.088439765635846,0.088467416434885,0.08859049317757,0.088614203048827,0.088705987360736,0.088906448119093,0.088983813001435,0.089040527683497,0.089063538298434,0.089141437987367,0.089232615084114,0.089255674321257,0.089255674321257,0.089240934905776,0.089240934905776,0.089240934905776,0.089286032532327,0.08933915133258,0.089281888720376,0.089281888720376,0.089300530825587,0.089257454097587,0.089257454097587,0.089257454097587,0.089257454097587,0.089351644527103,0.089351644527103,0.089351644527103,0.089351644527103,0.089427726269092,0.089427726269092,0.089467238143272,0.089467238143272,0.089791340210376,0.089830106443629,0.090123982906282,0.090123982906282,0.090420652795007,0.090420652795007,0.090438831248318,0.090888737169691,0.09083835353862,0.090734457644999,0.090882452103513,0.091417504021652,0.091411912296864,0.091497673877714,0.092319885520847,0.093378994625533,0.096318549539872,0.104482011023144,0.243305669708536,1.16329760766721,1.545483286338631,1.582971240014282,1.582340226946002,1.581149121325333,1.58110097737083,1.58585786470399,1.58754036082992,1.581367886893096)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.127285626576322,0.084051343294127,0.080056368561793,0.079887574123383,0.079832613637383,0.079774599537834,0.079774599537834,0.079648822436237,0.079648822436237,0.079561962449633,0.079561962449633,0.079561962449633,0.079251687421575,0.079193373133279,0.079018831740645,0.079018831740645,0.079007565171396,0.078848055028022,0.078848055028022,0.078803105831994,0.078741519686639,0.078741519686639,0.078692780967367,0.078692780967367,0.078669403652469,0.078648324704748,0.078907079399694,0.078858333575473,0.079064272160751,0.079064272160751,0.079344775189121,0.079885949659559,0.079955565248786,0.080275738978012,0.080968875615812,0.081773637273043,0.083016513158582,0.08378632237108,0.085419461459851,0.088937605778804,0.090789809419591,0.095122013096472,0.097608468477008,0.098784410746203,0.099844255630062,0.102057200206907,0.104070285058567,0.108014332351007,0.112148668187621,0.118149503918222,0.1219895605423,0.127321342187123,0.133883015282991,0.135021835570415,0.135849490396611,0.136427785800386,0.136656029671035,0.137842170651595,0.139677217687517,0.156076664849317,0.222896072215362,0.260955955435397,0.321539029145196,0.366250770738613,0.419049495938748,0.498383389431732,0.538504819948932)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.039053247647118,0.00410223998583,0.00819326771649,0.008360571750696,0.008537150825669,0.008632539420697,0.008665166098012,0.008818593998648,0.008941670741333,0.009052240599194,0.009144024911103,0.009344485669461,0.009732125579861,0.009847154550219,0.01004470655779,0.010122606246722,0.010225049912718,0.010407619293236,0.010407619293236,0.010437829073782,0.010499415219137,0.010499415219137,0.01059325156496,0.010646370365213,0.010612485067907,0.010633564015628,0.010393451425893,0.010399120522114,0.010193181936836,0.010193181936836,0.009912678908466,0.009465694867544,0.009396079278318,0.009075905549091,0.008382768911291,0.00765408899605,0.00641121311051,0.005680915772193,0.004047776683422,0.000853734431571,-0.000959702975962,-0.00499803019019,-0.007484485570726,-0.008363757951196,-0.009423602835055,-0.011618368958589,-0.013181547888876,-0.017175978812387,-0.021414210542623,-0.02726705181471,-0.030572056520648,-0.035909429890259,-0.042385341405277,-0.042701950049569,-0.042470495771078,-0.040109236260514,-0.032174018647891,0.105463499056941,1.023620389979693,1.389406621489314,1.360075167798921,1.321384271510606,1.259610092180137,1.214850206632217,1.166808368765243,1.089156971398189,1.042863066944164)
trans=0.5
age=(-1:(134-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="e - Our Troodontidae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 0.8, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")

# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "f - Our Troodontidae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 0.6, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")



# SAKAMOTO DATA - Troodontidae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.057043643675691,0.057043643675691,0.057043643675691,0.055765048542509,0.057043643675691,0.061041505641866,0.061041505641866,0.061041505641866,0.055262189521551,0.055765048542509,0.055765048542509,0.055262189521551,0.057043643675691,0.057043643675691,0.057043643675691,0.057043643675691,0.057043643675691,0.055262189521551,0.06345769723902,0.057043643675691,0.057043643675691,0.057043643675691,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.057043643675691,0.057043643675691,0.057043643675691,0.057043643675691,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.055262189521551,0.057043643675691,0.057043643675691,0.057043643675691,0.056219002151221,0.056219002151221,0.056219002151221,0.056219002151221,0.061041505641866,0.061041505641866,0.061041505641866,0.060576176779706,0.060576176779706,0.059934537985539,0.060576176779706,0.060576176779706,0.060576176779706,0.060576176779706,0.060576176779706,0.060576176779706,0.060576176779706,0.060576176779706,0.059934537985539,0.060576176779706,0.060576176779706,0.057158989105755,0.057043643675691,0.057043643675691,0.055262189521551,0.055262189521551,0.055262189521551,0.057043643675691,0.055262189521551,0.055262189521551,0.055262189521551)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.155813245254487,0.155813245254487,0.155813245254487,0.152660953969151,0.152660953969151,0.155813245254487,0.155813245254487,0.154666845416032,0.147496460088233,0.149018157198588,0.149018157198588,0.147496460088233,0.149018157198588,0.149018157198588,0.149018157198588,0.149018157198588,0.149018157198588,0.147073076355169,0.154666845416032,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147496460088233,0.147073076355169,0.149018157198588,0.149018157198588,0.149018157198588,0.149018157198588,0.149018157198588,0.149018157198588,0.149018157198588,0.154666845416032,0.154666845416032,0.154666845416032,0.154666845416032,0.154666845416032,0.154666845416032,0.155813245254487,0.155813245254487,0.155813245254487,0.155813245254487,0.155813245254487,0.155813245254487,0.155813245254487,0.155813245254487,0.155813245254487,0.157404533027952,0.157404533027952,0.154666845416032,0.154666845416032,0.155813245254487,0.154666845416032,0.155813245254487,0.157404533027952,0.161445378737292,0.161445378737292,0.165618003253784,0.170852922924796)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.030275592487274,0.030275592487274,0.038437495113666,0.038117301508783,0.037634771988384,0.037634771988384,0.037634771988384,0.038437495113666,0.038437495113666,0.038117301508783,0.038117301508783,0.038117301508783,0.038437495113666,0.038437495113666,0.038117301508783,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.038437495113666,0.038437495113666,0.038437495113666,0.038117301508783,0.038117301508783,0.038117301508783,0.038117301508783,0.037634771988384,0.037634771988384,0.037634771988384,0.038117301508783,0.038117301508783,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037634771988384,0.037147214499125,0.037147214499125,0.037147214499125,0.037147214499125,0.037147214499125,0.037147214499125,0.037147214499125,0.037147214499125,0.037147214499125,0.037147214499125,0.038437495113666,0.038117301508783,0.038117301508783,0.038117301508783,0.038437495113666,0.038437495113666,0.038437495113666,0.038437495113666,0.038437495113666,0.038117301508783,0.038117301508783,0.038437495113666,0.038117301508783,0.037634771988384,0.037634771988384,0.037634771988384,0.037147214499125,0.037147214499125,0.038437495113666,0.038437495113666,0.038437495113666,0.038117301508783,0.038117301508783,0.038117301508783,0.038117301508783,0.037634771988384,0.037634771988384,0.035684409948188,0.035360476191987,0.035360476191987)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.942439648333438,0.142275787888628,0.137726443896494,0.134991321544034,0.131143660101026,0.129078992903663,0.12819257920354,0.127572670063717,0.127572670063717,0.126928218682115,0.126928218682115,0.126928218682115,0.126928218682115,0.126928218682115,0.124879949203998,0.122416487763613,0.122416487763613,0.122416487763613,0.122416487763613,0.122416487763613,0.122416487763613,0.122416487763613,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.12235963665692,0.12235963665692,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.121510283129992,0.12235963665692,0.12235963665692,0.12235963665692,0.12235963665692,0.12235963665692,0.12235963665692,0.123323637325748,0.123323637325748,0.123323637325748,0.12235963665692,0.12235963665692,0.12235963665692,0.12235963665692,0.12235963665692,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.124879949203998,0.125468661900827,0.125468661900827,0.125468661900827,0.125468661900827,0.125468661900827,0.125468661900827,0.125468661900827,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646,0.12738474956646)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.84750255986296,-0.073024221266509,-0.046358132188756,-0.046358132188756,-0.046358132188756,-0.046358132188756,-0.046260055089665,-0.046358132188756,-0.046358132188756,-0.046358132188756,-0.046358132188756,-0.046358132188756,-0.043572601667739,-0.046260055089665,-0.046260055089665,-0.043572601667739,-0.043572601667739,-0.046260055089665,-0.043572601667739,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.043572601667739,-0.043231350990088,-0.043231350990088,-0.043231350990088,-0.042258942766059,-0.04202552097558,-0.04202552097558,-0.042258942766059,-0.043231350990088,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.04202552097558,-0.04202552097558,-0.04202552097558,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.03854493768839,-0.03854493768839,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.042258942766059,-0.04202552097558,-0.042258942766059,-0.04202552097558,-0.04202552097558,-0.042258942766059,-0.042258942766059,-0.043572601667739,-0.042258942766059,-0.040687371875351,-0.04202552097558,-0.042258942766059,-0.046260055089665,-0.046260055089665,-0.048786371019872)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.129266134510613,0.11081399383179,0.11081399383179,0.098467434776372,0.091375757753938,0.089265591943769,0.089265591943769,0.087586865371114,0.087586865371114,0.087304922272576,0.086995817140863,0.086995817140863,0.089265591943769,0.086144700714928,0.084490563822459,0.085244994536344,0.085244994536344,0.081674416658759,0.083584933222382,0.083584933222382,0.083584933222382,0.084490563822459,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.081674416658759,0.082314968047052,0.082314968047052,0.081674416658759,0.082751990317745,0.082314968047052,0.082314968047052,0.082314968047052,0.082751990317745,0.082751990317745,0.083178694000318,0.083178694000318,0.083178694000318,0.083178694000318,0.083584933222382,0.083584933222382,0.083584933222382,0.084490563822459,0.085244994536344,0.085244994536344,0.085244994536344,0.085244994536344,0.086144700714928,0.086144700714928,0.090595687925793,0.090595687925793,0.087304922272576,0.087586865371114,0.087586865371114,0.087586865371114,0.088268455313947,0.088268455313947,0.088268455313947,0.088594126756652,0.089265591943769,0.089265591943769,0.090595687925793,0.090595687925793,0.091375757753938,0.092098868208192,0.092098868208192,0.094566186591582,0.096681729634575,0.096681729634575,0.098667120770518,0.100791257706204,0.106843381728824,0.112918023316984)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.102241525314733,0.102246557855562,0.102246557855562,0.102851603400852,0.103249758087027,0.103244708698218,0.103197342813048,0.103392112344411,0.103548655081251,0.103625102247284,0.103697007052041,0.103753764750538,0.104588080722319,0.104598272679625,0.104598272679625,0.104598272679625,0.104600648386608,0.104549761152783,0.104409328087802,0.103867242692248,0.103791359538323,0.103791359538323,0.103714715832224,0.103714715832224,0.103714715832224,0.103714715832224,0.103641486600714,0.103641486600714,0.1036636819526,0.1036636819526,0.10376582566635,0.10376582566635,0.10376582566635,0.103761823627676,0.103796942866134,0.103796942866134,0.103793141793094,0.103855273399446,0.103855273399446,0.103879089506363,0.103879089506363,0.103879089506363,0.103778322455458,0.103635528402327,0.103588843310227,0.103588843310227,0.103588843310227,0.103588843310227,0.103588843310227,0.103588843310227,0.103588843310227,0.103611372696627,0.103682762133727,0.103682762133727,0.103682762133727,0.103859246664518,0.103859246664518,0.103859246664518,0.103859246664518,0.103912820044414,0.103937204423638,0.103983251128281,0.104128010877276,0.104128010877276,0.104293173702379,0.104350438172586,0.104357401263423,0.104357401263423,0.10428282775981,0.10428282775981,0.104295557633844,0.104308442317743,0.104308442317743,0.104352321155068,0.104457816364249,0.104432822626468,0.105068388996502,0.105173910015582,0.105219365897775,0.105372637806612,0.105627811976319,0.10681475881586,0.107871879185644,0.109261940251141,0.110633479914201,0.114595332662779)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.196261412511733,0.092287452906248,0.084841754849177,0.083436066340255,0.082215822099778,0.081854710213194,0.081562416485156,0.081113759354638,0.081113759354638,0.08088801242067,0.080819288174055,0.080778885732024,0.080652262190363,0.080498187267692,0.080014361058228,0.079628967867338,0.079628967867338,0.079463729538721,0.079463729538721,0.079359683407105,0.079320810945315,0.079291976170046,0.078959831543998,0.078768526234572,0.078719323687504,0.078719323687504,0.07877826661477,0.0786700587088,0.0786700587088,0.078821779449589,0.078821779449589,0.078751302371125,0.078751302371125,0.078700444715434,0.078618950486977,0.078679671184754,0.078679671184754,0.078679671184754,0.078679671184754,0.078563875767092,0.078563875767092,0.078600342372181,0.078578807792157,0.078578807792157,0.078578807792157,0.07862909084259,0.078650293774135,0.078650293774135,0.078697075073553,0.078705571286627,0.078705571286627,0.078620995787775,0.078620995787775,0.0785919242193,0.078662916316783,0.078662916316783,0.078796836396866,0.078727803054487,0.078727803054487,0.078727803054487,0.078716840703481,0.078716840703481,0.078716840703481,0.078716840703481,0.078716840703481,0.07886220019499,0.07886220019499,0.078796115548436,0.07897613124862,0.078881766184508,0.078894399252784,0.078894399252784,0.078847248582036,0.078847248582036,0.078736842151999,0.078753045220931,0.078753045220931,0.078665084994581,0.078665084994581,0.078665084994581,0.078665084994581,0.078955416335127,0.07894152427232,0.079318356914313,0.079403486554383,0.079396243281776)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.094019887197,0.009959104949314,0.017404803006385,0.019415537060597,0.021033935987249,0.021389998485024,0.021634926327892,0.022278352989773,0.022434895726613,0.022737089826614,0.022877718877987,0.022974879018515,0.023935818531956,0.024100085411933,0.024583911621397,0.024969304812288,0.024971680519271,0.025086031614062,0.024945598549081,0.024507559285143,0.024470548593007,0.024499383368277,0.024754884288225,0.024946189597652,0.02499539214472,0.02499539214472,0.024863219985944,0.024971427891915,0.0249936232438,0.024841902503011,0.024944046216761,0.025014523295225,0.025014523295225,0.025061378912242,0.025177992379156,0.025117271681379,0.025113470608339,0.025175602214692,0.025175602214692,0.025315213739271,0.025315213739271,0.025278747134182,0.025199514663301,0.02505672061017,0.02501003551807,0.024959752467637,0.024938549536092,0.024938549536092,0.024891768236674,0.024883272023601,0.024883272023601,0.024990376908853,0.025061766345953,0.025090837914427,0.025019845816945,0.025196330347735,0.025062410267652,0.025131443610031,0.025131443610031,0.025185016989927,0.025220363720157,0.0252664104248,0.025411170173795,0.025411170173795,0.025576332998898,0.025488237977596,0.025495201068432,0.025561285714986,0.02530669651119,0.025401061575302,0.02540115838106,0.025414043064959,0.025461193735706,0.025505072573032,0.02572097421225,0.025679777405537,0.026315343775571,0.026508825021001,0.026554280903194,0.026707552812031,0.026962726981738,0.027859342480733,0.028930354913325,0.029943583336828,0.031229993359818,0.035199089381003)
trans=0.5
age=(-1:(153-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="g - Sakamoto et al.'s Troodontidae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 0.8, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "h - Sakamoto et al.'s Troodontidae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 0.6, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")


dev.off()
