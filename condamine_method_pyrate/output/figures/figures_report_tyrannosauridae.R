# 1 files combined:
# 	./PyRate_Inputs_2_BDMCMC_Grj_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

if(!require('base64')) {
  install.packages('base64')
  library('base64')
}

library("magick")

pngfile <- "./figures report Tyrannosauridae.png"
png(pngfile, width = 8, height = 15, units = "in", res = 1200)
# par(mfrow=c(4,2))

# Define the layout matrix
layout_matrix <- matrix(c(1, 1, 
                          2, 3, 
                          4, 5, 
                          6, 7, 
                          8, 9), 
                        nrow = 5, ncol = 2, byrow = TRUE)

# Set up the layout
layout(layout_matrix)

images <- image_read("Results Condamine Tyrannosauridae.png")
par(mar = c(0, 0, 0, 0))
plot.new()
rasterImage(images, 0, 0, 1, 1)

par(mar = c(5, 4, 4, 2))

library(scales)
plot_RTT <- function (age,hpd_M,hpd_m,mean_m,color){
  N=100
  beta=(1:(N-1))/N
  alpha_shape=0.25
  cat=1-(beta^(1./alpha_shape))
  for (i in 1:(N-1)){
    trans= 1/N + 2/N
    polygon(c(age, rev(age)), c(hpd_M-((hpd_M-mean_m)*cat[i]), rev(hpd_m+((mean_m-hpd_m)*cat[i]))), col = alpha(color,trans), border = NA)
  }
  lines(rev(age), rev(mean_m), col = color, lwd=3)
}


# CONDAMINE EDITED DATA - Tyrannosauridae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.090037579334737,0.090037579334737,0.101003631558322,0.120521628925798,0.156245988574034,0.156245988574034,0.154282370734395,0.203339144189464,0.253115055227988,0.234161832905105,0.257450446131942,0.334611158744173,0.32888857006754)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.840317184601937,0.831048961842792,0.83840832460871,0.858101459175528,0.929865099097282,1.053510163163788,1.13000102112045,1.515900167421213,1.616720656325065,1.710710968727035,3.086728363515871,3.308587089335668,3.308587089335668)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.205044738355035,0.2527314801149,0.205044738355035,0.226998915262041,0.2305085701679,0.255991751793455,0.266880365648088,0.293825917482767,0.279161377283795,0.291081491665974,0.264495176680952,0.221095640697552,0.169154411129677)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,1.12370581155887,1.109562194901113,0.971007161958212,0.971007161958212,0.971007161958212,0.95585341095126,0.990879700811567,1.067631988918786,1.153411166183803,1.201802519856067,1.393356653515546,2.14046561118582,2.281159340750292)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.835549988593186,-0.703114057566804,-0.607944990209763,-0.585746155578308,-0.585746155578308,-0.602642992519661,-0.612942643415877,-0.70402651685942,-0.726422291154842,-0.714395347441378,-1.158871344727585,-1.161709340662549,-1.187158976230492)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.453819485032827,0.488023154545238,0.447637056123233,0.436364734489956,0.462073686670935,0.62150677535608,0.731266987778104,1.035240418797333,1.122519930735755,1.256200157536776,2.498467728248922,3.156277620889446,3.156277620889446)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.478014661878733,0.484997238335216,0.48534166588407,0.488927282311114,0.506038820820587,0.568011570660085,0.598136493465787,0.720484124147358,0.783167965852656,0.83439978226172,1.276372059848819,1.368802356040826,1.395289193164118)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.637611863320757,0.625942844151845,0.575916557575723,0.563593693468798,0.572257885251936,0.597431052557563,0.606368505364441,0.625896657434675,0.659370317687564,0.666625615229552,0.725162205281582,0.871531692896495,0.914691850773225)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.159597201442024,-0.140945605816628,-0.090574891691653,-0.074666411157684,-0.066219064431349,-0.029419481897478,-0.008232011898654,0.094587466712683,0.123797648165091,0.167774167032169,0.551209854567237,0.497270663144331,0.480597342390894)
trans=0.5
age=(-1:(80-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 1.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="a - Condamine et al.'s Edited Tyrannosauridae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 1.6, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "b - Condamine et al.'s Edited Tyrannosauridae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 0.6, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")




# CONDAMINE RAW DATA - Tyrannosauridae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.025718633643719,0.024027130226156,0.024027130226156,0.024027130226156,0.024467958546362,0.024027130226156,0.024027130226156,0.024027130226156,0.024027130226156,0.024027130226156,0.024467958546362,0.024027130226156,0.025718633643719,0.024027130226156,0.011738356278948,0.014742278763149,0.05253722876431,0.053870147522793)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.152713772760019,0.145508814553762,0.143581482552666,0.143581482552666,0.143581482552666,0.141879338224863,0.1400628683153,0.138428355336599,0.141879338224863,0.141077310457476,0.14366435513668,0.143581482552666,0.149555881557636,0.148953635611427,0.166788469428222,1.178838260712677,1.704483481788875,1.931333593799597)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.020534162017888,0.020042632136658,0.022882839898994,0.018572159513483,0.018572159513483,0.018988652147929,0.019746234011746,0.019746234011746,0.020042632136658,0.019746234011746,0.018988652147929,0.018988652147929,0.015751719426525,0.023202026796625,0.023202026796625,0.018988652147929,0.018988652147929,0.018988652147929)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,1.626285847666804,0.143496747818556,0.140173705036949,0.133253185558621,0.129026209382331,0.128131310979424,0.128131310979424,0.128131310979424,0.128131310979424,0.128131310979424,0.128131310979424,0.128131310979424,0.128131310979424,0.140173705036949,0.14226451166871,0.145009090253426,0.159721959774064,0.288965970133418)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-1.586614222335303,-0.090673335114291,-0.086925920390883,-0.085265136168995,-0.073986560514903,-0.075003492242352,-0.073986560514903,-0.07232180661554,-0.073986560514903,-0.073986560514903,-0.075003492242352,-0.075003492242352,-0.082784544133758,-0.089537525984922,-0.10309852507419,-0.151836662385034,-0.050339177801965,-0.041854514825419)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.14438102721429,0.097156780136571,0.094576816404501,0.094576816404501,0.102466022192663,0.097156780136571,0.094576816404501,0.094576816404501,0.094252815875911,0.094576816404501,0.094576816404501,0.094576816404501,0.094576816404501,0.094252815875911,0.152225437873866,1.113749554556966,1.658475978551758,1.965967155512229)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.082097020854087,0.081310335147974,0.081242788950993,0.081356883987348,0.081207388583926,0.080603946517621,0.079566368972862,0.078619196237848,0.07861005171294,0.07845168438735,0.078702401753062,0.078557913831644,0.079184447175066,0.079782454934342,0.094122490640984,0.360379645986431,0.890584685200621,1.029513379162726)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.373041930850714,0.079494831797392,0.075966507658084,0.075225766619429,0.074301291204388,0.07390517909799,0.073759277353896,0.073797160066147,0.073715180080703,0.073786740685701,0.073955795763711,0.073925585349759,0.074530865986827,0.076402505174849,0.077301994568088,0.079579666789214,0.083695218123419,0.118696948875503)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.290944909996627,0.001815503350581,0.005276281292909,0.006131117367919,0.006906097379538,0.006698767419631,0.005807091618966,0.004822036171701,0.004894871632237,0.004664943701649,0.00474660598935,0.004632328481884,0.004653581188238,0.003379949759493,0.016820496072896,0.280799979197217,0.806889467077202,0.910816430287224)
trans=0.5
age=(-1:(85-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 1.2), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="c - Condamine et al.'s Unedited Tyrannosauridae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 1.2, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 1.2), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "d - Condamine et al.'s Unedited Tyrannosauridae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 1.2, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")



# OUR DATA - Tyrannosauridae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.049557969735271,0.053296798592976,0.053296798592976,0.053296798592976,0.0530473174234,0.053296798592976,0.053296798592976,0.053296798592976,0.0530473174234,0.0530473174234,0.0530473174234,0.053053395789976,0.053053395789976,0.053785720716019,0.053053395789976,0.046614065958023,0.049557969735271,0.049557969735271,0.04898126658503,0.04898126658503,0.04898126658503,0.049557969735271,0.049557969735271,0.049557969735271,0.050366809073493,0.050366809073493,0.04898126658503,0.047891592880673,0.047891592880673,0.047891592880673,0.042902826418919,0.040906536765078,0.040906536765078,0.040906536765078,0.040906536765078,0.040906536765078,0.040906536765078,0.040906536765078,0.040906536765078,0.042902826418919,0.040906536765078,0.042255718388658,0.042255718388658,0.03462614492527,0.042255718388658,0.040906536765078,0.040906536765078,0.040906536765078,0.038267399583321,0.042255718388658,0.038267399583321,0.03462614492527,0.027796255164586,0.03462614492527,0.001523725242169)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.12930931574042,0.130645164412507,0.130645164412507,0.130645164412507,0.130530542542582,0.130645164412507,0.130645164412507,0.130645164412507,0.129983996436094,0.129983996436094,0.129983996436094,0.129028773464539,0.12930931574042,0.130645164412507,0.132854207584884,0.132854207584884,0.143690003437001,0.143690003437001,0.143690003437001,0.143690003437001,0.143690003437001,0.143690003437001,0.143690003437001,0.143690003437001,0.143690003437001,0.143690003437001,0.143690003437001,0.143690003437001,0.143690003437001,0.148626754602888,0.143690003437001,0.142318989968722,0.142318989968722,0.143573809250644,0.142318989968722,0.143573809250644,0.143573809250644,0.143690003437001,0.143690003437001,0.148626754602888,0.15129549637797,0.156354424426874,0.156354424426874,0.148626754602888,0.157160523253781,0.156354424426874,0.156354424426874,0.156354424426874,0.157160523253781,0.1662528983463,0.16894329776431,0.16894329776431,0.189407637723111,0.208166509056598,0.218488920765835)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.024735095654537,0.026330032947017,0.024735095654537,0.020524996836516,0.023546105833784,0.024735095654537,0.02201505895224,0.022503750582837,0.023546105833784,0.023989609612371,0.013119223002818,0.005178595094712,0.003092450977859,0.003092450977859,0.003092450977859,0.002751471778048,0.001714168574358,0.001714168574358,0.001714168574358,0.001940026597941,0.002166694022459,0.002166694022459,0.001940026597941,0.001940026597941,0.001940026597941,0.002751471778048,0.002951843371794,0.002951843371794,0.002951843371794,0.002951843371794,0.002951843371794,0.002951843371794,0.002951843371794,0.002951843371794,0.002951843371794,0.002951843371794,0.002751471778048,0.002751471778048,0.002751471778048,0.002751471778048,0.002751471778048,0.002751471778048,0.002751471778048,0.002166694022459,0.003092450977859,0.001039943283091,0.001039943283091,0.001039943283091,0.001039943283091,0.003092450977859,0.003092450977859,0.001039943283091,0.002751471778048,0.002751471778048,0.002751471778048)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.154548360055206,0.150559734701317,0.146533241527986,0.139690029920329,0.139690029920329,0.139294303931749,0.13383244263322,0.130597044986255,0.130335290091636,0.130335290091636,0.11843783130716,0.098241205038717,0.091458181751641,0.086191600279466,0.082655505746145,0.081913146246211,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.079992138404238,0.079992138404238,0.079992138404238,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.080438198959684,0.081760348281154,0.079834782666273,0.079834782666273,0.079834782666273,0.079834782666273,0.081760348281154,0.081760348281154,0.079992138404238,0.081913146246211,0.081913146246211,0.081913146246211)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.085875406172727,-0.077325386432694,-0.069946845289413,-0.069946845289413,-0.069946845289413,-0.075931335403622,-0.058176634690407,-0.058490077663549,-0.058490077663549,-0.050250256758825,-0.04620145988007,-0.028647187719099,-0.023108843400233,-0.023942182696363,-0.013647435763552,-0.014923863011602,-0.015701647882316,-0.015409547211676,-0.015701647882316,-0.015701647882316,-0.015701647882316,-0.018155485857409,-0.015701647882316,-0.015701647882316,-0.015701647882316,-0.015409547211676,-0.015323673654161,-0.015409547211676,-0.015323673654161,-0.015409547211676,-0.015409547211676,-0.015409547211676,-0.015409547211676,-0.015409547211676,-0.015409547211676,-0.023039537864556,-0.023039537864556,-0.023720969268454,-0.023720969268454,-0.024119349962085,-0.024119349962085,-0.023720969268454,-0.023720969268454,-0.024119349962085,-0.024119349962085,-0.024119349962085,-0.024119349962085,-0.024119349962085,-0.027077204704487,-0.034004649725599,-0.038185396552691,-0.04304028918001,-0.050505645552154,-0.04176791807201,-0.0702106648528)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.087808918193414,0.085349804549949,0.090394000541344,0.087808918193414,0.087808918193414,0.080125803628907,0.087808918193414,0.084819784919877,0.083262529556959,0.090394000541344,0.088090049984627,0.088090049984627,0.090394000541344,0.088536061919193,0.101680844907622,0.102346208879641,0.104200390205572,0.10523823687173,0.10523823687173,0.106948640664697,0.10523823687173,0.10523823687173,0.106948640664697,0.106948640664697,0.10523823687173,0.10523823687173,0.10523823687173,0.10523823687173,0.10523823687173,0.108742124966472,0.110687892987477,0.111361523102497,0.110687892987477,0.110687892987477,0.108742124966472,0.102697643569499,0.102697643569499,0.102697643569499,0.102697643569499,0.102697643569499,0.106948640664697,0.108742124966472,0.108742124966472,0.108742124966472,0.111361523102497,0.116425133946573,0.116425133946573,0.116425133946573,0.117810481730902,0.117810481730902,0.121831977817374,0.124794432948909,0.143419794202239,0.162600795819688,0.179669119255856)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.083759496593904,0.083533273886776,0.083533273886776,0.083593692409397,0.083495839425145,0.083624420972634,0.083624420972634,0.083642081025393,0.083690260307528,0.083795121977403,0.083952916005469,0.084130321138271,0.084285511524149,0.085259742411012,0.087127655980885,0.089065614248946,0.092062332564719,0.092155414196147,0.092281103582735,0.092319967536497,0.092122397094144,0.091683916327724,0.091683916327724,0.091691417223592,0.090865344602396,0.090686762463021,0.089764597323548,0.089583079786451,0.089449632821356,0.089813013892102,0.088836754026542,0.088805246045722,0.088773958208911,0.088631691251257,0.088462042886022,0.088481173729097,0.088478637988279,0.088394263371182,0.088448338197917,0.088752768047141,0.089399290431624,0.089660379874008,0.08961857244807,0.089561386744087,0.089559937949219,0.089853319051235,0.089911118218921,0.089911118218921,0.090254448008097,0.091788497369327,0.093403713529063,0.094931566097827,0.097258575998837,0.100556405969766,0.114600101296263)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.082019641042458,0.070344579872638,0.069554062130766,0.068903225862822,0.06868960484468,0.068324970225262,0.066316564155624,0.064792208796432,0.064479184194811,0.063874608634256,0.060978591703651,0.053657780487563,0.051228014209929,0.04876152765764,0.047067701692556,0.046601563884743,0.046459737801498,0.046270786330029,0.046216853799927,0.046038129903382,0.045759376388844,0.04568557435074,0.045534747919982,0.045471989534377,0.045471989534377,0.045396961464957,0.045397932409713,0.045397932409713,0.045397932409713,0.04530405284356,0.04530405284356,0.04530405284356,0.045251472490367,0.045196608764764,0.045176598565056,0.045176598565056,0.045159159492829,0.045159159492829,0.045165755084178,0.045136052319123,0.045151242713489,0.045159501797776,0.045159501797776,0.045283358905975,0.045296314838306,0.04570509427602,0.04570509427602,0.045697844930871,0.045697844930871,0.045464979082793,0.045464979082793,0.045655809858318,0.04575193401572,0.045431224978759,0.045431224978759)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.001739855551446,0.013188694014138,0.01397921175601,0.014690466546575,0.014806234580464,0.015299450747372,0.01730785681701,0.018849872228961,0.019211076112717,0.019920513343147,0.022974324301818,0.030472540650709,0.033057497314219,0.036498214753372,0.040059954288329,0.042464050364203,0.04560259476322,0.045884627866118,0.046064249782809,0.046281837633114,0.046363020705299,0.045998341976984,0.046149168407742,0.046219427689215,0.045393355068019,0.045289800998064,0.044366664913835,0.044185147376738,0.044051700411643,0.044508961048542,0.043532701182982,0.043501193202162,0.043522485718544,0.043435082486493,0.043285444320965,0.043304575164041,0.04331947849545,0.043235103878353,0.043282583113739,0.043616715728018,0.044248047718135,0.044500878076233,0.044459070650294,0.044278027838111,0.044263623110913,0.044148224775216,0.044206023942901,0.044213273288049,0.044556603077226,0.046323518286534,0.04793873444627,0.049275756239509,0.051506641983117,0.055125180991007,0.069168876317504)
trans=0.5
age=(-1:(122-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="e - Our Tyrannosauridae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 0.8, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "f - Our Tyrannosauridae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 0.6, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")



# SAKAMOTO DATA - Tyrannosauridae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.03246601547343,0.03246601547343,0.03246601547343,0.0358291066846,0.0358291066846,0.0358291066846,0.035894206914055,0.035894206914055,0.035894206914055,0.035894206914055,0.035894206914055,0.0358291066846,0.0358291066846,0.036451590848675,0.036451590848675,0.036451590848675,0.0358291066846,0.0358291066846,0.036680212250134,0.0358291066846,0.0358291066846,0.0358291066846,0.0358291066846,0.036680212250134,0.036451590848675,0.036451590848675,0.036451590848675,0.0358291066846,0.0358291066846,0.032527239203691,0.032527239203691,0.032527239203691,0.031711483697998,0.031711483697998,0.031711483697998,0.031711483697998,0.032527239203691,0.032527239203691,0.032527239203691,0.032527239203691,0.031711483697998,0.036451590848675,0.032527239203691,0.032527239203691,0.032527239203691,0.032527239203691,0.032527239203691,0.032527239203691,0.031010122732024,0.031010122732024,0.031010122732024,0.031010122732024,0.03128765807612,0.03128765807612,0.031010122732024,0.031010122732024,0.032527239203691,0.027445833849005,0.027445833849005,0.027445833849005,0.027445833849005,0.026798216358785,0.027478572502299,0.026798216358785,0.026798216358785,0.027445833849005,0.02597551101273,0.02597551101273)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.097848438038574,0.097848438038574,0.097848438038574,0.09928753936279,0.09928753936279,0.09928753936279,0.09928753936279,0.09928753936279,0.09928753936279,0.09928753936279,0.09928753936279,0.09928753936279,0.100228251542712,0.100355270075038,0.100355270075038,0.100355270075038,0.100355270075038,0.100355270075038,0.101807214488915,0.100355270075038,0.100355270075038,0.100355270075038,0.100355270075038,0.101807214488915,0.101807214488915,0.101807214488915,0.101807214488915,0.101807214488915,0.101807214488915,0.09928753936279,0.099405249777215,0.099405249777215,0.099405249777215,0.099405249777215,0.099405249777215,0.099405249777215,0.099405249777215,0.099405249777215,0.099405249777215,0.099405249777215,0.099405249777215,0.104013446663281,0.100355270075038,0.100355270075038,0.100355270075038,0.100355270075038,0.100355270075038,0.100355270075038,0.099405249777215,0.099405249777215,0.099405249777215,0.099405249777215,0.100355270075038,0.100355270075038,0.100355270075038,0.101807214488915,0.104385338376883,0.100228251542712,0.100355270075038,0.100355270075038,0.100355270075038,0.101807214488915,0.104385338376883,0.104385338376883,0.104385338376883,0.106345468355439,0.11150643898242,0.115270577301832)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.195091409979798,0.190863762202259,0.004725903996585,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586,0.003006301072586)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,1.002933777624736,1.012396198895345,0.764325319086444,0.49357758623105,0.21039381865063,0.04112030262048,0.038428769585792,0.038259585778207,0.038259585778207,0.03784078411231,0.03784078411231,0.03784078411231,0.03784078411231,0.036959471401918,0.036959471401918,0.036959471401918,0.036959471401918,0.036959471401918,0.03784078411231,0.03784078411231,0.03784078411231,0.03784078411231,0.03784078411231,0.036959471401918,0.036959471401918,0.036959471401918,0.036959471401918,0.036959471401918,0.036959471401918,0.036883654941447,0.036883654941447,0.036883654941447,0.036883654941447,0.036883654941447,0.036883654941447,0.036883654941447,0.036883654941447,0.036959471401918,0.03784078411231,0.03784078411231,0.03784078411231,0.03808755900616,0.03808755900616,0.03808755900616,0.03808755900616,0.03808755900616,0.03808755900616,0.03808755900616,0.03808755900616,0.03808755900616,0.038259585778207,0.038259585778207,0.038259585778207,0.038259585778207,0.038259585778207,0.038259585778207,0.038259585778207,0.038259585778207,0.038259585778207,0.038259585778207,0.038259585778207,0.038259585778207,0.038259585778207,0.038512313523557,0.038692840041,0.039715531701102,0.039784604351785,0.039890463976276)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.9438842518459,-0.96850919337499,-0.706021718744684,-0.436218172430274,-0.152340064960612,0.013299221277127,0.01532959709203,0.014984432474683,0.013896338911114,0.013896338911114,0.013896338911114,0.013896338911114,0.013896338911114,0.013896338911114,0.013896338911114,0.015543340131734,0.015543340131734,0.015543340131734,0.015543340131734,0.015543340131734,0.015543340131734,0.015543340131734,0.015543340131734,0.015543340131734,0.014984432474683,0.014984432474683,0.014984432474683,0.014984432474683,0.014984432474683,0.014984432474683,0.014296942091172,0.014296942091172,0.014296942091172,0.014296942091172,0.014296942091172,0.014296942091172,0.013896338911114,0.013896338911114,0.013896338911114,0.013896338911114,0.013896338911114,0.013896338911114,0.014110931604259,0.014110931604259,0.014110931604259,0.014110931604259,0.014110931604259,0.013896338911114,0.014110931604259,0.014110931604259,0.013896338911114,0.013896338911114,0.013299221277127,0.013299221277127,0.013299221277127,0.013299221277127,0.013299221277127,0.009079746577532,0.009079746577532,0.009079746577532,0.009079746577532,0.009225949155194,0.008398983013643,0.006689297507626,0.006243911350404,0.001039557818863,-0.006716958544351,0.001039557818863)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.126883129594723,-0.127829986971698,0.073711033767691,0.090691694682545,0.1026447127237,0.088585578478202,0.087268822107863,0.086639555122905,0.085067581094512,0.084708327717796,0.084708327717796,0.084708327717796,0.084708327717796,0.084708327717796,0.084708327717796,0.086952222915553,0.087116016407431,0.087116016407431,0.087268822107863,0.087268822107863,0.087268822107863,0.087268822107863,0.087268822107863,0.087268822107863,0.087116016407431,0.087116016407431,0.087116016407431,0.087268822107863,0.087268822107863,0.087423574519804,0.087268822107863,0.087268822107863,0.087423574519804,0.087423574519804,0.087423574519804,0.087423574519804,0.086639555122905,0.086639555122905,0.086952222915553,0.086952222915553,0.086639555122905,0.086639555122905,0.087423574519804,0.087423574519804,0.087423574519804,0.087423574519804,0.087423574519804,0.087423574519804,0.088724846798137,0.088724846798137,0.088724846798137,0.088724846798137,0.088585578478202,0.088585578478202,0.089283278639693,0.090121619881102,0.090691694682545,0.087423574519804,0.087423574519804,0.087423574519804,0.087423574519804,0.088724846798137,0.088724846798137,0.088724846798137,0.088724846798137,0.088724846798137,0.089527446245583,0.103460115332163)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.066402019940891,0.066402019940891,0.066402019940891,0.065695186356812,0.065695186356812,0.065695186356812,0.065596685612555,0.065596685612555,0.065596685612555,0.065743506439658,0.065743506439658,0.065804273843678,0.065866578699527,0.066062453349954,0.066390047597156,0.066715368861108,0.066789156409149,0.066798136845512,0.066927400352574,0.066966751262571,0.066966751262571,0.066966751262571,0.066966751262571,0.066904840789813,0.066986730577462,0.066887063522352,0.066887063522352,0.066882359501191,0.066882359501191,0.066760533279579,0.066669073560882,0.066669073560882,0.066667460200625,0.066673537903366,0.06670204283103,0.06665995057825,0.066544125111788,0.066538687076261,0.066538687076261,0.066530586536674,0.066609991183247,0.066655291108154,0.066551473740302,0.066541524585429,0.066541524585429,0.066525568522794,0.066525568522794,0.066429458768243,0.066339964896052,0.066349214658091,0.066349214658091,0.066369564368085,0.066292920423264,0.066267789276609,0.066400118484056,0.066622015665199,0.066747815264501,0.066843311002948,0.066770134796917,0.066770134796917,0.066770134796917,0.067667572393903,0.06850716758754,0.068661840836841,0.068661840836841,0.06946172398343,0.071409173558273,0.074165365590754)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.542542299007294,0.533290028020952,0.383546645436607,0.106408394480141,0.037387272910764,0.022151791926429,0.019751879880543,0.019600425320905,0.019260741986076,0.019191429105342,0.019191429105342,0.019193965341568,0.019193965341568,0.019146514119269,0.019146514119269,0.019146514119269,0.019146514119269,0.019146514119269,0.019167119642696,0.019167119642696,0.019167119642696,0.019167119642696,0.019167119642696,0.019156824707739,0.019156824707739,0.019156824707739,0.019145757275757,0.019149960230418,0.019149960230418,0.019089628845031,0.019089628845031,0.019076284136248,0.019076284136248,0.019076284136248,0.019031415986252,0.019031415986252,0.019031415986252,0.019057969693199,0.01909449345936,0.01909449345936,0.01909449345936,0.019100524312005,0.019100524312005,0.01913401017043,0.019121909347313,0.019121909347313,0.019121909347313,0.019121909347313,0.019158689031414,0.019158689031414,0.019226117962806,0.019226117962806,0.019226117962806,0.019226117962806,0.019226117962806,0.019226117962806,0.019226117962806,0.019226117962806,0.019226117962806,0.019226117962806,0.019226117962806,0.019226117962806,0.019226117962806,0.019631504881634,0.019767302625429,0.020076220873632,0.020143344162685,0.02028654301627)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.476140279066403,-0.466888008080061,-0.317144625495717,-0.040713208123328,0.028307913446048,0.043543394430383,0.045844805732013,0.045996260291651,0.04633594362648,0.046552077334316,0.046552077334316,0.04661030850211,0.046672613357959,0.046915939230685,0.047243533477888,0.04756885474184,0.04764264228988,0.047651622726244,0.047760280709878,0.047799631619875,0.047799631619875,0.047799631619875,0.047799631619875,0.047748016082074,0.047829905869724,0.047730238814613,0.047741306246594,0.047732399270773,0.047732399270773,0.047670904434548,0.047579444715851,0.047592789424634,0.047591176064377,0.047597253767117,0.047670626844778,0.047628534591998,0.047512709125536,0.047480717383062,0.047444193616901,0.047436093077314,0.047515497723887,0.047554766796149,0.047450949428298,0.047407514414999,0.047419615238116,0.047403659175482,0.047403659175482,0.04730754942093,0.047181275864639,0.047190525626678,0.047123096695285,0.047143446405279,0.047066802460458,0.047041671313803,0.04717400052125,0.047395897702393,0.047521697301695,0.047617193040142,0.047544016834111,0.047544016834111,0.047544016834111,0.048441454431097,0.049281049624734,0.049030335955207,0.048894538211412,0.049385503109799,0.051265829395588,0.053878822574483)
trans=0.5
age=(-1:(135-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="g - Sakamoto et al.'s Tyrannosauridae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 0.8, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "h - Sakamoto et al.'s Tyrannosauridae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 0.6, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")

n <- dev.off()