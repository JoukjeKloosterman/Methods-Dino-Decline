# 1 files combined:
# 	./PyRate_Inputs_2_BDMCMC_Grj_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

if(!require('base64')) {
  install.packages('base64')
  library('base64')
}

library("magick")


pngfile <- "./figures report Ceratopsidae.png"
png(pngfile, width = 8, height = 15, units = "in", res = 1200)
# par(mfrow=c(4,2))

# Define the layout matrix
layout_matrix <- matrix(c(1, 1, 
                          2, 3, 
                          4, 5, 
                          6, 7, 
                          8, 9), 
                        nrow = 5, ncol = 2, byrow = TRUE)

# Set up the layout
layout(layout_matrix)

images <- image_read("Results Condamine Ceratopsidae.png")
par(mar = c(0, 0, 0, 0))
plot.new()
rasterImage(images, 0, 0, 1, 1)

par(mar = c(5, 4, 4, 2))

library(scales)
plot_RTT <- function (age,hpd_M,hpd_m,mean_m,color){
  N=100
  beta=(1:(N-1))/N
  alpha_shape=0.25
  cat=1-(beta^(1./alpha_shape))
  for (i in 1:(N-1)){
    trans= 1/N + 2/N
    polygon(c(age, rev(age)), c(hpd_M-((hpd_M-mean_m)*cat[i]), rev(hpd_m+((mean_m-hpd_m)*cat[i]))), col = alpha(color,trans), border = NA)
  }
  lines(rev(age), rev(mean_m), col = color, lwd=3)
}


# CONDAMINE EDITED DATA - Ceratopsidae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.145156979644641,0.265689158188785,0.273868467794,0.283163245893637,0.275032202287325,0.277255853727985,0.273868467794,0.27480997669952,0.283163245893637,0.273868467794,0.291498739189553,0.281103886597859,0.288651456412944,0.273868467794,0.273868467794,0.245221337058638)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.575331067465156,0.57558978524617,0.56434305305535,0.56434305305535,0.561853284982578,0.561853284982578,0.536798308855406,0.53146860142445,0.534477439123311,0.527198691294681,0.544207716723417,0.534477439123311,0.545472323150676,0.533060081310922,0.545472323150676,0.755767607935665)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.33436366577074,0.324081648237301,0.32805181932142,0.336743366235282,0.344494600518621,0.323317394869116,0.323317394869116,0.293397854805247,0.23543700092188,0.169293010883545,0.104795372795098,0.062406447480925,0.077484676744376,0.077484676744376,0.079749416944165,0.076376666486545)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.927102048103798,0.843526306902848,0.835245277575727,0.835245277575727,0.850999810596179,0.849177585364491,0.845874185557582,0.850999810596179,0.825754557879637,0.785943491906598,0.677184325775085,0.473031607977955,0.464957646699182,0.458485393954709,0.458485393954709,0.460751945966565)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.575616149213027,-0.489923221307376,-0.474094593210987,-0.47839068481431,-0.484283101481808,-0.511810326850414,-0.47839068481431,-0.465490721441888,-0.42958890267497,-0.427416418936112,-0.328012780390909,-0.12109165590199,-0.117731702405074,-0.094316719919012,-0.121815103719391,-0.121815103719391)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.120905209462845,0.095625156152195,0.116952241342206,0.095625156152195,0.116952241342206,0.113344094172042,0.116952241342206,0.151637505363604,0.223295097103679,0.257864099836909,0.348379735056598,0.367471331628406,0.358307223046525,0.385659793290156,0.387125872905764,0.565076149507415)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.399976395433308,0.411978766229525,0.415700746663417,0.417000235874243,0.426683531078921,0.425475648640099,0.414723243519031,0.409341571162281,0.40828906319969,0.407805698244134,0.408595260236129,0.409098811111175,0.411903400868706,0.413147810577736,0.418086637129588,0.455371084018743)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.614371806136804,0.602506850538006,0.597462145758264,0.598364760337018,0.603488525892843,0.605654210593988,0.593870850682111,0.567590199661456,0.543147151638287,0.498867940150179,0.365087672507513,0.247130988722535,0.237418279904817,0.234543975792248,0.233119267184193,0.234238978593604)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.214395410703496,-0.190528084308481,-0.181761399094847,-0.181364524462775,-0.176804994813921,-0.18017856195389,-0.179147607163081,-0.158248628499175,-0.134858088438597,-0.091062241906045,0.043507587728616,0.16196782238864,0.174485120963889,0.178603834785487,0.184967369945396,0.22113210542514)
trans=0.5
age=(-1:(83-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="a - Condamine et al.'s Edited Ceratopsidae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 0.8, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "b - Condamine et al.'s Edited Ceratopsidae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 0.6, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")




# CONDAMINE RAW DATA - Ceratopsidae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.063566992015484,0.063566992015484,0.062614721324815,0.062614721324815,0.062614721324815,0.067974146039606,0.069385693825972,0.067974146039606,0.068349376244257,0.068349376244257,0.068349376244257,0.068349376244257,0.068349376244257,0.067974146039606,0.067974146039606,0.067974146039606,0.066287496047887,0.049910713171155)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.354960552609456,0.349358032334951,0.317419960403778,0.267318242969244,0.172675551106946,0.158077096480337,0.158077096480337,0.156788564580462,0.15687827932477,0.15687827932477,0.15687827932477,0.15687827932477,0.15687827932477,0.156788564580462,0.15687827932477,0.158077096480337,0.159308847649181,0.168465104890583)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.257114767909933,0.262764928720884,0.266358590734786,0.27403585857334,0.208763098409026,0.059257798790206,0.028224538680937,0.027058353456372,0.027058353456372,0.021534817027237,0.027058353456372,0.027058353456372,0.02749570587542,0.021060613811595,0.016221485523442,0.007032566712355,0.005735607733559,0.005735607733559)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.802032111840301,0.767523064907439,0.741419455708948,0.739519017097906,0.734078373021528,0.65061835335848,0.475726721044478,0.153970869148741,0.125920772924022,0.116586202718644,0.120797415031436,0.117020697590471,0.117020697590471,0.108958029634688,0.108958029634688,0.100603029535033,0.097379414031277,0.097778545991182)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.678160619090155,-0.680995453390032,-0.590136337887532,-0.581932218555889,-0.575818998326605,-0.539442737963841,-0.368995943957989,-0.050817704650323,-0.029644960403592,-0.028068950758714,-0.028068950758714,-0.025936507197898,-0.020293571254957,-0.003973795445979,-0.003973795445979,-0.003973795445979,-0.003686612472129,-0.029644960403592)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.006174336638523,-0.060939398284267,-0.040156605203954,-0.079253568729551,-0.028068950758714,0.069227814003191,0.109802932250822,0.117041396848122,0.110828494143167,0.109802932250822,0.109567253689924,0.110828494143167,0.109802932250822,0.119023317041285,0.117423720200359,0.11616478716262,0.11825937526044,0.128559138722071)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.148430577639072,0.14795436998517,0.139392232944765,0.131970430487187,0.120402403302487,0.11403816991548,0.113262338854033,0.113188625298772,0.112978375413316,0.11276311030191,0.112800584022834,0.112800584022834,0.112809219998301,0.112692732693162,0.112522056289448,0.112249045720597,0.113496404784138,0.132157029063949)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.512773269599773,0.504207458613824,0.485479881982357,0.479482519543429,0.461872160978056,0.432138248827276,0.145123567903385,0.074202128145327,0.068283543648421,0.067704369085026,0.067544254892345,0.067280241485062,0.065236188160093,0.062767659498566,0.059578978044335,0.057617249139699,0.057302657040563,0.05691703088559)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.364342691960701,-0.356253088628654,-0.346087649037592,-0.347512089056241,-0.341469757675569,-0.318100078911796,-0.031861229049352,0.038986497153445,0.044694831764895,0.045058741216884,0.045256329130489,0.045520342537772,0.047573031838208,0.049925073194597,0.052943078245113,0.054631796580898,0.056193747743575,0.075239998178358)
trans=0.5
age=(-1:(85-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="c - Condamine et al.'s Unedited Ceratopsidae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 1.2, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "d - Condamine et al.'s Unedited Ceratopsidae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 1.2, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")



# OUR DATA - Ceratopsidae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.083249355750056,0.082876198839224,0.082876198839224,0.082876198839224,0.083249355750056,0.083689303169046,0.083689303169046,0.083689303169046,0.083689303169046,0.082876198839224,0.082876198839224,0.084597873666966,0.067536187341402,0.083249355750056,0.085907234438676,0.085640199857868,0.089403911253452,0.104611167838482,0.124841149427069,0.124294126488957,0.124294126488957,0.120741492838233,0.105938067851669,0.093375374323787,0.105938067851669,0.085445168484035)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.173648716767674,0.172334100937195,0.172334100937195,0.172334100937195,0.172334100937195,0.172334100937195,0.172062495929704,0.172062495929704,0.172062495929704,0.172334100937195,0.172334100937195,0.175726860934405,0.175726860934405,0.328856212291187,0.355863323668733,0.391367758887102,0.67598601164997,0.990388900475108,0.990388900475108,0.898819061464707,0.837389587911272,0.837389587911272,0.820646423313863,0.820646423313863,0.820646423313863,0.820646423313863)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.073646025061076,0.083379420006567,0.077399918250212,0.077399918250212,0.088039719125516,0.10168721454124,0.064304078550259,0.068257220664395,0.061332544615171,0.056629084001292,0.060626737402277,0.059166473492568,0.061332544615171,0.061332544615171,0.060626737402277,0.056629084001292,0.051310773957577,0.039196170674482,0.033378301125653,0.027745969203995,0.027745969203995,0.027745969203995,0.016496613339878,0.011750386787288,0.010087388354468,0.008029641674498)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,1.164894592802857,0.312113747527726,0.310111246016483,0.310111246016483,0.327359609934789,0.653085286772447,0.549434369250792,0.324617603964449,0.254198867340774,0.202466292702067,0.185956617569818,0.183826074674655,0.18272927387477,0.182157926719226,0.1816275969812,0.179692860568163,0.179692860568163,0.18272927387477,0.18272927387477,0.182157926719226,0.18272927387477,0.18272927387477,0.173878475269448,0.17302544422457,0.173878475269448,0.179692860568163)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-1.030316065560454,-0.188677455928968,-0.192293582610549,-0.192293582610549,-0.211136158782542,-0.538753714854506,-0.413256438456897,-0.214228341582962,-0.131302875344923,-0.100255964483678,-0.076802228975847,-0.071560739299883,-0.071560739299883,-0.071421694143533,-0.071560739299883,-0.071560739299883,-0.053296342198459,-0.016131237246236,0.0148157094832,0.013867488948522,0.0120968374553,0.0148157094832,0.015015905539781,-0.010818083770511,-0.010818083770511,-0.042160059432223)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.07620877512329,0.056946267968877,0.056590300003358,0.056946267968877,0.047156177376097,0.057638904362605,0.064714291945702,0.065923213029722,0.082040593507383,0.075545799831757,0.082040593507383,0.086618743674548,0.098864362963946,0.232717062876404,0.255202542043618,0.282875435676948,0.570999036175028,0.915968545950941,0.889943785459134,0.812251761625827,0.733784040600816,0.733784040600816,0.733784040600816,0.733784040600816,0.733784040600816,0.777944109836823)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.126600636366665,0.125856567620281,0.125906007128091,0.125908009324268,0.125850957760363,0.125860719109498,0.125759678213759,0.125788847703136,0.125792896217903,0.125706853650652,0.125752187989029,0.126839185927777,0.130828714598726,0.16047521900554,0.170306649031146,0.184337221930078,0.313766964878527,0.484910683480453,0.50570793035255,0.480361531403206,0.460400240777128,0.453765995566908,0.452403251081958,0.454356821658858,0.457181193432188,0.465029275803632)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.288550593958948,0.19558409689725,0.195054916415806,0.19521477889165,0.197549474597728,0.256105781578822,0.238568322500711,0.186422934515228,0.140767905217809,0.123995955273285,0.119023094277364,0.117676053215271,0.116551231513457,0.115440382567066,0.112712090876075,0.111697793913897,0.110169771606399,0.106434935832505,0.105558671928243,0.105679084386485,0.105864903754834,0.106000185344009,0.106483109112491,0.107789806310022,0.109150998715116,0.116420154064979)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.161949957592283,-0.069727529276968,-0.069148909287715,-0.069306769567382,-0.071698516837365,-0.130245062469324,-0.112808644286952,-0.060634086812092,-0.014975008999905,0.001710898377367,0.006729093711664,0.009163132712505,0.014277483085269,0.045034836438474,0.057594558155071,0.072639428016181,0.203597193272128,0.378475747647948,0.400149258424308,0.374682447016722,0.354535337022293,0.347765810222899,0.345920141969467,0.346567015348836,0.348030194717072,0.348609121738654)
trans=0.5
age=(-1:(93-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="e - Our Ceratopsidae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 0.8, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "f - Our Ceratopsidae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 0.6, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")



# SAKAMOTO DATA - Ceratopsidae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.030524779466807,0.030524779466807,0.030524779466807,0.030524779466807,0.031146104342239,0.031876021438056,0.031592791555868,0.031592791555868,0.031146104342239,0.031592791555868,0.030524779466807,0.030524779466807,0.026376858236347,0.029911067956465,0.030428087509587,0.00745169249797,0.032450891153435,0.033099960298226,0.049374134079071,0.055875693087274,0.040732033173472,0.049374134079071,0.055875693087274)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.40291479660793,0.263338017366587,0.232505012832718,0.199270268586309,0.126177415103084,0.1195793324314,0.114704903797575,0.112056036264094,0.109668471419768,0.109668471419768,0.109668471419768,0.109668471419768,0.109668471419768,0.114704903797575,0.119355587198637,0.336432058988311,0.798920378272561,0.829035575039723,0.869906989164326,0.884900265706555,0.89959812860238,0.938729627323192,1.015132680680122)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.146558763324985,0.152174478625622,0.152893475764596,0.152893475764596,0.152174478625622,0.146558763324985,0.019804768935824,0.015991136337547,0.011675232231854,0.007483544294629,0.011376426456356,0.011376426456356,0.011376426456356,0.011376426456356,0.011376426456356,0.011376426456356,0.011376426456356,0.011376426456356,0.011438179149772,0.011438179149772,0.011438179149772,0.011376426456356,0.011376426456356)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.50104999065278,0.461148134228917,0.452566578250626,0.452566578250626,0.455658408595038,0.457254240299821,0.408411685782044,0.312118713105277,0.272260872237682,0.170629938809764,0.069336105438603,0.067132082442799,0.067061990533057,0.067061990533057,0.067222842040209,0.067484960339971,0.068000395433384,0.068353690784435,0.068353690784435,0.068353690784435,0.068353690784435,0.06846748182225,0.069336105438603)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.424058629631854,-0.412726583340671,-0.404602650404364,-0.414323492682806,-0.384653315841468,-0.384653315841468,-0.349462723715715,-0.248635261879785,-0.199221889389124,-0.09913176933371,-0.013450249093131,-0.014165831537291,-0.013329377893681,-0.013980729423522,-0.014756740646053,-0.038150595828486,-0.014165831537291,0.00262726406615,-0.008231573915879,0.004624546705035,0.004624546705035,0.024456808317101,0.027042949342478)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.272064911626692,0.014848471947956,-0.024073497860153,-0.044623826897642,-0.053341552283696,-0.059317716772632,0.056333924779314,0.078063225765084,0.087740387303472,0.104209494460588,0.087740387303472,0.084593268269288,0.087740387303472,0.087740387303472,0.090657913351825,0.294799738204345,0.755892898591512,0.812994363094705,0.813014725654063,0.834771831474211,0.863815181275885,0.907522258437088,0.963756231570048)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.128486638390883,0.1000155245241,0.093568407472535,0.090565350506466,0.07769210498538,0.074745085736087,0.073249365435404,0.072724381611882,0.072484680676381,0.072397927628087,0.07197184040639,0.071434020232789,0.070632857680215,0.070542742449162,0.072095070995664,0.098063372218047,0.338326653809766,0.415562941584601,0.443231311062962,0.461782125944808,0.484362340452958,0.504463118717014,0.541684207557734)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.31992910711398,0.28993670094959,0.287350628303986,0.288108424491046,0.290218664315734,0.291254923722788,0.233472231985007,0.142939300453367,0.099420148399527,0.049632559640814,0.038614235686918,0.037478792499744,0.037294366747757,0.037311365565636,0.037320947069386,0.037108277714398,0.036798976783976,0.036697978347726,0.03658957784043,0.036569130731362,0.036546612785183,0.036687641498798,0.03691563970099)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.191442468723097,-0.18992117642549,-0.193782220831451,-0.19754307398458,-0.212526559330354,-0.216509837986701,-0.160222866549603,-0.070214918841485,-0.026935467723146,0.022765367987273,0.033357604719472,0.033955227733045,0.033338490932459,0.033231376883526,0.034774123926278,0.060955094503649,0.30152767702579,0.378864963236875,0.406641733222532,0.425212995213446,0.447815727667775,0.467775477218216,0.504768567856744)
trans=0.5
age=(-1:(90-2))* -1


# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="g - Sakamoto et al.'s Ceratopsidae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 1.2, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "h - Sakamoto et al.'s Ceratopsidae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 1.2, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")

n <- dev.off()