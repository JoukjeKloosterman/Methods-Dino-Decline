# 1 files combined:
# 	./PyRate_Inputs_2_BDMCMC_Grj_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)


if(!require('base64')) {
  install.packages('base64')
  library('base64')
}

library("magick")


pngfile <- "./figures report All Dino.png"
png(pngfile, width = 8, height = 15, units = "in", res = 1200)
par(mfrow=c(4,2))

library(scales)
plot_RTT <- function (age,hpd_M,hpd_m,mean_m,color){
  N=100
  beta=(1:(N-1))/N
  alpha_shape=0.25
  cat=1-(beta^(1./alpha_shape))
  for (i in 1:(N-1)){
    trans= 1/N + 2/N
    polygon(c(age, rev(age)), c(hpd_M-((hpd_M-mean_m)*cat[i]), rev(hpd_m+((mean_m-hpd_m)*cat[i]))), col = alpha(color,trans), border = NA)
  }
  lines(rev(age), rev(mean_m), col = color, lwd=3)
}


# CONDAMINE EDITED DATA - 6 DINO FAMILY

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.047673742405133,0.109061526473946,0.108759728397461,0.149374340343602,0.193148179665552,0.298737018591635,0.29448263713432,0.29448263713432,0.298737018591635,0.29448263713432,0.29448263713432,0.29448263713432,0.298737018591635,0.29448263713432,0.29448263713432,0.298737018591635,0.286416403407353,0.288989882147753,0.288339137927036,0.288339137927036,0.286416403407353,0.286416403407353,0.288339137927036,0.288561524299699,0.288561524299699,0.288339137927036,0.286416403407353,0.281798228452073,0.281370919359693,0.281370919359693,0.282815363435366,0.286416403407353,0.286416403407353,0.286416403407353,0.286416403407353,0.286416403407353,0.282815363435366,0.288339137927036,0.288339137927036,0.288339137927036,0.288339137927036,0.288339137927036,0.288339137927036,0.288339137927036,0.286416403407353,0.286416403407353,0.286416403407353,0.286416403407353,0.28627227550489,0.28627227550489,0.28627227550489,0.284187547013798,0.284187547013798,0.282815363435366,0.282815363435366,0.282815363435366,0.281370919359693,0.281370919359693,0.278218223833081,0.276615420062655,0.276615420062655,0.276615420062655,0.277077977714581,0.276615420062655,0.276615420062655,0.2738053038284,0.272967184048693,0.272967184048693,0.272967184048693,0.270158522090541,0.267510652186873,0.267510652186873,0.261529611885198,0.268437480692233,0.267510652186873,0.267248026101299,0.267248026101299,0.267248026101299,0.267248026101299,0.267248026101299,0.261529611885198,0.267248026101299,0.267248026101299,0.267248026101299,0.267248026101299,0.267248026101299,0.267248026101299,0.267248026101299,0.267248026101299,0.267248026101299,0.261529611885198,0.255799202010961,0.238541026270875,0.230581251218008,0.238088317823562,0.238088317823562)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.37749772241213,0.37749772241213,0.37749772241213,0.397617276090142,0.421617416017681,0.41988751989707,0.413282237314656,0.413282237314656,0.416437199851873,0.411586603701825,0.411586603701825,0.411586603701825,0.416437199851873,0.411586603701825,0.411586603701825,0.416085193828309,0.416085193828309,0.416085193828309,0.411586603701825,0.411586603701825,0.410378144920999,0.410378144920999,0.413282237314656,0.414027021467111,0.414027021467111,0.414027021467111,0.413926867648836,0.414027021467111,0.414027021467111,0.414027021467111,0.414027021467111,0.416437199851873,0.416085193828309,0.416437199851873,0.416437199851873,0.416437199851873,0.414027021467111,0.420455254746681,0.421617416017681,0.419903307954754,0.419903307954754,0.419903307954754,0.420455254746681,0.420455254746681,0.419903307954754,0.419903307954754,0.419903307954754,0.419903307954754,0.419903307954754,0.421617416017681,0.421617416017681,0.420455254746681,0.420455254746681,0.419903307954754,0.420455254746681,0.421617416017681,0.421993600175685,0.421993600175685,0.419903307954754,0.419903307954754,0.420455254746681,0.420455254746681,0.421993600175685,0.421993600175685,0.421993600175685,0.421993600175685,0.421993600175685,0.423511229521356,0.423511229521356,0.421993600175685,0.421993600175685,0.421993600175685,0.423511229521356,0.433491392373311,0.433491392373311,0.433491392373311,0.437687603530178,0.437687603530178,0.455262992544291,0.456485602204641,0.456485602204641,0.466776713742552,0.466776713742552,0.468260283061933,0.469949271301006,0.470845621881869,0.476535275622168,0.481182703822114,0.481498591877909,0.483146219372304,0.483592945836528,0.483592945836528,0.481498591877909,0.483592945836528,0.49961653490619,0.506797899927809)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.328588189937292,0.328588189937292,0.328588189937292,0.33011785128168,0.328588189937292,0.33011785128168,0.33011785128168,0.34426398172897,0.34426398172897,0.102846931400082,0.094494029998143,0.09183818630057,0.09183818630057,0.09046942623096,0.087451652765798,0.093900367619687,0.116407447243465,0.119322748692675,0.119322748692675,0.115814135126097,0.122241514903657,0.117701002925267,0.117701002925267,0.117701002925267,0.117701002925267,0.117701002925267,0.117701002925267,0.115814135126097,0.115814135126097,0.122241514903657,0.119397624708391,0.119322748692675,0.119322748692675,0.12169060646166,0.119322748692675,0.122241514903657,0.119322748692675,0.122241514903657,0.122241514903657,0.122241514903657,0.125108652763142,0.125888693121714,0.139163104107962,0.151498069259779,0.151498069259779,0.161841179466097,0.173470036730643,0.174240690245147,0.156171587022974,0.156171587022974,0.156171587022974,0.15978718453046,0.15978718453046,0.171973249735539,0.176273646051363,0.173470036730643,0.173470036730643,0.173470036730643,0.173470036730643,0.171973249735539,0.171973249735539,0.171973249735539,0.171973249735539,0.171973249735539,0.171973249735539,0.176273646051363,0.174240690245147,0.174240690245147,0.174240690245147,0.173470036730643,0.171973249735539,0.171973249735539,0.173470036730643,0.171973249735539,0.171973249735539,0.173470036730643,0.173470036730643,0.173470036730643,0.17732103150602,0.179044239646298,0.179044239646298,0.179044239646298,0.17732103150602,0.176273646051363,0.176273646051363,0.176273646051363,0.176273646051363,0.176273646051363,0.176273646051363,0.176273646051363,0.176273646051363,0.176273646051363,0.176273646051363,0.176273646051363,0.171973249735539,0.176273646051363)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.54445233364259,0.54013582758563,0.539306608964322,0.539306608964322,0.539306608964322,0.539306608964322,0.563420790978063,0.600929018717189,0.667408020330353,0.59470728596763,0.24306752853547,0.231633812661614,0.231633812661614,0.231633812661614,0.230375646196624,0.252721150623841,0.316130693507396,0.31917799865856,0.31949484968418,0.322711837862298,0.330640018925424,0.322711837862298,0.322711837862298,0.322711837862298,0.322711837862298,0.322711837862298,0.322711837862298,0.322711837862298,0.322711837862298,0.330640018925424,0.330640018925424,0.332114551507219,0.338955403405463,0.351014698963994,0.370881477287479,0.383455908525743,0.404513259650826,0.43231172281373,0.452888956841146,0.471841444537846,0.48610187235775,0.4838481037476,0.48610187235775,0.491438976784902,0.482999818439246,0.482999818439246,0.491438976784902,0.482999818439246,0.458320419925201,0.458320419925201,0.458320419925201,0.459291592619237,0.459291592619237,0.466430973618928,0.466430973618928,0.459291592619237,0.459291592619237,0.459291592619237,0.459291592619237,0.459291592619237,0.459291592619237,0.459291592619237,0.459291592619237,0.459291592619237,0.459291592619237,0.466430973618928,0.466430973618928,0.466430973618928,0.466430973618928,0.466430973618928,0.466430973618928,0.466430973618928,0.466430973618928,0.466430973618928,0.466430973618928,0.471841444537846,0.471841444537846,0.471841444537846,0.480494822336787,0.482999818439246,0.482999818439246,0.482999818439246,0.482999818439246,0.482908784105529,0.482908784105529,0.482999818439246,0.482908784105529,0.482908784105529,0.482999818439246,0.482999818439246,0.482454849978436,0.482454849978436,0.482454849978436,0.482908784105529,0.482999818439246,0.495277668830592)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.406196340033812,-0.344405826268968,-0.343217083487462,-0.30195105795684,-0.25000125185528,-0.217432398058038,-0.222854539074222,-0.239474490062634,-0.32916356821903,-0.26885972020184,0.090655648908362,0.094334918475389,0.095100933495675,0.093906322946106,0.091227420591101,0.064180336287033,0.008785121274506,0.012195975896106,0.012195975896106,0.012195975896106,0.012195975896106,0.011176339387754,0.012195975896106,0.012195975896106,0.012195975896106,0.012195975896106,0.012195975896106,0.006923906139435,0.004693318631763,0.004693318631763,-0.012609377300699,-0.013320300173621,-0.013320300173621,-0.014236928732455,-0.034844685401582,-0.056127020200125,-0.081100290676635,-0.098227054227669,-0.13557268819023,-0.151274505712887,-0.156741762763438,-0.145426688241864,-0.145559199092619,-0.145559199092619,-0.145559199092619,-0.145559199092619,-0.144679240605609,-0.135202908209141,-0.128066322967101,-0.128066322967101,-0.128066322967101,-0.128066322967101,-0.128066322967101,-0.128066322967101,-0.125223038013283,-0.122585253217869,-0.124165009431891,-0.124165009431891,-0.124165009431891,-0.125223038013283,-0.125223038013283,-0.125223038013283,-0.128066322967101,-0.128066322967101,-0.128066322967101,-0.135641870781933,-0.133267294047555,-0.133267294047555,-0.133267294047555,-0.135641870781933,-0.135641870781933,-0.146546580820891,-0.135641870781933,-0.145559199092619,-0.145559199092619,-0.145559199092619,-0.146546580820891,-0.146546580820891,-0.146546580820891,-0.155236426688173,-0.155236426688173,-0.155236426688173,-0.154339868223187,-0.155236426688173,-0.17038884552597,-0.171676769532805,-0.17038884552597,-0.173647963182871,-0.17038884552597,-0.171676769532805,-0.17038884552597,-0.173647963182871,-0.171676769532805,-0.173647963182871,-0.171676769532805,-0.171676769532805)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.017713558170338,0.007172999696001,0.005537674044839,0.028552185603069,0.043958972151056,0.036955329683696,0.041347614545028,0.042649916006322,0.042649916006322,0.262202178341119,0.287861092794418,0.278099079288083,0.278099079288083,0.278099079288083,0.278099079288083,0.264422699224412,0.262202178341119,0.262202178341119,0.254861812459409,0.256615122177469,0.256615122177469,0.255159955989713,0.25716052151991,0.25716052151991,0.25716052151991,0.25811614265393,0.258870107621085,0.262202178341119,0.262202178341119,0.262202178341119,0.245037189951543,0.246620912981964,0.251470522723926,0.26089425773664,0.262822759673339,0.25716052151991,0.251470522723926,0.254861812459409,0.244430353507408,0.231124916718073,0.229312632018658,0.226900981643247,0.218163328718411,0.214768690080444,0.207953260814723,0.191852306135599,0.189059920111722,0.189059920111722,0.191501424788577,0.191501424788577,0.191501424788577,0.191501424788577,0.191501424788577,0.191501424788577,0.189059920111722,0.189059920111722,0.189059920111722,0.189059920111722,0.189059920111722,0.189059920111722,0.189059920111722,0.189059920111722,0.191501424788577,0.191501424788577,0.191501424788577,0.185205866223666,0.189059920111722,0.189059920111722,0.189059920111722,0.188944403236352,0.191501424788577,0.182766456227893,0.189059920111722,0.186040879185099,0.185205866223666,0.186040879185099,0.186040879185099,0.186040879185099,0.191501424788577,0.189059920111722,0.189059920111722,0.191501424788577,0.194320477860373,0.201725015717424,0.189059920111722,0.189059920111722,0.189059920111722,0.189059920111722,0.194320477860373,0.194320477860373,0.194320477860373,0.189059920111722,0.201725015717424,0.215478255059503,0.222175096683649,0.241454712892066)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.243735814526623,0.268553627431257,0.271077969078629,0.308392847529402,0.331672952228722,0.348849931195276,0.348855932555073,0.349000962843232,0.348480317704768,0.348275789919538,0.348268295919702,0.347870703382938,0.347802495875281,0.34769795635034,0.34769795635034,0.348474246476346,0.371963171153044,0.364846607150932,0.348569023667736,0.34661119410337,0.345813287884723,0.34582652568408,0.345395378838793,0.345215737363564,0.345184674481541,0.344536976233646,0.343573254033675,0.341498838382618,0.341068645004256,0.341068645004256,0.341721436596209,0.343540422754343,0.344865425472006,0.345207126018804,0.345207126018804,0.34506785217292,0.345590731127572,0.34569554435093,0.34598465922934,0.346329446978737,0.346566820406131,0.346604438059583,0.346768646225119,0.346786576235378,0.347180929692249,0.347337852086609,0.347332806324487,0.347461166167508,0.34733258242626,0.347728440753488,0.347728440753488,0.347546161263373,0.347546161263373,0.347631812242661,0.347796063274618,0.347987311767757,0.348413269345693,0.348393611803528,0.349352273595152,0.35033530667334,0.350634732908593,0.350634732908593,0.350808575992993,0.351077315557132,0.351100661400893,0.350906703836921,0.351317818641429,0.35130143576383,0.351271080691122,0.351509432178511,0.351841326355971,0.351920524954678,0.352149266006718,0.351714624511722,0.351610551406747,0.351600785385684,0.352151727210382,0.352151727210382,0.353414793340225,0.354746117001911,0.35467389411233,0.354439242035682,0.354439242035682,0.35497457606884,0.355219122717382,0.354880401998828,0.354953212691822,0.35597858157532,0.35624843193376,0.356677933182132,0.356935450759404,0.356793308903879,0.357771826540664,0.360185719314118,0.360532164366818,0.363901716992168)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.428528417672348,0.428828733242458,0.428701785273282,0.429253795790436,0.430362703768465,0.434012381537551,0.442230670754536,0.451525890872844,0.469197258758602,0.382901742992213,0.169039094991346,0.165748268271449,0.165411436955405,0.165180690885178,0.164993573002268,0.171439489400856,0.187169239181146,0.19056819366276,0.192908193406146,0.196058912751419,0.195612874044458,0.194592149235956,0.194985621220352,0.195102454156117,0.195310945246467,0.195392392440707,0.195392392440707,0.195258631793705,0.195302936853892,0.195654196349537,0.197288310078715,0.199571995281526,0.203720012560124,0.209841911868796,0.218207932934082,0.226317856739195,0.234835933991183,0.25010184763899,0.272980403269249,0.291026136948608,0.310064777469254,0.316424661596024,0.318486965744235,0.317658578350528,0.320868720393098,0.324655329627193,0.325544939252734,0.325110594679016,0.322543854347525,0.322429081816498,0.322583368093804,0.323734079714734,0.323909162585848,0.324284616666139,0.32410331269347,0.323678591158875,0.323656921934303,0.323625227756766,0.323625227756766,0.323934634659585,0.324026081993858,0.324148014942418,0.3246741416109,0.324788262997108,0.324788262997108,0.325205375602046,0.325835857271412,0.325947665976593,0.325499762742406,0.325891630401484,0.325587378829767,0.327122409287427,0.327031009531982,0.328317755937887,0.328500783951257,0.329244017525717,0.329519375875331,0.329805189142964,0.331196533157733,0.331802283995864,0.332049098675532,0.332049098675532,0.33284526271259,0.333566700295707,0.333539298025168,0.33392217037473,0.333204567488187,0.332895936252192,0.333470749414027,0.333470749414027,0.333028442627755,0.333128981280438,0.333128981280438,0.332611966983515,0.332119661190139,0.331736781924718)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.184792603145725,-0.160275105811201,-0.157623816194653,-0.120860948261034,-0.098689751539743,-0.085162450342276,-0.093374738199464,-0.102524928029612,-0.120716941053834,-0.034625953072675,0.179229200928356,0.18212243511149,0.182391058919877,0.182517265465162,0.182704383348072,0.17703475707549,0.184793931971898,0.174278413488172,0.15566083026159,0.150552281351951,0.150200413840265,0.151234376448124,0.150409757618441,0.150113283207447,0.149873729235075,0.149144583792938,0.148180861592968,0.146240206588913,0.145765708150364,0.145414448654719,0.144433126517494,0.143968427472817,0.141145412911881,0.135365214150008,0.126999193084723,0.118749995433725,0.11075479713639,0.095593696711941,0.073004255960091,0.055303310030129,0.036502042936877,0.030179776463559,0.028281680480884,0.02912799788485,0.026312209299152,0.022682522459416,0.021787867071752,0.022350571488492,0.024788728078735,0.02529935893699,0.025145072659684,0.02381208154864,0.023636998677525,0.023347195576522,0.023692750581147,0.024308720608882,0.02475634741139,0.024768384046762,0.025727045838386,0.026400672013755,0.026608650914735,0.026486717966175,0.026134434382092,0.026289052560024,0.026312398403785,0.025701328234875,0.025481961370017,0.025353769787237,0.025771317948716,0.025617801777027,0.026253947526205,0.024798115667251,0.025118256474736,0.023396868573834,0.02310976745549,0.022356767859967,0.022632351335051,0.022346538067419,0.022218260182492,0.022943833006047,0.022624795436799,0.02239014336015,0.021593979323092,0.021407875773133,0.021679824692214,0.020958231624098,0.021748645203635,0.023082645323128,0.022777682519733,0.023207183768105,0.02390700813165,0.023664327623441,0.024642845260226,0.027573752330603,0.028412503176679,0.032164935067451)
trans=0.5
age=(-1:(163-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="a - Condamine et al.'s Edited All Dinosaur Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 0.8, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "b - Condamine et al.'s Edited All Dinosaur Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 0.6, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")

# CONDAMINE RAW DATA - 6 DINO FAMILY

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.079467874954131,0.079467874954131,0.077486979693998,0.07736190390751,0.06548839644122,0.071862126111091,0.071862126111091,0.071862126111091,0.071862126111091,0.071862126111091,0.071862126111091,0.071862126111091,0.071862126111091,0.071862126111091,0.071862126111091,0.071862126111091,0.071862126111091,0.06548839644122,0.521409670140717,0.053402947444052,0.066152035489727,0.068837643251593,0.068972946316253,0.068972946316253,0.068972946316253,0.068972946316253,0.068972946316253,0.068972946316253,0.06555294754684,0.06555294754684,0.06555294754684,0.06555294754684,0.066152035489727,0.066152035489727,0.066152035489727,0.067839044988618,0.066152035489727,0.066152035489727,0.066152035489727,0.066152035489727,0.066152035489727,0.066152035489727,0.066152035489727,0.066152035489727,0.066152035489727,0.066224862062059,0.066224862062059,0.066152035489727,0.066152035489727,0.066152035489727,0.066152035489727,0.066152035489727,0.06555294754684,0.057841090655854,0.055084916725938,0.057841090655854,0.068972946316253,0.073137447653403,0.073137447653403,0.073137447653403,0.077266917405368,0.077266917405368,0.073137447653403,0.075221656885362,0.077323567506097,0.075753527011583,0.075753527011583,0.073137447653403,0.073137447653403,0.073137447653403,0.076337026006038,0.076337026006038,0.077323567506097,0.077323567506097,0.077380266360024,0.073137447653403,0.073137447653403,0.073137447653403,0.073137447653403,0.073137447653403,0.073137447653403,0.073137447653403,0.073137447653403,0.073137447653403,0.073137447653403,0.073137447653403)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.21657644146823,0.21657644146823,0.214002628949855,0.208599837233736,0.147101089733487,0.120831253555493,0.119413182196658,0.119413182196658,0.119413182196658,0.119413182196658,0.119413182196658,0.119817782061356,0.119817782061356,0.119817782061356,0.119817782061356,0.119817782061356,0.119817782061356,0.65825457091841,1.485934615252163,1.204000220856097,0.144996465820708,0.145671254711422,0.145671254711422,0.145671254711422,0.145671254711422,0.145671254711422,0.145671254711422,0.145671254711422,0.142338045593646,0.142338045593646,0.142338045593646,0.142338045593646,0.143554028840364,0.143554028840364,0.143554028840364,0.145671254711422,0.144568152117688,0.144568152117688,0.144568152117688,0.144568152117688,0.144568152117688,0.144996465820708,0.144568152117688,0.144568152117688,0.144568152117688,0.14541087387409,0.14541087387409,0.145671254711422,0.145671254711422,0.147479881793191,0.148370336052747,0.148928027491548,0.150386617866367,0.149292543931053,0.150386617866367,0.159803580938709,0.174711938834277,0.186930701323874,0.190117407779038,0.192839212411851,0.200726422727576,0.202733311463274,0.206349697935972,0.209720091424112,0.212463857696318,0.21258837890584,0.21258837890584,0.21258837890584,0.21258837890584,0.213203832985523,0.2177726481685,0.222265283351015,0.225487410366207,0.225879873567588,0.23799331450822,0.25315556138519,0.268911885926953,0.286663089675768,0.291995540852498,0.300808867476464,0.323496847213657,0.33709891370386,0.341955791212132,0.44621606017545,0.524458897532627,0.642096446229698)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.175044402779152,0.176079889055142,0.176617217355911,0.175044402779152,0.176079889055142,0.176079889055142,0.061768248805669,0.055311041855206,0.060601260247764,0.060601260247764,0.060742226500182,0.060742226500182,0.060742226500182,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060500238583062,0.060742226500182,0.060601260247764,0.060601260247764,0.060601260247764,0.060601260247764,0.060601260247764,0.060601260247764,0.060601260247764,0.060500238583062,0.060500238583062,0.060500238583062,0.059628357695977,0.060742226500182,0.060742226500182,0.060500238583062,0.059628357695977,0.060500238583062,0.060742226500182,0.060500238583062,0.060500238583062,0.060500238583062,0.058996451752429,0.057337148335961,0.05714696028546,0.05714696028546,0.05714696028546,0.05714696028546,0.05714696028546,0.05714696028546,0.05714696028546,0.05714696028546,0.05714696028546,0.05714696028546,0.05714696028546,0.05714696028546,0.05714696028546,0.05714696028546,0.05714696028546,0.059628357695977,0.058996451752429,0.05714696028546,0.05714696028546,0.05714696028546,0.05714696028546,0.059260176939047,0.059260176939047,0.058996451752429,0.058996451752429,0.057337148335961,0.055311041855206,0.055311041855206,0.055311041855206,0.05714696028546)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.298852498275703,0.298852498275703,0.298852498275703,0.298852498275703,0.301991812421138,0.308512883002049,0.268693541280626,0.096665206301627,0.091160833334138,0.091160833334138,0.091160833334138,0.091160833334138,0.091160833334138,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.090788613980757,0.091160833334138,0.091160833334138,0.091160833334138,0.091160833334138,0.091160833334138,0.091160833334138,0.091160833334138,0.091160833334138,0.091160833334138,0.091160833334138,0.091840131366093,0.091160833334138,0.092287762032109,0.092664076910045,0.092920530960312,0.092664076910045,0.095012600150515,0.096233759346944,0.096233759346944,0.096665206301627,0.096665206301627,0.096665206301627,0.096377329292677,0.096665206301627,0.096665206301627,0.096665206301627,0.096665206301627,0.096665206301627,0.096665206301627,0.096665206301627,0.096665206301627,0.096665206301627,0.096665206301627,0.096665206301627,0.096665206301627,0.096665206301627,0.096665206301627,0.097166939398045,0.100175753155823,0.0998177942582,0.100175753155823,0.100175753155823,0.100175753155823,0.100175753155823,0.104583327727564,0.104583327727564,0.105015916511353,0.105015916511353,0.104583327727564,0.104583327727564,0.108346181986066,0.109668708909584,0.124251570918582)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.189067711710479,-0.190784569427452,-0.189387338392353,-0.189387338392353,-0.2165210216,-0.217204399214319,-0.178436844557174,-0.010912578863457,-0.008266644240238,-0.008266644240238,-0.008086550215517,-0.008442399171033,-0.008442399171033,-0.008266644240238,-0.008266644240238,-0.008266644240238,-0.008266644240238,-0.015775872011747,0.448757679480777,-0.02016935634339,-0.0141168435684,-0.0141168435684,-0.012840583938158,-0.012840583938158,-0.0141168435684,-0.0141168435684,-0.0141168435684,-0.0141168435684,-0.012840583938158,-0.012840583938158,-0.012840583938158,-0.012840583938158,-0.0141168435684,-0.0141168435684,-0.0141168435684,-0.014484718471656,-0.0141168435684,-0.0141168435684,-0.0141168435684,-0.0141168435684,-0.0141168435684,-0.0141168435684,-0.0141168435684,-0.014484718471656,-0.0141168435684,-0.0141168435684,-0.0141168435684,-0.013801880671896,-0.013801880671896,-0.014946960714705,-0.013801880671896,-0.014484718471656,-0.014946960714705,-0.020355918079609,-0.022733451400227,-0.025683131883554,-0.014484718471656,-0.016948756075905,-0.014946960714705,-0.014946960714705,-0.0141168435684,-0.012317972503957,-0.010217549441163,-0.012317972503957,-0.012317972503957,-0.013248270366863,-0.013248270366863,-0.014946960714705,-0.014946960714705,-0.0141168435684,-0.018371036333671,-0.0141168435684,-0.013248270366863,-0.018371036333671,-0.0141168435684,-0.018371036333671,-0.025226360593583,-0.018371036333671,-0.025226360593583,-0.018371036333671,-0.020355918079609,-0.05804012308672,-0.05804012308672,-0.046834440641332,-0.046834440641332,-0.05804012308672)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.000351744054703,-0.002314833765185,-0.002735842985813,-0.004884696513751,-0.062406466045426,-0.07051592561335,0.044107700891375,0.059741041169903,0.046263984367121,0.046263984367121,0.046263984367121,0.046263984367121,0.046263984367121,0.046263984367121,0.046263984367121,0.046263984367121,0.046263984367121,0.57908056255544,1.411932190200443,1.13543600188487,0.069826049321548,0.067112138511274,0.068069582706322,0.068069582706322,0.067112138511274,0.067112138511274,0.067112138511274,0.067112138511274,0.068069582706322,0.068069582706322,0.068069582706322,0.068069582706322,0.067112138511274,0.067112138511274,0.067112138511274,0.067112138511274,0.068069582706322,0.068069582706322,0.068069582706322,0.068069582706322,0.068069582706322,0.069826049321548,0.069826049321548,0.069826049321548,0.069826049321548,0.070587254776356,0.070587254776356,0.071314148478837,0.071314148478837,0.071314148478837,0.075212051627633,0.076711310154261,0.078473466416261,0.077388242977861,0.078473466416261,0.084798103968821,0.105193195593718,0.111697893441568,0.117743037462514,0.119922258955862,0.126166042963378,0.134120741494329,0.141840107207479,0.141840107207479,0.141840107207479,0.141840107207479,0.141840107207479,0.141840107207479,0.141840107207479,0.143186687910868,0.143186687910868,0.155226839063121,0.158745898367047,0.158745898367047,0.176824721924834,0.189423253909343,0.211139065494573,0.233966770794926,0.233966770794926,0.259967922071613,0.282587430329435,0.263725383178227,0.305177328982865,0.414678425694602,0.496387299730709,0.820777060126084)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.127555917365194,0.127555917365194,0.126119750400026,0.121507568265664,0.102711612462568,0.09787532557106,0.097375877765412,0.097375877765412,0.097375877765412,0.097368015625849,0.097368015625849,0.097439006977299,0.097439006977299,0.097439006977299,0.097439006977299,0.097439006977299,0.097439006977299,0.1613625417409,0.950344219394832,0.518044463974832,0.107182543720813,0.105058132795637,0.104968901862106,0.104968901862106,0.104958987467889,0.104958987467889,0.104958987467889,0.104986233313682,0.10490101472652,0.10490101472652,0.104873770152624,0.104873770152624,0.104766696913483,0.104708708603422,0.104658560918091,0.104588835847582,0.104333988047603,0.104333988047603,0.104333988047603,0.104333988047603,0.104333988047603,0.104395480171706,0.104465761342724,0.104479947531048,0.104655512976857,0.104805011536568,0.104845164820217,0.104937853409302,0.105043264089671,0.10522534165298,0.105511935162356,0.106291368281458,0.106966779641828,0.108219927403366,0.108968785996673,0.11060518449977,0.113631721830497,0.115985449307665,0.118471385094335,0.119120345424559,0.120394169760427,0.121944259200945,0.124217107107092,0.124824579901288,0.125102977673745,0.125901252770243,0.126011015967226,0.126372679532302,0.126372679532302,0.126819870882978,0.127077907397249,0.12855990544719,0.129106362439313,0.130212185518334,0.133530537156306,0.137401745459703,0.140660690575917,0.142936618436242,0.144483408223729,0.146403593221084,0.150024318433995,0.15291518387273,0.155921847484937,0.169499503163288,0.185599830532951,0.211871256297633)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.234251281755463,0.234335081329538,0.234100233165856,0.233917054908881,0.233175591900125,0.231078739373196,0.158803920557301,0.080713591372373,0.076026919555686,0.076026919555686,0.075998166917376,0.075998166917376,0.075988968742305,0.075847255703339,0.075847255703339,0.0758444162737,0.0758444162737,0.0758444162737,0.0758444162737,0.0758444162737,0.07585370849822,0.075871700795516,0.075871700795516,0.075871700795516,0.075871700795516,0.075871700795516,0.075871700795516,0.075871700795516,0.075871700795516,0.075871700795516,0.075871700795516,0.075871700795516,0.075871700795516,0.075913237352152,0.075944891227125,0.075944891227125,0.075944891227125,0.075931714616384,0.075931714616384,0.075931714616384,0.075948695127008,0.075981211587828,0.075997446136272,0.076148435906842,0.076234699590441,0.076263650244496,0.076429308927223,0.076581861799921,0.076702158025733,0.077105682875617,0.077429178242685,0.07751719925748,0.077737079106281,0.077737079106281,0.078000180539808,0.078138183541428,0.078340684699031,0.078340684699031,0.078245107417515,0.078136546959409,0.078136546959409,0.078136546959409,0.078115243267958,0.078115243267958,0.078115243267958,0.078115243267958,0.078115243267958,0.078115243267958,0.078115243267958,0.078057326270149,0.078371510040203,0.078476900524062,0.078522588682965,0.079176311839969,0.079176311839969,0.079176311839969,0.079214673807755,0.07966146702468,0.07966146702468,0.07991884637018,0.079909632410577,0.079880817779533,0.081005458373877,0.081859131858473,0.082105617684604,0.089258180138297)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.106695364390269,-0.106779163964344,-0.10798048276583,-0.112409486643217,-0.130463979437557,-0.133203413802135,-0.061428042791889,0.016662286393039,0.021348958209726,0.021341096070164,0.021369848708474,0.021440840059923,0.021450038234994,0.02159175127396,0.02159175127396,0.021594590703599,0.021594590703599,0.085518125467201,0.874499803121132,0.442200047701132,0.031328835222593,0.029186432000121,0.02909720106659,0.02909720106659,0.029087286672373,0.029087286672373,0.029087286672373,0.029114532518166,0.029029313931004,0.029029313931004,0.029002069357109,0.029002069357109,0.028894996117967,0.02879547125127,0.028713669690966,0.028643944620457,0.028389096820478,0.028402273431219,0.028402273431219,0.028402273431219,0.028385292920595,0.028414268583878,0.028468315206452,0.028331511624206,0.028420813386416,0.028541361292072,0.028415855892994,0.028355991609381,0.028341106063937,0.028119658777363,0.028082756919671,0.028774169023978,0.029229700535547,0.030482848297085,0.030968605456865,0.032467000958342,0.035291037131466,0.037644764608634,0.04022627767682,0.040983798465151,0.042257622801019,0.043807712241537,0.046101863839134,0.04670933663333,0.046987734405787,0.047786009502285,0.047895772699268,0.048257436264344,0.048257436264344,0.04876254461283,0.048706397357046,0.050083004923128,0.050583773756348,0.051035873678366,0.054354225316338,0.058225433619734,0.061446016768162,0.063275151411562,0.064821941199049,0.066484746850905,0.070114686023418,0.073034366093197,0.07491638911106,0.087640371304815,0.103494212848348,0.122613076159336)
trans=0.5
age=(-1:(153-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 1.2), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="c - Condamine et al.'s Unedited All Dinosaur Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 1.2, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.4, 1.2), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "d - Condamine et al.'s Unedited All Dinosaur Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 1.2, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")

# OUR DATA - 6 DINO FAMILY

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.000199981960717,0.000199981960717,0.000199981960717,0.003522141831923,0.081833004870268,0.083103839294841,0.083103839294841,0.083103839294841,0.083103839294841,0.084516557285983,0.083857785141763,0.083857785141763,0.083857785141763,0.083857785141763,0.083857785141763,0.083103839294841,0.083103839294841,0.081119980073705,0.087410921413237,0.231607886541197,0.231607886541197,0.063977598071213,0.054234884487331,0.049645118608131,0.049253119899501,0.050719974815127,0.050842957419327,0.050719974815127,0.050719974815127,0.051192954670771,0.050842957419327,0.05142037435884,0.05142037435884,0.05142037435884,0.05142037435884,0.051192954670771,0.050842957419327,0.050842957419327,0.050842957419327,0.05112272026214,0.05112272026214,0.05112272026214,0.05112272026214,0.05112272026214,0.05112272026214,0.05112272026214,0.05112272026214,0.05112272026214,0.050842957419327,0.049989710459274,0.049645118608131,0.049210296063699,0.049210296063699,0.049239440197524,0.041408456558099,0.041310628211489,0.049210296063699,0.051192954670771,0.064551887600107,0.064551887600107,0.06877810097195,0.074923201906909,0.077379507984137,0.077379507984137,0.077379507984137,0.077379507984137,0.077379507984137,0.077379507984137,0.077379507984137,0.077379507984137,0.077379507984137,0.077379507984137,0.077379507984137,0.080259017118505,0.080259017118505,0.080259017118505,0.080259017118505,0.080259017118505,0.083335505425552,0.078496239673375,0.078496239673375,0.077379507984137)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.028476757019122,0.028692587010468,0.036837457968787,0.115847408938395,0.137674848782366,0.124369703956369,0.123345874552931,0.123345874552931,0.122071461150417,0.122071461150417,0.120468690827024,0.120682396813025,0.120682396813025,0.120682396813025,0.120682396813025,0.120468690827024,0.120468690827024,0.122024111247896,0.39939532702345,0.578143784362484,0.57871307673158,0.461856128376896,0.394164654553593,0.289103721383868,0.120455080870827,0.116749247637011,0.11405217388578,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112797474536954,0.112738114020533,0.112797474536954,0.112738114020533,0.113963264774439,0.116299223013041,0.116749247637011,0.163274341475592,0.193561421732837,0.207610970688814,0.21776365570695,0.21690756645819,0.221439647592386,0.228981661814783,0.231140929720993,0.228981661814783,0.228981661814783,0.228981661814783,0.228981661814783,0.230583827859364,0.231140929720993,0.231140929720993,0.230583827859364,0.230583827859364,0.2319980041309,0.235281503206746,0.235281503206746,0.236947358909994,0.236947358909994,0.236947358909994,0.244137259437469,0.241301494923188,0.251137982430958,0.264489728486947)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.189463285111513,0.157909927094605,0.120425962410471,0.141113695332549,0.141113695332549,0.139859870585218,0.139562136406475,0.145780456581439,0.145803276529871,0.171699359814658,0.055976314011813,0.057616541374201,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057905002491161,0.057638934911111,0.057616541374201,0.057616541374201,0.057287274042892,0.057287274042892,0.057287274042892,0.057287274042892,0.057287274042892,0.057287274042892,0.05893432246139,0.058431540244803,0.058431540244803,0.058431540244803,0.058431540244803,0.058179888070753,0.058179888070753,0.058179888070753,0.058179888070753,0.058431540244803,0.058179888070753,0.058179888070753,0.058019302770115,0.058019302770115,0.057616541374201,0.057616541374201,0.057377287959356,0.056979003846619,0.056979003846619,0.056341181719336)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.488776289991795,0.425404221344065,0.293002755936577,0.278725585389432,0.278725585389432,0.276322852198345,0.276322852198345,0.284966447470426,0.367772292708457,0.445113027579939,0.219538486969826,0.080791494964011,0.080633921080516,0.080633921080516,0.080633921080516,0.080633921080516,0.080633921080516,0.080633921080516,0.080633921080516,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080791494964011,0.080633921080516,0.080633921080516,0.080791494964011,0.080633921080516,0.080633921080516,0.080633921080516,0.080633921080516,0.080633921080516,0.080633921080516,0.082435018201462,0.0820667369228,0.0820667369228,0.0820667369228,0.0820667369228,0.0820667369228,0.0820667369228,0.082335641540003,0.082335641540003,0.082814695820956,0.082741657131724,0.082814695820956,0.082814695820956,0.082814695820956,0.082741657131724,0.082814695820956,0.082814695820956,0.082666012707452,0.082814695820956,0.082741657131724)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.465223812169961,-0.423046010793124,-0.282436559447863,-0.264109644757748,-0.181008475201675,-0.181008475201675,-0.181008475201675,-0.18646124525565,-0.279231760547594,-0.35417446795557,-0.122930324808813,0.010586105821322,0.009502602775317,0.009502602775317,0.009502602775317,0.008928090935944,0.008928090935944,0.008739445103086,0.008739445103086,0.1612261899452,0.168381094437713,-0.009473307802234,-0.019397899414094,-0.027319899752123,-0.02440878164715,-0.023394076046321,-0.017464205947994,-0.016255257500266,-0.016255257500266,-0.016532458819729,-0.016532458819729,-0.020744744526145,-0.020926004593013,-0.019474217278302,-0.019474217278302,-0.020926004593013,-0.020926004593013,-0.016532458819729,-0.016532458819729,-0.016951463167045,-0.016951463167045,-0.016951463167045,-0.016951463167045,-0.016951463167045,-0.016951463167045,-0.016951463167045,-0.016951463167045,-0.016951463167045,-0.017464205947994,-0.019474217278302,-0.018381008131605,-0.018976985281279,-0.019474217278302,-0.021998936503021,-0.027319899752123,-0.029328344538783,-0.02440878164715,-0.013544925020067,-0.01004476508918,-0.004903433380979,-0.003578096501283,0.003726457793617,0.004584074408342,0.007822217914672,0.007822217914672,0.007822217914672,0.007822217914672,0.007455920857165,0.007455920857165,0.005172732432931,0.005398708165232,0.005172732432931,0.004810832951515,0.004810832951515,0.004017379224348,0.005172732432931,0.005172732432931,0.004810832951515,0.004810832951515,0.004810832951515,0.004017379224348,0.004810832951515)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.16968136273735,-0.147822411521249,-0.090874027826027,-0.068123345743692,-0.03414222532718,-0.033129458948644,-0.033129458948644,-0.034062587239782,-0.02927133836528,-0.064488113484578,0.057351487135385,0.057781405003215,0.055967299398059,0.055967299398059,0.055967299398059,0.055617527619667,0.055617527619667,0.058631853887533,0.325473866728804,0.509259865666137,0.518358609498246,0.388417483452669,0.325086579976312,0.217038526147929,0.054457000257346,0.04964546026113,0.04964546026113,0.04964546026113,0.04964546026113,0.04964546026113,0.04964546026113,0.044860891860464,0.044062409492366,0.044860891860464,0.044860891860464,0.044062409492366,0.044335931973606,0.04964546026113,0.04964546026113,0.049480434467788,0.049480434467788,0.049480434467788,0.049480434467788,0.049480434467788,0.049480434467788,0.049480434467788,0.049480434467788,0.04964546026113,0.049480434467788,0.047849672182879,0.04964546026113,0.049408176777063,0.04964546026113,0.04964546026113,0.04964546026113,0.090455551405949,0.121225839518855,0.140859110784197,0.146499622438975,0.149668833562186,0.151433261258038,0.157616891497622,0.160363992523573,0.163544584851501,0.163544584851501,0.163544584851501,0.163544584851501,0.163627361146663,0.164401452964985,0.163627361146663,0.163627361146663,0.163627361146663,0.164401452964985,0.166097568994422,0.166097568994422,0.16942776155692,0.16942776155692,0.16942776155692,0.173327912866039,0.176925240440779,0.188268602230809,0.207609493730964)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.01134469626908,0.01145370956847,0.014719496621954,0.065679179523083,0.100953614107973,0.104892512759179,0.104795148172592,0.104904088067388,0.104798858207451,0.104059651580899,0.101711641112205,0.10166672473411,0.101633792115754,0.101633792115754,0.101633792115754,0.101670389658203,0.101670389658203,0.103748443613266,0.231993410253779,0.376779023204745,0.377667285599563,0.303274347037186,0.1984620142805,0.10054038766673,0.086568416312924,0.084549286009311,0.081915170574453,0.081068209026953,0.081068209026953,0.080951776956037,0.080756600323563,0.080303775723274,0.080061975930781,0.079821899545188,0.079709626901831,0.07956958896613,0.079359352483037,0.079237440497222,0.079237440497222,0.079167394814291,0.079184536763784,0.079185269798343,0.079142476867882,0.079142476867882,0.079142476867882,0.079142476867882,0.079111283687569,0.079079388005141,0.079036524232953,0.078928021644574,0.07891571415157,0.07905119887092,0.079528867834375,0.08014312001524,0.081464051533637,0.087661604700726,0.103005361840296,0.124909966581026,0.13745324851523,0.140941890693335,0.14704931448878,0.152246597780325,0.156491075334488,0.157002292304453,0.156971802439463,0.157185714224543,0.157300909305412,0.157390904850717,0.157627587872016,0.157878201921888,0.158569980461738,0.159074094800237,0.159471309075185,0.159782720436251,0.160162321129114,0.161174066566311,0.161150972172353,0.1610912415387,0.162509824511068,0.163038028859279,0.168996361283044,0.178881630544718)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.271642848831893,0.25334862886868,0.232723788015828,0.223472034534047,0.223267153398947,0.223053849391364,0.223269881127141,0.225886315113446,0.244198764553188,0.254500564023262,0.084803981098973,0.069753196734094,0.069240251290968,0.069240251290968,0.069234111868594,0.069234111868594,0.069234111868594,0.069234111868594,0.069234111868594,0.069249581743197,0.069249581743197,0.069249581743197,0.069235018198332,0.069235018198332,0.069235018198332,0.069235018198332,0.069214212915345,0.069214212915345,0.069214212915345,0.069214212915345,0.069214212915345,0.0692173070028,0.0692173070028,0.0692173070028,0.0692173070028,0.069220418031857,0.069220418031857,0.069224657906081,0.069224657906081,0.069213465337821,0.069213465337821,0.069213465337821,0.069213465337821,0.06920063416752,0.06920063416752,0.06920063416752,0.06920063416752,0.069228778446551,0.069231418657467,0.069231418657467,0.069231418657467,0.069231418657467,0.069231418657467,0.069268873867916,0.069301502769451,0.069372223702903,0.069410119724519,0.069410119724519,0.069410119724519,0.069410119724519,0.069410119724519,0.069410119724519,0.069387551910668,0.069408564055524,0.069408564055524,0.069408564055524,0.069414763211799,0.06954955832409,0.06954955832409,0.069777138593215,0.069777138593215,0.069870231164358,0.070169862263494,0.070201634912158,0.070282360751199,0.070282360751199,0.070309157530671,0.070449912524348,0.07040151776762,0.070298655739961,0.070256250028988,0.070158530679373)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.260298152562812,-0.24189491930021,-0.218004291393874,-0.157792855010964,-0.122313539290974,-0.118161336632185,-0.118474732954549,-0.120982227046057,-0.139399906345736,-0.150440912442363,0.016907660013231,0.031913528000016,0.032393540824786,0.032393540824786,0.032399680247161,0.032436277789609,0.032436277789609,0.034514331744672,0.162759298385185,0.307529441461548,0.308417703856366,0.234024765293988,0.129226996082168,0.031305369468398,0.017333398114592,0.015314267810979,0.012700957659108,0.011853996111608,0.011853996111608,0.011737564040692,0.011542387408218,0.011086468720474,0.010844668927981,0.010604592542389,0.010492319899031,0.010349170934273,0.01013893445118,0.01001278259114,0.01001278259114,0.00995392947647,0.009971071425963,0.009971804460522,0.009929011530061,0.009941842700361,0.009941842700361,0.009941842700361,0.009910649520049,0.00985060955859,0.009805105575486,0.009696602987107,0.009684295494103,0.009819780213453,0.010297449176908,0.010874246147324,0.012162548764186,0.018289380997823,0.033595242115776,0.055499846856507,0.06804312879071,0.071531770968816,0.077639194764261,0.082836478055806,0.087103523423821,0.087593728248929,0.087563238383939,0.087777150169019,0.087886146093613,0.087841346526626,0.088078029547926,0.088101063328674,0.088792841868523,0.089203863635879,0.089301446811691,0.089581085524093,0.089879960377915,0.090891705815113,0.090841814641682,0.090641329014352,0.092108306743448,0.092739373119318,0.098740111254056,0.108723099865345)
trans=0.5
age=(-1:(146-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="e - Our All Dinosaur Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 0.8, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "f - Our All Dinosaur Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 0.6, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")


# SAKAMOTO DATA - 6 DINO FAMILY

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.06113309907083,0.06113309907083,0.06113309907083,0.06113309907083,0.06113309907083,0.06113309907083,0.06113309907083,0.061898936976589,0.06113309907083,0.06113309907083,0.06113309907083,0.06113309907083,0.06113309907083,0.06113309907083,0.06113309907083,0.06113309907083,0.500210192603808,0.521598187867071,0.029761864436809,0.037279034368295,0.03885386560777,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.038411915486168,0.038411915486168,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039328253607854,0.039328253607854,0.039328253607854,0.039328253607854,0.039328253607854,0.039328253607854,0.039328253607854,0.039328253607854,0.039328253607854,0.039328253607854,0.039328253607854,0.039328253607854,0.039328253607854,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.039122861164197,0.037887024723184,0.038718515748207,0.038718515748207,0.038718515748207,0.038718515748207,0.037887024723184,0.038718515748207,0.038718515748207,0.038718515748207,0.038718515748207,0.038718515748207,0.038718515748207,0.038718515748207,0.038718515748207,0.038411915486168,0.038411915486168,0.038411915486168,0.038329824890252,0.038329824890252,0.038218828594314,0.038218828594314,0.038218828594314,0.037887024723184,0.037887024723184,0.037887024723184,0.037887024723184,0.037887024723184,0.037887024723184,0.037279034368295,0.037279034368295,0.038218828594314,0.038218828594314,0.037887024723184,0.037530545974024,0.037279034368295,0.037279034368295,0.037279034368295,0.037887024723184,0.037887024723184,0.037279034368295,0.037279034368295)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.093426156710269,0.093001260237727,0.093001260237727,0.092947358705652,0.092875602850575,0.092875602850575,0.092875602850575,0.093141879514242,0.092685868057075,0.092685868057075,0.092685868057075,0.092685868057075,0.092685868057075,0.093001260237727,0.093141879514242,0.093141879514242,1.470063466367848,1.438705744525122,0.770039259801505,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.069896854575807,0.069896854575807,0.069896854575807,0.069896854575807,0.069896854575807,0.069896854575807,0.069896854575807,0.069896854575807,0.069896854575807,0.069896854575807,0.069896854575807,0.069896854575807,0.069847173562268,0.069847173562268,0.069847173562268,0.069847173562268,0.069003908473204,0.069003908473204,0.069563102600701,0.069563102600701,0.069563102600701,0.069563102600701,0.069563102600701,0.069563102600701,0.069847173562268,0.069847173562268,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.069003908473204,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.069003908473204,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.070016690549754,0.069896854575807,0.069896854575807,0.069896854575807,0.069896854575807,0.069896854575807,0.069896854575807,0.070016690549754,0.070016690549754,0.069896854575807,0.069896854575807,0.069896854575807,0.069896854575807,0.070016690549754,0.070016690549754,0.069896854575807,0.069896854575807,0.071382650319901,0.071382650319901,0.071382650319901,0.071382650319901,0.071363332236153,0.071382650319901,0.071382650319901,0.072837196954209,0.072837196954209,0.072837196954209,0.073235253160408)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.14484014028971,0.14484014028971,0.14484014028971,0.145449921999657,0.145449921999657,0.145449921999657,0.14484014028971,0.039422496221268,0.031684417873701,0.033409834063766,0.033409834063766,0.033409834063766,0.03352725921051,0.03352725921051,0.03352725921051,0.03352725921051,0.03352725921051,0.033409834063766,0.033409834063766,0.033409834063766,0.033409834063766,0.033409834063766,0.033409834063766,0.033409834063766,0.033409834063766,0.033409834063766,0.033409834063766,0.033409834063766,0.033409834063766,0.033409834063766,0.033409834063766,0.033245103456932,0.033245103456932,0.033245103456932,0.033245103456932,0.033245103456932,0.033245103456932,0.032397823660253,0.032397823660253,0.032397823660253,0.032230505651594,0.032397823660253,0.032397823660253,0.032397823660253,0.032230505651594,0.032230505651594,0.032230505651594,0.032230505651594,0.032230505651594,0.032230505651594,0.032230505651594,0.032230505651594,0.032230505651594,0.032230505651594,0.032230505651594,0.031684417873701,0.031684417873701,0.031684417873701,0.031684417873701,0.031684417873701,0.031684417873701,0.027829201845057,0.027903382321139,0.025627636529477,0.019028184941859,0.010446502742272,0.007765552980494,0.007765552980494,0.006005347024239,0.005748374691385,0.004537833862894,0.003798664449953,0.000419104069764,0.000474006148892,0.000419104069764,0.000419104069764,0.000169590591392,0.000430991334486,8.8559768429e-05,5.1208391666e-05,8.8559768429e-05,8.8559768429e-05,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392,0.000169590591392)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.224531677791345,0.224531677791345,0.224531677791345,0.224598170084003,0.224598170084003,0.224598170084003,0.224531677791345,0.219419397207745,0.168329677028792,0.055961060431647,0.055961060431647,0.055961060431647,0.056035246081668,0.056035246081668,0.056035246081668,0.056035246081668,0.056035246081668,0.055961060431647,0.055961060431647,0.055961060431647,0.055961060431647,0.055961060431647,0.055961060431647,0.055961060431647,0.055961060431647,0.055961060431647,0.056035246081668,0.056035246081668,0.056035246081668,0.056035246081668,0.056035246081668,0.055961060431647,0.056035246081668,0.056237773644286,0.056237773644286,0.056425365499676,0.056425365499676,0.055687909904223,0.055687909904223,0.055687909904223,0.055687909904223,0.055931185423271,0.055931185423271,0.056035246081668,0.056035246081668,0.056035246081668,0.056035246081668,0.056035246081668,0.056035246081668,0.056237773644286,0.056237773644286,0.056237773644286,0.056237773644286,0.056425365499676,0.056425365499676,0.055961060431647,0.055961060431647,0.055961060431647,0.057281160571271,0.057281160571271,0.058604170288902,0.057567350261396,0.058604170288902,0.061299809870235,0.058604170288902,0.056035246081668,0.05363588743638,0.054166162097868,0.053572252128119,0.053144368057971,0.053144368057971,0.053144368057971,0.051091817433473,0.050984829978885,0.050791821720465,0.050373794394782,0.049846973427109,0.049846973427109,0.049429891900027,0.049261249314124,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289,0.049135106704289)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.151718776624911,-0.151718776624911,-0.151718776624911,-0.149524759659162,-0.148887245924996,-0.148887245924996,-0.149524759659162,-0.140996191513486,-0.093834592726925,0.013819503211368,0.013819503211368,0.013819503211368,0.014158357913857,0.013819503211368,0.013563459047804,0.013563459047804,0.456868980946988,0.456084133711963,-0.021909582396145,-0.010397446762198,-0.010580741379459,-0.010580741379459,-0.010397446762198,-0.010397446762198,-0.010397446762198,-0.01026233976447,-0.010397446762198,-0.010397446762198,-0.010397446762198,-0.010397446762198,-0.010397446762198,-0.010580741379459,-0.010580741379459,-0.01026233976447,-0.01026233976447,-0.01026233976447,-0.01026233976447,-0.01026233976447,-0.010397446762198,-0.010397446762198,-0.010397446762198,-0.010397446762198,-0.010397446762198,-0.009748333537245,-0.009748333537245,-0.009748333537245,-0.009748333537245,-0.009748333537245,-0.009748333537245,-0.01026233976447,-0.01026233976447,-0.01026233976447,-0.01026233976447,-0.01026233976447,-0.01026233976447,-0.01026233976447,-0.01026233976447,-0.01026233976447,-0.01026233976447,-0.01026233976447,-0.010580741379459,-0.011877917820928,-0.010580741379459,-0.010580741379459,-0.010580741379459,-0.010397446762198,-0.010580741379459,-0.010580741379459,-0.00875838945898,-0.00875838945898,-0.00875838945898,-0.00875838945898,-0.005999652140393,-0.005925708540964,-0.004776342837889,-0.004476875633204,-0.004009244214389,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.002956858749238,-0.002956858749238,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003068841593371,-0.003932920892393,-0.004591041309132,-0.004591041309132,-0.004591041309132,-0.004591041309132,-0.004776342837889,-0.005467443561911)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.063559111916721,-0.064215701287701,-0.064215701287701,-0.063489096311073,-0.063489096311073,-0.063489096311073,-0.063489096311073,0.043460144405826,0.0553753504584,0.050852699710596,0.050852699710596,0.050852699710596,0.051004873890684,0.051004873890684,0.050852699710596,0.050852699710596,1.429921482963085,1.367855213273857,0.720760520829099,0.031330196802098,0.029170148238788,0.028841943900379,0.028841943900379,0.028841943900379,0.028841943900379,0.028841943900379,0.028841943900379,0.028841943900379,0.028841943900379,0.028841943900379,0.028841943900379,0.028841943900379,0.029170148238788,0.029977332571226,0.029977332571226,0.029977332571226,0.029977332571226,0.029977332571226,0.029977332571226,0.029977332571226,0.029977332571226,0.030137288689466,0.030137288689466,0.030494293779765,0.030494293779765,0.030494293779765,0.030494293779765,0.030494293779765,0.030494293779765,0.030381757014478,0.030381757014478,0.030381757014478,0.030381757014478,0.030494293779765,0.030494293779765,0.030494293779765,0.030494293779765,0.030381757014478,0.031330196802098,0.031330196802098,0.031583755779297,0.033318369347706,0.035191166639301,0.038056227556339,0.038298546259701,0.040877043813632,0.041874495190937,0.044557061127716,0.048354694104972,0.048479429635778,0.050903768142058,0.05138375528346,0.055304053353223,0.056547523840235,0.058042498921939,0.058042498921939,0.058042498921939,0.058568116306681,0.058904723485446,0.058568116306681,0.058031583425758,0.0584134202064,0.058042498921939,0.058042498921939,0.0584134202064,0.0584134202064,0.0584134202064,0.0584134202064,0.0584134202064,0.0584134202064,0.0584134202064,0.0584134202064,0.0584134202064,0.0584134202064,0.058521061507194,0.058521061507194,0.058521061507194,0.058521061507194,0.058521061507194,0.058568116306681,0.058521061507194,0.058521061507194,0.058568116306681,0.058568116306681,0.058904723485446,0.058904723485446,0.059445662759808,0.059445662759808,0.059377791227255,0.059377791227255,0.059674751943184,0.059674751943184,0.059799207504557,0.06041005818766,0.059799207504557,0.059445662759808,0.059445662759808,0.059445662759808,0.059445662759808,0.059799207504557,0.059799207504557)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.07778453205009,0.077646074551271,0.077652797440363,0.077684303865291,0.077628522882058,0.077628522882058,0.077599408631655,0.07737365153045,0.077037844793039,0.077037844793039,0.077037844793039,0.077037844793039,0.077037844793039,0.077038036008786,0.077105734065655,0.077105734065655,0.932075451155842,0.969938324865522,0.170480213645825,0.058691880569509,0.053292961608298,0.053324901547607,0.05335586661666,0.05335586661666,0.05335586661666,0.053294829779823,0.053278896613082,0.053278896613082,0.053262719141899,0.053262719141899,0.053262719141899,0.053262719141899,0.053261411790086,0.053261411790086,0.053261411790086,0.053261411790086,0.053261411790086,0.05320145022712,0.053200917237618,0.053200917237618,0.053200917237618,0.053176915240628,0.053176915240628,0.05314328490722,0.05314328490722,0.05314328490722,0.053151289638976,0.053156256483142,0.053156256483142,0.053181458601921,0.053181458601921,0.053206276796197,0.053206276796197,0.053314836454815,0.053314836454815,0.053325174236716,0.053325174236716,0.053325174236716,0.053325174236716,0.053325174236716,0.053327684867817,0.053327684867817,0.053327684867817,0.053327684867817,0.053299043807579,0.053299043807579,0.053299043807579,0.053299043807579,0.053299043807579,0.053299043807579,0.053299043807579,0.053299043807579,0.053299043807579,0.053299043807579,0.053299043807579,0.053342676709115,0.053342676709115,0.053347063823153,0.053347063823153,0.053347063823153,0.053397636990363,0.053472835013192,0.053472835013192,0.053472835013192,0.053472835013192,0.053500644571202,0.053472841665482,0.053472841665482,0.053472841665482,0.053472841665482,0.053472841665482,0.053472841665482,0.053472841665482,0.053472841665482,0.053554991478001,0.053554991478001,0.053554991478001,0.05359805614034,0.05359805614034,0.053677238575857,0.053773832807809,0.053773832807809,0.053910719756501,0.053935222232674,0.053946636233783,0.053946636233783,0.054045818835497,0.054045818835497,0.05411131753531,0.05411131753531,0.054495499780885,0.054495499780885,0.054739197168385,0.054793231173277,0.055224828973571,0.055309174421938,0.055309174421938,0.055336453558948,0.055336453558948,0.055835355910984,0.056697312999079)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.182774747917022,0.182774747917022,0.182777504402668,0.183073818957969,0.183144084422,0.183156204969102,0.183008477339088,0.154133534051758,0.056678492874591,0.044814175439105,0.044814175439105,0.044814175439105,0.044765923818817,0.044765923818817,0.044757471607371,0.044757471607371,0.044757471607371,0.044736255010481,0.044736255010481,0.044719017968528,0.044719017968528,0.044719017968528,0.044705985142233,0.044705985142233,0.044705985142233,0.044705985142233,0.044668809357123,0.044668809357123,0.044668809357123,0.044668809357123,0.044668809357123,0.044656196599705,0.044612308627686,0.044538704765813,0.044481286397544,0.044452651012132,0.04444201688984,0.044414188268078,0.044363933590807,0.044363933590807,0.044319352333933,0.044287066957648,0.044287066957648,0.044239360743968,0.044207307546548,0.044207307546548,0.044207307546548,0.044207307546548,0.044207307546548,0.044195653065021,0.044195653065021,0.044195653065021,0.044195653065021,0.044168268258133,0.044168268258133,0.044150008860632,0.044130196103939,0.044071360157934,0.043860085388224,0.043860085388224,0.043661226927383,0.043112270694313,0.042907783966302,0.042356773489576,0.041838641291805,0.040954678943719,0.040496655808811,0.039978935327639,0.03925695827898,0.038543522576512,0.037308369509535,0.036165789295103,0.034848139023727,0.033914901193661,0.033210363070746,0.031993487544667,0.030092300397347,0.029131499038448,0.028976993012987,0.028675429011768,0.028095372827858,0.028066291734773,0.027989184177637,0.027966617296885,0.027763615494914,0.027730851485169,0.027730851485169,0.027730851485169,0.027668839263517,0.027637877001405,0.027637877001405,0.027637877001405,0.027637877001405,0.027637877001405,0.027607347514591,0.027572361405455,0.027572361405455,0.027572361405455,0.027572361405455,0.027572361405455,0.027572361405455,0.027572361405455,0.027572361405455,0.027572361405455,0.027572361405455,0.027572361405455,0.02756680840417,0.02756680840417,0.02756680840417,0.02754597161232,0.02754597161232,0.027562873062458,0.027562873062458,0.027562873062458,0.027562873062458,0.027562873062458,0.027576148404532,0.027576148404532,0.027576148404532,0.027576148404532,0.027576148404532)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.104990215866932,-0.105128673365751,-0.105124706962305,-0.105389515092678,-0.105515561539942,-0.105527682087044,-0.105409068707432,-0.076759882521308,0.020359351918448,0.032223669353934,0.032223669353934,0.032223669353934,0.032271920974222,0.032272112189969,0.032348262458284,0.032348262458284,0.887317979548471,0.925202069855041,0.125743958635343,0.013972862600981,0.00857394363977,0.008605883579079,0.008649881474427,0.008649881474427,0.008649881474427,0.00858884463759,0.008610087255959,0.008610087255959,0.008593909784776,0.008593909784776,0.008593909784776,0.008606522542193,0.0086491031624,0.008722707024273,0.008780125392542,0.008808760777954,0.008819394900245,0.008787261959042,0.008836983646811,0.008836983646811,0.008881564903685,0.008889848282981,0.008889848282981,0.008903924163252,0.008935977360671,0.008935977360671,0.008943982092428,0.008948948936593,0.008948948936593,0.008985805536901,0.008985805536901,0.009010623731177,0.009010623731177,0.009146568196682,0.009146568196682,0.009175165376084,0.009194978132777,0.009253814078782,0.009465088848492,0.009465088848492,0.009666457940435,0.010215414173504,0.010419900901515,0.010970911378241,0.011460402515775,0.012344364863861,0.012802387998768,0.01332010847994,0.0140420855286,0.014755521231067,0.015990674298044,0.017133254512476,0.018450904783852,0.019384142613919,0.020088680736833,0.021349189164448,0.023250376311768,0.024215564784705,0.024370070810166,0.024671634811385,0.025302264162505,0.025406543278419,0.025483650835556,0.025506217716307,0.025709219518278,0.025769793086033,0.025741990180313,0.025741990180313,0.025804002401964,0.025834964664077,0.025834964664077,0.025834964664077,0.025834964664077,0.025834964664077,0.02594764396341,0.025982630072546,0.025982630072546,0.026025694734885,0.026025694734885,0.026104877170402,0.026201471402354,0.026201471402354,0.026338358351046,0.026362860827219,0.026374274828328,0.026374274828328,0.026479010431326,0.026479010431326,0.026544509131139,0.026565345922989,0.026949528168565,0.026932626718428,0.027176324105927,0.02723035811082,0.027661955911113,0.02774630135948,0.027733026017405,0.027760305154416,0.027760305154416,0.028259207506452,0.029121164594547)
trans=0.5
age=(-1:(188-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 1.2), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="g - Sakamoto et al.'s All Dinosaur Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 1.2, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.4, 1.2), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "h - Sakamoto et al.'s All Dinosaur Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 1.2, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")

n <- dev.off()