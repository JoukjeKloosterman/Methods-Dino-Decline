# 1 files combined:
# 	./PyRate_Inputs_2_BDMCMC_Grj_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

if(!require('base64')) {
  install.packages('base64')
  library('base64')
}

library("magick")


pngfile <- "./figures report Hadrosauridae.png"
png(pngfile, width = 8, height = 15, units = "in", res = 1200)
# par(mfrow=c(4,2))

# Define the layout matrix
layout_matrix <- matrix(c(1, 1, 
                          2, 3, 
                          4, 5, 
                          6, 7, 
                          8, 9), 
                        nrow = 5, ncol = 2, byrow = TRUE)

# Set up the layout
layout(layout_matrix)

images <- image_read("Results Condamine Hadrosauridae.png")
par(mar = c(0, 0, 0, 0))
plot.new()
rasterImage(images, 0, 0, 1, 1)

par(mar = c(5, 4, 4, 2))

library(scales)
plot_RTT <- function (age,hpd_M,hpd_m,mean_m,color){
  N=100
  beta=(1:(N-1))/N
  alpha_shape=0.25
  cat=1-(beta^(1./alpha_shape))
  for (i in 1:(N-1)){
    trans= 1/N + 2/N
    polygon(c(age, rev(age)), c(hpd_M-((hpd_M-mean_m)*cat[i]), rev(hpd_m+((mean_m-hpd_m)*cat[i]))), col = alpha(color,trans), border = NA)
  }
  lines(rev(age), rev(mean_m), col = color, lwd=3)
}


# CONDAMINE EDITED DATA - Hadrosauridae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.035548468570875,0.034824043995327,0.033410109087498,0.025320533058942,0.053645650947302,0.202591250295625,0.252500159202533,0.259254483460838,0.236581289698822,0.245606319455136,0.248280714062243,0.245606319455136,0.245606319455136,0.249886617712333,0.248280714062243,0.246966817665873,0.23305878234987,0.237758316999978,0.246966817665873,0.219939596402324,0.23305878234987,0.237758316999978)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.342554808420283,0.342725710669677,0.344434925673599,0.380112585194513,0.501734021158947,0.627627986439769,0.547024723167449,0.552313549744944,0.510330607912806,0.510330607912806,0.510330607912806,0.510330607912806,0.510330607912806,0.522142378556869,0.528819131758174,0.552313549744944,0.602539466802188,0.684453618008663,0.755034458041105,0.78705553244829,0.81610077013978,0.857029969028131)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.180237674727914,0.186524962544365,0.186524962544365,0.185593298668804,0.186524962544365,0.186524962544365,0.186524962544365,0.186524962544365,0.186524962544365,0.186524962544365,0.186524962544365,0.18299762240156,0.181422411148219,0.176583419605047,0.176583419605047,0.180369341806485,0.180237674727914,0.181422411148219,0.178160618777397,0.166045466428254,0.136417031545071,0.135392515049176)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.376276131167271,0.365254766230421,0.364076989447571,0.359340955461482,0.359340955461482,0.357690363077347,0.357690363077347,0.357690363077347,0.358368461552213,0.359137557415494,0.364972820479482,0.365254766230421,0.364076989447571,0.359340955461482,0.359340955461482,0.364076989447571,0.364972820479482,0.376276131167271,0.377034932726092,0.382145699559544,0.375697761682154,0.377034932726092)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.285720390381456,-0.289360102431049,-0.289360102431049,-0.295555713675888,-0.265439965242779,-0.096181592975243,-0.066244874180575,-0.058098497149833,-0.057636157637293,-0.058098497149833,-0.033098337799821,-0.028239934013405,-0.028239934013405,-0.028239934013405,-0.052850048770737,-0.056628508510758,-0.096181592975243,-0.072243685562017,-0.085949687472914,-0.117065336454084,-0.096181592975243,-0.091245161395509)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.10872446754044,0.083365193808035,0.08290447131478,0.111459169951974,0.245685825027895,0.362606014662259,0.289868836372744,0.294239465290088,0.280277994115059,0.272971339926123,0.285409508090661,0.287770139780746,0.287770139780746,0.287770139780746,0.286288195029852,0.322319020654578,0.356737468717781,0.482653887582177,0.509150014712592,0.544224601598302,0.562182030951933,0.629004083231252)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.146464687009824,0.146246932629835,0.144198849783047,0.158917045577686,0.315139061137229,0.412663856890784,0.393481582081193,0.39110631688907,0.386932132968556,0.38530764838273,0.385468634994166,0.385727763208915,0.385620133786798,0.387528821430912,0.391994190461761,0.404181465242575,0.418826898371937,0.426809152405679,0.433143616013901,0.441375966313466,0.439700822399923,0.444265890627029)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.283984946675545,0.271517841878256,0.272496272348002,0.273503864995227,0.274513349308516,0.276211774112452,0.276288559916759,0.276829342199437,0.27860083758784,0.276112258567585,0.269914375857647,0.268587529307698,0.267876025581238,0.267770630325148,0.267849775056029,0.268164307512248,0.269184799583037,0.272565388900051,0.27576601757165,0.274355527384944,0.271101700893994,0.271021512021279)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.13752025966572,-0.125270909248422,-0.128297422564954,-0.114586819417541,0.040625711828713,0.136452082778331,0.117193022164434,0.114276974689633,0.108331295380716,0.109195389815144,0.115554259136519,0.117140233901216,0.11774410820556,0.119758191105763,0.124144415405732,0.136017157730327,0.1496420987889,0.154243763505628,0.157377598442251,0.167020438928522,0.168599121505929,0.17324437860575)
trans=0.5
age=(-1:(89-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="a - Condamine et al.'s Edited Hadrosauridae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 0.8, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "b - Condamine et al.'s Edited Hadrosauridae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 0.6, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")




# CONDAMINE RAW DATA - Hadrosauridae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.19635703741539,0.19635703741539,0.180322483646013,0.038749648920372,0.024949740761015,0.024486127286281,0.029886122204579,0.03066891530423,0.03066891530423,0.03066891530423,0.03066891530423,0.03066891530423,0.027062865849285,0.025460592446863,0.029419365957107,0.025632158588751,0.025460592446863,0.036245656033542,0.093312730550287,0.0313168958941,0.019976734715033,0.011615055942392,0.009442261481154,0.019976734715033,0.020679902225237,0.020860395446528,0.021491959444198,0.02389905337577,0.02389905337577,0.02389905337577,0.024150747674445,0.024596797350916,0.024906949541604,0.024906949541604,0.024906949541604,0.024596797350916,0.02389905337577,0.02389905337577,0.02389905337577,0.021491959444198,0.019976734715033,0.021491959444198,0.019976734715033,0.016804397195098,0.019976734715033)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.574593158030899,0.576557027520544,0.608982762802307,0.456850054725646,0.303732389644808,0.103055678307032,0.097793297537593,0.097793297537593,0.097793297537593,0.097793297537593,0.097793297537593,0.097793297537593,0.097793297537593,0.097793297537593,0.108271809060272,0.108271809060272,0.229305888181694,0.989255379199927,1.060771935882075,1.004185327902246,0.612351840940069,0.380017066108065,0.249533891610563,0.190235421622003,0.181586266822169,0.181586266822169,0.181586266822169,0.183211509797562,0.182565092624989,0.181586266822169,0.181586266822169,0.181586266822169,0.181586266822169,0.181586266822169,0.181586266822169,0.181586266822169,0.181586266822169,0.181586266822169,0.181586266822169,0.181586266822169,0.183211509797562,0.189906193807885,0.192167500541762,0.203953821540043,0.226057457607152)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.249730803082594,0.265406543508158,0.264768296934707,0.257142703090091,0.033559497345791,0.031867548902901,0.0356971367414,0.036333734210363,0.036333734210363,0.036333734210363,0.036333734210363,0.036333734210363,0.036333734210363,0.036333734210363,0.036333734210363,0.036333734210363,0.036333734210363,0.036333734210363,0.036333734210363,0.0356971367414,0.032602879070587,0.031867548902901,0.030960478411619,0.027420481703115,0.020543044381188,0.011175212740457,0.011175212740457,0.011175212740457,0.011175212740457,0.011175212740457,0.011175212740457,0.007521429543872,0.007521429543872,0.007521429543872,0.007521429543872,0.007521429543872,0.007521429543872,0.006862732763422,0.006862732763422,0.006862732763422,0.006224272943371,0.006224272943371,0.006224272943371,0.006018488613524,0.006047321902232)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.743137672348405,0.657801402439331,0.650238553640659,0.64777809361668,0.573741804198021,0.085703506801743,0.085881006803165,0.085881006803165,0.085703506801743,0.085703506801743,0.085703506801743,0.085703506801743,0.085703506801743,0.085703506801743,0.085443914017747,0.085443914017747,0.085443914017747,0.085703506801743,0.085881006803165,0.085881006803165,0.084793020963329,0.087489914529659,0.091684409491073,0.091684409491073,0.091684409491073,0.084793020963329,0.085443914017747,0.085443914017747,0.085881006803165,0.085443914017747,0.085881006803165,0.082528170742988,0.082528170742988,0.082528170742988,0.082528170742988,0.082528170742988,0.082528170742988,0.082361930598748,0.082361930598748,0.082528170742988,0.082272832722108,0.082361930598748,0.082361930598748,0.082272832722108,0.084320981438354)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.423280912482017,-0.342832740654864,-0.364640913405553,-0.553051506103183,-0.583318507908168,-0.044275504770548,-0.039778659192749,-0.039628959777626,-0.036832813163355,-0.036832813163355,-0.036832813163355,-0.039778659192749,-0.039778659192749,-0.039778659192749,-0.043353659806937,-0.044038860987531,-0.062886760807316,-0.028771100818088,0.041360012695593,-0.028322120078787,-0.048022752515911,-0.057012448816953,-0.056168076498404,-0.056168076498404,-0.045046407751268,-0.056168076498404,-0.057012448816953,-0.057012448816953,-0.056168076498404,-0.056168076498404,-0.054611974151625,-0.05097756677044,-0.048022752515911,-0.048022752515911,-0.048022752515911,-0.05097756677044,-0.048022752515911,-0.043036902241198,-0.043036902241198,-0.042002563855246,-0.048022752515911,-0.044270737811754,-0.041928894653068,-0.048022752515911,-0.057105229862176)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.234085844457261,0.166405189612269,0.157595706440712,0.094357292962749,0.056383295850808,0.063840042187272,0.046594393861812,0.046329613995934,0.048544576204306,0.048544576204306,0.048544576204306,0.047139836763658,0.052077231003339,0.052469655972731,0.052469655972731,0.059093427751534,0.167001447617196,0.929325774131688,1.014730686611857,0.9517192901657,0.55928951838782,0.316184667141822,0.201713274193371,0.14140191656893,0.142335307136812,0.131474585193116,0.128967959527698,0.128967959527698,0.128967959527698,0.128967959527698,0.128967959527698,0.131282730129764,0.131282730129764,0.131282730129764,0.131282730129764,0.131282730129764,0.134422858866547,0.142335307136812,0.142335307136812,0.146290394598643,0.146290394598643,0.160197683022956,0.167001447617196,0.17356873772679,0.189494530067233)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.362530785416293,0.361025572683476,0.352859121575999,0.232426347173737,0.092322679362335,0.064454513048525,0.061183256018633,0.061055983271394,0.061055983271394,0.061067294869574,0.061042576571608,0.061523387590032,0.062426064324563,0.062802238580877,0.063547065747952,0.064595353998007,0.082819634308082,0.552138300627805,0.626033124067714,0.500391640851413,0.179797291554314,0.120008303785579,0.107641540916918,0.096927733302997,0.093357451940059,0.093124822618937,0.092950503772731,0.092989918153191,0.092774292994148,0.092919889599266,0.092610904024382,0.092513883224929,0.092409817225477,0.092353569179759,0.092439135482161,0.092734320043415,0.093075793464434,0.093013554087012,0.093056707212631,0.093632137253353,0.095096814093659,0.097768626968001,0.100293043807565,0.105864766331225,0.112754045323242)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.485142918447668,0.455486599394606,0.454056410871983,0.454504715331546,0.331034553996212,0.063463687257069,0.059207423882881,0.058936341504547,0.058897583956293,0.058867422489139,0.058867422489139,0.058980474839757,0.058980474839757,0.058864441286763,0.058806518500197,0.058806518500197,0.058799637705305,0.058750831507461,0.058705703080633,0.05837209531781,0.05800137250446,0.057079764875028,0.056461134151373,0.055982057112095,0.055255426622456,0.05490525234432,0.054661303651014,0.05451965317728,0.054357492700214,0.054228623399798,0.054024563375724,0.054009560387043,0.054034017646072,0.054034017646072,0.053988448039972,0.053959119882998,0.053938509975419,0.054320385892629,0.054275826732428,0.054309630772057,0.05427268411375,0.05431302027214,0.05431302027214,0.054371119557321,0.054622306120422)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.122612133031375,-0.09446102671113,-0.101197289295984,-0.222078368157809,-0.238711874633877,0.000990825791456,0.001975832135752,0.002119641766848,0.002158399315101,0.002199872380435,0.002175154082469,0.002542912750275,0.003445589484806,0.003937797294114,0.004740547247755,0.00578883549781,0.024019996602777,0.493387469120344,0.567327420987081,0.442019545533603,0.121795919049854,0.06292853891055,0.051180406765545,0.040945676190902,0.038102025317603,0.038219570274617,0.038289200121717,0.038470264975911,0.038416800293933,0.038691266199468,0.038586340648657,0.038504322837886,0.038375799579405,0.038319551533687,0.038450687442189,0.038775200160418,0.039137283489015,0.038693168194382,0.038780880480203,0.039322506481296,0.040824129979909,0.04345560669586,0.045980023535425,0.051493646773904,0.05813173920282)
trans=0.5
age=(-1:(112-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="c - Condamine et al.'s Unedited Hadrosauridae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 1.2, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "d - Condamine et al.'s Unedited Hadrosauridae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 1.2, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")



# OUR DATA - Hadrosauridae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.082039064539861,0.085586836176761,0.086778924084721,0.085586836176761,0.081347774418974,0.081347774418974,0.088530056665142,0.08425246508228,0.08425246508228,0.084987083438854,0.084987083438854,0.084987083438854,0.08425246508228,0.085992200867328,0.082427249416905,0.072064504341168,0.26021422250862,0.129608212697466,0.03937163696598,0.042390428002723,0.048017883961544,0.04227542479029,0.04227542479029,0.035179938923018,0.0200782651958,0.017082802226607,0.010363995140714,0.009369442526343,0.008306991599952,0.00540366333783,0.00540366333783,0.00578953878502,0.009768430348859,0.006301143977365,0.008306991599952,0.009768430348859,0.009231636057223,0.00540366333783,0.006301143977365,0.006301143977365,0.00578953878502,0.00578953878502,0.00578953878502,0.00578953878502,0.00540366333783,0.00540366333783,0.00540366333783,0.00540366333783,0.00540366333783,0.00540366333783,0.00578953878502,0.006301143977365,0.006301143977365,0.006301143977365,0.006301143977365,0.006301143977365,0.00578953878502,0.006301143977365,0.006301143977365,0.006301143977365,0.006301143977365,0.006301143977365,0.00578953878502,0.00578953878502,0.00540366333783,0.00540366333783,0.008656851202369,0.008656851202369,0.009231636057223,0.009231636057223,0.009231636057223,0.008306991599952,0.00540366333783,0.00578953878502)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.226725654470592,0.205533995679691,0.195298519953591,0.192148920696129,0.185363914750066,0.17992717723685,0.173373046185699,0.16441161657439,0.16441161657439,0.16441161657439,0.16441161657439,0.16441161657439,0.16441161657439,0.167225568645991,0.167225568645991,0.421404754085702,1.372120602071074,1.336444607301346,0.784967739038241,0.65234200085971,0.633432581391394,0.623032073058296,0.623032073058296,0.604859967126779,0.579741713269552,0.564697351719965,0.523012153464145,0.475051790885673,0.444668459928165,0.368236663921499,0.245532262039582,0.183927577046461,0.16512719508366,0.150826831020932,0.148863799996984,0.146894739074434,0.14599489696771,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.141689999840762,0.14599489696771,0.14599489696771,0.146894739074434,0.147386091459985,0.147794764683315,0.147794764683315,0.147386091459985,0.154274102728066)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.154892104890213,0.197265293785725,0.201303207313572,0.201170999985039,0.201170999985039,0.199893672611115,0.061155363010947,0.055368864447407,0.047408007459981,0.050695969125788,0.054977956029494,0.054334305422472,0.054334305422472,0.054334305422472,0.054334305422472,0.054334305422472,0.054334305422472,0.054334305422472,0.054500255388854,0.054334305422472,0.054334305422472,0.050695969125788,0.047408007459981,0.047408007459981,0.042225084641347,0.042225084641347,0.042225084641347,0.042225084641347,0.037147466543767,0.034748767241433,0.034596498909984,0.030830152878405,0.027382953226325,0.012713033890078,0.011070354573438,0.011890495206162,0.006602905854429,0.006602905854429,0.002220873819325,0.002220873819325,0.002220873819325,0.001996920084319,0.002244749870304,0.002244749870304,0.002220873819325,0.001996920084319,0.001996920084319,0.001996920084319,0.001996920084319,0.001996920084319,0.001996920084319,0.002117379992871,0.002117379992871,0.001996920084319,0.001996920084319,0.001996920084319,0.001996920084319,0.001996920084319,0.001996920084319,0.001996920084319,0.001996920084319,0.001996920084319,0.002117379992871,0.002117379992871,0.001996920084319,0.001996920084319,0.002117379992871,0.001996920084319,0.001996920084319,0.001996920084319,0.001996920084319,0.001996920084319,0.001996920084319,0.001996920084319)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,1.484639586254466,0.444086147611889,0.444086147611889,0.444086147611889,0.444086147611889,0.445050721097099,0.379321942026955,0.337895902457202,0.169586096401074,0.126040820945702,0.122342583136706,0.120889628320953,0.120889628320953,0.120889628320953,0.120889628320953,0.120889628320953,0.120889628320953,0.120889628320953,0.122342583136706,0.123515714943609,0.126040820945702,0.124960247300931,0.123515714943609,0.124960247300931,0.126040820945702,0.125670640221802,0.126040820945702,0.128032492671939,0.126040820945702,0.124960247300931,0.124960247300931,0.126040820945702,0.124960247300931,0.112963125333236,0.11381432364835,0.116578502833565,0.112963125333236,0.112963125333236,0.108508406254693,0.107322671508502,0.107221206328711,0.1064544870779,0.1064544870779,0.1064544870779,0.106260535253983,0.105768957369506,0.105768957369506,0.105721471624814,0.10542277201018,0.10542277201018,0.105065749888954,0.105065749888954,0.105065749888954,0.105065749888954,0.105065749888954,0.105065749888954,0.105065749888954,0.105065749888954,0.105065749888954,0.105065749888954,0.105065749888954,0.105065749888954,0.105065749888954,0.105065749888954,0.105065749888954,0.105065749888954,0.105440133181939,0.105440133181939,0.105440133181939,0.105721471624814,0.105721471624814,0.105721471624814,0.106260535253983,0.106260535253983)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-1.351362417051274,-0.31074548558945,-0.297296903816984,-0.297296903816984,-0.296064819572626,-0.298724163194944,-0.26663092401173,-0.225779173036352,-0.048688097383014,-0.021123021478958,-0.016689962926393,-0.013734009970633,-0.013550711514825,-0.013550711514825,-0.016667626133086,-0.029066660791023,0.168303791749661,0.031833069750452,-0.047392102013969,-0.0460438200265,-0.045587980652286,-0.042979817490943,-0.062292316879163,-0.061099502038014,-0.070199014112764,-0.072764688730455,-0.091726224464683,-0.102634509553187,-0.102634509553187,-0.095896541107119,-0.102634509553187,-0.102634509553187,-0.099758729243185,-0.088620655229154,-0.090319400691494,-0.091726224464683,-0.083367787692095,-0.081919360704925,-0.081919360704925,-0.081919360704925,-0.081919360704925,-0.081919360704925,-0.081919360704925,-0.081919360704925,-0.078803245633233,-0.081919360704925,-0.078803245633233,-0.078803245633233,-0.081919360704925,-0.081919360704925,-0.081618696521373,-0.081295276526382,-0.078803245633233,-0.081618696521373,-0.081618696521373,-0.081618696521373,-0.081919360704925,-0.082943791090304,-0.082943791090304,-0.082943791090304,-0.082943791090304,-0.082943791090304,-0.081919360704925,-0.081919360704925,-0.083367787692095,-0.083367787692095,-0.077302070957306,-0.077302070957306,-0.081919360704925,-0.088446395246508,-0.078272451582749,-0.078803245633233,-0.085395686450797,-0.088446395246508)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.087562671189782,-0.035549408792712,-0.035229089380357,-0.035229089380357,-0.035229089380357,-0.035229089380357,0.085142121155667,0.093392222960735,0.105090697664807,0.093392222960735,0.088395422001481,0.089435165537366,0.089435165537366,0.088395422001481,0.088395422001481,0.337984177324871,1.278306496759767,1.238496407073678,0.712593448897173,0.577419369231255,0.551012099599034,0.551012099599034,0.529905169366979,0.522172530839346,0.507225277452594,0.500850202015526,0.447020155978862,0.397679564427415,0.350929157000693,0.309132505804313,0.170971716791414,0.106827106069718,0.087749265617622,0.087749265617622,0.087749265617622,0.087749265617622,0.094389254923961,0.093545815006597,0.093545815006597,0.093545815006597,0.093545815006597,0.093545815006597,0.093545815006597,0.093545815006597,0.097499695153351,0.093545815006597,0.097506134275554,0.098953212500249,0.097506134275554,0.097506134275554,0.097665993134484,0.097665993134484,0.098953212500249,0.097665993134484,0.097665993134484,0.097665993134484,0.097665993134484,0.097665993134484,0.097665993134484,0.097665993134484,0.097665993134484,0.097665993134484,0.097665993134484,0.097665993134484,0.097665993134484,0.097665993134484,0.106904033800521,0.106904033800521,0.103238345931528,0.097665993134484,0.110072358833031,0.111217826257073,0.111217826257073,0.117174295193545)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.141405397161858,0.137327382914044,0.135207214970779,0.134757903429417,0.134703268544514,0.134401697563037,0.129075544065331,0.127074911337121,0.126109487928426,0.125989826774604,0.125805270057707,0.125754347601681,0.125832100252816,0.126272669804859,0.127557972670744,0.152934447324465,0.722042682649208,0.69160286589661,0.380279638612742,0.330097665530464,0.307007305665206,0.301448475595385,0.298732032610284,0.286044193147165,0.252357478654052,0.222186630882794,0.179221169423659,0.145692535617542,0.120759662933593,0.104382767664277,0.089949030281268,0.08352388348484,0.078050220287686,0.074226309113866,0.072222274480985,0.070427683152527,0.069609511039439,0.069445057339806,0.069065402414541,0.069065402414541,0.06926882211356,0.069267663143561,0.069265029054327,0.069229296865407,0.069347985758215,0.069249576790505,0.069249576790505,0.069249576790505,0.069249576790505,0.069249576790505,0.06916767342981,0.069022440495077,0.069039877280606,0.069039877280606,0.068991281760654,0.069108740916851,0.069258951155565,0.069335472362349,0.069230968879955,0.069230968879955,0.069230968879955,0.06927402520872,0.069375540727275,0.069375540727275,0.069511959748455,0.069511959748455,0.069776547913631,0.069776547913631,0.07004271060763,0.07026749773147,0.07061063305221,0.071914618194645,0.07382742672655,0.081617433028182)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.476025611446446,0.305885536500532,0.305097362030144,0.305496477541463,0.306175378510389,0.307800688949191,0.235675953705346,0.153700815083162,0.094554109165479,0.089891624315581,0.087427280401868,0.086920964654351,0.086920964654351,0.086751240092808,0.086687122939439,0.086526280786526,0.086526280786526,0.086526280786526,0.085954541369945,0.085744857189155,0.085435000452275,0.085352858371841,0.084903856525851,0.084422876601433,0.083914903364987,0.083915939034805,0.083822598458912,0.083202083322396,0.082669046125206,0.082098456153351,0.0818684131852,0.08124260207202,0.080766578066374,0.079777449316698,0.077913216428441,0.076166750654065,0.075455041810789,0.074570256199241,0.073235686603753,0.071945824798751,0.07158080775601,0.070703828769668,0.069677152823656,0.069334928877545,0.069030285402865,0.068780712380217,0.068371317112186,0.068144939791498,0.06760287666329,0.067367163275487,0.067356442806294,0.067198682500578,0.067014922101659,0.067078812271695,0.067078812271695,0.066952603254891,0.066952603254891,0.066830968053053,0.066800152464227,0.066791351885249,0.066698479470324,0.066561173288836,0.066437085523285,0.066513602244695,0.066747034627616,0.066747034627616,0.066805459415738,0.066846758472619,0.066846758472619,0.067020900951502,0.067020900951502,0.067046381146447,0.067734279051293,0.067770009987216)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.334620214284587,-0.168558153586488,-0.169890147059365,-0.170738574112046,-0.171472109965875,-0.173398991386153,-0.106600409640015,-0.026625903746042,0.031555378762948,0.036098202459023,0.038377989655839,0.03883338294733,0.038911135598466,0.039521429712051,0.040870849731306,0.066408166537938,0.635516401862682,0.605076585110084,0.294325097242797,0.244352808341309,0.221572305212931,0.216095617223544,0.213828176084434,0.201621316545731,0.168442575289065,0.138270691847989,0.095398570964747,0.062490452295146,0.038090616808387,0.022284311510926,0.008080617096068,0.00228128141282,-0.002716357778688,-0.005551140202832,-0.005690941947455,-0.005739067501538,-0.005845530771349,-0.005125198859435,-0.004170284189212,-0.002880422384211,-0.00231198564245,-0.001436165626107,-0.00041212376933,-0.000105632012138,0.00031770035535,0.000468864410288,0.000878259678319,0.001104636999007,0.001646700127215,0.001882413515018,0.001811230623516,0.001823757994499,0.002024955178947,0.001961065008911,0.001912469488959,0.002156137661961,0.002306347900674,0.002504504309297,0.002430816415729,0.002439616994707,0.002532489409631,0.002712851919884,0.00293845520399,0.002861938482579,0.002764925120839,0.002764925120839,0.002971088497894,0.002929789441012,0.00319595213501,0.003246596779968,0.003589732100708,0.004868237048197,0.006093147675257,0.013847423040966)
trans=0.5
age=(-1:(141-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="e - Our Hadrosauridae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 0.8, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "f - Our Hadrosauridae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 0.6, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")



# SAKAMOTO DATA - Hadrosauridae

L_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.118105700900143,0.119179645880071,0.119179645880071,0.119179645880071,0.119179645880071,0.119544459444406,0.119179645880071,0.119544459444406,0.119544459444406,0.119544459444406,0.119179645880071,0.119544459444406,0.119544459444406,0.119179645880071,0.118105700900143,0.115012407324399,0.119179645880071,0.113567167348376,0.113567167348376,0.110865329579554,0.10997107151795,0.051179042153763,0.025027727452248,0.020443616433875,0.007092613152542,0.003646934816768,0.006074324333897,0.005846979081355,0.005085540497615,0.003210115856858,0.004856861119654,0.004836197517059,0.004836197517059,0.005085540497615,0.003210115856858,0.003646934816768,0.004383688429322,0.004836197517059,0.003202230850654,0.003202230850654,0.003610681755209,0.002245466535621,0.003202230850654,0.003202230850654,0.003202230850654,0.003202230850654,0.002245466535621,0.003610681755209,0.003202230850654,0.003202230850654,0.003610681755209,0.002245466535621,0.003202230850654,0.003202230850654,0.002245466535621,0.002245466535621,0.002245466535621,0.003202230850654,0.003202230850654,0.003202230850654,0.003610681755209,0.000986830882672,0.002245466535621,0.002245466535621,0.002245466535621,0.002338957283106,0.002338957283106,0.003202230850654,0.002245466535621,0.002245466535621,0.002245466535621,0.002245466535621,0.002245466535621,0.002245466535621,0.002245466535621,0.003202230850654,0.000986830882672,0.000986830882672,0.002338957283106,0.002245466535621,0.002245466535621,0.002245466535621,0.003202230850654,0.003202230850654,0.000986830882672,0.000986830882672,0.000986830882672,0.000986830882672,0.000986830882672,0.000986830882672,0.000986830882672,0.002245466535621,0.002245466535621,0.002245466535621,0.002245466535621,0.002245466535621,0.003210115856858,0.003210115856858,0.002245466535621,0.003610681755209,0.003610681755209,0.003610681755209,0.003610681755209,0.003610681755209)
L_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.214266623460049,0.214266623460049,0.213734818593878,0.213734818593878,0.213018511248302,0.212319240336786,0.211242879397357,0.212319240336786,0.212319240336786,0.212319240336786,0.212319240336786,0.213018511248302,0.213018511248302,0.213734818593878,0.213734818593878,0.214061621293979,0.221251470582843,0.218624488712858,0.221251470582843,0.224094201545415,0.244674988148769,0.249748231351251,0.235459119019884,0.226126855077736,0.214061621293979,0.205480398405269,0.205480398405269,0.202821770726679,0.199715403456997,0.195619224745268,0.195500825928283,0.192255135778188,0.191324255247753,0.188072343627543,0.18399122851084,0.1814397248901,0.179795311152415,0.179795311152415,0.175798955602662,0.172858766662942,0.170525186493651,0.168496241088071,0.16636926610117,0.160237063223332,0.158191072841927,0.156423416754441,0.151230780673685,0.149745729735641,0.145285806895878,0.143718402832522,0.142367135335527,0.138859288507414,0.137775551643967,0.136245266608107,0.129906545180823,0.127876477711343,0.127876477711343,0.126278583021407,0.125895351090113,0.12571726689831,0.12571726689831,0.122306749166258,0.122306749166258,0.122205527419403,0.122205527419403,0.121295786820475,0.121295786820475,0.121295786820475,0.119179645880071,0.119179645880071,0.1182226224427,0.1182226224427,0.1182226224427,0.1182226224427,0.115739611285108,0.116101648166554,0.112235326720647,0.112235326720647,0.112235326720647,0.110865329579554,0.110865329579554,0.110865329579554,0.1113671559648,0.1113671559648,0.106278030551747,0.106278030551747,0.106278030551747,0.106278030551747,0.106278030551747,0.106278030551747,0.106278030551747,0.106278030551747,0.106278030551747,0.106278030551747,0.106278030551747,0.106278030551747,0.110865329579554,0.1113671559648,0.110865329579554,0.112573246489219,0.112573246489219,0.114404315897224,0.1182226224427,0.120518659149765)
M_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.121884865633771,0.123271037188041,0.123271037188041,0.121884865633771,0.121546217296632,0.119230915781122,0.049870508612447,0.061628392008672,0.061628392008672,0.061628392008672,0.061628392008672,0.061628392008672,0.061628392008672,0.061628392008672,0.062125811017322,0.061628392008672,0.000627174926682,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000587515251956,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.00036177322865,0.00036177322865,0.00036177322865,0.00036177322865,0.00036177322865,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000587515251956,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000587515251956,0.000587515251956,0.000301816286756,0.000587515251956,0.000627174926682,0.000627174926682,0.000627174926682,0.000627174926682,0.000627174926682,0.000627174926682,0.000627174926682,0.000627174926682,0.000627174926682,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756,0.000301816286756)
M_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.433530102155079,0.430434625180402,0.430434625180402,0.433530102155079,0.433530102155079,0.433266100932972,0.313572187019518,0.219569202752851,0.208666988134532,0.20616467579025,0.205534113597795,0.205534113597795,0.20616467579025,0.206357204343252,0.208086485166236,0.208086485166236,0.190841676537465,0.116532133910584,0.087766960780472,0.082714477676229,0.07912939803549,0.078969994053249,0.07912939803549,0.078193179530706,0.076415873204072,0.073730144511674,0.07247807781578,0.071621778929359,0.071621778929359,0.069975243526994,0.069975243526994,0.069975243526994,0.069975243526994,0.069975243526994,0.069975243526994,0.069512034691061,0.068772406637465,0.068318652437517,0.068318652437517,0.068318652437517,0.068318652437517,0.068318652437517,0.068318652437517,0.068318652437517,0.068318652437517,0.068152823771749,0.067377141811251,0.066944822373515,0.064679214956416,0.063179428009073,0.062509564113131,0.061800834666302,0.061800834666302,0.061800834666302,0.058523631130784,0.058523631130784,0.054518761537256,0.054518761537256,0.053442429459261,0.053442429459261,0.053256961823243,0.053256961823243,0.053256961823243,0.053256961823243,0.053256961823243,0.053256961823243,0.053256961823243,0.053256961823243,0.053256961823243,0.051469894389415,0.051469894389415,0.051469894389415,0.051469894389415,0.051469894389415,0.051176363282489,0.051176363282489,0.050921657410627,0.050921657410627,0.050921657410627,0.050921657410627,0.050921657410627,0.050921657410627,0.050921657410627,0.050921657410627,0.050921657410627,0.050921657410627,0.050921657410627,0.049870508612447,0.050921657410627,0.051176363282489,0.051176363282489,0.051176363282489,0.051176363282489,0.051176363282489,0.051176363282489,0.051176363282489,0.051176363282489,0.051176363282489,0.051176363282489,0.051176363282489,0.051176363282489,0.051176363282489,0.051176363282489,0.051176363282489)
R_hpd_m95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.275108487840988,-0.27061585060645,-0.2758490547728,-0.2758490547728,-0.274620803269003,-0.274620803269003,-0.163504579894985,-0.059729658621455,-0.056163735503513,-0.057185618837697,-0.056771826303097,-0.056163735503513,-0.056163735503513,-0.057185618837697,-0.057185618837697,-0.057185618837697,-0.048141613177211,0.008314335283221,0.056312849135194,0.056577844546505,0.054842761027309,0.042009054454334,0.013742096715496,-0.002596894003805,-0.003158386712973,-0.007965986493722,-0.00809457772745,-0.023456438010156,-0.038891463191198,-0.040324481619364,-0.042151256872186,-0.04110505410567,-0.04110505410567,-0.040324481619364,-0.046705950899148,-0.046705950899148,-0.042151256872186,-0.053039753441791,-0.053039753441791,-0.056964090840528,-0.056105646150164,-0.056105646150164,-0.053039753441791,-0.052747495183907,-0.053039753441791,-0.065884548055507,-0.065884548055507,-0.064856336984602,-0.056964090840528,-0.053039753441791,-0.046891243902022,-0.04110505410567,-0.04110505410567,-0.040324481619364,-0.03766451217808,-0.038891463191198,-0.036437145519848,-0.046891243902022,-0.040324481619364,-0.044746338617101,-0.04110505410567,-0.042151256872186,-0.042151256872186,-0.04110505410567,-0.04110505410567,-0.040324481619364,-0.040324481619364,-0.040324481619364,-0.040324481619364,-0.040324481619364,-0.040324481619364,-0.040324481619364,-0.040324481619364,-0.040324481619364,-0.038156821654065,-0.038156821654065,-0.036838931599375,-0.036838931599375,-0.040324481619364,-0.040324481619364,-0.040324481619364,-0.040324481619364,-0.038891463191198,-0.038891463191198,-0.038156821654065,-0.038156821654065,-0.038156821654065,-0.031882784220349,-0.038156821654065,-0.038891463191198,-0.038891463191198,-0.038156821654065,-0.038156821654065,-0.038156821654065,-0.038156821654065,-0.038156821654065,-0.040324481619364,-0.040324481619364,-0.040324481619364,-0.042151256872186,-0.038156821654065,-0.038891463191198,-0.042151256872186,-0.046705950899148)
R_hpd_M95=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.057587919666877,0.057587919666877,0.050071584257926,0.055229292298085,0.057587919666877,0.057587919666877,0.132505071639968,0.127992671984479,0.119712787603662,0.113635299189147,0.113635299189147,0.113635299189147,0.113635299189147,0.113635299189147,0.115613437274562,0.12098049060127,0.199868160099394,0.215141308789189,0.215141308789189,0.215141308789189,0.221272295459795,0.236101557414696,0.231151884823182,0.215141308789189,0.218780429852655,0.215141308789189,0.213665937677196,0.215141308789189,0.203016389312214,0.203016389312214,0.200987673485643,0.199868160099394,0.199006683793864,0.199006683793864,0.192864482416125,0.192864482416125,0.189461346983598,0.179957828319842,0.178529841068311,0.16992425148572,0.16992425148572,0.16992425148572,0.169827838086411,0.168217046898038,0.168217046898038,0.151774683296312,0.148413464646767,0.143792637448947,0.142798374004391,0.142798374004391,0.143792637448947,0.144708499969361,0.143792637448947,0.142798374004391,0.142020595400161,0.139400130607508,0.139400130607508,0.123890832378821,0.129683895362417,0.123890832378821,0.123890832378821,0.122216992043357,0.122216992043357,0.122216992043357,0.122216992043357,0.122048967644095,0.122048967644095,0.122048967644095,0.122048967644095,0.122048967644095,0.121473565250106,0.121473565250106,0.121473565250106,0.121473565250106,0.122048967644095,0.121473565250106,0.121473565250106,0.121473565250106,0.11657777097812,0.116128002518623,0.116128002518623,0.116128002518623,0.11657777097812,0.11657777097812,0.11657777097812,0.11657777097812,0.11657777097812,0.122048967644095,0.11657777097812,0.11657777097812,0.11657777097812,0.11657777097812,0.11657777097812,0.11657777097812,0.11657777097812,0.11657777097812,0.116128002518623,0.116128002518623,0.11657777097812,0.11657777097812,0.122048967644095,0.122048967644095,0.122048967644095,0.121473565250106)
L_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.165396387869364,0.165308025477488,0.165180723087962,0.165180723087962,0.165007057693047,0.164588457348376,0.164295994762629,0.164246878125558,0.164246878125558,0.164246878125558,0.164364626050484,0.164604811076427,0.164604811076427,0.165004348191882,0.165256821602797,0.166874216135321,0.168587874630653,0.169944501037994,0.170834311100636,0.172326942636935,0.180811024476833,0.184932352709703,0.178988537659862,0.165588635507394,0.154526655833246,0.14338347421684,0.136340847064943,0.12712173453121,0.120183822531722,0.112010931650234,0.105806973456537,0.098290929632483,0.093212219751039,0.085866544790013,0.080532698284727,0.07641874179715,0.072090136174888,0.068762526044987,0.066012141532125,0.062231491339449,0.058596333866605,0.056488320863143,0.054633529738541,0.051459536918859,0.050132583549934,0.049287023744775,0.047906740758602,0.047048208573971,0.046015994433648,0.04515966093699,0.044357338082425,0.043423266319653,0.042806543711757,0.042101483207462,0.041314690914486,0.041055645170488,0.041055645170488,0.040215205736978,0.040080102104656,0.039974560809421,0.039769682200521,0.039665864303038,0.0395360469005,0.039472427016173,0.039472427016173,0.039229630051366,0.039229630051366,0.039115129362905,0.038973808034963,0.038973808034963,0.038800958498349,0.038800958498349,0.038800958498349,0.038800958498349,0.038425576739475,0.038281298261883,0.038115352873465,0.038115352873465,0.037865359099382,0.037765376499167,0.037765376499167,0.037765376499167,0.037700892590824,0.037700892590824,0.037473645114871,0.037473645114871,0.037509076399491,0.037509076399491,0.037509076399491,0.037509076399491,0.037509076399491,0.037414839912283,0.037485732505265,0.037485732505265,0.037548271003941,0.037558426868961,0.03800973889407,0.038114769326966,0.03817151834839,0.038869117885165,0.039389163316023,0.039806877504124,0.041887921385019,0.042635481437998)
M_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,0.261384416203311,0.258386785833871,0.258185116676663,0.259982706153397,0.259409952840226,0.256004997224109,0.163412345629651,0.14290001447494,0.139899604783956,0.138388829698481,0.13821458444971,0.13821458444971,0.138093621816774,0.13815300220043,0.137990671854431,0.137580866696556,0.086127176450345,0.029998787235463,0.021160113843288,0.019823744827926,0.018914207163932,0.018791216196339,0.018703456486232,0.018446552956376,0.018207288858218,0.018011058588828,0.017848193122514,0.017642077747787,0.017642077747787,0.017549570304904,0.01749184088146,0.01749184088146,0.01749184088146,0.017529378823689,0.017529378823689,0.017463460767997,0.017234599494678,0.017066306076656,0.017066306076656,0.017066306076656,0.01707403685983,0.01707403685983,0.01707403685983,0.017115377688854,0.017115377688854,0.016878210115338,0.016844386531615,0.016656008867664,0.01609848797046,0.015932535630606,0.015788342038838,0.015626043904905,0.015626043904905,0.015626043904905,0.015417558467816,0.015367719570466,0.014939133637746,0.014939133637746,0.014879705186905,0.014716853511438,0.014590417837235,0.014590417837235,0.014590417837235,0.014544324307434,0.014544324307434,0.014544324307434,0.014544324307434,0.014544324307434,0.014544324307434,0.014509651328239,0.014509651328239,0.014509651328239,0.014509651328239,0.014509651328239,0.014471202578293,0.014471202578293,0.014405369710553,0.014417289437436,0.014408196788705,0.014408196788705,0.014408196788705,0.014408196788705,0.014408196788705,0.014408196788705,0.014408196788705,0.014408196788705,0.014378267859313,0.014340164951681,0.014617913782384,0.0147622044944,0.0147622044944,0.014811910721308,0.014811910721308,0.014811910721308,0.014811910721308,0.014811910721308,0.014811910721308,0.014811910721308,0.014811910721308,0.014811910721308,0.014811910721308,0.014811910721308,0.014811910721308,0.014811910721308)
R_mean=c(NA, NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,NA,-0.095988028333947,-0.093078760356383,-0.093004393588702,-0.094801983065436,-0.094402895147179,-0.091416539875733,0.000883649132978,0.021346863650618,0.024347273341603,0.025858048427077,0.026150041600775,0.026390226626718,0.026511189259653,0.026851345991452,0.027266149748366,0.029293349438765,0.082460698180308,0.139945713802531,0.149674197257348,0.152503197809009,0.161896817312901,0.166141136513365,0.16028508117363,0.147142082551018,0.136319366975028,0.125372415628011,0.118492653942429,0.109479656783423,0.102541744783935,0.09446136134533,0.088315132575077,0.080799088751023,0.075720378869579,0.068337165966324,0.063003319461038,0.058955281029153,0.054855536680211,0.051696219968332,0.04894583545547,0.045165185262793,0.041522297006775,0.039414284003313,0.037559492878711,0.034344159230005,0.03301720586108,0.032408813629437,0.031062354226987,0.030392199706307,0.029917506463187,0.029227125306384,0.028568996043587,0.027797222414748,0.027180499806852,0.026475439302557,0.025897132446669,0.025687925600021,0.026116511532742,0.025276072099232,0.025200396917751,0.025257707297982,0.025179264363286,0.025075446465803,0.024945629063265,0.024928102708739,0.024928102708739,0.024685305743932,0.024685305743932,0.02457080505547,0.024429483727528,0.024464156706724,0.02429130717011,0.02429130717011,0.02429130717011,0.02429130717011,0.023954374161182,0.02381009568359,0.023709983162911,0.023698063436029,0.023457162310677,0.023357179710462,0.023357179710462,0.023357179710462,0.023292695802119,0.023292695802119,0.023065448326166,0.023065448326166,0.023130808540178,0.02316891144781,0.022891162617107,0.022746871905091,0.022746871905091,0.022602929190975,0.022673821783957,0.022673821783957,0.022736360282633,0.022746516147653,0.023197828172762,0.023302858605658,0.023359607627082,0.024057207163857,0.024577252594715,0.024994966782816,0.027076010663711,0.02782357071669)
trans=0.5
age=(-1:(171-2))* -1

# Plot Speciation and Extinction rates
plot(age,age,type = 'n', ylim = c(0, 0.8), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My',main="g - Sakamoto et al.'s Hadrosauridae Data\nSpeciation and Extinction Rates")
plot_RTT(age,L_hpd_M95,L_hpd_m95,L_mean,"#4c4cec")
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot_RTT(age,M_hpd_M95,M_hpd_m95,M_mean,"#e34a33")
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
legend(-100, 1.2, legend = c("Speciation rate", "Extinction rate"), col=c("#4c4cec","#e34a33"), lwd=2, bty = "n")


# Plot Diversification rate
plot(age,age,type = 'n', ylim = c(-0.6, 0.6), xlim = c(-100,-66), ylab = 'Rates (events / My / lineage)', xlab = 'My', main = "h - Sakamoto et al.'s Hadrosauridae Data\nDiversification rate")
abline(h=0,lty=2,col="darkred")
abline(v=c(-72.1, -83.6, -86.3, -89.8, -93.9, -100.5),lty=2,col="lightgrey")
abline(v=-66.0, lty=2, lwd=2, col="red")
plot_RTT(age,R_hpd_M95,R_hpd_m95,R_mean,"#504A4B")
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
legend(-100, 1.2, legend = c("Net diversification rate"), col=c("#504A4B"), lwd=2, bty = "n")

n <- dev.off()